<!DOCTYPE html><html><head><meta charset="utf-8"/>
<link rel="stylesheet" href="../../../zoo/sh/styles/aplsimple.css">
<title>::trimmer reference</title>
<style>
/*
Copyright (c) 2009, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.net/yui/license.txt
version: 2.7.0
*/
html{color:#000;background:#FFF;}body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,code,form,fieldset,legend,input,button,textarea,p,blockquote,th,td{margin:0;padding:0;}table{border-collapse:collapse;border-spacing:0;}fieldset,img{border:0;}address,caption,cite,code,dfn,em,strong,th,var,optgroup{font-style:inherit;font-weight:inherit;}del,ins{text-decoration:none;}li{list-style:none;}caption,th{text-align:left;}h1,h2,h3,h4,h5,h6{font-size:100%;font-weight:normal;}q:before,q:after{content:'';}abbr,acronym{border:0;font-variant:normal;}sup{vertical-align:baseline;}sub{vertical-align:baseline;}legend{color:#000;}input,button,textarea,select,optgroup,option{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;}input,button,textarea,select{*font-size:100%;}body{font:13px/1.231 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small;}select,input,button,textarea,button{font:99% arial,helvetica,clean,sans-serif;}table{font-size:inherit;font:100%;}pre,code,kbd,samp,tt{font-family:Consolas,"Courier New",monospace;font-size:100%;line-height:100%;}body{text-align:center;}#doc,#doc2,#doc3,#doc4,.yui-t1,.yui-t2,.yui-t3,.yui-t4,.yui-t5,.yui-t6,.yui-t7{margin:auto;text-align:left;width:57.69em;*width:56.25em;}#doc2{width:73.076em;*width:71.25em;}#doc3{margin:auto;width:auto;}#doc4{width:74.923em;*width:73.05em;}.yui-b{position:relative;}.yui-b{_position:static;}#yui-main .yui-b{position:static;}#yui-main,.yui-g .yui-u .yui-g{width:100%;}.yui-t1 #yui-main,.yui-t2 #yui-main,.yui-t3 #yui-main{float:right;margin-left:-25em;}.yui-t4 #yui-main,.yui-t5 #yui-main,.yui-t6 #yui-main{float:left;margin-right:-25em;}.yui-t1 .yui-b{float:left;width:12.30769em;*width:12.00em;}.yui-t1 #yui-main .yui-b{margin-left:13.30769em;*margin-left:13.05em;}.yui-t2 .yui-b{float:left;width:9.8461em;*width:13.50em;}.yui-t2 #yui-main .yui-b{margin-left:10.8461em;*margin-left:14.55em;}.yui-t3 .yui-b{float:left;width:23.0769em;*width:22.50em;}.yui-t3 #yui-main .yui-b{margin-left:24.0769em;*margin-left:23.62em;}.yui-t4 .yui-b{float:right;width:13.8456em;*width:13.50em;}.yui-t4 #yui-main .yui-b{margin-right:14.8456em;*margin-right:14.55em;}.yui-t5 .yui-b{float:right;width:18.4615em;*width:18.00em;}.yui-t5 #yui-main .yui-b{margin-right:19.4615em;*margin-right:19.125em;}.yui-t6 .yui-b{float:right;width:23.0769em;*width:22.50em;}.yui-t6 #yui-main .yui-b{margin-right:24.0769em;*margin-right:23.62em;}.yui-t7 #yui-main .yui-b{display:block;margin:0 0 1em 0;}#yui-main .yui-b{float:none;width:auto;}.yui-gb .yui-u,.yui-g .yui-gb .yui-u,.yui-gb .yui-g,.yui-gb .yui-gb,.yui-gb .yui-gc,.yui-gb .yui-gd,.yui-gb .yui-ge,.yui-gb .yui-gf,.yui-gc .yui-u,.yui-gc .yui-g,.yui-gd .yui-u{float:left;}.yui-g .yui-u,.yui-g .yui-g,.yui-g .yui-gb,.yui-g .yui-gc,.yui-g .yui-gd,.yui-g .yui-ge,.yui-g .yui-gf,.yui-gc .yui-u,.yui-gd .yui-g,.yui-g .yui-gc .yui-u,.yui-ge .yui-u,.yui-ge .yui-g,.yui-gf .yui-g,.yui-gf .yui-u{float:right;}.yui-g div.first,.yui-gb div.first,.yui-gc div.first,.yui-gd div.first,.yui-ge div.first,.yui-gf div.first,.yui-g .yui-gc div.first,.yui-g .yui-ge div.first,.yui-gc div.first div.first{float:left;}.yui-g .yui-u,.yui-g .yui-g,.yui-g .yui-gb,.yui-g .yui-gc,.yui-g .yui-gd,.yui-g .yui-ge,.yui-g .yui-gf{width:49.1%;}.yui-gb .yui-u,.yui-g .yui-gb .yui-u,.yui-gb .yui-g,.yui-gb .yui-gb,.yui-gb .yui-gc,.yui-gb .yui-gd,.yui-gb .yui-ge,.yui-gb .yui-gf,.yui-gc .yui-u,.yui-gc .yui-g,.yui-gd .yui-u{width:32%;margin-left:1.99%;}.yui-gb .yui-u{*margin-left:1.9%;*width:31.9%;}.yui-gc div.first,.yui-gd .yui-u{width:66%;}.yui-gd div.first{width:32%;}.yui-ge div.first,.yui-gf .yui-u{width:74.2%;}.yui-ge .yui-u,.yui-gf div.first{width:24%;}.yui-g .yui-gb div.first,.yui-gb div.first,.yui-gc div.first,.yui-gd div.first{margin-left:0;}.yui-g .yui-g .yui-u,.yui-gb .yui-g .yui-u,.yui-gc .yui-g .yui-u,.yui-gd .yui-g .yui-u,.yui-ge .yui-g .yui-u,.yui-gf .yui-g .yui-u{width:49%;*width:48.1%;*margin-left:0;}.yui-g .yui-g .yui-u{width:48.1%;}.yui-g .yui-gb div.first,.yui-gb .yui-gb div.first{*margin-right:0;*width:32%;_width:31.7%;}.yui-g .yui-gc div.first,.yui-gd .yui-g{width:66%;}.yui-gb .yui-g div.first{*margin-right:4%;_margin-right:1.3%;}.yui-gb .yui-gc div.first,.yui-gb .yui-gd div.first{*margin-right:0;}.yui-gb .yui-gb .yui-u,.yui-gb .yui-gc .yui-u{*margin-left:1.8%;_margin-left:4%;}.yui-g .yui-gb .yui-u{_margin-left:1.0%;}.yui-gb .yui-gd .yui-u{*width:66%;_width:61.2%;}.yui-gb .yui-gd div.first{*width:31%;_width:29.5%;}.yui-g .yui-gc .yui-u,.yui-gb .yui-gc .yui-u{width:32%;_float:right;margin-right:0;_margin-left:0;}.yui-gb .yui-gc div.first{width:66%;*float:left;*margin-left:0;}.yui-gb .yui-ge .yui-u,.yui-gb .yui-gf .yui-u{margin:0;}.yui-gb .yui-gb .yui-u{_margin-left:.7%;}.yui-gb .yui-g div.first,.yui-gb .yui-gb div.first{*margin-left:0;}.yui-gc .yui-g .yui-u,.yui-gd .yui-g .yui-u{*width:48.1%;*margin-left:0;}.yui-gb .yui-gd div.first{width:32%;}.yui-g .yui-gd div.first{_width:29.9%;}.yui-ge .yui-g{width:24%;}.yui-gf .yui-g{width:74.2%;}.yui-gb .yui-ge div.yui-u,.yui-gb .yui-gf div.yui-u{float:right;}.yui-gb .yui-ge div.first,.yui-gb .yui-gf div.first{float:left;}.yui-gb .yui-ge .yui-u,.yui-gb .yui-gf div.first{*width:24%;_width:20%;}.yui-gb .yui-ge div.first,.yui-gb .yui-gf .yui-u{*width:73.5%;_width:65.5%;}.yui-ge div.first .yui-gd .yui-u{width:65%;}.yui-ge div.first .yui-gd div.first{width:32%;}#hd:after,#bd:after,#ft:after,.yui-g:after,.yui-gb:after,.yui-gc:after,.yui-gd:after,.yui-ge:after,.yui-gf:after{content:".";display:block;height:0;clear:both;visibility:hidden;}#hd,#bd,#ft,.yui-g,.yui-gb,.yui-gc,.yui-gd,.yui-ge,.yui-gf{zoom:0;}

body{margin:10px;}h1{font-size:138.5%;}h2{font-size:123.1%;}h3{font-size:108%;}h1,h2,h3{margin:1em 0;}h1,h2,h3,h4,h5,h6,strong,dt{font-weight:bold;}optgroup{font-weight:normal;}abbr,acronym{border-bottom:1px dotted #000;cursor:help;}em{font-style:italic;}del{text-decoration:line-through;}blockquote,ul,ol,dl{margin:1em;}ol,ul,dl{margin-left:2em;}ol li{list-style:decimal outside;}ul li{list-style:disc outside;}dl dd{margin-left:1em;}th,td{border:1px solid #000;padding:.5em;}th{font-weight:bold;text-align:center;}caption{margin-bottom:.5em;text-align:center;}sup{vertical-align:super;}sub{vertical-align:sub;}p,fieldset,table,pre{margin-bottom:1em;}button,input[type="checkbox"],input[type="radio"],input[type="reset"],input[type="submit"]{padding:1px;}

/* Ruff default CSS */

body {
  /*max-width: 70em;*/
  margin: 0;
}

h1,h2 {
  color: #888888;
  margin-bottom: 0.5em;
  margin-top: 0em;
}

#ft { font-size: x-small; font-family: Arial, sans-serif;
  text-align: left;
  border-top: 1px solid #0B3467;
  color: #888888;
  margin-top: 10px;
}

.banner h2 {
  color: #0B3467;
}

#hd.banner {
 font-family: "Times New Roman", serif;
 font-size: 200%;
 line-height: 64px;
 border-bottom: thin solid #0B3467;
 color: #0B3467;
}

p.linkline {
  text-align: right;
  font-size: smaller;
  /*    margin-top: -1em; */
  margin-bottom: 0;
}

.tinylink {
  font-size: x-small;
  font-variant: normal;
  font-family: Arial, sans-serif;
  float: right;
  padding:2px;
}

h1 .tinylink a {
  color: white;
}

#bd {
font-family: Arial, sans-serif;
/*font-size: 108%;*/
}

div.navbox {
  /* margin-top: 1em; */
  background-color: #0B3467;
  color: white;
  padding: 3px 4px 2px 4px;
  font-family: Arial, sans-serif;
  overflow: hidden;
}

div.navbox:hover {
  overflow: visible;
}

/* Note .navbox header css should be based on $header_levels */
.navbox h1, .navbox h2, .navbox h3, .navbox h4, .navbox h5 {
  font-size: 85%;
  margin: 0px;
  font-weight: normal;
}
.navbox h1 {
  font-weight: bold; /* Override */
}
.navbox h2 {
  padding-left: 1em;
}
.navbox h3 {
  padding-left: 2em;
}
.navbox h4 {
  padding-left: 2.5em;
  font-weight: normal;
}
.navbox h5 {
  padding-left: 3em;
  font-weight: normal;
}
.navbox hr {
  color: white;
  margin-top:0.1em;
  margin-bottom:0.1em;
}

.navbox a:link, .navbox a:visited, .navbox a:hover {
  text-decoration: none;
  color: white;
  background-color: #0B3467;
}

.navbox a:hover {
   font-weight: bold;
}

/* Tooltip text - see https://www.w3schools.com/css/css_tooltip.asp */
.tooltip {
  position: relative;
  /* display: inline-block; */
}

.tooltip .tooltiptext {
  width: 100%;
  font-weight: bold;
  background-color: white;
  color: #0B3467;
  text-align: left;
  border: 1px solid #0B3467;
  /* border-radius: 4px; */
  position: absolute;
  z-index: 1;
  margin-left: 4px;
  padding: 2px 3px;
  visibility: hidden;
}

/* Show the tooltip text when you mouse over the tooltip container */
.tooltip:hover .tooltiptext {
  visibility: visible;
}

span.ns_scope {
  color: #aaaaaa;
}

span.ns_scope a:link, span.ns_scope a:visited {
  text-decoration: none;
  color: #aaaaaa;

}

li {
  margin-top: 0.5em;
}

span.ns_scope a:hover {
  text-decoration: none;
  color: #666666;
}

table {
  margin: 1em;
  margin-top: 0.5em;
  border: thin solid;
  border-collapse: collapse;
  border-color: #808080;
  padding: 4px;
}

td {
  border: thin solid;
  border-color: #808080;
  vertical-align: top;
  font-size: 93%;
  padding: 0.3em;
  padding-top: 0.1em;
}
th {
  border: thin solid;
  border-color: #808080;
  padding: 0.3em;
  padding-top: 0.1em;
  background-color: #CCCCCC;
}

dt, dd {
   font-size: 93%;
}

h1.ruff {
  background-color: #0B3467;
  color: #ffffff;
  padding-left: 0.2em;
  font-family: "Times New Roman", serif;
}
h2.ruff {
  font-variant: small-caps;
  color: #0B3467;
  font-weight: bold;
  font-family: "Times New Roman", serif;
}

h3.ruff, h4.ruff, h5.ruff, h6.ruff {
  color: #0B3467;
}
h5.ruff {
  font-style: italic;
  font-weight: normal;
}
h6.ruff {
  font-weight: normal;
}
h3.ruffclass, h3.ruffproc, h3.ruffmethod,
h4.ruffclass, h4.ruffproc, h4.ruffmethod,
h5.ruffclass, h5.ruffproc, h5.ruffmethod {
  border-bottom: thin solid #0B3467;
  color: #0B3467;
  margin-bottom: 0.2em;
}

pre {
  background-color: #f9f9f9;
  margin-top: 1em;
  margin-left: 1em;
  padding: 5px;
  font-family: Consolas, "Courier New", monospace;
  /* width: max-content; --- to leave footsteps */ overflow: auto;
  line-height: 1.2em;
}

.ruff_dyn_src {
  display: none; /* Displayed via JS */
}

.ruff_synopsis {
  border: thin solid #cccccc;
  background: #f9f9f9;
  font-family: Consolas, "Courier New", monospace;
  padding: 5px;
  margin: 0em 2em 1em;
}
.ruff_const, .ruff_cmd, ruff_defitem {
  font-weight: bold;
  font-family: Consolas, "Courier New", monospace;
}
.ruff_arg {
  font-style: italic;
  font-family: Consolas, "Courier New", monospace;
}

.ruff_source_link {
  font-size: smaller;
}

.ruff_index {
  font-size: small;
  color: grey;
  line-height: 1;
}

.ruff_index ul li {
  list-style-type: none;
}

.ruff_index ul li a {
  text-decoration: none;
}
</style>
<script>function toggleSource( id )
{
  /* Copied from Rails */
  var elem
  var link

  if( document.getElementById )
  {
      elem = document.getElementById( id )
      link = document.getElementById( "l_" + id )
  }
  else if ( document.all )
  {
      elem = eval( "document.all." + id )
      link = eval( "document.all.l_" + id )
  }
  else
      return false;

  if( elem.style.display == "block" )
  {
      elem.style.display = "none"
      link.innerHTML = "Show source"
  }
  else
  {
      elem.style.display = "block"
      link.innerHTML = "Hide source"
  }
}
</script></head>
<meta name="author" content="aplsimple">
<meta name="description" content="aplsimple's home page">
<meta name="keywords" content="aplsimple,home">
<link rel="stylesheet" href="../../../en/zoo/style.css">
<style>
table{
background-color: #f9f9f9;
margin: 0%;
margin-bottom: 2%;
padding: 0%;
box-shadow: none;
filter: none;
}
pre{
margin: 0%;
margin-bottom: 2%;
padding: 0%;
}
</style>
<link rel="icon" type="image/jpg" href="../../../zoo/favicon.jpg">
<body>
<div id="wrapper">
<div name="divd1" ALIGN="CENTER"> <FONT SIZE=5em color=#b01c20><B>
<noscript>THIS PAGE IS NOT WORKING WITHOUT JAVASCRIPT!
<BR>
<BR>PLEASE, SWITCH ON JAVASCRIPT IN SETTINGS OF YOUR BROWSER AND RELOAD THE PAGE.
</noscript>
</B></FONT></div>
<div id='doc3' class='yui-t2'>
<script src="../../../zoo/funcs.js"></script>
<script src="../../../en/zoo/this.js"></script>
<section id=sec2>
<div id='hd' class='banner'>
<a name='trimmer.html'>::trimmer reference</a>
</div>
<div id='bd'><div id='yui-main'><div class='yui-b'><h1 class='ruff'><a name='::trimmer'></a>::trimmer<span class='tinylink'><a href='#top'>Top</a></span></h1>
<div style='clear:both;'></div>
<p class='ruff'>Trimming a Tcl source file off comments and whitespaces.</p>
<br><h2 class='ruff'><a name='::trimmer-License'></a>License<span class='tinylink'><a href='#::trimmer'>trimmer</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>MIT.</p>
<br><h2 class='ruff'><a name='::trimmer-Download'></a>Download<span class='tinylink'><a href='#::trimmer'>trimmer</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'><a href="https://chiselapp.com/user/aplsimple/repository/trimmer/download" >trimmer.zip</a></p>
<br><h2 class='ruff'><a name='::trimmer-Usage'></a>Usage<span class='tinylink'><a href='#::trimmer'>trimmer</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<pre class='ruff'><br><code class="tcl">tclsh trim.tcl [glob_ptn] [-i idir|ifile] [-o odir] [-r] [-f] [-n] [--] [app args]
</code><br></pre>
<p class='ruff'>where:</p>
<table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code>glob_ptn</code></td><td class='ruff_defitem'>sets a glob pattern instead of *.tcl that is default</td></tr>
<tr><td class='ruff_defitem'><code>-i idir</code></td><td class='ruff_defitem'>a directory of files to process (by default ./)</td></tr>
<tr><td class='ruff_defitem'><code>-i ifile</code></td><td class='ruff_defitem'>a file listing .tcl files (#-comments disregarded)</td></tr>
<tr><td class='ruff_defitem'><code>-o odir</code></td><td class='ruff_defitem'>a directory of resulting files (by default ../release)</td></tr>
<tr><td class='ruff_defitem'><code>app</code></td><td class='ruff_defitem'>an application to be run after trimming</td></tr>
<tr><td class='ruff_defitem'><code>args</code></td><td class='ruff_defitem'>optional arguments of <code>app</code></td></tr>
</table>
<p class='ruff'>The <code>-i</code> (or <code>--input</code>) can be multiple, <code>-o</code> (or <code>--output</code>) can not.</p>
<p class='ruff'>The command switches mean:</p>
<ul class='ruff'>
<li>If <code>-r</code> (or <code>--recursive</code>) is set, the input directories are processed recursively. By default, they are processed non-recursively.</li>
<li>If <code>-f</code> (or <code>--force</code>) is set, the existing output file(s) will be rewritten. By default, the <em>trim.tcl</em> doesn't rewrite the existing file(s).</li>
<li>If <code>-n</code> (or <code>--no</code>) is set, no real changes made, supposed changes shown only.</li>
</ul>
<p class='ruff'>The <em>trim.tcl</em> by no means changes the input file(s).</p>
<p class='ruff'>Example:</p>
<pre class='ruff'><br><code class="tcl">tclsh trim.tcl <font color=#6c3e67>-i</font> ./lib <font color=#6c3e67>-o</font> ./bin tclsh <font color=#6c3e67>-f</font> ./bin/main.tcl arg1 <font color=#8b2a0e>&quot;arg 2&quot;</font>
</code><br></pre>
<br><h2 class='ruff'><a name='::trimmer-Limitations'></a>Limitations<span class='tinylink'><a href='#::trimmer'>trimmer</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>The <em>trim.tcl</em> sets the following limitations for the code processed:</p>
<p class='ruff'><strong>1.</strong> In general, multi-line strings should be double-quoted (not braced), because the braced strings would be trimmed. But there are two important exceptions: when <em>set</em> and <em>variable</em> commands use a braced string, it is not trimmed, e.g.</p>
<pre class='ruff'><br><code class="tcl"><b><font color=#3a6797>set</font></b> str1 <font color=#8b2a0e>&quot;</font>
<font color=#8b2a0e>   Correct&quot;</font>       ;<i><font color=#4b5d50># equals to set str1 &quot;\n   Correct&quot;</font></i>
<b><font color=#3a6797>set</font></b> str1 {
   Correct}       ;<i><font color=#4b5d50># equals to set str1 &quot;\n   Correct&quot;</font></i>
<b><font color=#3a6797>variable</font></b> str2 <font color=#8b2a0e>&quot;</font>
<font color=#8b2a0e>   Correct&quot;</font>       ;<i><font color=#4b5d50># equals to variable str2 &quot;\n   Correct&quot;</font></i>
<b><font color=#3a6797>variable</font></b> str2 {
   Correct}       ;<i><font color=#4b5d50># equals to variable str2 &quot;\n   Correct&quot;</font></i>
<b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot;</font>
<font color=#8b2a0e>   Correct&quot;</font>       ;<i><font color=#4b5d50># equals to puts &quot;\n   Correct&quot;</font></i>
<b><font color=#3a6797>puts</font></b> {
  NOT CORRECT}  ;<i><font color=#4b5d50># equals to puts &quot;NOT CORRECT&quot;</font></i>
</code><br></pre>
<p class='ruff'><strong>2.</strong> Comments after &quot;{&quot; should begin with &quot;;#&quot;, e.g.</p>
<pre class='ruff'><br><code class="tcl"><b><font color=#3a6797>while</font></b> {true} {  ;<i><font color=#4b5d50># infinite cycle</font></i>
}
</code><br></pre>
<p class='ruff'><strong>3.</strong> <em>List</em> or <em>switch</em> commands can contain comments which are not considered to be meaningful items, e.g.</p>
<pre class='ruff'><br><code class="tcl"><b><font color=#3a6797>switch</font></b> <font color=#1b1baa>$option</font> {
   <i><font color=#4b5d50># it's a comment (and the error in standard Tcl switch)</font></i>
   <font color=#6c3e67>-opt1</font> {
   <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot;-opt1 processed&quot;</font>
   }
   <i><font color=#4b5d50># ...</font></i>
}
</code><br></pre>
<p class='ruff'>The 1st limitation is rarely encountered and easily overcome with \n escape sequences.</p>
<p class='ruff'>The last two limitations are actually the advantages of the utility.</p>
<p class='ruff'>The 2nd requires a bit more discipline of coders.</p>
<p class='ruff'>The 3rd eliminates Tcl comment freaks, incl. unmatched braces.</p>
<p class='ruff'>The <em>trim.tcl</em> and <em>trim_test.tcl</em> set examples of this in action:</p>
<pre class='ruff'><br><code class="tcl">tclsh trim.tcl <font color=#6c3e67>-f</font> <font color=#6c3e67>-o</font> trimmed

tclsh trim_test.tcl <font color=#6c3e67>-f</font> <font color=#6c3e67>-o</font> trimmed

tclsh trimmed/trim.tcl <font color=#6c3e67>-f</font> <font color=#6c3e67>-o</font> trimmed

tclsh trimmed/trim_test.tcl <font color=#6c3e67>-f</font> <font color=#6c3e67>-o</font> trimmed
</code><br></pre>
<br><h2 class='ruff'><a name='::trimmer-Commands'></a>Commands<span class='tinylink'><a href='#::trimmer'>trimmer</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<br><br><br><h4 class='ruffproc'><a name='::trimmer::countCh'>countCh</a><span class='ns_scope'> [<a href="#::trimmer" title="::trimmer" class='ruff_cmd'>::trimmer</a>]</span><span class='tinylink'><a href='#::trimmer'>trimmer</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Counts a character in a string.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>countCh</span> <span class='ruff_arg'>str ch</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code>str</code></td><td class='ruff_defitem'>a string</td></tr>
<tr><td class='ruff_defitem'><code>ch</code></td><td class='ruff_defitem'>a character</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns a number of non-escaped occurences of character <em>ch</em> in string <em>str</em>.</p>
<h5 class='ruff'>See also</h5><p class='ruff'><a href="https://wiki.tcl-lang.org/page/Reformatting+Tcl+code+indentation" >wiki.tcl-lang.org</a></p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_trimmer_countCh' href="javascript:toggleSource('trimmer_countCh')">Show source</a></p>
<div id='trimmer_countCh' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::trimmer::countCh {str ch} {
  <i><font color=#4b5d50># Counts a character in a string.</font></i>
  <i><font color=#4b5d50>#   str - a string</font></i>
  <i><font color=#4b5d50>#   ch - a character</font></i>
  <i><font color=#4b5d50>#</font></i>
  <i><font color=#4b5d50># Returns a number of non-escaped occurences of character *ch* in</font></i>
  <i><font color=#4b5d50># string *str*.</font></i>
  <i><font color=#4b5d50>#</font></i>
  <i><font color=#4b5d50># See also:</font></i>
  <i><font color=#4b5d50># [wiki.tcl-lang.org](https://wiki.tcl-lang.org/page/Reformatting+Tcl+code+indentation)</font></i>

  <b><font color=#3a6797>set</font></b> icnt 0
  <b><font color=#3a6797>while</font></b> {[<b><font color=#3a6797>set</font></b> idx [<b><font color=#3a6797>string</font></b> first <font color=#1b1baa>$ch</font> <font color=#1b1baa>$str</font>]] &gt;= 0} {
    <b><font color=#3a6797>set</font></b> backslashes 0
    <b><font color=#3a6797>set</font></b> nidx <font color=#1b1baa>$idx</font>
    <b><font color=#3a6797>while</font></b> {[<b><font color=#3a6797>string</font></b> equal [<b><font color=#3a6797>string</font></b> index <font color=#1b1baa>$str</font> [<b><font color=#3a6797>incr</font></b> nidx -1]] \\]} {
      <b><font color=#3a6797>incr</font></b> backslashes
    }
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$backslashes</font> % 2 == 0} { <b><font color=#3a6797>incr</font></b> icnt }
    <b><font color=#3a6797>set</font></b> str [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$str</font> [<b><font color=#3a6797>incr</font></b> idx] end]
  }
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$icnt</font>
}</code><br></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::trimmer::trimFile'>trimFile</a><span class='ns_scope'> [<a href="#::trimmer" title="::trimmer" class='ruff_cmd'>::trimmer</a>]</span><span class='tinylink'><a href='#::trimmer'>trimmer</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Trims an input file and writes a result to an output file.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>trimFile</span> <span class='ruff_arg'>finp fout ?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code>finp</code></td><td class='ruff_defitem'>input file name</td></tr>
<tr><td class='ruff_defitem'><code>fout</code></td><td class='ruff_defitem'>output file name</td></tr>
<tr><td class='ruff_defitem'><code>args</code></td><td class='ruff_defitem'>additional parameters (so far not used)</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_trimmer_trimFile' href="javascript:toggleSource('trimmer_trimFile')">Show source</a></p>
<div id='trimmer_trimFile' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::trimmer::trimFile {finp fout args} {
  <i><font color=#4b5d50># Trims an input file and writes a result to an output file.</font></i>
  <i><font color=#4b5d50>#   finp - input file name</font></i>
  <i><font color=#4b5d50>#   fout - output file name</font></i>
  <i><font color=#4b5d50>#   args - additional parameters (so far not used)</font></i>

  <b><font color=#3a6797>if</font></b> { [<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> chani [<b><font color=#3a6797>open</font></b> <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>finp&quot;</font> <font color=#8b2a0e>&quot;r&quot;</font>]} e] } {
    batchio::onError <font color=#1b1baa>$e</font> 0
    <b><font color=#ca14ca>return</font></b>
  }
  <b><font color=#3a6797>if</font></b> { [<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> chano [<b><font color=#3a6797>open</font></b> <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>fout&quot;</font> <font color=#8b2a0e>&quot;w&quot;</font>]} e] } {
    <b><font color=#3a6797>close</font></b> <font color=#1b1baa>$chani</font>
    batchio::onError <font color=#1b1baa>$e</font> 0
    <b><font color=#ca14ca>return</font></b>
  }
  <b><font color=#3a6797>chan</font></b> configure <font color=#1b1baa>$chani</font> <font color=#6c3e67>-encoding</font> utf-8
  <b><font color=#3a6797>chan</font></b> configure <font color=#1b1baa>$chano</font> <font color=#6c3e67>-encoding</font> utf-8
  <b><font color=#3a6797>set</font></b> brace [<b><font color=#3a6797>set</font></b> braceST [<b><font color=#3a6797>set</font></b> ccmnt -2]]
  <b><font color=#3a6797>set</font></b> quoted [<b><font color=#3a6797>set</font></b> cbrc 0]
  <b><font color=#3a6797>while</font></b> {[<b><font color=#3a6797>gets</font></b> <font color=#1b1baa>$chani</font> line] &gt;= 0} {
    <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$quoted</font>} {      ;<i><font color=#4b5d50># it's not a multi-line quoted string</font></i>
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$braceST</font>&lt;1} {  ;<i><font color=#4b5d50># check a braced string at some important commands</font></i>
        <b><font color=#3a6797>foreach</font></b> {cmd a1} {<b><font color=#3a6797>set</font></b> <font color=#8b2a0e>&quot;\\S&quot;</font> variable <font color=#8b2a0e>&quot;\\S&quot;</font>} {
          <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> braceST [<b><font color=#3a6797>regexp</font></b> <font color=#8b2a0e>&quot;^\\s*<font color=#1b1baa>$</font>cmd\\s+<font color=#1b1baa>$</font>a1+\\s+\{&quot;</font> <font color=#1b1baa>$line</font>]]} {
            <b><font color=#3a6797>set</font></b> line <font color=#8b2a0e>&quot;\n<font color=#1b1baa>[</font>string trimleft <font color=#1b1baa>$</font>line<font color=#1b1baa>]</font>&quot;</font>
            <b><font color=#3a6797>set</font></b> cbrc 0
            <b><font color=#ca14ca>break</font></b>
          }
        }
      }
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$braceST</font>&gt;-2} {
        <b><font color=#3a6797>incr</font></b> cbrc [ <b><font color=#3a6797>expr</font></b> {[countCh <font color=#1b1baa>$line</font> <font color=#8b2a0e>&quot;\{&quot;</font>] - [countCh <font color=#1b1baa>$line</font> <font color=#8b2a0e>&quot;\}&quot;</font>]} ]
      }
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$braceST</font>&gt;0} {  ;<i><font color=#4b5d50># check matching left/right braces</font></i>
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$cbrc</font>&lt;=0} {
          <b><font color=#3a6797>set</font></b> brace [<b><font color=#3a6797>set</font></b> braceST -1]
        } <b><font color=#3a6797>else</font></b> {
          <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chano</font> <font color=#1b1baa>$line</font>
          <b><font color=#ca14ca>continue</font></b>
        }
      }
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>regexp</font></b> <font color=#8b2a0e>&quot;^\\s*;*#&quot;</font> <font color=#1b1baa>$line</font>] || <font color=#1b1baa>$ccmnt</font>} {
        <b><font color=#3a6797>set</font></b> cc [ <b><font color=#3a6797>expr</font></b> {[<b><font color=#3a6797>string</font></b> index <font color=#1b1baa>$line</font> end] eq <font color=#8b2a0e>&quot;\\&quot;</font>} ]
        <b><font color=#3a6797>if</font></b> {(<font color=#1b1baa>$ccmnt</font> || <font color=#1b1baa>$cc</font>) && <font color=#1b1baa>$brace</font>!=-2} {
          <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$cc</font>} {<b><font color=#3a6797>set</font></b> line <font color=#8b2a0e>&quot;\n<font color=#1b1baa>$</font>line&quot;</font>}  ;<i><font color=#4b5d50># newline for comments inside braces</font></i>
          <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chano</font> <font color=#1b1baa>$line</font>  ;<i><font color=#4b5d50># permit 1st comments & their continuations</font></i>
        } <b><font color=#3a6797>elseif</font></b> {[<b><font color=#3a6797>regexp</font></b> <font color=#8b2a0e>&quot;^\\s*;#&quot;</font> <font color=#1b1baa>$line</font>]} {
          <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chano</font> <font color=#8b2a0e>&quot;;&quot;</font>  ;<i><font color=#4b5d50># this semicolon may be meaningful</font></i>
        }
        <b><font color=#3a6797>set</font></b> ccmnt <font color=#1b1baa>$cc</font>  ;<i><font color=#4b5d50># comments continued</font></i>
        <b><font color=#ca14ca>continue</font></b>
      }
      <b><font color=#3a6797>set</font></b> line [<b><font color=#3a6797>string</font></b> trimleft <font color=#1b1baa>$line</font> <font color=#8b2a0e>&quot;\t\ &quot;</font>]
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$line</font> eq <font color=#8b2a0e>&quot;&quot;</font>} <b><font color=#ca14ca>continue</font></b>
      <b><font color=#3a6797>foreach</font></b> s [<b><font color=#3a6797>regexp</font></b> <font color=#6c3e67>-all</font> <font color=#6c3e67>-inline</font> <font color=#6c3e67>-indices</font> <font color=#8b2a0e>&quot;;#&quot;</font> <font color=#1b1baa>$line</font>] {
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$cbrc</font>&lt;=0 && [countCh  [<b><font color=#3a6797>set</font></b> _ [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$line</font> 0 [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$s</font> 0]-1]]  <font color=#8b2a0e>&quot;\&quot;&quot;</font>] % 2 == 0} { ;<i><font color=#4b5d50># example of continued command</font></i>
          <b><font color=#3a6797>set</font></b> ccmnt [ <b><font color=#3a6797>expr</font></b> {[<b><font color=#3a6797>string</font></b> index <font color=#1b1baa>$line</font> end] eq <font color=#8b2a0e>&quot;\\&quot;</font>} ]
          <b><font color=#3a6797>set</font></b> line [ <b><font color=#3a6797>string</font></b> trimright <font color=#1b1baa>$_</font> ]
          <b><font color=#ca14ca>break</font></b>   ;<i><font color=#4b5d50># the ending &quot;;#&quot; is a comment</font></i>
        }
      }
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$ccmnt</font>} {
        <b><font color=#3a6797>set</font></b> brace [<b><font color=#3a6797>set</font></b> braceST -1]
        <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chano</font> <font color=#8b2a0e>&quot;\n<font color=#1b1baa>$</font>line&quot;</font>  ;<i><font color=#4b5d50># the ending &quot;;#&quot; is a comment continued \</font></i>
<i><font color=#4b5d50>           (example of continued comment) \</font></i>
<i><font color=#4b5d50>           (end of example)</font></i>
        <b><font color=#ca14ca>continue</font></b>
      }
    }
    <b><font color=#3a6797>set</font></b> line [<b><font color=#3a6797>string</font></b> trimright <font color=#1b1baa>$line</font>]
    <b><font color=#3a6797>set</font></b> prevbrace <font color=#1b1baa>$brace</font>
    <b><font color=#3a6797>set</font></b> brace [ <b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$line</font> eq <font color=#8b2a0e>&quot;\}&quot;</font> ? 1 : 0} ]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$prevbrace</font> in {1 0} && !<font color=#1b1baa>$brace</font>} { <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chano</font> <font color=#8b2a0e>&quot;&quot;</font> }
    <b><font color=#3a6797>if</font></b> {[countCh <font color=#1b1baa>$line</font> <font color=#8b2a0e>&quot;\&quot;&quot;</font>]%2} { <b><font color=#3a6797>set</font></b> quoted [ <b><font color=#3a6797>expr</font></b> {!<font color=#1b1baa>$quoted</font>} ] }
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> _ [<b><font color=#3a6797>string</font></b> index <font color=#1b1baa>$line</font> end]] eq <font color=#8b2a0e>&quot;\{&quot;</font>} {
      <b><font color=#3a6797>set</font></b> brace 2           ;<i><font color=#4b5d50># line ending with \{ will join with next line</font></i>
    } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$_</font> eq <font color=#8b2a0e>&quot;\\&quot;</font>} {
      <b><font color=#3a6797>set</font></b> brace 2           ;<i><font color=#4b5d50># the ending &quot;\&quot; should be removed</font></i>
      <b><font color=#3a6797>set</font></b> line [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$line</font> 0 end-1]
      <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$quoted</font>} { <b><font color=#3a6797>set</font></b> line <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>string trimright <font color=#1b1baa>$</font>line<font color=#1b1baa>]</font> &quot;</font> }
    }
    <b><font color=#3a6797>puts</font></b> <font color=#6c3e67>-nonewline</font> <font color=#1b1baa>$chano</font> <font color=#1b1baa>$line</font>
  }
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chano</font> <font color=#8b2a0e>&quot;\n#by trimmer&quot;</font>
  <b><font color=#3a6797>close</font></b> <font color=#1b1baa>$chani</font>
  <b><font color=#3a6797>close</font></b> <font color=#1b1baa>$chano</font>
}</code><br></pre></div>
</div><br><br><h1 class='ruff'><a name='::trimmer::batchio'></a>::trimmer::batchio<span class='tinylink'><a href='#top'>Top</a></span></h1>
<div style='clear:both;'></div>
<p class='ruff'>Processing a batch of input files to make appropriate output files.</p>
<br><h2 class='ruff'><a name='::trimmer::batchio-License'></a>License<span class='tinylink'><a href='#::trimmer::batchio'>batchio</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>MIT.</p>
<br><h2 class='ruff'><a name='::trimmer::batchio-Usage'></a>Usage<span class='tinylink'><a href='#::trimmer::batchio'>batchio</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<pre class='ruff'><br><code class="tcl">tclsh script.tcl [-i idir|ifile] [-o odir] [-r] [-f] [-n] [--] [app args]
</code><br></pre>
<p class='ruff'>where</p>
<p class='ruff'><em>script.tcl</em> is a Tcl script sourcing <em>batchio.tcl</em> to call its 'main' proc</p>
<p class='ruff'>arguments are:</p>
<table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code>-i idir</code></td><td class='ruff_defitem'>a directory of files to process (by default ./)</td></tr>
<tr><td class='ruff_defitem'><code>-i ifile</code></td><td class='ruff_defitem'>a file listing files to process (#-comments disregarded)</td></tr>
<tr><td class='ruff_defitem'><code>-o odir</code></td><td class='ruff_defitem'>a directory of resulting files (by default ../release)</td></tr>
<tr><td class='ruff_defitem'><code>app</code></td><td class='ruff_defitem'>an application to be run after trimming</td></tr>
<tr><td class='ruff_defitem'><code>args</code></td><td class='ruff_defitem'>optional arguments of <em>app</em></td></tr>
</table>
<p class='ruff'>The <code>-i</code> (or <code>--input</code>) can be multiple, <code>-o</code> (or <code>--output</code>) can not.</p>
<p class='ruff'>The command switches mean:</p>
<ul class='ruff'>
<li>If <code>-r</code> (or <code>--recursive</code>) is set, the input directories are processed recursively. By default, they are processed non-recursively.</li>
<li>If <code>-f</code> (or <code>--force</code>) is set, the existing output file(s) will be rewritten. By default, the existing file(s) aren't rewritten.</li>
<li>If <code>-n</code> (or <code>--no</code>) is set, no real changes made, supposed changes shown only.</li>
</ul>
<p class='ruff'>Example:</p>
<pre class='ruff'><br><code class="tcl">tclsh trim.tcl <font color=#6c3e67>-i</font> ./lib <font color=#6c3e67>-o</font> ./bin tclsh <font color=#6c3e67>-f</font> ./bin/main.tcl arg1 <font color=#8b2a0e>&quot;arg 2&quot;</font>
</code><br></pre>
<br><h2 class='ruff'><a name='::trimmer::batchio-Commands'></a>Commands<span class='tinylink'><a href='#::trimmer::batchio'>batchio</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<br><br><br><h4 class='ruffproc'><a name='::trimmer::batchio::doFile'>doFile</a><span class='ns_scope'> [<a href="#::trimmer::batchio" title="::trimmer::batchio" class='ruff_cmd'>::trimmer::batchio</a>]</span><span class='tinylink'><a href='#::trimmer::batchio'>batchio</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Prepares and does a call of procedure to process two files.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>doFile</span> <span class='ruff_arg'>procN noact pdirN root finp odir rm ?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code>procN</code></td><td class='ruff_defitem'>name of procedure to process two files</td></tr>
<tr><td class='ruff_defitem'><code>noact</code></td><td class='ruff_defitem'>if true, no output file</td></tr>
<tr><td class='ruff_defitem'><code>pdirN</code></td><td class='ruff_defitem'>variable's name of previous input directory</td></tr>
<tr><td class='ruff_defitem'><code>root</code></td><td class='ruff_defitem'>root of input directory</td></tr>
<tr><td class='ruff_defitem'><code>finp</code></td><td class='ruff_defitem'>input file</td></tr>
<tr><td class='ruff_defitem'><code>odir</code></td><td class='ruff_defitem'>output directory</td></tr>
<tr><td class='ruff_defitem'><code>rm</code></td><td class='ruff_defitem'>flag 'rewrite the existing output file or not'</td></tr>
<tr><td class='ruff_defitem'><code>args</code></td><td class='ruff_defitem'>other arguments</td></tr>
</table>
<h5 class='ruff'>Description</h5><p class='ruff'>If <em>noact</em> is true, no outputs are actually made (to show only).</p>
<p class='ruff'>The <em>pdirN</em> is used to show an input directory when changed. It needs only to be initialized with &quot;&quot;.</p>
<p class='ruff'>The <em>root</em> is a root name of input directory that is used to make the output path from the <em>odir</em> and a relative (to <em>root</em>) part of <em>finp</em>.</p>
<p class='ruff'>If <em>root</em> is empty, an input file is set instead of a directory, so the output path has no relative part.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_trimmer_batchio_doFile' href="javascript:toggleSource('trimmer_batchio_doFile')">Show source</a></p>
<div id='trimmer_batchio_doFile' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::trimmer::batchio::doFile {procN noact pdirN root finp odir rm args} {
  <i><font color=#4b5d50># Prepares and does a call of procedure to process two files.</font></i>
  <i><font color=#4b5d50>#   procN - name of procedure to process two files</font></i>
  <i><font color=#4b5d50>#   noact - if true, no output file</font></i>
  <i><font color=#4b5d50>#   pdirN - variable's name of previous input directory</font></i>
  <i><font color=#4b5d50>#   root  - root of input directory</font></i>
  <i><font color=#4b5d50>#   finp  - input file</font></i>
  <i><font color=#4b5d50>#   odir  - output directory</font></i>
  <i><font color=#4b5d50>#   rm    - flag 'rewrite the existing output file or not'</font></i>
  <i><font color=#4b5d50>#   args  - other arguments</font></i>
  <i><font color=#4b5d50>#</font></i>
  <i><font color=#4b5d50># If *noact* is true, no outputs are actually made (to show only).</font></i>
  <i><font color=#4b5d50>#</font></i>
  <i><font color=#4b5d50># The *pdirN* is used to show an input directory when changed.</font></i>
  <i><font color=#4b5d50># It needs only to be initialized with &quot;&quot;.</font></i>
  <i><font color=#4b5d50>#</font></i>
  <i><font color=#4b5d50># The *root* is a root name of input directory that is used to make</font></i>
  <i><font color=#4b5d50># the output path from the *odir* and a relative (to *root*) part</font></i>
  <i><font color=#4b5d50># of *finp*.</font></i>
  <i><font color=#4b5d50>#</font></i>
  <i><font color=#4b5d50># If *root* is empty, an input file is set instead of a directory,</font></i>
  <i><font color=#4b5d50># so the output path has no relative part.</font></i>

  <b><font color=#3a6797>upvar</font></b> <font color=#1b1baa>$pdirN</font> pdir
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$root</font> ne <font color=#8b2a0e>&quot;&quot;</font>} {
    <i><font color=#4b5d50># input subdir</font></i>
    <b><font color=#3a6797>set</font></b> idir [<b><font color=#3a6797>file</font></b> dirname [<b><font color=#3a6797>file</font></b> normalize <font color=#1b1baa>$finp</font>]]
    <b><font color=#3a6797>set</font></b> idir [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$idir</font> [<b><font color=#3a6797>string</font></b> length <font color=#1b1baa>$root</font>]+1 end]
    <i><font color=#4b5d50># outdir + input subdir + input filename = output file</font></i>
    <b><font color=#3a6797>set</font></b> fout [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$odir</font> <font color=#1b1baa>$idir</font> [<b><font color=#3a6797>file</font></b> tail <font color=#1b1baa>$finp</font>]]
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> fout [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$odir</font> [<b><font color=#3a6797>file</font></b> tail <font color=#1b1baa>$finp</font>]]
  }
  <b><font color=#3a6797>set</font></b> dinp [<b><font color=#3a6797>file</font></b> dirname <font color=#1b1baa>$finp</font>]
  <b><font color=#3a6797>set</font></b> dout [<b><font color=#3a6797>file</font></b> normalize <font color=#1b1baa>$odir</font>]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$pdir</font> ne <font color=#1b1baa>$dinp</font>} {
    <b><font color=#3a6797>set</font></b> pdir <font color=#1b1baa>$dinp</font>
    <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot; Input directory : <font color=#1b1baa>$</font>dinp&quot;</font>
  }
  <b><font color=#3a6797>set</font></b> fdisp <font color=#8b2a0e>&quot;...<font color=#1b1baa>[</font>string range <font color=#1b1baa>$</font>fout <font color=#1b1baa>[</font>string length <font color=#1b1baa>$</font>dout<font color=#1b1baa>]</font> end<font color=#1b1baa>]</font>&quot;</font>
  <b><font color=#3a6797>append</font></b> fdisp [<b><font color=#3a6797>string</font></b> repeat <font color=#8b2a0e>&quot; &quot;</font> 80]
  <b><font color=#3a6797>puts</font></b> <font color=#6c3e67>-nonewline</font> <font color=#8b2a0e>&quot;     Output file : <font color=#1b1baa>[</font>string range <font color=#1b1baa>$</font>fdisp 0 38<font color=#1b1baa>]</font>&quot;</font>
  <b><font color=#3a6797>if</font></b> { <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>file normalize <font color=#1b1baa>$</font>finp<font color=#1b1baa>]</font>&quot;</font> eq <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>file normalize <font color=#1b1baa>$</font>fout<font color=#1b1baa>]</font>&quot;</font> } {
    onError <font color=#8b2a0e>&quot;-       the same.&quot;</font> 0
    <b><font color=#ca14ca>return</font></b>
  }
  <b><font color=#3a6797>if</font></b> { !<font color=#1b1baa>$rm</font> && [<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$fout</font>] } {
    onError <font color=#8b2a0e>&quot;- already exists.&quot;</font> 0
    <b><font color=#ca14ca>return</font></b>
  }
  <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot;&quot;</font>
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$noact</font>} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>file</font></b> mkdir [<b><font color=#3a6797>file</font></b> dirname <font color=#1b1baa>$fout</font>]}
  <font color=#1b1baa>$procN</font> <font color=#1b1baa>$finp</font> <font color=#1b1baa>$fout</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
}</code><br></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::trimmer::batchio::getFilesList'>getFilesList</a><span class='ns_scope'> [<a href="#::trimmer::batchio" title="::trimmer::batchio" class='ruff_cmd'>::trimmer::batchio</a>]</span><span class='tinylink'><a href='#::trimmer::batchio'>batchio</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets a list of input files.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>getFilesList</span> <span class='ruff_arg'>ilistN idir globPatt recursive</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code>ilistN</code></td><td class='ruff_defitem'>a name of variable to contain the resulting list</td></tr>
<tr><td class='ruff_defitem'><code>idir</code></td><td class='ruff_defitem'>a name of input directory / file</td></tr>
<tr><td class='ruff_defitem'><code>globPatt</code></td><td class='ruff_defitem'>glob pattern for files to be processed</td></tr>
<tr><td class='ruff_defitem'><code>recursive</code></td><td class='ruff_defitem'>a boolean to scan directories recursively</td></tr>
</table>
<h5 class='ruff'>Description</h5><p class='ruff'>If <em>idir</em> is a directory, it is scanned for files.</p>
<p class='ruff'>If <em>idir</em> is a file, it should contain a list of directories (to scan for files to be included in the list) and/or files (to be included in the list directly).</p>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns a list of <em>roots</em>, i.e. root directory names for scanned directories or &quot;&quot; for files included directly.</p>
<h5 class='ruff'>See also</h5><p class='ruff'><a href="#::trimmer::batchio::recurseProc" title="recurseProc" class='ruff_cmd'>recurseProc</a></p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_trimmer_batchio_getFilesList' href="javascript:toggleSource('trimmer_batchio_getFilesList')">Show source</a></p>
<div id='trimmer_batchio_getFilesList' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::trimmer::batchio::getFilesList {ilistN idir globPatt recursive} {
  <i><font color=#4b5d50># Gets a list of input files.</font></i>
  <i><font color=#4b5d50>#   ilistN    - a name of variable to contain the resulting list</font></i>
  <i><font color=#4b5d50>#   idir      - a name of input directory / file</font></i>
  <i><font color=#4b5d50>#   globPatt  - glob pattern for files to be processed</font></i>
  <i><font color=#4b5d50>#   recursive - a boolean to scan directories recursively</font></i>
  <i><font color=#4b5d50>#</font></i>
  <i><font color=#4b5d50># If *idir* is a directory, it is scanned for files.</font></i>
  <i><font color=#4b5d50>#</font></i>
  <i><font color=#4b5d50># If *idir* is a file, it should contain a list of directories (to scan</font></i>
  <i><font color=#4b5d50># for files to be included in the list) and/or files (to be included in</font></i>
  <i><font color=#4b5d50># the list directly).</font></i>
  <i><font color=#4b5d50>#</font></i>
  <i><font color=#4b5d50># Returns a list of *roots*, i.e. root directory names for scanned</font></i>
  <i><font color=#4b5d50># directories or &quot;&quot; for files included directly.</font></i>
  <i><font color=#4b5d50>#</font></i>
  <i><font color=#4b5d50># See also: recurseProc</font></i>

  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>file</font></b> exist <font color=#1b1baa>$idir</font>]} {
    onError <font color=#8b2a0e>&quot;Input directory/file \&quot;<font color=#1b1baa>$</font>idir\&quot; does not exist.&quot;</font>
  }
  <b><font color=#3a6797>set</font></b> root {}
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>file</font></b> isfile <font color=#1b1baa>$idir</font>]} {
    <i><font color=#4b5d50># it's a file containing a list of files and/or directories</font></i>
    <b><font color=#3a6797>set</font></b> ch [<b><font color=#3a6797>open</font></b> <font color=#1b1baa>$idir</font>]
    <b><font color=#3a6797>foreach</font></b> fin [<b><font color=#3a6797>split</font></b> [<b><font color=#3a6797>read</font></b> <font color=#1b1baa>$ch</font>] \n] {
      <b><font color=#3a6797>set</font></b> fin [<b><font color=#3a6797>string</font></b> trim <font color=#1b1baa>$fin</font>]
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$fin</font> ne <font color=#8b2a0e>&quot;&quot;</font> && [<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$fin</font>]} {
        <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>file</font></b> isfile <font color=#1b1baa>$fin</font>]} {      ;<i><font color=#4b5d50># a file</font></i>
          <b><font color=#3a6797>lappend</font></b> <font color=#1b1baa>$ilistN</font> <font color=#1b1baa>$fin</font>
          <b><font color=#3a6797>lappend</font></b> root <font color=#8b2a0e>&quot;&quot;</font>
        } <b><font color=#3a6797>else</font></b> {                       ;<i><font color=#4b5d50># a directory</font></i>
          <b><font color=#3a6797>set</font></b> [<b><font color=#3a6797>namespace</font></b> current]::iltmp {}
          <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$recursive</font>} {
            recurseProc <font color=#8b2a0e>&quot;lappend <font color=#1b1baa>[</font>namespace current<font color=#1b1baa>]</font>::iltmp&quot;</font> <font color=#1b1baa>$fin</font> <font color=#1b1baa>$globPatt</font>
          } <b><font color=#3a6797>else</font></b> {
            <b><font color=#3a6797>set</font></b> [<b><font color=#3a6797>namespace</font></b> current]::iltmp  [<b><font color=#3a6797>glob</font></b> <font color=#6c3e67>-nocomplain</font> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$fin</font> <font color=#1b1baa>$globPatt</font>]]
          }
          <b><font color=#3a6797>set</font></b> rdir  [<b><font color=#3a6797>file</font></b> normalize <font color=#1b1baa>$fin</font>]
          <b><font color=#3a6797>foreach</font></b> f [<b><font color=#3a6797>set</font></b> [<b><font color=#3a6797>namespace</font></b> current]::iltmp] {
            <b><font color=#3a6797>lappend</font></b> <font color=#1b1baa>$ilistN</font> <font color=#1b1baa>$f</font>
            <b><font color=#3a6797>lappend</font></b> root <font color=#1b1baa>$rdir</font>
          }
          <b><font color=#3a6797>unset</font></b> [<b><font color=#3a6797>namespace</font></b> current]::iltmp
        }
      }
    }
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$recursive</font>} {
      recurseProc <font color=#8b2a0e>&quot;lappend <font color=#1b1baa>$</font>ilistN&quot;</font> <font color=#1b1baa>$idir</font> <font color=#1b1baa>$globPatt</font>
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>lappend</font></b> <font color=#1b1baa>$ilistN</font> {<b><font color=#3a6797>*</font></b>}[<b><font color=#3a6797>glob</font></b> <font color=#6c3e67>-nocomplain</font> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$idir</font> <font color=#1b1baa>$globPatt</font>]]
    }
    <b><font color=#3a6797>lappend</font></b> root [<b><font color=#3a6797>file</font></b> normalize <font color=#1b1baa>$idir</font>]
  }
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$root</font>
}</code><br></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::trimmer::batchio::main'>main</a><span class='ns_scope'> [<a href="#::trimmer::batchio" title="::trimmer::batchio" class='ruff_cmd'>::trimmer::batchio</a>]</span><span class='tinylink'><a href='#::trimmer::batchio'>batchio</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Main procedure of batchio.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>main</span> <span class='ruff_arg'>procN globPatt options ?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code>procN</code></td><td class='ruff_defitem'>name of procedure to process two files</td></tr>
<tr><td class='ruff_defitem'><code>globPatt</code></td><td class='ruff_defitem'>glob pattern for files to be processed</td></tr>
<tr><td class='ruff_defitem'><code>options</code></td><td class='ruff_defitem'>list of {opt optshort}, additional options</td></tr>
<tr><td class='ruff_defitem'><code>args</code></td><td class='ruff_defitem'>arguments passed to script.tcl, containing switches and values:</td></tr>
<tr><td class='ruff_defitem'><code>--</code></td><td class='ruff_defitem'>to end the switches and begin a command to run</td></tr>
<tr><td class='ruff_defitem'><code>-f</code></td><td class='ruff_defitem'>(or --force) a flag to rewrite existing output files</td></tr>
<tr><td class='ruff_defitem'><code>-i</code></td><td class='ruff_defitem'>(or --input) input directory or file of processed list</td></tr>
<tr><td class='ruff_defitem'><code>-n</code></td><td class='ruff_defitem'>(or --no) a flag to show output files only, without making</td></tr>
<tr><td class='ruff_defitem'><code>-o</code></td><td class='ruff_defitem'>(or --output) output directory</td></tr>
<tr><td class='ruff_defitem'><code>-r</code></td><td class='ruff_defitem'>(or --recursive) a flag to scan directories recursively</td></tr>
<tr><td class='ruff_defitem'><code>rest</code></td><td class='ruff_defitem'>resting arguments are a command to run and its arguments</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_trimmer_batchio_main' href="javascript:toggleSource('trimmer_batchio_main')">Show source</a></p>
<div id='trimmer_batchio_main' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::trimmer::batchio::main {procN globPatt options args} {
  <i><font color=#4b5d50># Main procedure of batchio.</font></i>
  <i><font color=#4b5d50>#   procN - name of procedure to process two files</font></i>
  <i><font color=#4b5d50>#   globPatt - glob pattern for files to be processed</font></i>
  <i><font color=#4b5d50>#   options  - list of {opt optshort}, additional options</font></i>
  <i><font color=#4b5d50>#   args - arguments passed to script.tcl, containing switches and values:</font></i>
  <i><font color=#4b5d50>#   -i   - (or --input) input directory or file of processed list</font></i>
  <i><font color=#4b5d50>#   -o   - (or --output) output directory</font></i>
  <i><font color=#4b5d50>#   -r   - (or --recursive) a flag to scan directories recursively</font></i>
  <i><font color=#4b5d50>#   -f   - (or --force) a flag to rewrite existing output files</font></i>
  <i><font color=#4b5d50>#   -n   - (or --no) a flag to show output files only, without making</font></i>
  <i><font color=#4b5d50>#   --   - to end the switches and begin a command to run</font></i>
  <i><font color=#4b5d50>#   rest - resting arguments are a command to run and its arguments</font></i>

  underLine

  <i><font color=#4b5d50># when run without arguments, put the synopsis</font></i>
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>set</font></b> ac [<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$args</font>]]} {synopsis; underLine }

  <i><font color=#4b5d50># get arguments and check if the arguments are correct</font></i>
  <b><font color=#3a6797>set</font></b> mydir [<b><font color=#3a6797>file</font></b> dirname [<b><font color=#3a6797>info</font></b> script]]
  <b><font color=#3a6797>set</font></b> err [<b><font color=#3a6797>set</font></b> remove [<b><font color=#3a6797>set</font></b> recursive [<b><font color=#3a6797>set</font></b> noact false]]]
  <b><font color=#3a6797>lassign</font></b> <font color=#8b2a0e>&quot;&quot;</font> iopt odir mfile margs addargs
  <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i 0} {<font color=#1b1baa>$i</font>&lt;<font color=#1b1baa>$ac</font>} {<b><font color=#3a6797>incr</font></b> i} {
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#3a6797>lrange</font></b> <font color=#1b1baa>$args</font> <font color=#1b1baa>$i</font> end] opt val
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$opt</font> eq <font color=#8b2a0e>&quot;--&quot;</font>} {
      <b><font color=#3a6797>set</font></b> mfile <font color=#1b1baa>$val</font>
      <b><font color=#3a6797>incr</font></b> i
    } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$mfile</font> ne <font color=#8b2a0e>&quot;&quot;</font>} {  ;<i><font color=#4b5d50># after an application, its arguments go</font></i>
      <b><font color=#3a6797>lappend</font></b> margs <font color=#1b1baa>$opt</font>
    } <b><font color=#3a6797>else</font></b> {                   ;<i><font color=#4b5d50># here the batchio options go</font></i>
      <b><font color=#3a6797>switch</font></b> <font color=#1b1baa>$opt</font> {
        <font color=#6c3e67>--input</font> - <font color=#6c3e67>-i</font> {
           <b><font color=#3a6797>lappend</font></b> iopt <font color=#1b1baa>$val</font>
           <b><font color=#3a6797>incr</font></b> i
           }
        <font color=#6c3e67>--output</font> - <font color=#6c3e67>-o</font> {
           <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$odir</font> ne <font color=#8b2a0e>&quot;&quot;</font>} { onError <font color=#8b2a0e>&quot;--output argument duplicated&quot;</font> }
           <b><font color=#3a6797>set</font></b> odir <font color=#1b1baa>$val</font>
           <b><font color=#3a6797>incr</font></b> i
           }
        <font color=#6c3e67>--recursive</font> - <font color=#6c3e67>-r</font> {
           <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$recursive</font>} { onError <font color=#8b2a0e>&quot;--recursive argument duplicated&quot;</font> }
           <b><font color=#3a6797>set</font></b> recursive true
           }
        <font color=#6c3e67>--force</font> - <font color=#6c3e67>-f</font> {
           <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$remove</font>} { onError <font color=#8b2a0e>&quot;--force argument duplicated&quot;</font> }
           <b><font color=#3a6797>set</font></b> remove true
           }
        <font color=#6c3e67>--no</font> - <font color=#6c3e67>-n</font> {
           <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$noact</font>} { onError <font color=#8b2a0e>&quot;--no argument duplicated&quot;</font> }
           <b><font color=#3a6797>set</font></b> noact true
           }
        <b><font color=#3a6797>default</font></b> {
          <b><font color=#3a6797>set</font></b> isapp true
          <b><font color=#3a6797>set</font></b> i2 0
          <b><font color=#3a6797>foreach</font></b> {o osh} <font color=#1b1baa>$options</font> {
            <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$opt</font> in <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>o <font color=#1b1baa>$</font>osh&quot;</font>} {
              <b><font color=#3a6797>set</font></b> isapp false
              <b><font color=#3a6797>lset</font></b> options <font color=#1b1baa>$i2</font> {}
              <b><font color=#3a6797>lappend</font></b> addargs <font color=#1b1baa>$val</font>
              <b><font color=#3a6797>incr</font></b> i
              <b><font color=#ca14ca>break</font></b>
            }
            <b><font color=#3a6797>incr</font></b> i2
          }
          <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$isapp</font>} { <b><font color=#3a6797>set</font></b> mfile <font color=#1b1baa>$opt</font> }
        }
      }
    }
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$iopt</font> eq <font color=#8b2a0e>&quot;&quot;</font>} { <b><font color=#3a6797>set</font></b> iopt ./ }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$odir</font> eq <font color=#8b2a0e>&quot;&quot;</font>} { <b><font color=#3a6797>set</font></b> odir ../release }
  <b><font color=#3a6797>set</font></b> odir [<b><font color=#3a6797>file</font></b> normalize <font color=#1b1baa>$odir</font>]
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>file</font></b> isfile <font color=#1b1baa>$odir</font>]} { onError <font color=#8b2a0e>&quot;\&quot;<font color=#1b1baa>$</font>odir\&quot; is not a directory.&quot;</font> }

  <i><font color=#4b5d50># get the input files list from the list of input directories and/or files</font></i>
  <b><font color=#3a6797>set</font></b> ilistALL [<b><font color=#3a6797>set</font></b> rootlistALL {}]
  <b><font color=#3a6797>set</font></b> tmpl [<b><font color=#3a6797>namespace</font></b> current]::ilistTmp
  <b><font color=#3a6797>foreach</font></b> idir <font color=#1b1baa>$iopt</font> {
    <b><font color=#3a6797>set</font></b> <font color=#1b1baa>$tmpl</font> {}
    <b><font color=#3a6797>set</font></b> rootlist [getFilesList <font color=#1b1baa>$tmpl</font> <font color=#1b1baa>$idir</font> <font color=#1b1baa>$globPatt</font> <font color=#1b1baa>$recursive</font>]
    <b><font color=#3a6797>lappend</font></b> ilistALL {<b><font color=#3a6797>*</font></b>}[<b><font color=#3a6797>set</font></b> <font color=#1b1baa>$tmpl</font>]
    <b><font color=#3a6797>lappend</font></b> rootlistALL {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$rootlist</font>
    <b><font color=#3a6797>unset</font></b> <font color=#1b1baa>$tmpl</font>
  }

  <i><font color=#4b5d50># process all files</font></i>
  <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot; OUTPUT DIRECTORY: <font color=#1b1baa>$</font>odir&quot;</font>
  underLine
  <b><font color=#3a6797>set</font></b> pdir <font color=#8b2a0e>&quot;&quot;</font>
  <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$rootlistALL</font> root
  <b><font color=#3a6797>foreach</font></b> fin <font color=#1b1baa>$ilistALL</font> rt <font color=#1b1baa>$rootlistALL</font> {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$rt</font> ne <font color=#8b2a0e>&quot;&quot;</font>} { <b><font color=#3a6797>set</font></b> root <font color=#1b1baa>$rt</font> }
    <b><font color=#3a6797>set</font></b> fin [<b><font color=#3a6797>file</font></b> normalize <font color=#1b1baa>$fin</font>]
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>file</font></b> isfile <font color=#1b1baa>$fin</font>]} {
      doFile <font color=#1b1baa>$procN</font> <font color=#1b1baa>$noact</font> pdir <font color=#1b1baa>$root</font> <font color=#1b1baa>$fin</font> <font color=#1b1baa>$odir</font> <font color=#1b1baa>$remove</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$addargs</font>
    }
  }
  underLine

  <i><font color=#4b5d50># run a command if set</font></i>
  <b><font color=#3a6797>set</font></b> dispargs <font color=#8b2a0e>&quot;&quot;</font>
  <b><font color=#3a6797>foreach</font></b> a <font color=#1b1baa>$margs</font> {
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$a</font>]&gt;1} {<b><font color=#3a6797>set</font></b> a <font color=#8b2a0e>&quot;\&quot;<font color=#1b1baa>$</font>a\&quot;&quot;</font>}
    <b><font color=#3a6797>append</font></b> dispargs <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>a &quot;</font>
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$noact</font>} {
    <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot; Supposed run: \&quot;<font color=#1b1baa>$</font>mfile\&quot; <font color=#1b1baa>$</font>dispargs&quot;</font>
  } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$mfile</font> ne <font color=#8b2a0e>&quot;&quot;</font>} {
    <b><font color=#3a6797>set</font></b> err <font color=#8b2a0e>&quot;&quot;</font>
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> comm [<b><font color=#3a6797>auto_execok</font></b> <font color=#1b1baa>$mfile</font>]] eq <font color=#8b2a0e>&quot;&quot;</font>} {
      <b><font color=#3a6797>set</font></b> err <font color=#8b2a0e>&quot; Not found: <font color=#1b1baa>$</font>mfile&quot;</font>
    }
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$err</font> ne <font color=#8b2a0e>&quot;&quot;</font> || [<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>exec</font></b> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$comm</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$margs</font> } err]} {
      onError <font color=#8b2a0e>&quot;Run:\n   \&quot;<font color=#1b1baa>$</font>mfile\&quot; <font color=#1b1baa>$</font>dispargs\n<font color=#1b1baa>$</font>err&quot;</font> 0
    }
  }
}</code><br></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::trimmer::batchio::onError'>onError</a><span class='ns_scope'> [<a href="#::trimmer::batchio" title="::trimmer::batchio" class='ruff_cmd'>::trimmer::batchio</a>]</span><span class='tinylink'><a href='#::trimmer::batchio'>batchio</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Shows an error and optionally performs <em>exit</em>.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>onError</span> <span class='ruff_arg'>?err? ?doexit?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code>err</code></td><td class='ruff_defitem'>optional error message (empty by default, to put the synopsis); <i>optional, default</i> <code>&quot;&quot;</code></td></tr>
<tr><td class='ruff_defitem'><code>doexit</code></td><td class='ruff_defitem'>optional boolean flag to perform <em>exit</em> (true by default); <i>optional, default</i> <code>true</code></td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_trimmer_batchio_onError' href="javascript:toggleSource('trimmer_batchio_onError')">Show source</a></p>
<div id='trimmer_batchio_onError' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::trimmer::batchio::onError {{err {}} {doexit true}} {
  <i><font color=#4b5d50># Shows an error and optionally performs *exit*.</font></i>
  <i><font color=#4b5d50>#   err - optional error message (empty by default, to put the synopsis)</font></i>
  <i><font color=#4b5d50>#   doexit - optional boolean flag to perform *exit* (true by default)</font></i>

  <b><font color=#3a6797>set</font></b> err [<b><font color=#3a6797>string</font></b> trim <font color=#1b1baa>$err</font>]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$doexit</font>} {
    synopsis
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$err</font> != <font color=#8b2a0e>&quot;&quot;</font>} { underLine; <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot; <font color=#1b1baa>$</font>err&quot;</font> }
    underLine
    <b><font color=#3a6797>exit</font></b>
  }
  <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot; <font color=#1b1baa>$</font>err&quot;</font>
}</code><br></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::trimmer::batchio::recurseProc'>recurseProc</a><span class='ns_scope'> [<a href="#::trimmer::batchio" title="::trimmer::batchio" class='ruff_cmd'>::trimmer::batchio</a>]</span><span class='tinylink'><a href='#::trimmer::batchio'>batchio</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Applies a command to files of a directory, recursively.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>recurseProc</span> <span class='ruff_arg'>procf dirname pattns</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code>procf</code></td><td class='ruff_defitem'>a command to apply</td></tr>
<tr><td class='ruff_defitem'><code>dirname</code></td><td class='ruff_defitem'>a directory to scan</td></tr>
<tr><td class='ruff_defitem'><code>pattns</code></td><td class='ruff_defitem'>glob patterns of files (devided by &quot; &quot; or &quot;,&quot;)</td></tr>
</table>
<h5 class='ruff'>See also</h5><p class='ruff'><a href="#::trimmer::batchio::getFilesList" title="getFilesList" class='ruff_cmd'>getFilesList</a></p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_trimmer_batchio_recurseProc' href="javascript:toggleSource('trimmer_batchio_recurseProc')">Show source</a></p>
<div id='trimmer_batchio_recurseProc' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::trimmer::batchio::recurseProc {procf dirname pattns} {
  <i><font color=#4b5d50># Applies a command to files of a directory, recursively.</font></i>
  <i><font color=#4b5d50>#   procf   - a command to apply</font></i>
  <i><font color=#4b5d50>#   dirname - a directory to scan</font></i>
  <i><font color=#4b5d50>#   pattns  - glob patterns of files (devided by &quot; &quot; or &quot;,&quot;)</font></i>
  <i><font color=#4b5d50>#</font></i>
  <i><font color=#4b5d50># See also: getFilesList</font></i>

  <b><font color=#3a6797>foreach</font></b> dir [<b><font color=#3a6797>glob</font></b> <font color=#6c3e67>-nocomplain</font> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$dirname</font> *]] {
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>file</font></b> isdirectory <font color=#1b1baa>$dir</font>]} { recurseProc <font color=#1b1baa>$procf</font> <font color=#1b1baa>$dir</font> <font color=#1b1baa>$pattns</font> }
  }
  <i><font color=#4b5d50># no dirs anymore</font></i>
  <b><font color=#3a6797>foreach</font></b> filetempl [<b><font color=#3a6797>split</font></b> <font color=#1b1baa>$pattns</font> <font color=#8b2a0e>&quot;, &quot;</font>] {
    <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>catch</font></b> {  <b><font color=#3a6797>set</font></b> files [<b><font color=#3a6797>glob</font></b> <font color=#6c3e67>-nocomplain</font> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$dirname</font> <font color=#1b1baa>$filetempl</font>]]}]} {
      <b><font color=#3a6797>foreach</font></b> f <font color=#1b1baa>$files</font> { {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$procf</font> [<b><font color=#3a6797>file</font></b> normalize <font color=#1b1baa>$f</font>] }
    }
  }
}</code><br></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::trimmer::batchio::synopsis'>synopsis</a><span class='ns_scope'> [<a href="#::trimmer::batchio" title="::trimmer::batchio" class='ruff_cmd'>::trimmer::batchio</a>]</span><span class='tinylink'><a href='#::trimmer::batchio'>batchio</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Shows a syntax and a usage of namespace.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>synopsis</span> </div>
<h5 class='ruff'>Description</h5><p class='ruff'>If <em>_ruff_preamble</em> is defined in the parent namespace, puts it. Otherwise puts its own <em>_ruff_preamble</em>.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_trimmer_batchio_synopsis' href="javascript:toggleSource('trimmer_batchio_synopsis')">Show source</a></p>
<div id='trimmer_batchio_synopsis' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::trimmer::batchio::synopsis {} {
  <i><font color=#4b5d50># Shows a syntax and a usage of namespace.</font></i>
  <i><font color=#4b5d50>#</font></i>
  <i><font color=#4b5d50># If *_ruff_preamble* is defined in the parent namespace, puts it.</font></i>
  <i><font color=#4b5d50># Otherwise puts its own *_ruff_preamble*.</font></i>

  <b><font color=#3a6797>variable</font></b> SynShown
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$SynShown</font>} <b><font color=#3a6797>exit</font></b> {<b><font color=#3a6797>set</font></b> SynShown true}
  <b><font color=#3a6797>set</font></b> preamble [<b><font color=#3a6797>namespace</font></b> parent]::_ruff_preamble
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>info</font></b> exist <font color=#1b1baa>$preamble</font>]} {
    <b><font color=#3a6797>set</font></b> preamble [<b><font color=#3a6797>namespace</font></b> current]::_ruff_preamble
  }
  <b><font color=#3a6797>puts</font></b> [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> \\\{ \{] [<b><font color=#3a6797>set</font></b> <font color=#1b1baa>$preamble</font>]]\n
}</code><br></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::trimmer::batchio::underLine'>underLine</a><span class='ns_scope'> [<a href="#::trimmer::batchio" title="::trimmer::batchio" class='ruff_cmd'>::trimmer::batchio</a>]</span><span class='tinylink'><a href='#::trimmer::batchio'>batchio</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Puts out an underlining string.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>underLine</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_trimmer_batchio_underLine' href="javascript:toggleSource('trimmer_batchio_underLine')">Show source</a></p>
<div id='trimmer_batchio_underLine' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::trimmer::batchio::underLine {} {
  <i><font color=#4b5d50># Puts out an underlining string.</font></i>

  <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot; <font color=#1b1baa>[</font>string repeat - 75<font color=#1b1baa>]</font>&quot;</font>
}</code><br></pre></div>
</div></div></div><div class='yui-b navbox' ><h1><a href='#::trimmer'>trimmer</a></h1><h2><a href='#::trimmer-License'>License</a></h2><h2><a href='#::trimmer-Download'>Download</a></h2><h2><a href='#::trimmer-Usage'>Usage</a></h2><h2><a href='#::trimmer-Limitations'>Limitations</a></h2><h2><a href='#::trimmer-Commands'>Commands</a></h2><h4 class='tooltip'><a href='#::trimmer::countCh'>countCh</a><span class='tooltiptext'>Counts a character in a string.
</span></h4><h4 class='tooltip'><a href='#::trimmer::trimFile'>trimFile</a><span class='tooltiptext'>Trims an input file and writes a result to an output file.
</span></h4><h1><a href='#::trimmer::batchio'>trimmer::batchio</a></h1><h2><a href='#::trimmer::batchio-License'>License</a></h2><h2><a href='#::trimmer::batchio-Usage'>Usage</a></h2><h2><a href='#::trimmer::batchio-Commands'>Commands</a></h2><h4 class='tooltip'><a href='#::trimmer::batchio::doFile'>doFile</a><span class='tooltiptext'>Prepares and does a call of procedure to process two files.
</span></h4><h4 class='tooltip'><a href='#::trimmer::batchio::getFilesList'>getFilesList</a><span class='tooltiptext'>Gets a list of input files.
</span></h4><h4 class='tooltip'><a href='#::trimmer::batchio::main'>main</a><span class='tooltiptext'>Main procedure of batchio.
</span></h4><h4 class='tooltip'><a href='#::trimmer::batchio::onError'>onError</a><span class='tooltiptext'>Shows an error and optionally performs <em>exit</em>.
</span></h4><h4 class='tooltip'><a href='#::trimmer::batchio::recurseProc'>recurseProc</a><span class='tooltiptext'>Applies a command to files of a directory, recursively.
</span></h4><h4 class='tooltip'><a href='#::trimmer::batchio::synopsis'>synopsis</a><span class='tooltiptext'>Shows a syntax and a usage of namespace.
</span></h4><h4 class='tooltip'><a href='#::trimmer::batchio::underLine'>underLine</a><span class='tooltiptext'>Puts out an underlining string.
</span></h4></div></div><div id='ft'><div style='float: right;'>Document generated by <a href='https://ruff.magicsplat.com'>Ruff!</a></div></div>
</div></body></html>
