<!DOCTYPE html><html><head><meta charset="utf-8"/>
<link rel="stylesheet" href="../../../zoo/sh/styles/aplsimple.css">
<title>::aloupe reference</title>
<style>
/*
Copyright (c) 2009, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.net/yui/license.txt
version: 2.7.0
*/
html{color:#000;background:#FFF;}body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,code,form,fieldset,legend,input,button,textarea,p,blockquote,th,td{margin:0;padding:0;}table{border-collapse:collapse;border-spacing:0;}fieldset,img{border:0;}address,caption,cite,code,dfn,em,strong,th,var,optgroup{font-style:inherit;font-weight:inherit;}del,ins{text-decoration:none;}li{list-style:none;}caption,th{text-align:left;}h1,h2,h3,h4,h5,h6{font-size:100%;font-weight:normal;}q:before,q:after{content:'';}abbr,acronym{border:0;font-variant:normal;}sup{vertical-align:baseline;}sub{vertical-align:baseline;}legend{color:#000;}input,button,textarea,select,optgroup,option{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;}input,button,textarea,select{*font-size:100%;}body{font:13px/1.231 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small;}select,input,button,textarea,button{font:99% arial,helvetica,clean,sans-serif;}table{font-size:inherit;font:100%;}pre,code,kbd,samp,tt{font-family:Consolas,"Courier New",monospace;font-size:100%;line-height:100%;}body{text-align:center;}#doc,#doc2,#doc3,#doc4,.yui-t1,.yui-t2,.yui-t3,.yui-t4,.yui-t5,.yui-t6,.yui-t7{margin:auto;text-align:left;width:57.69em;*width:56.25em;}#doc2{width:73.076em;*width:71.25em;}#doc3{margin:auto 10px;width:auto;}#doc4{width:74.923em;*width:73.05em;}.yui-b{position:relative;}.yui-b{_position:static;}#yui-main .yui-b{position:static;}#yui-main,.yui-g .yui-u .yui-g{width:100%;}.yui-t1 #yui-main,.yui-t2 #yui-main,.yui-t3 #yui-main{float:right;margin-left:-25em;}.yui-t4 #yui-main,.yui-t5 #yui-main,.yui-t6 #yui-main{float:left;margin-right:-25em;}.yui-t1 .yui-b{float:left;width:12.30769em;*width:12.00em;}.yui-t1 #yui-main .yui-b{margin-left:13.30769em;*margin-left:13.05em;}.yui-t2 .yui-b{float:left;width:9.8461em;*width:13.50em;}.yui-t2 #yui-main .yui-b{margin-left:10.8461em;*margin-left:14.55em;}.yui-t3 .yui-b{float:left;width:23.0769em;*width:22.50em;}.yui-t3 #yui-main .yui-b{margin-left:24.0769em;*margin-left:23.62em;}.yui-t4 .yui-b{float:right;width:13.8456em;*width:13.50em;}.yui-t4 #yui-main .yui-b{margin-right:14.8456em;*margin-right:14.55em;}.yui-t5 .yui-b{float:right;width:18.4615em;*width:18.00em;}.yui-t5 #yui-main .yui-b{margin-right:19.4615em;*margin-right:19.125em;}.yui-t6 .yui-b{float:right;width:23.0769em;*width:22.50em;}.yui-t6 #yui-main .yui-b{margin-right:24.0769em;*margin-right:23.62em;}.yui-t7 #yui-main .yui-b{display:block;margin:0 0 1em 0;}#yui-main .yui-b{float:none;width:auto;}.yui-gb .yui-u,.yui-g .yui-gb .yui-u,.yui-gb .yui-g,.yui-gb .yui-gb,.yui-gb .yui-gc,.yui-gb .yui-gd,.yui-gb .yui-ge,.yui-gb .yui-gf,.yui-gc .yui-u,.yui-gc .yui-g,.yui-gd .yui-u{float:left;}.yui-g .yui-u,.yui-g .yui-g,.yui-g .yui-gb,.yui-g .yui-gc,.yui-g .yui-gd,.yui-g .yui-ge,.yui-g .yui-gf,.yui-gc .yui-u,.yui-gd .yui-g,.yui-g .yui-gc .yui-u,.yui-ge .yui-u,.yui-ge .yui-g,.yui-gf .yui-g,.yui-gf .yui-u{float:right;}.yui-g div.first,.yui-gb div.first,.yui-gc div.first,.yui-gd div.first,.yui-ge div.first,.yui-gf div.first,.yui-g .yui-gc div.first,.yui-g .yui-ge div.first,.yui-gc div.first div.first{float:left;}.yui-g .yui-u,.yui-g .yui-g,.yui-g .yui-gb,.yui-g .yui-gc,.yui-g .yui-gd,.yui-g .yui-ge,.yui-g .yui-gf{width:49.1%;}.yui-gb .yui-u,.yui-g .yui-gb .yui-u,.yui-gb .yui-g,.yui-gb .yui-gb,.yui-gb .yui-gc,.yui-gb .yui-gd,.yui-gb .yui-ge,.yui-gb .yui-gf,.yui-gc .yui-u,.yui-gc .yui-g,.yui-gd .yui-u{width:32%;margin-left:1.99%;}.yui-gb .yui-u{*margin-left:1.9%;*width:31.9%;}.yui-gc div.first,.yui-gd .yui-u{width:66%;}.yui-gd div.first{width:32%;}.yui-ge div.first,.yui-gf .yui-u{width:74.2%;}.yui-ge .yui-u,.yui-gf div.first{width:24%;}.yui-g .yui-gb div.first,.yui-gb div.first,.yui-gc div.first,.yui-gd div.first{margin-left:0;}.yui-g .yui-g .yui-u,.yui-gb .yui-g .yui-u,.yui-gc .yui-g .yui-u,.yui-gd .yui-g .yui-u,.yui-ge .yui-g .yui-u,.yui-gf .yui-g .yui-u{width:49%;*width:48.1%;*margin-left:0;}.yui-g .yui-g .yui-u{width:48.1%;}.yui-g .yui-gb div.first,.yui-gb .yui-gb div.first{*margin-right:0;*width:32%;_width:31.7%;}.yui-g .yui-gc div.first,.yui-gd .yui-g{width:66%;}.yui-gb .yui-g div.first{*margin-right:4%;_margin-right:1.3%;}.yui-gb .yui-gc div.first,.yui-gb .yui-gd div.first{*margin-right:0;}.yui-gb .yui-gb .yui-u,.yui-gb .yui-gc .yui-u{*margin-left:1.8%;_margin-left:4%;}.yui-g .yui-gb .yui-u{_margin-left:1.0%;}.yui-gb .yui-gd .yui-u{*width:66%;_width:61.2%;}.yui-gb .yui-gd div.first{*width:31%;_width:29.5%;}.yui-g .yui-gc .yui-u,.yui-gb .yui-gc .yui-u{width:32%;_float:right;margin-right:0;_margin-left:0;}.yui-gb .yui-gc div.first{width:66%;*float:left;*margin-left:0;}.yui-gb .yui-ge .yui-u,.yui-gb .yui-gf .yui-u{margin:0;}.yui-gb .yui-gb .yui-u{_margin-left:.7%;}.yui-gb .yui-g div.first,.yui-gb .yui-gb div.first{*margin-left:0;}.yui-gc .yui-g .yui-u,.yui-gd .yui-g .yui-u{*width:48.1%;*margin-left:0;}.yui-gb .yui-gd div.first{width:32%;}.yui-g .yui-gd div.first{_width:29.9%;}.yui-ge .yui-g{width:24%;}.yui-gf .yui-g{width:74.2%;}.yui-gb .yui-ge div.yui-u,.yui-gb .yui-gf div.yui-u{float:right;}.yui-gb .yui-ge div.first,.yui-gb .yui-gf div.first{float:left;}.yui-gb .yui-ge .yui-u,.yui-gb .yui-gf div.first{*width:24%;_width:20%;}.yui-gb .yui-ge div.first,.yui-gb .yui-gf .yui-u{*width:73.5%;_width:65.5%;}.yui-ge div.first .yui-gd .yui-u{width:65%;}.yui-ge div.first .yui-gd div.first{width:32%;}#hd:after,#bd:after,#ft:after,.yui-g:after,.yui-gb:after,.yui-gc:after,.yui-gd:after,.yui-ge:after,.yui-gf:after{content:".";display:block;height:0;clear:both;visibility:hidden;}#hd,#bd,#ft,.yui-g,.yui-gb,.yui-gc,.yui-gd,.yui-ge,.yui-gf{zoom:0;}

body{margin:10px;}h1{font-size:138.5%;}h2{font-size:123.1%;}h3{font-size:108%;}h1,h2,h3{margin:1em 0;}h1,h2,h3,h4,h5,h6,strong,dt{font-weight:bold;}optgroup{font-weight:normal;}abbr,acronym{border-bottom:1px dotted #000;cursor:help;}em{font-style:italic;}del{text-decoration:line-through;}blockquote,ul,ol,dl{margin:1em;}ol,ul,dl{margin-left:2em;}ol li{list-style:decimal outside;}ul li{list-style:disc outside;}dl dd{margin-left:1em;}th,td{border:1px solid #000;padding:.5em;}th{font-weight:bold;text-align:center;}caption{margin-bottom:.5em;text-align:center;}sup{vertical-align:super;}sub{vertical-align:sub;}p,fieldset,table,pre{margin-bottom:1em;}button,input[type="checkbox"],input[type="radio"],input[type="reset"],input[type="submit"]{padding:1px;}

/* Ruff default CSS */

body {
  /*max-width: 70em;*/
  margin: 0;
}

h1,h2 {
  color: #888888;
  margin-bottom: 0.5em;
  margin-top: 0em;
}

#ft { font-size: x-small; font-family: Arial, sans-serif;
  text-align: left;
  border-top: 1px solid #0B3467;
  color: #888888;
  margin-top: 10px;
}

.banner h2 {
  color: #0B3467;
}

#hd.banner {
 font-family: "Times New Roman", serif;
 font-size: 200%;
 line-height: 64px;
 border-bottom: thin solid #0B3467;
 color: #0B3467;
}

p.linkline {
  text-align: right;
  font-size: smaller;
  /*    margin-top: -1em; */
  margin-bottom: 0;
}

.tinylink {
  font-size: x-small;
  font-variant: normal;
  font-family: Arial, sans-serif;
  float: right;
  padding:2px;
}

h1 .tinylink a {
  color: white;
}

#bd {
font-family: Arial, sans-serif;
/*font-size: 108%;*/
}

div.navbox {
  /* margin-top: 1em; */
  background-color: #0B3467;
  color: white;
  padding: 3px 4px 2px 4px;
  font-family: Arial, sans-serif;
  overflow: hidden;
}

div.navbox:hover {
  overflow: visible;
}

/* Note .navbox header css should be based on $header_levels */
.navbox h1, .navbox h2, .navbox h3, .navbox h4, .navbox h5 {
  font-size: 85%;
  margin: 0px;
  font-weight: normal;
}
.navbox h1 {
  font-weight: bold; /* Override */
}
.navbox h2 {
  padding-left: 1em;
}
.navbox h3 {
  padding-left: 2em;
}
.navbox h4 {
  padding-left: 2.5em;
  font-weight: normal;
}
.navbox h5 {
  padding-left: 3em;
  font-weight: normal;
}
.navbox hr {
  color: white;
  margin-top:0.1em;
  margin-bottom:0.1em;
}

.navbox a:link, .navbox a:visited, .navbox a:hover {
  text-decoration: none;
  color: white;
  background-color: #0B3467;
}

.navbox a:hover {
   font-weight: bold;
}

/* Tooltip text - see https://www.w3schools.com/css/css_tooltip.asp */
.tooltip {
  position: relative;
  /* display: inline-block; */
}

.tooltip .tooltiptext {
  width: 100%;
  font-weight: bold;
  background-color: white;
  color: #0B3467;
  text-align: left;
  border: 1px solid #0B3467;
  /* border-radius: 4px; */
  position: absolute;
  z-index: 1;
  margin-left: 4px;
  padding: 2px 3px;
  visibility: hidden;
}

/* Show the tooltip text when you mouse over the tooltip container */
.tooltip:hover .tooltiptext {
  visibility: visible;
}

span.ns_scope {
  color: #aaaaaa;
}

span.ns_scope a:link, span.ns_scope a:visited {
  text-decoration: none;
  color: #aaaaaa;

}

li {
  margin-top: 0.5em;
}

span.ns_scope a:hover {
  text-decoration: none;
  color: #666666;
}

table {
  margin: 1em;
  margin-top: 0.5em;
  border: thin solid;
  border-collapse: collapse;
  border-color: #808080;
  padding: 4px;
}

td {
  border: thin solid;
  border-color: #808080;
  vertical-align: top;
  font-size: 93%;
  padding: 0.3em;
  padding-top: 0.1em;
}
th {
  border: thin solid;
  border-color: #808080;
  padding: 0.3em;
  padding-top: 0.1em;
  background-color: #CCCCCC;
}

dt, dd {
   font-size: 93%;
}

h1.ruff {
  background-color: #0B3467;
  color: #ffffff;
  padding-left: 0.2em;
  font-family: "Times New Roman", serif;
}
h2.ruff {
  font-variant: small-caps;
  color: #0B3467;
  font-weight: bold;
  font-family: "Times New Roman", serif;
}

h3.ruff, h4.ruff, h5.ruff, h6.ruff {
  color: #0B3467;
}
h5.ruff {
  font-style: italic;
  font-weight: normal;
}
h6.ruff {
  font-weight: normal;
}
h3.ruffclass, h3.ruffproc, h3.ruffmethod,
h4.ruffclass, h4.ruffproc, h4.ruffmethod,
h5.ruffclass, h5.ruffproc, h5.ruffmethod {
  border-bottom: thin solid #0B3467;
  color: #0B3467;
  margin-bottom: 0.2em;
}

pre {
  background-color: #f9f9f9;
  margin-top: 1em;
  margin-left: 1em;
  padding: 5px;
  font-family: Consolas, "Courier New", monospace;
  /* width: max-content; --- to leave footsteps */ overflow: auto;
  line-height: 1.2em;
}

.ruff_dyn_src {
  display: none; /* Displayed via JS */
}

.ruff_synopsis {
  border: thin solid #cccccc;
  background: #f9f9f9;
  font-family: Consolas, "Courier New", monospace;
  padding: 5px;
  margin: 0em 2em 1em;
}
.ruff_const, .ruff_cmd, ruff_defitem {
  font-weight: bold;
  font-family: Consolas, "Courier New", monospace;
}
.ruff_arg {
  font-style: italic;
  font-family: Consolas, "Courier New", monospace;
}

.ruff_source_link {
  font-size: smaller;
}

.ruff_index {
  font-size: small;
  color: grey;
  line-height: 1;
}

.ruff_index ul li {
  list-style-type: none;
}

.ruff_index ul li a {
  text-decoration: none;
}
</style>
<script>function toggleSource( id )
{
  /* Copied from Rails */
  var elem
  var link

  if( document.getElementById )
  {
      elem = document.getElementById( id )
      link = document.getElementById( "l_" + id )
  }
  else if ( document.all )
  {
      elem = eval( "document.all." + id )
      link = eval( "document.all.l_" + id )
  }
  else
      return false;

  if( elem.style.display == "block" )
  {
      elem.style.display = "none"
      link.innerHTML = "Show source"
  }
  else
  {
      elem.style.display = "block"
      link.innerHTML = "Hide source"
  }
}
</script></head>
<meta name="author" content="aplsimple">
<meta name="description" content="aplsimple's home page">
<meta name="keywords" content="aplsimple,home">
<link rel="stylesheet" href="../../../en/zoo/style.css">
<style>
table{
background-color: #f9f9f9;
margin: 0%;
margin-bottom: 2%;
padding: 0%;
box-shadow: none;
filter: none;
}
pre{
margin: 0%;
margin-bottom: 2%;
padding: 0%;
}
</style>
<link rel="icon" type="image/jpg" href="../../../zoo/favicon.jpg">
<body>
<div id="wrapper">
<div name="divd1" ALIGN="CENTER"> <FONT SIZE=5em color=#b01c20><B>
<noscript>THIS PAGE IS NOT WORKING WITHOUT JAVASCRIPT!
<BR>
<BR>PLEASE, SWITCH ON JAVASCRIPT IN SETTINGS OF YOUR BROWSER AND RELOAD THE PAGE.
</noscript>
</B></FONT></div>
<div id='doc3' class='yui-t2'>
<script src="../../../zoo/funcs.js"></script>
<script src="../../../en/zoo/this.js"></script>
<section id=sec2>
<div id='hd' class='banner'>
<a name='aloupe.html'>::aloupe reference</a>
</div>
<div id='bd'><div id='yui-main'><div class='yui-b'><h1 class='ruff'><a name='::aloupe'></a>::aloupe<span class='tinylink'><a href='#top'>Top</a></span></h1>
<div style='clear:both;'></div>
<p class='ruff'>The <em>aloupe</em> is a Tcl/Tk small widget / utility allowing to view the screen through a loupe.</p>
<p class='ruff'>It allows also</p>
<ul class='ruff'>
<li>to make screenshots of magnified images</li>
<li>to pick a color from the images.</li>
</ul>
<p class='ruff'>It is inspired by the Tcl/Tk wiki pages:</p>
<p class='ruff'><a href="https://wiki.tcl-lang.org/page/A+little+magnifying+glass" >A little magnifying glass</a></p>
<p class='ruff'><a href="https://wiki.tcl-lang.org/page/A+Screenshot+Widget+implemented+with+TclOO" >A Screenshot Widget implemented with TclOO</a></p>
<p class='ruff'>It looks like this:</p>
<p class='ruff'><img src="https://aplsimple.github.io/en/tcl/aloupe/files/aloupe.png" class="media" alt=""></p>
<br><h2 class='ruff'><a name='::aloupe-Usage'></a>Usage<span class='tinylink'><a href='aloupe.html#::aloupe'>aloupe</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>The <em>aloupe</em> utility runs with the command:</p>
<pre class='ruff'><br><code class="tcl"> tclsh aloupe.tcl ?option value ...?
<br></code></pre>
<p class='ruff'>where <code>option</code> may be <code>-size, -zoom, -alpha, -background, -geometry, -ontop</code>.</p>
<p class='ruff'>The <code>Img</code> and <code>treectrl</code> packages have to be installed to run it. In Debian Linux the packages are titled <code>libtk-img</code> and <code>tktreectrl</code>. If <em>aloupe</em> is run by a <em>tclkit</em> that doesn't provide these packages, define an environment variable <code>TCLLIBPATH</code> before running <em>aloupe</em> so that <code>TCLLIBPATH</code> be a list of pathes to the packages.</p>
<p class='ruff'>There are also stand-alone <a href="https://github.com/aplsimple/aloupe/releases" >aloupe executables</a> for Linux / Windows.</p>
<p class='ruff'>The executables are started as simply as:</p>
<pre class='ruff'><br><code class="tcl"> aloupe ?option value ...?
 aloupe.exe ?option value ...?
<br></code></pre>
<p class='ruff'>After the start, two windows would be displayed: a moveable loupe (at the mouse pointer) and a displaying window.</p>
<p class='ruff'>The loupe is moved by drag-and-drop. At dropping the loupe, its underlying image is magnified in the displaying window.</p>
<p class='ruff'>To change a size/zoom of the loupe, use the appropriate spinboxes. After changing them, just click the loupe to update the windows.</p>
<p class='ruff'>To save the magnified image, use <em>Save</em> button.</p>
<p class='ruff'>The <em>To clipboard</em> button displays a current pixel's color at clicking the image. When hit, the button puts the color into the clipboard.</p>
<p class='ruff'>The <code>-command</code> option may be passed to <code>::aloupe::run</code> which will run the passed command at pressing the <em>To clipboard</em> button. The command may contain <code>%c</code> wildcard meaning the color value. Just to test, try and set <code>-command &quot;puts %c&quot;</code> option.</p>
<br><h2 class='ruff'><a name='::aloupe-Options'></a>Options<span class='tinylink'><a href='aloupe.html#::aloupe'>aloupe</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>The <em>aloupe</em> can be run with the options:</p>
<ul class='ruff'>
<li><code>-size</code> - a size of the loupe's box (8 .. 256)</li>
<li><code>-zoom</code> - a zoom factor (2 .. 32)</li>
<li><code>-alpha</code> - an opacity of the loupe (0.0 .. 1.0)</li>
<li><code>-background</code> - a background color of the loupe</li>
<li><code>-geometry</code> - a displaying window's geometry set as +X+Y</li>
<li><code>-ontop</code> - if <em>yes</em> (default), sets the displaying window above others</li>
<li><code>-save</code> - if <em>yes</em> (default), saves/restores the appearance settings</li>
<li><code>-inifile</code> - a file to save the settings (~/.config/aloupe.conf by default)</li>
<li><code>-locale</code> - a preferable locale (e.g., ru, ua, cz)</li>
</ul>
<p class='ruff'>Some options can be used at running <em>aloupe</em> from a Tcl code:</p>
<ul class='ruff'>
<li><code>-exit</code> - is <em>false</em> which means &quot;don't finish Tcl/Tk session, just close the loupe&quot;</li>
<li><code>-command</code> - a command to be run at pressing the <em>To clipboard</em> button</li>
<li><code>-commandname</code> - a label instead of <em>To clipboard</em>; when set it means also &quot;no copy to clipboard&quot;</li>
<li><code>-parent</code> - a parent window's path (when the parent closes, its <em>aloupe</em> children do too)</li>
</ul>
<p class='ruff'>From a Tcl code, <em>aloupe</em> widget is called this way:</p>
<pre class='ruff'><br><code class="tcl"> <b><font color=#923B23>package</font></b> require aloupe
 ::aloupe::run ?option value ...?
<br></code></pre>
<br><h2 class='ruff'><a name='::aloupe-Links'></a>Links<span class='tinylink'><a href='aloupe.html#::aloupe'>aloupe</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<ul class='ruff'>
<li><a href="https://aplsimple.github.io/en/tcl/aloupe/aloupe.html" >Reference</a></li>
<li><a href="https://chiselapp.com/user/aplsimple/repository/aloupe/download" >Source</a> (aloupe.zip)</li>
<li><a href="https://github.com/aplsimple/aloupe/releases" >Demo and executables</a> for Linux / Windows</li>
</ul>
<br><h2 class='ruff'><a name='::aloupe-License'></a>License<span class='tinylink'><a href='aloupe.html#::aloupe'>aloupe</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>MIT.</p>
<br><h2 class='ruff'><a name='::aloupe-Commands'></a>Commands<span class='tinylink'><a href='aloupe.html#::aloupe'>aloupe</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<br><br><br><h4 class='ruffproc'><a name='::aloupe::option'>option</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe" title="::aloupe" class='ruff_cmd'>::aloupe</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe'>aloupe</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Returns a value of aloupe option.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>option</span> <span class='ruff_arg'>opt</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>opt</code></code></td><td class='ruff_defitem'>the option's name</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns a value of aloupe option.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_1' href="javascript:toggleSource('1')">Show source</a></p>
<div id='1' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::option {opt} {

  <i><font color=#646464># Returns a value of aloupe option.</font></i>
  <i><font color=#646464>#   opt - the option's name</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#A106A1>return</font></b> <font color=#4A181B>$data(</font>$opt)
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::run'>run</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe" title="::aloupe" class='ruff_cmd'>::aloupe</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe'>aloupe</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Runs the loupe.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>run</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>args</code></code></td><td class='ruff_defitem'>options of the loupe</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_2' href="javascript:toggleSource('2')">Show source</a></p>
<div id='2' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::run {args} {

  <i><font color=#646464># Runs the loupe.</font></i>
  <i><font color=#646464>#  args - options of the loupe</font></i>

  <b><font color=#923B23>variable</font></b> my::data
  <b><font color=#923B23>variable</font></b> my::size
  <b><font color=#923B23>variable</font></b> my::zoom
  <i><font color=#646464># save the default settings of aloupe</font></i>
  <b><font color=#923B23>set</font></b> data(<font color=#463e11>-commandname</font>) <font color=#035103>&quot;&quot;</font>
  <b><font color=#923B23>if</font></b> {![<b><font color=#923B23>info</font></b> exists my::data(DEFAULTS)]} {
    <b><font color=#923B23>set</font></b> defar ::aloupe::_DEFAULTS_
    <b><font color=#923B23>array</font></b> set <font color=#4A181B>$defar</font> [<b><font color=#923B23>array</font></b> get my::data]
    <b><font color=#923B23>set</font></b> my::data(DEFAULTS) <font color=#4A181B>$defar</font>
    <b><font color=#923B23>catch</font></b> {<b><font color=#923B23>set</font></b> my::data(<font color=#463e11>-inifile</font>) [<b><font color=#923B23>dict</font></b> get <font color=#4A181B>$args</font> <font color=#463e11>-inifile</font>]}
    <b><font color=#923B23>catch</font></b> {
      <b><font color=#923B23>if</font></b> { ([<b><font color=#923B23>dict</font></b> exists <font color=#4A181B>$args</font> <font color=#463e11>-save</font>] && [<b><font color=#923B23>dict</font></b> get <font color=#4A181B>$args</font> <font color=#463e11>-save</font>]) ||  (![<b><font color=#923B23>dict</font></b> exists <font color=#4A181B>$args</font> <font color=#463e11>-save</font>] && <font color=#4A181B>$my::data(<font color=#463e11></font>-save</font>)) } {
        my::RestoreOptions
      }
    }
  }
  <i><font color=#646464># restore the default settings of aloupe (for a 2nd/3rd... run)</font></i>
  <b><font color=#923B23>set</font></b> svd <font color=#4A181B>$my::data(DEFAULTS)</font>
  <b><font color=#923B23>foreach</font></b> an [<b><font color=#923B23>array</font></b> names <font color=#4A181B>$svd)</font>] {
    <b><font color=#923B23>set</font></b> my::data(<font color=#4A181B>$an)</font> [<b><font color=#923B23>set</font></b> <font color=#4A181B>${svd}</font>(<font color=#4A181B>$an)</font>] ;<i><font color=#646464># a bit of addresses</font></i>
  }
  <b><font color=#923B23>foreach</font></b> {a v} <font color=#4A181B>$args</font> {
    <b><font color=#923B23>if</font></b> {(<font color=#4A181B>$v</font> ne <font color=#035103>&quot;&quot;</font> || <font color=#4A181B>$a</font> in {<font color=#463e11>-geometry</font>}) &&  [<b><font color=#923B23>info</font></b> exists my::data(<font color=#4A181B>$a)</font>] && [<b><font color=#923B23>string</font></b> is lower [<b><font color=#923B23>string</font></b> index <font color=#4A181B>$a</font> 1]]} {
      <b><font color=#923B23>set</font></b> my::data(<font color=#4A181B>$a)</font> <font color=#4A181B>$v</font>
    } <b><font color=#923B23>else</font></b> {
      <b><font color=#923B23>puts</font></b> <font color=#035103>&quot;Bad option: <font color=#4A181B>$</font>a \&quot;<font color=#4A181B>$</font>v\&quot;&quot;</font>
      my::Synopsis
    }
  }
  <b><font color=#923B23>if</font></b> {<font color=#4A181B>$my::data(<font color=#463e11></font>-locale</font>) ne {}} {
    <b><font color=#923B23>catch</font></b> {
      ::msgcat::mcload [<b><font color=#923B23>file</font></b> join [<b><font color=#923B23>file</font></b> dirname [<b><font color=#923B23>info</font></b> script]] msgs]
      ::msgcat::mclocale <font color=#4A181B>$my::data(<font color=#463e11></font>-locale</font>)
    }
  }
  <b><font color=#923B23>catch</font></b> {::apave::obj untouchWidgets <font color=#035103>&quot;*_a_loupe_loup*&quot;</font>}  ;<i><font color=#646464># don't theme the loupe</font></i>
  <b><font color=#923B23>set</font></b> my::size [<b><font color=#923B23>set</font></b> my::data(PREVSIZE) <font color=#4A181B>$my::data(<font color=#463e11></font>-size</font>)]
  <b><font color=#923B23>set</font></b> my::zoom [<b><font color=#923B23>set</font></b> my::data(PREVZOOM) <font color=#4A181B>$my::data(<font color=#463e11></font>-zoom</font>)]
  my::Create yes
}<br><br></code></pre></div>
</div><br><br><h1 class='ruff'><a name='::aloupe::my'></a>::aloupe::my<span class='tinylink'><a href='#top'>Top</a></span></h1>
<div style='clear:both;'></div>
<p class='ruff'>The <code>::aloupe::my</code> namespace contains procedures for the &quot;internal&quot; usage by <em>aloupe</em> package.</p>
<p class='ruff'>All of them are upper-cased, in contrast with the UI procedures of <code>aloupe</code> namespace.</p>
<br><h2 class='ruff'><a name='::aloupe::my-Commands'></a>Commands<span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<br><br><br><h4 class='ruffproc'><a name='::aloupe::my::Button2Click'>Button2Click</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Processes the click on 'Clipboard' button.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Button2Click</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_3' href="javascript:toggleSource('3')">Show source</a></p>
<div id='3' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::Button2Click {} {

  <i><font color=#646464># Processes the click on 'Clipboard' button.</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>if</font></b> {<font color=#4A181B>$data(COLOR)</font> ne <font color=#035103>&quot;&quot;</font>} {
    StyleButton2 yes <font color=#463e11>-background</font> <font color=#4A181B>$data(INVCOLOR)</font> <font color=#463e11>-foreground</font> <font color=#4A181B>$data(COLOR)</font>
    <b><font color=#923B23>update</font></b> idletasks
    <b><font color=#923B23>after</font></b> 60 ;<i><font color=#646464># just to make the click visible</font></i>
  }
  <b><font color=#923B23>if</font></b> {[HandleColor] && !<font color=#4A181B>$data(<font color=#463e11></font>-exit</font>) && <font color=#4A181B>$data(<font color=#463e11></font>-command</font>) ne <font color=#035103>&quot;&quot;</font>} {
    SaveGeometry
    {*}[<b><font color=#923B23>string</font></b> map [<b><font color=#923B23>list</font></b> %c <font color=#4A181B>$data(COLOR)</font>] <font color=#4A181B>$data(<font color=#463e11></font>-command</font>)]
  }
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::Create'>Create</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Initializes and creates the utility's windows.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Create</span> <span class='ruff_arg'>start</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>start</code></code></td><td class='ruff_defitem'>yes, if called at start</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_4' href="javascript:toggleSource('4')">Show source</a></p>
<div id='4' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::Create {start} {

  <i><font color=#646464># Initializes and creates the utility's windows.</font></i>
  <i><font color=#646464>#   start - yes, if called at start</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>catch</font></b> {<b><font color=#7A040E>destroy</font></b> <font color=#4A181B>$data(WLOUP)</font>}
  <b><font color=#923B23>catch</font></b> {<b><font color=#7A040E>destroy</font></b> <font color=#4A181B>$data(WDISP)</font>}
  <b><font color=#923B23>set</font></b> data(WLOUP) <font color=#035103>&quot;<font color=#4A181B>$</font>data(-parent)._a_loupe_loup&quot;</font>
  <b><font color=#923B23>set</font></b> data(WDISP) <font color=#035103>&quot;<font color=#4A181B>$</font>data(-parent)._a_loupe_disp&quot;</font>
  <b><font color=#923B23>set</font></b> data(LABEL) <font color=#035103>&quot;<font color=#4A181B>$</font>data(WDISP).label&quot;</font>
  <b><font color=#923B23>set</font></b> data(COLOR) [<b><font color=#923B23>set</font></b> data(CAPTURE) <font color=#035103>&quot;&quot;</font>]
  <b><font color=#923B23>catch</font></b> {<b><font color=#7A040E>image</font></b> delete <font color=#4A181B>$data(IMAGE)</font>}
  <b><font color=#923B23>if</font></b> {[<b><font color=#923B23>set</font></b> wgr [<b><font color=#7A040E>grab</font></b> current]] ne <font color=#035103>&quot;&quot;</font>} {<b><font color=#7A040E>grab</font></b> release <font color=#4A181B>$wgr</font>}
  CreateDisplay <font color=#4A181B>$start</font>
  CreateLoupe
  <b><font color=#923B23>set</font></b> data(PREVZOOM) <font color=#4A181B>$data(<font color=#463e11></font>-zoom</font>)
  <b><font color=#923B23>set</font></b> data(PREVSIZE) <font color=#4A181B>$data(<font color=#463e11></font>-size</font>)
  <b><font color=#7A040E>focus</font></b> <font color=#4A181B>$data(WDISP)</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::CreateDisplay'>CreateDisplay</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Creates the displaying window.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>CreateDisplay</span> <span class='ruff_arg'>start</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>start</code></code></td><td class='ruff_defitem'>yes, if called at start</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_5' href="javascript:toggleSource('5')">Show source</a></p>
<div id='5' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::CreateDisplay {start} {

  <i><font color=#646464># Creates the displaying window.</font></i>
  <i><font color=#646464>#   start - yes, if called at start</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>set</font></b> sZ [<b><font color=#923B23>expr</font></b> {2*<font color=#4A181B>$data(<font color=#463e11></font>-size</font>)*<font color=#4A181B>$data(<font color=#463e11></font>-zoom</font>)}]
  <b><font color=#923B23>set</font></b> data(IMAGE) [<b><font color=#7A040E>image</font></b> create photo <font color=#463e11>-width</font> <font color=#4A181B>$sZ</font> <font color=#463e11>-height</font> <font color=#4A181B>$sZ</font>]
  <b><font color=#7A040E>toplevel</font></b> <font color=#4A181B>$data(WDISP)</font>
  <b><font color=#7A040E>wm</font></b> title <font color=#4A181B>$data(WDISP)</font> [::msgcat::mc Loupe]
  <font color=#4A181B>$data(WDISP)</font> configure <font color=#463e11>-background</font> [<b><font color=#7A040E>ttk::style</font></b> configure . <font color=#463e11>-background</font>]
  <b><font color=#7A040E>grid</font></b> [<b><font color=#7A040E>ttk::label</font></b> <font color=#4A181B>$data(WDISP)</font>.lab1 <font color=#463e11>-text</font> <font color=#035103>&quot; <font color=#4A181B>[</font>::msgcat::mc Size<font color=#4A181B>]</font>&quot;</font>] <font color=#463e11>-row</font> 0 <font color=#463e11>-column</font> 0 <font color=#463e11>-sticky</font> e
  <b><font color=#7A040E>grid</font></b> [<b><font color=#7A040E>ttk::spinbox</font></b> <font color=#4A181B>$data(WDISP)</font>.sp1 <font color=#463e11>-from</font> 8 <font color=#463e11>-to</font> 500 <font color=#463e11>-justify</font> center  <font color=#463e11>-width</font> 4 <font color=#463e11>-textvariable</font> ::aloupe::my::size <font color=#463e11>-command</font> ::aloupe::my::SizeLoupe]  <font color=#463e11>-row</font> 0 <font color=#463e11>-column</font> 1 <font color=#463e11>-sticky</font> w
  <b><font color=#7A040E>grid</font></b> [<b><font color=#7A040E>ttk::label</font></b> <font color=#4A181B>$data(WDISP)</font>.lab2 <font color=#463e11>-text</font> <font color=#035103>&quot; <font color=#4A181B>[</font>::msgcat::mc Zoom<font color=#4A181B>]</font>&quot;</font>] <font color=#463e11>-row</font> 0 <font color=#463e11>-column</font> 2 <font color=#463e11>-sticky</font> e
  <b><font color=#7A040E>grid</font></b> [<b><font color=#7A040E>ttk::spinbox</font></b> <font color=#4A181B>$data(WDISP)</font>.sp2 <font color=#463e11>-from</font> 1 <font color=#463e11>-to</font> 50 <font color=#463e11>-justify</font> center  <font color=#463e11>-width</font> 2 <font color=#463e11>-textvariable</font> ::aloupe::my::zoom] <font color=#463e11>-row</font> 0 <font color=#463e11>-column</font> 3 <font color=#463e11>-sticky</font> w
  <b><font color=#7A040E>grid</font></b> [<b><font color=#7A040E>ttk::separator</font></b> <font color=#4A181B>$data(WDISP)</font>.sep1 <font color=#463e11>-orient</font> horizontal] <font color=#463e11>-row</font> 1 <font color=#463e11>-columnspan</font> 4 <font color=#463e11>-sticky</font> we <font color=#463e11>-pady</font> 2
  <b><font color=#7A040E>grid</font></b> [<b><font color=#7A040E>ttk::label</font></b> <font color=#4A181B>$data(LABEL)</font> <font color=#463e11>-image</font> <font color=#4A181B>$data(IMAGE)</font> <font color=#463e11>-relief</font> flat  <font color=#463e11>-style</font> [<b><font color=#923B23>lindex</font></b> [SetStyle TLabel no <font color=#463e11>-bd</font> 0] 1]] <font color=#463e11>-row</font> 2 <font color=#463e11>-columnspan</font> 4 <font color=#463e11>-padx</font> 2
  <b><font color=#923B23>set</font></b> data(BUT2) <font color=#4A181B>$data(WDISP)</font>.but2
  <b><font color=#923B23>if</font></b> {[<b><font color=#923B23>set</font></b> but2text <font color=#4A181B>$data(<font color=#463e11></font>-commandname</font>)] eq <font color=#035103>&quot;&quot;</font>} {
    <b><font color=#923B23>set</font></b> but2text [::msgcat::mc <font color=#035103>&quot;To clipboard&quot;</font>]
  }
  <b><font color=#7A040E>grid</font></b> [<b><font color=#7A040E>ttk::button</font></b> <font color=#4A181B>$data(BUT2)</font> <font color=#463e11>-text</font> <font color=#4A181B>$but2text</font>  <font color=#463e11>-command</font> ::aloupe::my::Button2Click] <font color=#463e11>-row</font> 3 <font color=#463e11>-column</font> 0 <font color=#463e11>-columnspan</font> 2 <font color=#463e11>-sticky</font> ew
  <b><font color=#7A040E>grid</font></b> [<b><font color=#7A040E>ttk::button</font></b> <font color=#4A181B>$data(WDISP)</font>.but1 <font color=#463e11>-text</font> [::msgcat::mc Save]  <font color=#463e11>-command</font> ::aloupe::my::Save] <font color=#463e11>-row</font> 3 <font color=#463e11>-column</font> 2 <font color=#463e11>-columnspan</font> 2 <font color=#463e11>-sticky</font> ew
  <b><font color=#923B23>set</font></b> data(<font color=#463e11>-geometry</font>) [<b><font color=#923B23>regexp</font></b> <font color=#463e11>-inline</font> \\+.* <font color=#4A181B>$data(<font color=#463e11></font>-geometry</font>)]
  <b><font color=#923B23>if</font></b> {<font color=#4A181B>$data(<font color=#463e11></font>-geometry</font>) ne <font color=#035103>&quot;&quot;</font>} {
    <b><font color=#7A040E>wm</font></b> geometry <font color=#4A181B>$data(WDISP)</font> <font color=#4A181B>$data(<font color=#463e11></font>-geometry</font>)
  } <b><font color=#923B23>elseif</font></b> {<font color=#4A181B>$data(<font color=#463e11></font>-parent</font>) ne <font color=#035103>&quot;&quot;</font>} {
    ::tk::PlaceWindow <font color=#4A181B>$data(WDISP)</font> widget <font color=#4A181B>$data(<font color=#463e11></font>-parent</font>)
  } <b><font color=#923B23>else</font></b> {
    ::tk::PlaceWindow <font color=#4A181B>$data(WDISP)</font>
  }
  <b><font color=#923B23>if</font></b> {<font color=#4A181B>$start</font>} {
    <b><font color=#923B23>set</font></b> defargs [<b><font color=#923B23>list</font></b>  <font color=#463e11>-foreground</font> [<b><font color=#7A040E>ttk::style</font></b> configure . <font color=#463e11>-foreground</font>]  <font color=#463e11>-background</font> [<b><font color=#7A040E>ttk::style</font></b> configure . <font color=#463e11>-background</font>] ]
    <b><font color=#923B23>set</font></b> data(BUTCFG) [StyleButton2 no {*}<font color=#4A181B>$defargs</font>]
    <b><font color=#923B23>lappend</font></b> data(BUTCFG) {*}<font color=#4A181B>$defargs</font> <font color=#463e11>-text</font> <font color=#4A181B>$but2text</font>
  }
  <b><font color=#7A040E>bind</font></b> <font color=#4A181B>$data(LABEL)</font> &lt;ButtonPress-1&gt; {::aloupe::my::PickColor %W %X %Y}
  <b><font color=#7A040E>bind</font></b> <font color=#4A181B>$data(WDISP)</font> &lt;Escape&gt; ::aloupe::my::Exit
  <b><font color=#7A040E>wm</font></b> resizable <font color=#4A181B>$data(WDISP)</font> 0 0
  <b><font color=#7A040E>wm</font></b> protocol <font color=#4A181B>$data(WDISP)</font> WM_DELETE_WINDOW ::aloupe::my::Exit
  <b><font color=#923B23>if</font></b> {<font color=#4A181B>$data(<font color=#463e11></font>-ontop</font>)} {<b><font color=#7A040E>wm</font></b> attributes <font color=#4A181B>$data(WDISP)</font> <font color=#463e11>-topmost</font> 1}
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::CreateLoupe'>CreateLoupe</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Creates the loupe window.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>CreateLoupe</span> <span class='ruff_arg'>?geom?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>geom</code></code></td><td class='ruff_defitem'>the predefined geometry; <i>optional, default</i> <code>&quot;&quot;</code></td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_6' href="javascript:toggleSource('6')">Show source</a></p>
<div id='6' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::CreateLoupe {{geom {}}} {

  <i><font color=#646464># Creates the loupe window.</font></i>
  <i><font color=#646464>#   geom - the predefined geometry</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#7A040E>frame</font></b> <font color=#4A181B>$data(WLOUP)</font>
  <b><font color=#7A040E>wm</font></b> manage <font color=#4A181B>$data(WLOUP)</font>
  <b><font color=#7A040E>wm</font></b> withdraw <font color=#4A181B>$data(WLOUP)</font>
  <b><font color=#7A040E>wm</font></b> overrideredirect <font color=#4A181B>$data(WLOUP)</font> 1
  <b><font color=#923B23>set</font></b> canvas <font color=#4A181B>$data(WLOUP)</font>.c
  <b><font color=#7A040E>canvas</font></b> <font color=#4A181B>$canvas</font> <font color=#463e11>-width</font> 100 <font color=#463e11>-height</font> 100 <font color=#463e11>-background</font> <font color=#4A181B>$data(<font color=#463e11></font>-background</font>)  <font color=#463e11>-relief</font> flat <font color=#463e11>-bd</font> 0 <font color=#463e11>-highlightthickness</font> 1 <font color=#463e11>-highlightbackground</font> red
  <b><font color=#7A040E>pack</font></b> <font color=#4A181B>$canvas</font> <font color=#463e11>-fill</font> both <font color=#463e11>-expand</font> true
  <b><font color=#7A040E>bind</font></b> <font color=#4A181B>$canvas</font> &lt;ButtonPress-1&gt;   {::aloupe::my::DragStart %W %X %Y}
  <b><font color=#7A040E>bind</font></b> <font color=#4A181B>$canvas</font> &lt;B1<font color=#463e11>-Motion</font>&gt;       {::aloupe::my::Drag %W %X %Y}
  <b><font color=#7A040E>bind</font></b> <font color=#4A181B>$canvas</font> &lt;ButtonRelease-1&gt; {::aloupe::my::DragEnd %W}
  <b><font color=#7A040E>bind</font></b> <font color=#4A181B>$canvas</font> &lt;Escape&gt;          {::aloupe::my::Exit}
  <b><font color=#923B23>after</font></b> 50 <font color=#035103>&quot;</font>
<font color=#035103>    ::aloupe::my::InitGeometry <font color=#4A181B>$</font>geom</font>
<font color=#035103>    wm deiconify <font color=#4A181B>$</font>data(WLOUP)</font>
<font color=#035103>    wm attributes <font color=#4A181B>$</font>data(WLOUP) -topmost 1 -alpha <font color=#4A181B>$</font>data(-alpha)</font>
<font color=#035103>    &quot;</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::Drag'>Drag</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Performs the frag-and-drop of the loupe.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Drag</span> <span class='ruff_arg'>w X Y</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>w</code></code></td><td class='ruff_defitem'>the loupe window's path</td></tr>
<tr><td class='ruff_defitem'><code><code>X</code></code></td><td class='ruff_defitem'>X-coordinate of the mouse pointer</td></tr>
<tr><td class='ruff_defitem'><code><code>Y</code></code></td><td class='ruff_defitem'>Y-coordinate of the mouse pointer</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_7' href="javascript:toggleSource('7')">Show source</a></p>
<div id='7' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::Drag {w X Y} {

  <i><font color=#646464># Performs the frag-and-drop of the loupe.</font></i>
  <i><font color=#646464>#   w - the loupe window's path</font></i>
  <i><font color=#646464>#   X - X-coordinate of the mouse pointer</font></i>
  <i><font color=#646464>#   Y - Y-coordinate of the mouse pointer</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>if</font></b> {![<b><font color=#923B23>info</font></b> exists data(dragX)]} <b><font color=#A106A1>return</font></b>
  <b><font color=#923B23>set</font></b> dx [<b><font color=#923B23>expr</font></b> {<font color=#4A181B>$X</font> - <font color=#4A181B>$data(dragX)</font>}]
  <b><font color=#923B23>set</font></b> dy [<b><font color=#923B23>expr</font></b> {<font color=#4A181B>$Y</font> - <font color=#4A181B>$data(dragY)</font>}]
  <b><font color=#7A040E>wm</font></b> geometry <font color=#4A181B>$data(WLOUP)</font> +<font color=#4A181B>$dx</font>+<font color=#4A181B>$dy</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::DragEnd'>DragEnd</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Ends the frag-and-drop of the loupe and displays its magnified image.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>DragEnd</span> <span class='ruff_arg'>w</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>w</code></code></td><td class='ruff_defitem'>the loupe window's path</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_8' href="javascript:toggleSource('8')">Show source</a></p>
<div id='8' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::DragEnd {w} {

  <i><font color=#646464># Ends the frag-and-drop of the loupe and displays its magnified image.</font></i>
  <i><font color=#646464>#   w - the loupe window's path</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>if</font></b> {![<b><font color=#923B23>info</font></b> exists data(dragX)]} <b><font color=#A106A1>return</font></b>
  <b><font color=#7A040E>wm</font></b> withdraw <font color=#4A181B>$data(WLOUP)</font>
  <b><font color=#923B23>if</font></b> {!<font color=#4A181B>$data(<font color=#463e11></font>-ontop</font>) && ![<b><font color=#923B23>string</font></b> match <font color=#4A181B>$data(WDISP)</font>* <font color=#4A181B>$data(FOCUS)</font>] &&
  <font color=#4A181B>$::tcl_platform(platform)</font> eq <font color=#035103>&quot;unix&quot;</font>} {
    <i><font color=#646464># the disp window can be overlapped by others =&gt; it should be deiconified</font></i>
    <b><font color=#7A040E>wm</font></b> withdraw <font color=#4A181B>$data(WDISP)</font>
  }
  <b><font color=#923B23>set</font></b> curX [<b><font color=#7A040E>winfo</font></b> rootx <font color=#4A181B>$w</font>]
  <b><font color=#923B23>set</font></b> curY [<b><font color=#7A040E>winfo</font></b> rooty <font color=#4A181B>$w</font>]
  <b><font color=#923B23>set</font></b> curW [<b><font color=#7A040E>winfo</font></b> width <font color=#4A181B>$w</font>]
  <b><font color=#923B23>set</font></b> curH [<b><font color=#7A040E>winfo</font></b> height <font color=#4A181B>$w</font>]
  <b><font color=#923B23>catch</font></b> {<b><font color=#7A040E>image</font></b> delete <font color=#4A181B>$data(CAPTURE)</font>}
  <b><font color=#923B23>set</font></b> sz [<b><font color=#923B23>expr</font></b> {2*<font color=#4A181B>$data(<font color=#463e11></font>-size</font>)}]
  <b><font color=#923B23>set</font></b> sZ [<b><font color=#923B23>expr</font></b> {<font color=#4A181B>$sz</font>*<font color=#4A181B>$data(<font color=#463e11></font>-zoom</font>)}]
  <b><font color=#923B23>set</font></b> data(CAPTURE) [<b><font color=#7A040E>image</font></b> create photo <font color=#463e11>-width</font> <font color=#4A181B>$sz</font> <font color=#463e11>-height</font> <font color=#4A181B>$sz</font>]
  <b><font color=#923B23>set</font></b> loupe_x [<b><font color=#923B23>expr</font></b> {<font color=#4A181B>$curX</font> + <font color=#4A181B>$sz</font>/2}]
  <b><font color=#923B23>set</font></b> loupe_y [<b><font color=#923B23>expr</font></b> {<font color=#4A181B>$curY</font> + <font color=#4A181B>$sz</font>/2}]
  <b><font color=#923B23>after</font></b> 40 <font color=#035103>&quot;loupe <font color=#4A181B>$</font>data(CAPTURE) <font color=#4A181B>$</font>loupe_x <font color=#4A181B>$</font>loupe_y <font color=#4A181B>$</font>sz <font color=#4A181B>$</font>sz 1&quot;</font>
  <b><font color=#923B23>after</font></b> 50
  <b><font color=#923B23>update</font></b>   ;<i><font color=#646464># enough time to hide the window and capture the image</font></i>
  <b><font color=#923B23>after</font></b> 50
  <b><font color=#923B23>catch</font></b> {
    <font color=#4A181B>$data(IMAGE)</font> copy <font color=#4A181B>$data(CAPTURE)</font> <font color=#463e11>-from</font> 0 0 <font color=#4A181B>$sz</font> <font color=#4A181B>$sz</font>  <font color=#463e11>-to</font> 0 0 <font color=#4A181B>$sZ</font> <font color=#4A181B>$sZ</font> <font color=#463e11>-zoom</font> <font color=#4A181B>$data(<font color=#463e11></font>-zoom</font>)
  }
  <b><font color=#7A040E>wm</font></b> deiconify <font color=#4A181B>$data(WDISP)</font>
  <b><font color=#7A040E>wm</font></b> deiconify <font color=#4A181B>$data(WLOUP)</font>
  <b><font color=#7A040E>focus</font></b> <font color=#463e11>-force</font> <font color=#4A181B>$data(WDISP)</font>.but2
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::DragStart'>DragStart</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Initializes the frag-and-drop of the loupe.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>DragStart</span> <span class='ruff_arg'>w X Y</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>w</code></code></td><td class='ruff_defitem'>the loupe window's path</td></tr>
<tr><td class='ruff_defitem'><code><code>X</code></code></td><td class='ruff_defitem'>X-coordinate of the mouse pointer</td></tr>
<tr><td class='ruff_defitem'><code><code>Y</code></code></td><td class='ruff_defitem'>Y-coordinate of the mouse pointer</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_9' href="javascript:toggleSource('9')">Show source</a></p>
<div id='9' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::DragStart {w X Y} {

  <i><font color=#646464># Initializes the frag-and-drop of the loupe.</font></i>
  <i><font color=#646464>#   w - the loupe window's path</font></i>
  <i><font color=#646464>#   X - X-coordinate of the mouse pointer</font></i>
  <i><font color=#646464>#   Y - Y-coordinate of the mouse pointer</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>variable</font></b> size
  <b><font color=#923B23>variable</font></b> zoom
  <b><font color=#923B23>set</font></b> data(FOCUS) [<b><font color=#7A040E>focus</font></b>]
  <b><font color=#7A040E>focus</font></b> <font color=#463e11>-force</font> <font color=#4A181B>$data(WDISP)</font>
  <b><font color=#923B23>set</font></b> data(<font color=#463e11>-size</font>) <font color=#4A181B>$size</font>
  <b><font color=#923B23>set</font></b> data(<font color=#463e11>-zoom</font>) <font color=#4A181B>$zoom</font>
  <b><font color=#923B23>if</font></b> {<font color=#4A181B>$data(PREVZOOM)</font> != <font color=#4A181B>$data(<font color=#463e11></font>-zoom</font>) || <font color=#4A181B>$data(PREVSIZE)</font> != <font color=#4A181B>$data(<font color=#463e11></font>-size</font>)} {
    SaveGeometry
    Create no
    <b><font color=#923B23>catch</font></b> {<b><font color=#923B23>unset</font></b> data(dragX)}  ;<i><font color=#646464># no drag-n-drop, update the loupe only</font></i>
    <b><font color=#923B23>update</font></b>
    <b><font color=#A106A1>return</font></b>
  }
  <b><font color=#923B23>set</font></b> data(COLOR) [<b><font color=#923B23>set</font></b> data(CAPTURE) <font color=#035103>&quot;&quot;</font>]
  StyleButton2 no {*}<font color=#4A181B>$data(BUTCFG)</font>
  InitGeometry
  <b><font color=#923B23>update</font></b>
  <b><font color=#923B23>set</font></b> data(dragX) [<b><font color=#923B23>expr</font></b> {<font color=#4A181B>$X</font> - [<b><font color=#7A040E>winfo</font></b> rootx <font color=#4A181B>$w</font>]}]
  <b><font color=#923B23>set</font></b> data(dragY) [<b><font color=#923B23>expr</font></b> {<font color=#4A181B>$Y</font> - [<b><font color=#7A040E>winfo</font></b> rooty <font color=#4A181B>$w</font>]}]
  <b><font color=#923B23>set</font></b> data(dragw) [<b><font color=#7A040E>winfo</font></b> width <font color=#4A181B>$w</font>]
  <b><font color=#923B23>set</font></b> data(dragh) [<b><font color=#7A040E>winfo</font></b> height <font color=#4A181B>$w</font>]
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::Exit'>Exit</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Clears all and exits.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Exit</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_10' href="javascript:toggleSource('10')">Show source</a></p>
<div id='10' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::Exit {} {

  <i><font color=#646464># Clears all and exits.</font></i>

  <b><font color=#923B23>variable</font></b> data
  SaveOptions
  <b><font color=#923B23>if</font></b> {<font color=#4A181B>$data(<font color=#463e11></font>-exit</font>)} <b><font color=#923B23>exit</font></b>
  SaveGeometry
  <b><font color=#923B23>catch</font></b> {<b><font color=#7A040E>image</font></b> delete <font color=#4A181B>$data(IMAGE)</font>}
  <b><font color=#923B23>catch</font></b> {<b><font color=#7A040E>image</font></b> delete <font color=#4A181B>$data(CAPTURE)</font>}
  <b><font color=#923B23>catch</font></b> {<b><font color=#7A040E>destroy</font></b> <font color=#4A181B>$data(WDISP)</font>}
  <b><font color=#923B23>catch</font></b> {
    <b><font color=#7A040E>wm</font></b> withdraw <font color=#4A181B>$data(WLOUP)</font>
    <b><font color=#7A040E>destroy</font></b> <font color=#4A181B>$data(WLOUP)</font>
  }
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::HandleColor'>HandleColor</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Processes the image color under the mouse pointer, optionally saving it to the clipboard.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>HandleColor</span> <span class='ruff_arg'>?doclb?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>doclb</code></code></td><td class='ruff_defitem'>if 'yes', means &quot;put the color into the clipboard&quot; <i>optional, default</i> <code>yes</code></td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns 'yes' if the color was chosen.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_11' href="javascript:toggleSource('11')">Show source</a></p>
<div id='11' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::HandleColor {{doclb yes}} {

  <i><font color=#646464># Processes the image color under the mouse pointer,</font></i>
  <i><font color=#646464># optionally saving it to the clipboard.</font></i>
  <i><font color=#646464>#   doclb - if 'yes', means &quot;put the color into the clipboard&quot;</font></i>
  <i><font color=#646464># Returns 'yes' if the color was chosen.</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>set</font></b> res no
  <b><font color=#923B23>if</font></b> {[IsCapture]} {
    <b><font color=#923B23>if</font></b> {<font color=#4A181B>$data(COLOR)</font> eq <font color=#035103>&quot;&quot;</font>} {
      Message <font color=#463e11>-title</font> <font color=#035103>&quot;Color of Image&quot;</font> <font color=#463e11>-icon</font> warning  <font color=#463e11>-message</font> [msgcat::mc <font color=#035103>&quot;Click the magnified image\nto get a pixel's color.\n\nThen hit this button.&quot;</font>]
    } <b><font color=#923B23>else</font></b> {
      <b><font color=#923B23>if</font></b> {<font color=#4A181B>$doclb</font> && <font color=#4A181B>$data(<font color=#463e11></font>-commandname</font>) eq <font color=#035103>&quot;&quot;</font>} {
        <b><font color=#7A040E>clipboard</font></b> clear
        <b><font color=#7A040E>clipboard</font></b> append <font color=#463e11>-type</font> STRING <font color=#4A181B>$data(COLOR)</font>
      }
      StyleButton2 yes <font color=#463e11>-background</font> <font color=#4A181B>$data(COLOR)</font> <font color=#463e11>-foreground</font> <font color=#4A181B>$data(INVCOLOR)</font>  <font color=#463e11>-text</font> <font color=#4A181B>$data(COLOR)</font>
      <b><font color=#923B23>set</font></b> res yes
    }
  }
  <b><font color=#A106A1>return</font></b> <font color=#4A181B>$res</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::InitGeometry'>InitGeometry</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets and sets the geometry of the loupe window, based on the image label's sizes and the zoom factor.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>InitGeometry</span> <span class='ruff_arg'>?geom?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>geom</code></code></td><td class='ruff_defitem'>the predefined geometry; <i>optional, default</i> <code>&quot;&quot;</code></td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_12' href="javascript:toggleSource('12')">Show source</a></p>
<div id='12' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::InitGeometry {{geom {}}} {

  <i><font color=#646464># Gets and sets the geometry of the loupe window,</font></i>
  <i><font color=#646464># based on the image label's sizes and the zoom factor.</font></i>
  <i><font color=#646464>#   geom - the predefined geometry</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>if</font></b> {<font color=#4A181B>$geom</font> eq <font color=#035103>&quot;&quot;</font>} {
    <b><font color=#923B23>set</font></b> sz [<b><font color=#923B23>expr</font></b> {2*<font color=#4A181B>$data(<font color=#463e11></font>-size</font>)}]
    <b><font color=#923B23>lassign</font></b> [<b><font color=#7A040E>winfo</font></b> pointerxy .] x y
    <b><font color=#923B23>set</font></b> x [<b><font color=#923B23>expr</font></b> {<font color=#4A181B>$x</font>-<font color=#4A181B>$sz</font>/2}]
    <b><font color=#923B23>set</font></b> y [<b><font color=#923B23>expr</font></b> {<font color=#4A181B>$y</font>-<font color=#4A181B>$sz</font>/2}]
    <b><font color=#923B23>set</font></b> geom <font color=#4A181B>${sz}</font>x<font color=#4A181B>${sz}</font>+<font color=#4A181B>$x</font>+<font color=#4A181B>$y</font>
  }
  <b><font color=#7A040E>wm</font></b> geometry <font color=#4A181B>$data(WLOUP)</font> <font color=#4A181B>$geom</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::InvertBg'>InvertBg</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Inverts colors from light to dark and vice versa to get &quot;fg&quot; from &quot;bg&quot;. It's simplified way, just to not include the bulky HSV code.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>InvertBg</span> <span class='ruff_arg'>r g b</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>r</code></code></td><td class='ruff_defitem'>red component</td></tr>
<tr><td class='ruff_defitem'><code><code>g</code></code></td><td class='ruff_defitem'>green component</td></tr>
<tr><td class='ruff_defitem'><code><code>b</code></code></td><td class='ruff_defitem'>blue component</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns {R G B} list of inverted colors.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_13' href="javascript:toggleSource('13')">Show source</a></p>
<div id='13' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::InvertBg {r g b} {

  <i><font color=#646464># Inverts colors from light to dark and vice versa to get &quot;fg&quot; from &quot;bg&quot;.</font></i>
  <i><font color=#646464># It's simplified way, just to not include the bulky HSV code.</font></i>
  <i><font color=#646464>#  r - red component</font></i>
  <i><font color=#646464>#  g - green component</font></i>
  <i><font color=#646464>#  b - blue component</font></i>
  <i><font color=#646464># Returns {R G B} list of inverted colors.</font></i>

  <b><font color=#923B23>set</font></b> c [<b><font color=#923B23>expr</font></b> {<font color=#4A181B>$r</font>&lt;100 && <font color=#4A181B>$g</font>&lt;100 || <font color=#4A181B>$r</font>&lt;100 && <font color=#4A181B>$b</font>&lt;100 || <font color=#4A181B>$b</font>&lt;100 && <font color=#4A181B>$g</font>&lt;100 ||
    (<font color=#4A181B>$r</font>+<font color=#4A181B>$g</font>+<font color=#4A181B>$b)</font>&lt;300 ? 255 : 0}]
  <b><font color=#A106A1>return</font></b> [<b><font color=#923B23>list</font></b> <font color=#4A181B>$c</font> <font color=#4A181B>$c</font> <font color=#4A181B>$c</font>]
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::IsCapture'>IsCapture</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Checks if the image was captured.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>IsCapture</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_14' href="javascript:toggleSource('14')">Show source</a></p>
<div id='14' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::IsCapture {} {

  <i><font color=#646464># Checks if the image was captured.</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>if</font></b> {<font color=#4A181B>$data(CAPTURE)</font> eq <font color=#035103>&quot;&quot;</font>} {
    Message <font color=#463e11>-title</font> <font color=#035103>&quot;Color of Image&quot;</font> <font color=#463e11>-icon</font> warning  <font color=#463e11>-message</font>  [msgcat::mc <font color=#035103>&quot;Click, then drag and drop\nthe loupe to get the image.&quot;</font>]
    <b><font color=#A106A1>return</font></b> no
  }
  <b><font color=#A106A1>return</font></b> yes
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::Message'>Message</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Displays a message, with the loupe hidden.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Message</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>args</code></code></td><td class='ruff_defitem'>Optional arguments.</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_15' href="javascript:toggleSource('15')">Show source</a></p>
<div id='15' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::Message {args} {

  <i><font color=#646464># Displays a message, with the loupe hidden.</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#7A040E>wm</font></b> withdraw <font color=#4A181B>$data(WLOUP)</font>
  <b><font color=#7A040E>tk_messageBox</font></b> <font color=#463e11>-parent</font> <font color=#4A181B>$data(WDISP)</font> <font color=#463e11>-type</font> ok {*}<font color=#4A181B>$args</font>
  <b><font color=#7A040E>wm</font></b> deiconify <font color=#4A181B>$data(WLOUP)</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::PickColor'>PickColor</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets the image color under the mouse pointer.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>PickColor</span> <span class='ruff_arg'>w X Y</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>w</code></code></td><td class='ruff_defitem'>the image label's path</td></tr>
<tr><td class='ruff_defitem'><code><code>X</code></code></td><td class='ruff_defitem'>X-coordinate of the mouse pointer</td></tr>
<tr><td class='ruff_defitem'><code><code>Y</code></code></td><td class='ruff_defitem'>Y-coordinate of the mouse pointer</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_16' href="javascript:toggleSource('16')">Show source</a></p>
<div id='16' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::PickColor {w X Y} {

  <i><font color=#646464># Gets the image color under the mouse pointer.</font></i>
  <i><font color=#646464>#   w - the image label's path</font></i>
  <i><font color=#646464>#   X - X-coordinate of the mouse pointer</font></i>
  <i><font color=#646464>#   Y - Y-coordinate of the mouse pointer</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>if</font></b> {![IsCapture]} <b><font color=#A106A1>return</font></b>
  <b><font color=#923B23>set</font></b> x [<b><font color=#923B23>expr</font></b> {max((<font color=#4A181B>$X</font> - [<b><font color=#7A040E>winfo</font></b> rootx <font color=#4A181B>$w</font>] -4),0)}]
  <b><font color=#923B23>set</font></b> y [<b><font color=#923B23>expr</font></b> {max((<font color=#4A181B>$Y</font> - [<b><font color=#7A040E>winfo</font></b> rooty <font color=#4A181B>$w</font>] -4),0)}]
  <b><font color=#923B23>catch</font></b> {
    <b><font color=#923B23>lassign</font></b> [<font color=#4A181B>$data(IMAGE)</font> get <font color=#4A181B>$x</font> <font color=#4A181B>$y</font>] r g b
    <b><font color=#923B23>set</font></b> data(COLOR) [<b><font color=#923B23>format</font></b> <font color=#035103>&quot;#%02x%02x%02x&quot;</font> <font color=#4A181B>$r</font> <font color=#4A181B>$g</font> <font color=#4A181B>$b</font>]
    <b><font color=#923B23>set</font></b> data(INVCOLOR) [<b><font color=#923B23>format</font></b> <font color=#035103>&quot;#%02x%02x%02x&quot;</font> {*}[InvertBg <font color=#4A181B>$r</font> <font color=#4A181B>$g</font> <font color=#4A181B>$b</font>]]
    HandleColor no
    <b><font color=#923B23>set</font></b> msec [<b><font color=#923B23>clock</font></b> milliseconds]
    <b><font color=#923B23>if</font></b> {[<b><font color=#923B23>info</font></b> exists data(MSEC)] && [<b><font color=#923B23>expr</font></b> {(<font color=#4A181B>$msec</font>-<font color=#4A181B>$data(MSEC))</font>&lt;400}]} {
      Button2Click
    }
    <b><font color=#923B23>set</font></b> data(MSEC) <font color=#4A181B>$msec</font>
  }
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::RestoreOptions'>RestoreOptions</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Restores options of appearance from a file.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>RestoreOptions</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_17' href="javascript:toggleSource('17')">Show source</a></p>
<div id='17' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::RestoreOptions {} {

  <i><font color=#646464># Restores options of appearance from a file.</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>if</font></b> {!<font color=#4A181B>$data(<font color=#463e11></font>-save</font>)} <b><font color=#A106A1>return</font></b>
  <b><font color=#923B23>if</font></b> {![<b><font color=#923B23>file</font></b> exists <font color=#4A181B>$data(<font color=#463e11></font>-inifile</font>)]} <b><font color=#A106A1>return</font></b>
  <b><font color=#923B23>set</font></b> chan [<b><font color=#923B23>open</font></b> <font color=#4A181B>$data(<font color=#463e11></font>-inifile</font>)]
  <b><font color=#923B23>set</font></b> data(CONFIG) [<b><font color=#923B23>read</font></b> <font color=#4A181B>$chan</font>]
  <b><font color=#923B23>close</font></b> <font color=#4A181B>$chan</font>
  <b><font color=#923B23>set</font></b> svd <font color=#4A181B>$data(DEFAULTS)</font>
  <b><font color=#923B23>foreach</font></b> line [<b><font color=#923B23>split</font></b> <font color=#4A181B>$data(CONFIG)</font> \n] {
    <b><font color=#923B23>if</font></b> {[<b><font color=#923B23>string</font></b> match <font color=#035103>&quot;*=*&quot;</font> <font color=#4A181B>$line</font>]} {
      <b><font color=#923B23>set</font></b> opt -[<b><font color=#923B23>string</font></b> range <font color=#4A181B>$line</font> 0 [<b><font color=#923B23>string</font></b> first = <font color=#4A181B>$line</font>]-1]
      <b><font color=#923B23>set</font></b> val [<b><font color=#923B23>string</font></b> range <font color=#4A181B>$line</font> [<b><font color=#923B23>string</font></b> length <font color=#4A181B>$opt</font>] end]
      <b><font color=#923B23>set</font></b> <font color=#4A181B>${svd}</font>(<font color=#4A181B>$opt)</font> [<b><font color=#923B23>set</font></b> data(<font color=#4A181B>$opt)</font> <font color=#4A181B>$val</font>]
    }
  }
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::Save'>Save</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Saves the magnified image to a file.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Save</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_18' href="javascript:toggleSource('18')">Show source</a></p>
<div id='18' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::Save {} {

  <i><font color=#646464># Saves the magnified image to a file.</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>if</font></b> {![IsCapture]} <b><font color=#A106A1>return</font></b>
  <b><font color=#7A040E>wm</font></b> withdraw <font color=#4A181B>$data(WLOUP)</font>
  <b><font color=#923B23>set</font></b> filetypes { {<font color=#035103>&quot;PNG Images&quot;</font> .png} {<font color=#035103>&quot;All Image Files&quot;</font> {.png .gif}} }
  <b><font color=#923B23>catch</font></b> {::apave::obj themeExternal <font color=#035103>&quot;<font color=#4A181B>$</font>data(WLOUP)*&quot;</font>}  ;<i><font color=#646464># theme the file chooser</font></i>
  <b><font color=#923B23>set</font></b> file [<b><font color=#7A040E>tk_getSaveFile</font></b> <font color=#463e11>-parent</font> <font color=#4A181B>$data(WDISP)</font>  <font color=#463e11>-title</font> [::msgcat::mc <font color=#035103>&quot;Save the Loupe&quot;</font>] <font color=#463e11>-filetypes</font> <font color=#4A181B>$filetypes</font>]
  <b><font color=#923B23>if</font></b> {<font color=#4A181B>$file</font> ne <font color=#035103>&quot;&quot;</font>} {
    <b><font color=#923B23>if</font></b> {![<b><font color=#923B23>regexp</font></b> <font color=#463e11>-nocase</font> {\.(png|gif)$} <font color=#4A181B>$file</font> -&gt; ext]} {
      <b><font color=#923B23>set</font></b> ext <font color=#035103>&quot;png&quot;</font>
      <b><font color=#923B23>append</font></b> file <font color=#035103>&quot;.<font color=#4A181B>${</font>ext<font color=#4A181B>}</font>&quot;</font>
    }
    <b><font color=#923B23>if</font></b> {[<b><font color=#923B23>catch</font></b> {<font color=#4A181B>$data(IMAGE)</font> write <font color=#4A181B>$file</font> <font color=#463e11>-format</font> [<b><font color=#923B23>string</font></b> tolower <font color=#4A181B>$ext</font>]} err]} {
      Message <font color=#463e11>-title</font> <font color=#035103>&quot;Error Writing File&quot;</font> <font color=#463e11>-icon</font> error  <font color=#463e11>-message</font> <font color=#035103>&quot;Error writing to file \&quot;<font color=#4A181B>$</font>file\&quot;:\n<font color=#4A181B>$</font>err&quot;</font>
    }
  }
  <b><font color=#7A040E>wm</font></b> deiconify <font color=#4A181B>$data(WLOUP)</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::SaveGeometry'>SaveGeometry</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Saves the displaying window's geometry.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>SaveGeometry</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_19' href="javascript:toggleSource('19')">Show source</a></p>
<div id='19' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::SaveGeometry {} {

  <i><font color=#646464># Saves the displaying window's geometry.</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>set</font></b> data(<font color=#463e11>-geometry</font>) <font color=#035103>&quot;&quot;</font>
  <b><font color=#923B23>catch</font></b> {<b><font color=#923B23>set</font></b> data(<font color=#463e11>-geometry</font>) [<b><font color=#7A040E>wm</font></b> geometry <font color=#4A181B>$data(WDISP)</font>]}
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::SaveOptions'>SaveOptions</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Saves options of appearance to a file.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>SaveOptions</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_20' href="javascript:toggleSource('20')">Show source</a></p>
<div id='20' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::SaveOptions {} {

  <i><font color=#646464># Saves options of appearance to a file.</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>if</font></b> {!<font color=#4A181B>$data(<font color=#463e11></font>-save</font>)} <b><font color=#A106A1>return</font></b>
  <b><font color=#923B23>set</font></b> w <font color=#4A181B>$data(WDISP)</font>
  <b><font color=#923B23>catch</font></b> {<b><font color=#923B23>file</font></b> mkdir [<b><font color=#923B23>file</font></b> dirinfo <font color=#4A181B>$data(<font color=#463e11></font>-inifile</font>)]}
  <b><font color=#923B23>catch</font></b> {
    <b><font color=#923B23>if</font></b> {[<b><font color=#923B23>info</font></b> exists data(CONFIG)]} {<b><font color=#923B23>set</font></b> old <font color=#4A181B>$data(CONFIG)</font>} {<b><font color=#923B23>set</font></b> old <font color=#035103>&quot;&quot;</font>}
    <b><font color=#923B23>append</font></b> new {[<b><font color=#7A040E>options</font></b>]} \n
    <b><font color=#923B23>foreach</font></b> opt [<b><font color=#923B23>array</font></b> names data] {
      <b><font color=#923B23>if</font></b> {<font color=#4A181B>$opt</font> in {<font color=#463e11>-size</font> <font color=#463e11>-geometry</font> <font color=#463e11>-background</font> <font color=#463e11>-zoom</font> <font color=#463e11>-alpha</font> <font color=#463e11>-ontop</font>}} {
        <b><font color=#923B23>if</font></b> {<font color=#4A181B>$opt</font> eq <font color=#035103>&quot;-geometry&quot;</font>} {
          <b><font color=#923B23>set</font></b> val [<b><font color=#7A040E>wm</font></b> geometry <font color=#4A181B>$w</font>]
        } <b><font color=#923B23>else</font></b> {
          <b><font color=#923B23>set</font></b> val <font color=#4A181B>$data(</font>$opt)
        }
        <b><font color=#923B23>append</font></b> new <font color=#035103>&quot;<font color=#4A181B>[</font>string range <font color=#4A181B>$</font>opt 1 end<font color=#4A181B>]</font>=<font color=#4A181B>$</font>val&quot;</font> \n
      }
    }
    <b><font color=#923B23>if</font></b> {<font color=#4A181B>$old</font> ne <font color=#4A181B>$new</font>} {  ;<i><font color=#646464># update config, if necessary</font></i>
      <b><font color=#923B23>set</font></b> chan [<b><font color=#923B23>open</font></b> <font color=#4A181B>$data(<font color=#463e11></font>-inifile</font>) w]
      <b><font color=#923B23>puts</font></b> <font color=#463e11>-nonewline</font> <font color=#4A181B>$chan</font> <font color=#4A181B>$new</font>
      <b><font color=#923B23>close</font></b> <font color=#4A181B>$chan</font>
    }
  }
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::SetStyle'>SetStyle</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Sets a style for of widgets with a type.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>SetStyle</span> <span class='ruff_arg'>type domap ?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>type</code></code></td><td class='ruff_defitem'>Not documented.</td></tr>
<tr><td class='ruff_defitem'><code><code>domap</code></code></td><td class='ruff_defitem'>yes, if set the map options</td></tr>
<tr><td class='ruff_defitem'><code><code>args</code></code></td><td class='ruff_defitem'>configuration options</td></tr>
<tr><td class='ruff_defitem'><code><code>'type</code></code></td><td class='ruff_defitem'>the type of widgets</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns a list of old type's configuration and new type's name.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_21' href="javascript:toggleSource('21')">Show source</a></p>
<div id='21' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::SetStyle {type domap args} {

  <i><font color=#646464># Sets a style for of widgets with a type.</font></i>
  <i><font color=#646464>#   'type - the type of widgets</font></i>
  <i><font color=#646464>#   domap - yes, if set the map options</font></i>
  <i><font color=#646464>#   args - configuration options</font></i>
  <i><font color=#646464># Returns a list of old type's configuration and new type's name.</font></i>

  <b><font color=#923B23>set</font></b> config [<b><font color=#7A040E>ttk::style</font></b> configure TButton]
  <b><font color=#923B23>set</font></b> new <font color=#4A181B>${type}</font>_A_LOUPE
  <b><font color=#7A040E>ttk::style</font></b> configure <font color=#4A181B>$new</font> {*}<font color=#4A181B>$config</font>
  <b><font color=#7A040E>ttk::style</font></b> configure <font color=#4A181B>$new</font> {*}<font color=#4A181B>$args</font>
  <b><font color=#923B23>if</font></b> {<font color=#4A181B>$domap</font>} {
    <b><font color=#7A040E>ttk::style</font></b> map <font color=#4A181B>$new</font> {*}[<b><font color=#7A040E>ttk::style</font></b> map <font color=#4A181B>$type</font>]
    <b><font color=#923B23>set</font></b> fg [<b><font color=#923B23>dict</font></b> get <font color=#4A181B>$args</font> <font color=#463e11>-foreground</font>]
    <b><font color=#923B23>set</font></b> bg [<b><font color=#923B23>dict</font></b> get <font color=#4A181B>$args</font> <font color=#463e11>-background</font>]
    <b><font color=#7A040E>ttk::style</font></b> map <font color=#4A181B>$new</font> <font color=#463e11>-foreground</font> [<b><font color=#923B23>list</font></b> pressed <font color=#4A181B>$fg</font> active <font color=#4A181B>$fg</font> alternate <font color=#4A181B>$fg</font> focus <font color=#4A181B>$fg</font> selected <font color=#4A181B>$fg</font>]
    <b><font color=#7A040E>ttk::style</font></b> map <font color=#4A181B>$new</font> <font color=#463e11>-background</font> [<b><font color=#923B23>list</font></b> pressed <font color=#4A181B>$bg</font> active <font color=#4A181B>$bg</font> alternate <font color=#4A181B>$bg</font> focus <font color=#4A181B>$bg</font> selected <font color=#4A181B>$bg</font>]
  } <b><font color=#923B23>else</font></b> {
    <b><font color=#7A040E>ttk::style</font></b> map <font color=#4A181B>$new</font> <font color=#463e11>-foreground</font> [<b><font color=#923B23>list</font></b>]
    <b><font color=#7A040E>ttk::style</font></b> map <font color=#4A181B>$new</font> <font color=#463e11>-background</font> [<b><font color=#923B23>list</font></b>]
    <b><font color=#7A040E>ttk::style</font></b> map <font color=#4A181B>$new</font> {*}[<b><font color=#7A040E>ttk::style</font></b> map <font color=#4A181B>$type</font>]
  }
  <b><font color=#7A040E>ttk::style</font></b> layout <font color=#4A181B>$new</font> [<b><font color=#7A040E>ttk::style</font></b> layout <font color=#4A181B>$type</font>]
  <b><font color=#A106A1>return</font></b> [<b><font color=#923B23>list</font></b> <font color=#4A181B>$config</font> <font color=#4A181B>$new</font>]
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::SizeLoupe'>SizeLoupe</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Re-displays the loupe at changing its size.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>SizeLoupe</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_22' href="javascript:toggleSource('22')">Show source</a></p>
<div id='22' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::SizeLoupe {} {

  <i><font color=#646464># Re-displays the loupe at changing its size.</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>variable</font></b> size
  <b><font color=#923B23>set</font></b> data(<font color=#463e11>-size</font>) <font color=#4A181B>$size</font>
  <b><font color=#923B23>lassign</font></b> [<b><font color=#923B23>split</font></b> [<b><font color=#7A040E>wm</font></b> geometry <font color=#4A181B>$data(WLOUP)</font>] +] -&gt; x y
  <b><font color=#923B23>set</font></b> sz [<b><font color=#923B23>expr</font></b> {2*<font color=#4A181B>$size</font>}]
  <b><font color=#7A040E>destroy</font></b> <font color=#4A181B>$data(WLOUP)</font>
  CreateLoupe <font color=#4A181B>${sz}</font>x<font color=#4A181B>${sz}</font>+<font color=#4A181B>$x</font>+<font color=#4A181B>$y</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::StyleButton2'>StyleButton2</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Makes a style for Tbutton.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>StyleButton2</span> <span class='ruff_arg'>domap ?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>domap</code></code></td><td class='ruff_defitem'>yes, if set the map options</td></tr>
<tr><td class='ruff_defitem'><code><code>args</code></code></td><td class='ruff_defitem'>options (&quot;name value&quot; pairs)</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns the TButton's configuration options.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_23' href="javascript:toggleSource('23')">Show source</a></p>
<div id='23' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::StyleButton2 {domap args} {

  <i><font color=#646464># Makes a style for Tbutton.</font></i>
   <i><font color=#646464>#  domap - yes, if set the map options</font></i>
  <i><font color=#646464>#   args - options (&quot;name value&quot; pairs)</font></i>
  <i><font color=#646464># Returns the TButton's configuration options.</font></i>

  <b><font color=#923B23>variable</font></b> data
  <b><font color=#923B23>if</font></b> {[<b><font color=#923B23>dict</font></b> exists <font color=#4A181B>$args</font> <font color=#463e11>-text</font>]} {
    <font color=#4A181B>$data(BUT2)</font> configure <font color=#463e11>-text</font> [<b><font color=#923B23>dict</font></b> get <font color=#4A181B>$args</font> <font color=#463e11>-text</font>]
    <b><font color=#923B23>set</font></b> args [<b><font color=#923B23>dict</font></b> remove <font color=#4A181B>$args</font> <font color=#463e11>-text</font>]
  }
  <b><font color=#923B23>lassign</font></b> [SetStyle TButton <font color=#4A181B>$domap</font> {*}<font color=#4A181B>$args</font>] config style
  <font color=#4A181B>$data(BUT2)</font> configure <font color=#463e11>-style</font> <font color=#4A181B>$style</font>
  <b><font color=#A106A1>return</font></b> <font color=#4A181B>$config</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::Synopsis'>Synopsis</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Short info about usage.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Synopsis</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_24' href="javascript:toggleSource('24')">Show source</a></p>
<div id='24' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#A106A1>proc</font></b> ::aloupe::my::Synopsis {} {

    <i><font color=#646464># Short info about usage.</font></i>

    <b><font color=#923B23>variable</font></b> data
    <b><font color=#923B23>puts</font></b> <font color=#035103>&quot;</font>
<font color=#035103>  Syntax:</font>
<font color=#035103>    tclsh aloupe.tcl ?option value ...?</font>
<font color=#035103>  where 'option' may be <font color=#4A181B>[</font>array names <font color=#4A181B>$</font>data(DEFAULTS)<font color=#4A181B>]</font>.</font>
<font color=#035103>  &quot;</font>
    <b><font color=#923B23>exit</font></b>
}<br><br></code></pre></div>
</div></div></div><div class='yui-b navbox' ><h1><a href='#::aloupe'>aloupe</a></h1><h2><a href='#::aloupe-Usage'>Usage</a></h2><h2><a href='#::aloupe-Options'>Options</a></h2><h2><a href='#::aloupe-Links'>Links</a></h2><h2><a href='#::aloupe-License'>License</a></h2><h2><a href='#::aloupe-Commands'>Commands</a></h2><h4 class='tooltip'><a href='aloupe.html#::aloupe::option'>option</a><span class='tooltiptext'>Returns a value of aloupe option.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::run'>run</a><span class='tooltiptext'>Runs the loupe.
</span></h4><h1><a href='#::aloupe::my'>aloupe::my</a></h1><h2><a href='#::aloupe::my-Commands'>Commands</a></h2><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::Button2Click'>Button2Click</a><span class='tooltiptext'>Processes the click on 'Clipboard' button.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::Create'>Create</a><span class='tooltiptext'>Initializes and creates the utility's windows.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::CreateDisplay'>CreateDisplay</a><span class='tooltiptext'>Creates the displaying window.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::CreateLoupe'>CreateLoupe</a><span class='tooltiptext'>Creates the loupe window.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::Drag'>Drag</a><span class='tooltiptext'>Performs the frag-and-drop of the loupe.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::DragEnd'>DragEnd</a><span class='tooltiptext'>Ends the frag-and-drop of the loupe and displays its magnified image.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::DragStart'>DragStart</a><span class='tooltiptext'>Initializes the frag-and-drop of the loupe.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::Exit'>Exit</a><span class='tooltiptext'>Clears all and exits.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::HandleColor'>HandleColor</a><span class='tooltiptext'>Processes the image color under the mouse pointer, optionally saving it to the clipboard.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::InitGeometry'>InitGeometry</a><span class='tooltiptext'>Gets and sets the geometry of the loupe window, based on the image label's sizes and the zoom factor.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::InvertBg'>InvertBg</a><span class='tooltiptext'>Inverts colors from light to dark and vice versa to get &quot;fg&quot; from &quot;bg&quot;. It's simplified way, just to not include the bulky HSV code.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::IsCapture'>IsCapture</a><span class='tooltiptext'>Checks if the image was captured.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::Message'>Message</a><span class='tooltiptext'>Displays a message, with the loupe hidden.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::PickColor'>PickColor</a><span class='tooltiptext'>Gets the image color under the mouse pointer.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::RestoreOptions'>RestoreOptions</a><span class='tooltiptext'>Restores options of appearance from a file.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::Save'>Save</a><span class='tooltiptext'>Saves the magnified image to a file.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::SaveGeometry'>SaveGeometry</a><span class='tooltiptext'>Saves the displaying window's geometry.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::SaveOptions'>SaveOptions</a><span class='tooltiptext'>Saves options of appearance to a file.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::SetStyle'>SetStyle</a><span class='tooltiptext'>Sets a style for of widgets with a type.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::SizeLoupe'>SizeLoupe</a><span class='tooltiptext'>Re-displays the loupe at changing its size.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::StyleButton2'>StyleButton2</a><span class='tooltiptext'>Makes a style for Tbutton.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::Synopsis'>Synopsis</a><span class='tooltiptext'>Short info about usage.
</span></h4></div></div><div id='ft'><div style='float: right;'>Document generated by <a href='https://ruff.magicsplat.com'>Ruff!</a></div></div>
</div></body></html>
