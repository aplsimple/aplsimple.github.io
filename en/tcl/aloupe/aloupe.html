<!DOCTYPE html><html><head><meta charset="utf-8"/>
<link rel="stylesheet" href="../../../zoo/sh/styles/aplsimple.css">
<title>::aloupe reference</title>
<style>
/*
Copyright (c) 2009, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.net/yui/license.txt
version: 2.7.0
*/
html{color:#000;background:#FFF;}body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,code,form,fieldset,legend,input,button,textarea,p,blockquote,th,td{margin:0;padding:0;}table{border-collapse:collapse;border-spacing:0;}fieldset,img{border:0;}address,caption,cite,code,dfn,em,strong,th,var,optgroup{font-style:inherit;font-weight:inherit;}del,ins{text-decoration:none;}li{list-style:none;}caption,th{text-align:left;}h1,h2,h3,h4,h5,h6{font-size:100%;font-weight:normal;}q:before,q:after{content:'';}abbr,acronym{border:0;font-variant:normal;}sup{vertical-align:baseline;}sub{vertical-align:baseline;}legend{color:#000;}input,button,textarea,select,optgroup,option{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;}input,button,textarea,select{*font-size:100%;}body{font:13px/1.231 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small;}select,input,button,textarea,button{font:99% arial,helvetica,clean,sans-serif;}table{font-size:inherit;font:100%;}pre,code,kbd,samp,tt{font-family:Consolas,"Courier New",monospace;font-size:100%;line-height:100%;}body{text-align:center;}#doc,#doc2,#doc3,#doc4,.yui-t1,.yui-t2,.yui-t3,.yui-t4,.yui-t5,.yui-t6,.yui-t7{margin:auto;text-align:left;width:57.69em;*width:56.25em;}#doc2{width:73.076em;*width:71.25em;}#doc3{margin:auto;width:auto;}#doc4{width:74.923em;*width:73.05em;}.yui-b{position:relative;}.yui-b{_position:static;}#yui-main .yui-b{position:static;}#yui-main,.yui-g .yui-u .yui-g{width:100%;}.yui-t1 #yui-main,.yui-t2 #yui-main,.yui-t3 #yui-main{float:right;margin-left:-25em;}.yui-t4 #yui-main,.yui-t5 #yui-main,.yui-t6 #yui-main{float:left;margin-right:-25em;}.yui-t1 .yui-b{float:left;width:12.30769em;*width:12.00em;}.yui-t1 #yui-main .yui-b{margin-left:13.30769em;*margin-left:13.05em;}.yui-t2 .yui-b{float:left;width:9.8461em;*width:13.50em;}.yui-t2 #yui-main .yui-b{margin-left:10.8461em;*margin-left:14.55em;}.yui-t3 .yui-b{float:left;width:23.0769em;*width:22.50em;}.yui-t3 #yui-main .yui-b{margin-left:24.0769em;*margin-left:23.62em;}.yui-t4 .yui-b{float:right;width:13.8456em;*width:13.50em;}.yui-t4 #yui-main .yui-b{margin-right:14.8456em;*margin-right:14.55em;}.yui-t5 .yui-b{float:right;width:18.4615em;*width:18.00em;}.yui-t5 #yui-main .yui-b{margin-right:19.4615em;*margin-right:19.125em;}.yui-t6 .yui-b{float:right;width:23.0769em;*width:22.50em;}.yui-t6 #yui-main .yui-b{margin-right:24.0769em;*margin-right:23.62em;}.yui-t7 #yui-main .yui-b{display:block;margin:0 0 1em 0;}#yui-main .yui-b{float:none;width:auto;}.yui-gb .yui-u,.yui-g .yui-gb .yui-u,.yui-gb .yui-g,.yui-gb .yui-gb,.yui-gb .yui-gc,.yui-gb .yui-gd,.yui-gb .yui-ge,.yui-gb .yui-gf,.yui-gc .yui-u,.yui-gc .yui-g,.yui-gd .yui-u{float:left;}.yui-g .yui-u,.yui-g .yui-g,.yui-g .yui-gb,.yui-g .yui-gc,.yui-g .yui-gd,.yui-g .yui-ge,.yui-g .yui-gf,.yui-gc .yui-u,.yui-gd .yui-g,.yui-g .yui-gc .yui-u,.yui-ge .yui-u,.yui-ge .yui-g,.yui-gf .yui-g,.yui-gf .yui-u{float:right;}.yui-g div.first,.yui-gb div.first,.yui-gc div.first,.yui-gd div.first,.yui-ge div.first,.yui-gf div.first,.yui-g .yui-gc div.first,.yui-g .yui-ge div.first,.yui-gc div.first div.first{float:left;}.yui-g .yui-u,.yui-g .yui-g,.yui-g .yui-gb,.yui-g .yui-gc,.yui-g .yui-gd,.yui-g .yui-ge,.yui-g .yui-gf{width:49.1%;}.yui-gb .yui-u,.yui-g .yui-gb .yui-u,.yui-gb .yui-g,.yui-gb .yui-gb,.yui-gb .yui-gc,.yui-gb .yui-gd,.yui-gb .yui-ge,.yui-gb .yui-gf,.yui-gc .yui-u,.yui-gc .yui-g,.yui-gd .yui-u{width:32%;margin-left:1.99%;}.yui-gb .yui-u{*margin-left:1.9%;*width:31.9%;}.yui-gc div.first,.yui-gd .yui-u{width:66%;}.yui-gd div.first{width:32%;}.yui-ge div.first,.yui-gf .yui-u{width:74.2%;}.yui-ge .yui-u,.yui-gf div.first{width:24%;}.yui-g .yui-gb div.first,.yui-gb div.first,.yui-gc div.first,.yui-gd div.first{margin-left:0;}.yui-g .yui-g .yui-u,.yui-gb .yui-g .yui-u,.yui-gc .yui-g .yui-u,.yui-gd .yui-g .yui-u,.yui-ge .yui-g .yui-u,.yui-gf .yui-g .yui-u{width:49%;*width:48.1%;*margin-left:0;}.yui-g .yui-g .yui-u{width:48.1%;}.yui-g .yui-gb div.first,.yui-gb .yui-gb div.first{*margin-right:0;*width:32%;_width:31.7%;}.yui-g .yui-gc div.first,.yui-gd .yui-g{width:66%;}.yui-gb .yui-g div.first{*margin-right:4%;_margin-right:1.3%;}.yui-gb .yui-gc div.first,.yui-gb .yui-gd div.first{*margin-right:0;}.yui-gb .yui-gb .yui-u,.yui-gb .yui-gc .yui-u{*margin-left:1.8%;_margin-left:4%;}.yui-g .yui-gb .yui-u{_margin-left:1.0%;}.yui-gb .yui-gd .yui-u{*width:66%;_width:61.2%;}.yui-gb .yui-gd div.first{*width:31%;_width:29.5%;}.yui-g .yui-gc .yui-u,.yui-gb .yui-gc .yui-u{width:32%;_float:right;margin-right:0;_margin-left:0;}.yui-gb .yui-gc div.first{width:66%;*float:left;*margin-left:0;}.yui-gb .yui-ge .yui-u,.yui-gb .yui-gf .yui-u{margin:0;}.yui-gb .yui-gb .yui-u{_margin-left:.7%;}.yui-gb .yui-g div.first,.yui-gb .yui-gb div.first{*margin-left:0;}.yui-gc .yui-g .yui-u,.yui-gd .yui-g .yui-u{*width:48.1%;*margin-left:0;}.yui-gb .yui-gd div.first{width:32%;}.yui-g .yui-gd div.first{_width:29.9%;}.yui-ge .yui-g{width:24%;}.yui-gf .yui-g{width:74.2%;}.yui-gb .yui-ge div.yui-u,.yui-gb .yui-gf div.yui-u{float:right;}.yui-gb .yui-ge div.first,.yui-gb .yui-gf div.first{float:left;}.yui-gb .yui-ge .yui-u,.yui-gb .yui-gf div.first{*width:24%;_width:20%;}.yui-gb .yui-ge div.first,.yui-gb .yui-gf .yui-u{*width:73.5%;_width:65.5%;}.yui-ge div.first .yui-gd .yui-u{width:65%;}.yui-ge div.first .yui-gd div.first{width:32%;}#hd:after,#bd:after,#ft:after,.yui-g:after,.yui-gb:after,.yui-gc:after,.yui-gd:after,.yui-ge:after,.yui-gf:after{content:".";display:block;height:0;clear:both;visibility:hidden;}#hd,#bd,#ft,.yui-g,.yui-gb,.yui-gc,.yui-gd,.yui-ge,.yui-gf{zoom:0;}

body{margin:10px;}h1{font-size:138.5%;}h2{font-size:123.1%;}h3{font-size:108%;}h1,h2,h3{margin:1em 0;}h1,h2,h3,h4,h5,h6,strong,dt{font-weight:bold;}optgroup{font-weight:normal;}abbr,acronym{border-bottom:1px dotted #000;cursor:help;}em{font-style:italic;}del{text-decoration:line-through;}blockquote,ul,ol,dl{margin:1em;}ol,ul,dl{margin-left:2em;}ol li{list-style:decimal outside;}ul li{list-style:disc outside;}dl dd{margin-left:1em;}th,td{border:1px solid #000;padding:.5em;}th{font-weight:bold;text-align:center;}caption{margin-bottom:.5em;text-align:center;}sup{vertical-align:super;}sub{vertical-align:sub;}p,fieldset,table,pre{margin-bottom:1em;}button,input[type="checkbox"],input[type="radio"],input[type="reset"],input[type="submit"]{padding:1px;}

/* Ruff default CSS */

body {
  /*max-width: 70em;*/
  margin: 0;
}

h1,h2 {
  color: #888888;
  margin-bottom: 0.5em;
  margin-top: 0em;
}

#ft { font-size: x-small; font-family: Arial, sans-serif;
  text-align: left;
  border-top: 1px solid #0B3467;
  color: #888888;
  margin-top: 10px;
}

.banner h2 {
  color: #0B3467;
}

#hd.banner {
 font-family: "Times New Roman", serif;
 font-size: 200%;
 line-height: 64px;
 border-bottom: thin solid #0B3467;
 color: #0B3467;
}

p.linkline {
  text-align: right;
  font-size: smaller;
  /*    margin-top: -1em; */
  margin-bottom: 0;
}

.tinylink {
  font-size: x-small;
  font-variant: normal;
  font-family: Arial, sans-serif;
  float: right;
  padding:2px;
}

h1 .tinylink a {
  color: white;
}

#bd {
font-family: Arial, sans-serif;
/*font-size: 108%;*/
}

div.navbox {
  /* margin-top: 1em; */
  background-color: #0B3467;
  color: white;
  padding: 3px 4px 2px 4px;
  font-family: Arial, sans-serif;
  overflow: hidden;
}

div.navbox:hover {
  overflow: visible;
}

/* Note .navbox header css should be based on $header_levels */
.navbox h1, .navbox h2, .navbox h3, .navbox h4, .navbox h5 {
  font-size: 85%;
  margin: 0px;
  font-weight: normal;
}
.navbox h1 {
  font-weight: bold; /* Override */
}
.navbox h2 {
  padding-left: 1em;
}
.navbox h3 {
  padding-left: 2em;
}
.navbox h4 {
  padding-left: 2.5em;
  font-weight: normal;
}
.navbox h5 {
  padding-left: 3em;
  font-weight: normal;
}
.navbox hr {
  color: white;
  margin-top:0.1em;
  margin-bottom:0.1em;
}

.navbox a:link, .navbox a:visited, .navbox a:hover {
  text-decoration: none;
  color: white;
  background-color: #0B3467;
}

.navbox a:hover {
   font-weight: bold;
}

/* Tooltip text - see https://www.w3schools.com/css/css_tooltip.asp */
.tooltip {
  position: relative;
  /* display: inline-block; */
}

.tooltip .tooltiptext {
  width: 100%;
  font-weight: bold;
  background-color: white;
  color: #0B3467;
  text-align: left;
  border: 1px solid #0B3467;
  /* border-radius: 4px; */
  position: absolute;
  z-index: 1;
  margin-left: 4px;
  padding: 2px 3px;
  visibility: hidden;
}

/* Show the tooltip text when you mouse over the tooltip container */
.tooltip:hover .tooltiptext {
  visibility: visible;
}

span.ns_scope {
  color: #aaaaaa;
}

span.ns_scope a:link, span.ns_scope a:visited {
  text-decoration: none;
  color: #aaaaaa;

}

li {
  margin-top: 0.5em;
}

span.ns_scope a:hover {
  text-decoration: none;
  color: #666666;
}

table {
  margin: 1em;
  margin-top: 0.5em;
  border: thin solid;
  border-collapse: collapse;
  border-color: #808080;
  padding: 4px;
}

td {
  border: thin solid;
  border-color: #808080;
  vertical-align: top;
  font-size: 93%;
  padding: 0.3em;
  padding-top: 0.1em;
}
th {
  border: thin solid;
  border-color: #808080;
  padding: 0.3em;
  padding-top: 0.1em;
  background-color: #CCCCCC;
}

dt, dd {
   font-size: 93%;
}

h1.ruff {
  background-color: #0B3467;
  color: #ffffff;
  padding-left: 0.2em;
  font-family: "Times New Roman", serif;
}
h2.ruff {
  font-variant: small-caps;
  color: #0B3467;
  font-weight: bold;
  font-family: "Times New Roman", serif;
}

h3.ruff, h4.ruff, h5.ruff, h6.ruff {
  color: #0B3467;
}
h5.ruff {
  font-style: italic;
  font-weight: normal;
}
h6.ruff {
  font-weight: normal;
}
h3.ruffclass, h3.ruffproc, h3.ruffmethod,
h4.ruffclass, h4.ruffproc, h4.ruffmethod,
h5.ruffclass, h5.ruffproc, h5.ruffmethod {
  border-bottom: thin solid #0B3467;
  color: #0B3467;
  margin-bottom: 0.2em;
}

pre {
  background-color: #f9f9f9;
  margin-top: 1em;
  margin-left: 1em;
  padding: 5px;
  font-family: Consolas, "Courier New", monospace;
  /* width: max-content; --- to leave footsteps */ overflow: auto;
  line-height: 1.2em;
}

.ruff_dyn_src {
  display: none; /* Displayed via JS */
}

.ruff_synopsis {
  border: thin solid #cccccc;
  background: #f9f9f9;
  font-family: Consolas, "Courier New", monospace;
  padding: 5px;
  margin: 0em 2em 1em;
}
.ruff_const, .ruff_cmd, ruff_defitem {
  font-weight: bold;
  font-family: Consolas, "Courier New", monospace;
}
.ruff_arg {
  font-style: italic;
  font-family: Consolas, "Courier New", monospace;
}

.ruff_source_link {
  font-size: smaller;
}

.ruff_index {
  font-size: small;
  color: grey;
  line-height: 1;
}

.ruff_index ul li {
  list-style-type: none;
}

.ruff_index ul li a {
  text-decoration: none;
}
</style>
<script>function toggleSource( id )
{
  /* Copied from Rails */
  var elem
  var link

  if( document.getElementById )
  {
      elem = document.getElementById( id )
      link = document.getElementById( "l_" + id )
  }
  else if ( document.all )
  {
      elem = eval( "document.all." + id )
      link = eval( "document.all.l_" + id )
  }
  else
      return false;

  if( elem.style.display == "block" )
  {
      elem.style.display = "none"
      link.innerHTML = "Show source"
  }
  else
  {
      elem.style.display = "block"
      link.innerHTML = "Hide source"
  }
}
</script></head>
<meta name="author" content="aplsimple">
<meta name="description" content="aplsimple's home page">
<meta name="keywords" content="aplsimple,home">
<link rel="stylesheet" href="../../../en/zoo/style.css">
<style>
table{
background-color: #f9f9f9;
margin: 0%;
margin-bottom: 2%;
padding: 0%;
box-shadow: none;
filter: none;
}
pre{
margin: 0%;
margin-bottom: 2%;
padding: 0%;
}
</style>
<link rel="icon" type="image/jpg" href="../../../zoo/favicon.jpg">
<body>
<div id="wrapper">
<div name="divd1" ALIGN="CENTER"> <FONT SIZE=5em color=#b01c20><B>
<noscript>THIS PAGE IS NOT WORKING WITHOUT JAVASCRIPT!
<BR>
<BR>PLEASE, SWITCH ON JAVASCRIPT IN SETTINGS OF YOUR BROWSER AND RELOAD THE PAGE.
</noscript>
</B></FONT></div>
<div id='doc3' class='yui-t2'>
<script src="../../../zoo/funcs.js"></script>
<script src="../../../en/zoo/this.js"></script>
<section id=sec2>
<div id='hd' class='banner'>
<a name='aloupe.html'>::aloupe reference</a>
</div>
<div id='bd'><div id='yui-main'><div class='yui-b'><h1 class='ruff'><a name='::aloupe'></a>::aloupe<span class='tinylink'><a href='#top'>Top</a></span></h1>
<div style='clear:both;'></div>
<p class='ruff'>The <em>aloupe</em> is a Tcl/Tk small widget / utility allowing to view the screen through a loupe.</p>
<p class='ruff'>It allows also</p>
<ul class='ruff'>
<li>to make screenshots of magnified images</li>
<li>to pick a color from the images.</li>
</ul>
<p class='ruff'>It is inspired by the Tcl/Tk wiki pages:</p>
<p class='ruff'><a href="https://wiki.tcl-lang.org/page/A+little+magnifying+glass" >A little magnifying glass</a></p>
<p class='ruff'><a href="https://wiki.tcl-lang.org/page/A+Screenshot+Widget+implemented+with+TclOO" >A Screenshot Widget implemented with TclOO</a></p>
<p class='ruff'>It looks like this:</p>
<p class='ruff'><img src="https://aplsimple.github.io/en/tcl/aloupe/files/aloupe.png" class="media" alt=""></p>
<br><h2 class='ruff'><a name='::aloupe-Usage'></a>Usage<span class='tinylink'><a href='aloupe.html#::aloupe'>aloupe</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>The <em>aloupe</em> utility runs with the command:</p>
<pre class='ruff'><br><code class="tcl"> tclsh aloupe.tcl ?option value ...?
<br></code></pre>
<p class='ruff'>where <code>option</code> may be <code>-size, -zoom, -alpha, -background, -geometry, -ontop</code>.</p>
<p class='ruff'>The <code>Img</code> and <code>treectrl</code> packages have to be installed to run it. In Debian Linux the packages are titled <code>libtk-img</code> and <code>tktreectrl</code>. If <em>aloupe</em> is run by a <em>tclkit</em> that doesn't provide these packages, define an environment variable <code>TCLLIBPATH</code> before running <em>aloupe</em> so that <code>TCLLIBPATH</code> be a list of pathes to the packages.</p>
<p class='ruff'>There are also stand-alone <a href="https://github.com/aplsimple/aloupe/releases" >aloupe executables</a> for Linux / Windows.</p>
<p class='ruff'>The executables are started as simply as:</p>
<pre class='ruff'><br><code class="tcl"> aloupe ?option value ...?
 aloupe.exe ?option value ...?
<br></code></pre>
<p class='ruff'>After the start, two windows would be displayed: a moveable loupe (at the mouse pointer) and a displaying window.</p>
<p class='ruff'>The loupe is moved by drag-and-drop. At dropping the loupe, its underlying image is magnified in the displaying window.</p>
<p class='ruff'>To change a size/zoom of the loupe, use the appropriate spinboxes. After changing them, just click the loupe to update the windows.</p>
<p class='ruff'>To save the magnified image, use <em>Save</em> button.</p>
<p class='ruff'>The <em>To clipboard</em> button displays a current pixel's color at clicking the image. When hit, the button puts the color into the clipboard.</p>
<p class='ruff'>The <code>-command</code> option may be passed to <code>::aloupe::run</code> which will run the passed command at pressing the <em>To clipboard</em> button. The command may contain <code>%c</code> wildcard meaning the color value. Just to test, try and set <code>-command &quot;puts %c&quot;</code> option.</p>
<br><h2 class='ruff'><a name='::aloupe-Options'></a>Options<span class='tinylink'><a href='aloupe.html#::aloupe'>aloupe</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>The <em>aloupe</em> can be run with the options:</p>
<ul class='ruff'>
<li><code>-size</code> - a size of the loupe's box (8 .. 256)</li>
<li><code>-zoom</code> - a zoom factor (2 .. 32)</li>
<li><code>-alpha</code> - an opacity of the loupe (0.0 .. 1.0)</li>
<li><code>-background</code> - a background color of the loupe</li>
<li><code>-geometry</code> - a displaying window's geometry set as +X+Y</li>
<li><code>-ontop</code> - if <em>yes</em> (default), sets the displaying window above others</li>
<li><code>-save</code> - if <em>yes</em> (default), saves/restores the appearance settings</li>
<li><code>-inifile</code> - a file to save the settings (~/.config/aloupe.conf by default)</li>
<li><code>-locale</code> - a preferable locale (e.g., ru, ua, cz)</li>
</ul>
<p class='ruff'>Some options can be used at running <em>aloupe</em> from a Tcl code:</p>
<ul class='ruff'>
<li><code>-exit</code> - is <em>false</em> which means &quot;don't finish Tcl/Tk session, just close the loupe&quot;</li>
<li><code>-command</code> - a command to be run at pressing the <em>To clipboard</em> button</li>
<li><code>-commandname</code> - a label instead of <em>To clipboard</em>; when set it means also &quot;no copy to clipboard&quot;</li>
<li><code>-parent</code> - a parent window's path (when the parent closes, its <em>aloupe</em> children do too)</li>
</ul>
<p class='ruff'>From a Tcl code, <em>aloupe</em> widget is called this way:</p>
<pre class='ruff'><br><code class="tcl"> <b><font color=#3a6797>package</font></b> require aloupe
 ::aloupe::run ?option value ...?
<br></code></pre>
<br><h2 class='ruff'><a name='::aloupe-Links'></a>Links<span class='tinylink'><a href='aloupe.html#::aloupe'>aloupe</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<ul class='ruff'>
<li><a href="https://aplsimple.github.io/en/tcl/aloupe/aloupe.html" >Reference</a></li>
<li><a href="https://chiselapp.com/user/aplsimple/repository/aloupe/download" >Source</a> (aloupe.zip)</li>
<li><a href="https://github.com/aplsimple/aloupe/releases" >Demo and executables</a> for Linux / Windows</li>
</ul>
<br><h2 class='ruff'><a name='::aloupe-License'></a>License<span class='tinylink'><a href='aloupe.html#::aloupe'>aloupe</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>MIT.</p>
<br><h2 class='ruff'><a name='::aloupe-Commands'></a>Commands<span class='tinylink'><a href='aloupe.html#::aloupe'>aloupe</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<br><br><br><h4 class='ruffproc'><a name='::aloupe::option'>option</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe" title="::aloupe" class='ruff_cmd'>::aloupe</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe'>aloupe</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Returns a value of aloupe option.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>option</span> <span class='ruff_arg'>opt</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>opt</code></code></td><td class='ruff_defitem'>the option's name</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns a value of aloupe option.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_option' href="javascript:toggleSource('aloupe_option')">Show source</a></p>
<div id='aloupe_option' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::option {opt} {
  <i><font color=#4b5d50># Returns a value of aloupe option.</font></i>
  <i><font color=#4b5d50>#   opt - the option's name</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$data($opt)</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::run'>run</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe" title="::aloupe" class='ruff_cmd'>::aloupe</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe'>aloupe</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Runs the loupe.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>run</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>args</code></code></td><td class='ruff_defitem'>options of the loupe</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_run' href="javascript:toggleSource('aloupe_run')">Show source</a></p>
<div id='aloupe_run' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::run {args} {
  <i><font color=#4b5d50># Runs the loupe.</font></i>
  <i><font color=#4b5d50>#  args - options of the loupe</font></i>

  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$::aloupe::starterr</font>} {
    RunSolo
    <b><font color=#ca14ca>return</font></b>
  }
  <b><font color=#3a6797>variable</font></b> my::data
  <b><font color=#3a6797>variable</font></b> my::size
  <b><font color=#3a6797>variable</font></b> my::zoom
  <i><font color=#4b5d50># save the default settings of aloupe</font></i>
  <b><font color=#3a6797>set</font></b> data(-commandname) <font color=#8b2a0e>&quot;&quot;</font>
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>info</font></b> exists my::data(DEFAULTS)]} {
    <b><font color=#3a6797>set</font></b> defar ::aloupe::_DEFAULTS_
    <b><font color=#3a6797>array</font></b> set <font color=#1b1baa>$defar</font> [<b><font color=#3a6797>array</font></b> get my::data]
    <b><font color=#3a6797>set</font></b> my::data(DEFAULTS) <font color=#1b1baa>$defar</font>
  }
  <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> my::data(-inifile) [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$args</font> <font color=#6c3e67>-inifile</font>]}
  <b><font color=#3a6797>catch</font></b> {
    <b><font color=#3a6797>if</font></b> {([<b><font color=#3a6797>dict</font></b> exists <font color=#1b1baa>$args</font> <font color=#6c3e67>-save</font>] && [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$args</font> <font color=#6c3e67>-save</font>]) ||  (![<b><font color=#3a6797>dict</font></b> exists <font color=#1b1baa>$args</font> <font color=#6c3e67>-save</font>] && <font color=#1b1baa>$my::data(-save)</font>)} {
      my::RestoreOptions
    }
  }
  <i><font color=#4b5d50># restore the default settings of aloupe (for a 2nd/3rd... run)</font></i>
  <b><font color=#3a6797>set</font></b> svd <font color=#1b1baa>$my::data(DEFAULTS)</font>
  <b><font color=#3a6797>foreach</font></b> an [<b><font color=#3a6797>array</font></b> names <font color=#1b1baa>$svd</font>] {
    <b><font color=#3a6797>set</font></b> my::data(<font color=#1b1baa>$an</font>) [<b><font color=#3a6797>set</font></b> <font color=#1b1baa>${svd}</font>(<font color=#1b1baa>$an</font>)] ;<i><font color=#4b5d50># &quot;by variable address&quot;</font></i>
  }
  <b><font color=#3a6797>foreach</font></b> {a v} <font color=#1b1baa>$args</font> {
    <b><font color=#3a6797>if</font></b> {(<font color=#1b1baa>$v</font> ne <font color=#8b2a0e>&quot;&quot;</font> || <font color=#1b1baa>$a</font> in {<font color=#6c3e67>-geometry</font> <font color=#6c3e67>-fcgeom</font>}) &&  [<b><font color=#3a6797>info</font></b> exists my::data(<font color=#1b1baa>$a</font>)] && [<b><font color=#3a6797>string</font></b> is lower [<b><font color=#3a6797>string</font></b> index <font color=#1b1baa>$a</font> 1]]} {
      <b><font color=#3a6797>set</font></b> my::data(<font color=#1b1baa>$a</font>) <font color=#1b1baa>$v</font>
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot;Bad option: <font color=#1b1baa>$</font>a \&quot;<font color=#1b1baa>$</font>v\&quot;&quot;</font>
      my::Synopsis
    }
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$my::data(-locale)</font> ne {}} {
    <b><font color=#3a6797>catch</font></b> {
      ::msgcat::mcload [<b><font color=#3a6797>file</font></b> join [<b><font color=#3a6797>file</font></b> dirname [<b><font color=#3a6797>info</font></b> script]] msgs]
      ::msgcat::mclocale <font color=#1b1baa>$my::data(-locale)</font>
    }
  }
  <b><font color=#3a6797>catch</font></b> {::apave::obj untouchWidgets <font color=#8b2a0e>&quot;*_a_loupe_loup*&quot;</font>}  ;<i><font color=#4b5d50># don't theme the loupe</font></i>
  <b><font color=#3a6797>set</font></b> my::size [<b><font color=#3a6797>set</font></b> my::data(PREVSIZE) <font color=#1b1baa>$my::data(-size)</font>]
  <b><font color=#3a6797>set</font></b> my::zoom [<b><font color=#3a6797>set</font></b> my::data(PREVZOOM) <font color=#1b1baa>$my::data(-zoom)</font>]
  <b><font color=#3a6797>set</font></b> my::pause <font color=#1b1baa>$my::data(-pause)</font>
  <b><font color=#3a6797>set</font></b> my::data(WDISP) <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>data(-parent)._a_loupe_disp&quot;</font>
  <b><font color=#3a6797>set</font></b> my::data(WLOUP) <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>data(-parent)._a_loupe_loup&quot;</font>
  <b><font color=#3a6797>set</font></b> my::data(LABEL) <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>data(WDISP).label&quot;</font>
  <b><font color=#3a6797>set</font></b> my::data(COLOR) [<b><font color=#3a6797>set</font></b> data(CAPTURE) <font color=#8b2a0e>&quot;&quot;</font>]
  my::Theme
  my::Create yes
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::RunSolo'>RunSolo</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe" title="::aloupe" class='ruff_cmd'>::aloupe</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe'>aloupe</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Runs aloupe as a sole Tcl script. When aloupe runs from tclkit, it may fail. So try it with tclsh deployed.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>RunSolo</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_RunSolo' href="javascript:toggleSource('aloupe_RunSolo')">Show source</a></p>
<div id='aloupe_RunSolo' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::RunSolo {} {
  <i><font color=#4b5d50># Runs aloupe as a sole Tcl script.</font></i>
  <i><font color=#4b5d50># When aloupe runs from tclkit, it may fail. So try it with tclsh deployed.</font></i>

  <b><font color=#3a6797>set</font></b> tclsh [<b><font color=#3a6797>auto_execok</font></b> tclsh]
  <b><font color=#3a6797>set</font></b> tclexe [<b><font color=#3a6797>info</font></b> nameofexecutable]
  <i><font color=#4b5d50># tclsh may be sort of &quot;tcl.sh&quot; to run a tclkit</font></i>
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$tclsh</font>] && [<b><font color=#3a6797>file</font></b> size <font color=#1b1baa>$tclsh</font>]&gt;1024 && <font color=#1b1baa>$tclsh</font> ne <font color=#1b1baa>$tclexe</font>} {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$::aloupe::solo</font>} {<b><font color=#3a6797>set</font></b> aar <font color=#1b1baa>$::argv</font>} {<b><font color=#3a6797>set</font></b> aar {}}
    <b><font color=#3a6797>exec</font></b> -- <font color=#1b1baa>$tclsh</font> <font color=#1b1baa>$::aloupe::aloupescript</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$aar</font> &
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot;aloupe: <font color=#1b1baa>$</font>::aloupe::runerr&quot;</font>
  }
}<br><br></code></pre></div>
</div><br><br><h1 class='ruff'><a name='::aloupe::my'></a>::aloupe::my<span class='tinylink'><a href='#top'>Top</a></span></h1>
<div style='clear:both;'></div>
<p class='ruff'>The <code>::aloupe::my</code> namespace contains procedures for the &quot;internal&quot; usage by <em>aloupe</em> package.</p>
<p class='ruff'>All of them are upper-cased, in contrast with the UI procedures of <code>aloupe</code> namespace.</p>
<br><h2 class='ruff'><a name='::aloupe::my-Commands'></a>Commands<span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<br><br><br><h4 class='ruffproc'><a name='::aloupe::my::Button2Click'>Button2Click</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Processes the click on 'Clipboard' button.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Button2Click</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_Button2Click' href="javascript:toggleSource('aloupe_my_Button2Click')">Show source</a></p>
<div id='aloupe_my_Button2Click' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::Button2Click {} {
  <i><font color=#4b5d50># Processes the click on 'Clipboard' button.</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$data(COLOR)</font> ne <font color=#8b2a0e>&quot;&quot;</font>} {
    StyleButton2 <font color=#6c3e67>-background</font> <font color=#1b1baa>$data(INVCOLOR)</font> <font color=#6c3e67>-foreground</font> <font color=#1b1baa>$data(COLOR)</font>
    <b><font color=#3a6797>update</font></b> idletasks
    <b><font color=#3a6797>after</font></b> 60 ;<i><font color=#4b5d50># just to make the click visible</font></i>
  }
  <b><font color=#3a6797>if</font></b> {[HandleColor] && !<font color=#1b1baa>$data(-exit)</font> && <font color=#1b1baa>$data(-command)</font> ne <font color=#8b2a0e>&quot;&quot;</font>} {
    SaveGeometry
    {<b><font color=#3a6797>*</font></b>}[<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %c <font color=#1b1baa>$data(COLOR)</font>] <font color=#1b1baa>$data(-command)</font>]
  }
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::CountDownPause'>CountDownPause</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Counts down a pause.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>CountDownPause</span> <span class='ruff_arg'>p</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>p</code></code></td><td class='ruff_defitem'>remaining seconds to count down</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_CountDownPause' href="javascript:toggleSource('aloupe_my_CountDownPause')">Show source</a></p>
<div id='aloupe_my_CountDownPause' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::CountDownPause {p} {
  <i><font color=#4b5d50># Counts down a pause.</font></i>
  <i><font color=#4b5d50>#   p - remaining seconds to count down</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$p</font>} {
    <b><font color=#3a6797>set</font></b> ::aloupe::my::pause [<b><font color=#3a6797>incr</font></b> p -1]
    <b><font color=#3a6797>set</font></b> msec [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$p</font> ? 1000 : 200}]
    <b><font color=#3a6797>after</font></b> <font color=#1b1baa>$msec</font> [<b><font color=#3a6797>list</font></b> ::aloupe::my::CountDownPause <font color=#1b1baa>$p</font>]
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> ::aloupe::my::pause <font color=#1b1baa>$data(-pause)</font>
  }
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::Create'>Create</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Initializes and creates the utility's windows.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Create</span> <span class='ruff_arg'>start</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>start</code></code></td><td class='ruff_defitem'>yes, if called at start</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_Create' href="javascript:toggleSource('aloupe_my_Create')">Show source</a></p>
<div id='aloupe_my_Create' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::Create {start} {
  <i><font color=#4b5d50># Initializes and creates the utility's windows.</font></i>
  <i><font color=#4b5d50>#   start - yes, if called at start</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>destroy</font></b> <font color=#1b1baa>$data(WLOUP)</font>}
  <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>destroy</font></b> <font color=#1b1baa>$data(WDISP)</font>}
  <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>image</font></b> delete <font color=#1b1baa>$data(IMAGE)</font>}
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> wgr [<b><font color=#134070>grab</font></b> current]] ne <font color=#8b2a0e>&quot;&quot;</font>} {<b><font color=#134070>grab</font></b> release <font color=#1b1baa>$wgr</font>}
  CreateDisplay <font color=#1b1baa>$start</font>
  CreateLoupe
  <b><font color=#3a6797>set</font></b> data(PREVZOOM) <font color=#1b1baa>$data(-zoom)</font>
  <b><font color=#3a6797>set</font></b> data(PREVSIZE) <font color=#1b1baa>$data(-size)</font>
  <b><font color=#134070>focus</font></b> <font color=#1b1baa>$data(WDISP)</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::CreateDisplay'>CreateDisplay</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Creates the displaying window.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>CreateDisplay</span> <span class='ruff_arg'>start</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>start</code></code></td><td class='ruff_defitem'>yes, if called at start</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_CreateDisplay' href="javascript:toggleSource('aloupe_my_CreateDisplay')">Show source</a></p>
<div id='aloupe_my_CreateDisplay' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::CreateDisplay {start} {
  <i><font color=#4b5d50># Creates the displaying window.</font></i>
  <i><font color=#4b5d50>#   start - yes, if called at start</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>set</font></b> sZ [<b><font color=#3a6797>expr</font></b> {2*<font color=#1b1baa>$data(-size)</font>*<font color=#1b1baa>$data(-zoom)</font>}]
  <b><font color=#3a6797>set</font></b> data(IMAGE) [<b><font color=#134070>image</font></b> create photo <font color=#6c3e67>-width</font> <font color=#1b1baa>$sZ</font> <font color=#6c3e67>-height</font> <font color=#1b1baa>$sZ</font>]
  <b><font color=#134070>toplevel</font></b> <font color=#1b1baa>$data(WDISP)</font>
  <b><font color=#134070>wm</font></b> title <font color=#1b1baa>$data(WDISP)</font> [::msgcat::mc Loupe]
  <b><font color=#3a6797>set</font></b> fg [<b><font color=#134070>ttk::style</font></b> configure . <font color=#6c3e67>-foreground</font>]
  <b><font color=#3a6797>set</font></b> bg [<b><font color=#134070>ttk::style</font></b> configure . <font color=#6c3e67>-background</font>]
  <b><font color=#3a6797>set</font></b> opts [<b><font color=#134070>ttk::style</font></b> config TButton]
  <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> fg [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$opts</font> <font color=#6c3e67>-foreground</font>]}
  <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> bg [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$opts</font> <font color=#6c3e67>-background</font>]}
  <font color=#1b1baa>$data(WDISP)</font> configure <font color=#6c3e67>-background</font> <font color=#1b1baa>$bg</font>
  <b><font color=#134070>grid</font></b> [<b><font color=#134070>label</font></b> <font color=#1b1baa>$data(WDISP)</font>.l <font color=#6c3e67>-fg</font> <font color=#1b1baa>$fg</font> <font color=#6c3e67>-bg</font> <font color=#1b1baa>$bg</font>] <font color=#6c3e67>-row</font> 0 <font color=#6c3e67>-columnspan</font> 2 <font color=#6c3e67>-sticky</font> we
  <b><font color=#134070>pack</font></b> [<b><font color=#134070>label</font></b> <font color=#1b1baa>$data(WDISP)</font>.l.lab1 <font color=#6c3e67>-text</font> <font color=#8b2a0e>&quot; <font color=#1b1baa>[</font>::msgcat::mc Size<font color=#1b1baa>]</font>&quot;</font> <font color=#6c3e67>-fg</font> <font color=#1b1baa>$fg</font> <font color=#6c3e67>-bg</font> <font color=#1b1baa>$bg</font>] <font color=#6c3e67>-side</font> left <font color=#6c3e67>-anchor</font> e <font color=#6c3e67>-expand</font> 1
  <b><font color=#134070>pack</font></b> [<b><font color=#134070>ttk::spinbox</font></b> <font color=#1b1baa>$data(WDISP)</font>.l.sp1 <font color=#6c3e67>-from</font> 8 <font color=#6c3e67>-to</font> 500 <font color=#6c3e67>-justify</font> center  <font color=#6c3e67>-width</font> 4 <font color=#6c3e67>-textvariable</font> ::aloupe::my::size <font color=#6c3e67>-command</font> ::aloupe::my::ShowLoupe] <font color=#6c3e67>-side</font> left
  <b><font color=#134070>pack</font></b> [<b><font color=#134070>label</font></b> <font color=#1b1baa>$data(WDISP)</font>.l.lab2 <font color=#6c3e67>-text</font> <font color=#8b2a0e>&quot; <font color=#1b1baa>[</font>::msgcat::mc Zoom<font color=#1b1baa>]</font>&quot;</font> <font color=#6c3e67>-fg</font> <font color=#1b1baa>$fg</font> <font color=#6c3e67>-bg</font> <font color=#1b1baa>$bg</font>] <font color=#6c3e67>-side</font> left <font color=#6c3e67>-anchor</font> e <font color=#6c3e67>-expand</font> 1
  <b><font color=#134070>pack</font></b> [<b><font color=#134070>ttk::spinbox</font></b> <font color=#1b1baa>$data(WDISP)</font>.l.sp2 <font color=#6c3e67>-from</font> 1 <font color=#6c3e67>-to</font> 50 <font color=#6c3e67>-justify</font> center  <font color=#6c3e67>-width</font> 2 <font color=#6c3e67>-textvariable</font> ::aloupe::my::zoom] <font color=#6c3e67>-side</font> left
  <b><font color=#134070>pack</font></b> [<b><font color=#134070>label</font></b> <font color=#1b1baa>$data(WDISP)</font>.l.lab3 <font color=#6c3e67>-text</font> <font color=#8b2a0e>&quot; <font color=#1b1baa>[</font>::msgcat::mc Pause<font color=#1b1baa>]</font>&quot;</font> <font color=#6c3e67>-fg</font> <font color=#1b1baa>$fg</font> <font color=#6c3e67>-bg</font> <font color=#1b1baa>$bg</font>] <font color=#6c3e67>-side</font> left <font color=#6c3e67>-anchor</font> e <font color=#6c3e67>-expand</font> 1
  <b><font color=#134070>pack</font></b> [<b><font color=#134070>ttk::spinbox</font></b> <font color=#1b1baa>$data(WDISP)</font>.l.sp3 <font color=#6c3e67>-from</font> 0 <font color=#6c3e67>-to</font> 60 <font color=#6c3e67>-justify</font> center  <font color=#6c3e67>-width</font> 2 <font color=#6c3e67>-textvariable</font> ::aloupe::my::pause] <font color=#6c3e67>-side</font> left
  <b><font color=#134070>grid</font></b> [<b><font color=#134070>ttk::separator</font></b> <font color=#1b1baa>$data(WDISP)</font>.sep1 <font color=#6c3e67>-orient</font> horizontal] <font color=#6c3e67>-row</font> 1 <font color=#6c3e67>-columnspan</font> 2 <font color=#6c3e67>-sticky</font> we <font color=#6c3e67>-pady</font> 2
  <b><font color=#134070>grid</font></b> [<b><font color=#134070>ttk::label</font></b> <font color=#1b1baa>$data(LABEL)</font> <font color=#6c3e67>-image</font> <font color=#1b1baa>$data(IMAGE)</font> <font color=#6c3e67>-relief</font> flat] <font color=#6c3e67>-row</font> 2 <font color=#6c3e67>-columnspan</font> 2 <font color=#6c3e67>-padx</font> 2
  <b><font color=#3a6797>set</font></b> data(BUT2) <font color=#1b1baa>$data(WDISP)</font>.but2
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> but2text <font color=#1b1baa>$data(-commandname)</font>] eq <font color=#8b2a0e>&quot;&quot;</font>} {
    <b><font color=#3a6797>set</font></b> but2text [::msgcat::mc <font color=#8b2a0e>&quot;To clipboard&quot;</font>]
  }
  <b><font color=#134070>grid</font></b> [<b><font color=#134070>button</font></b> <font color=#1b1baa>$data(BUT2)</font> <font color=#6c3e67>-text</font> <font color=#1b1baa>$but2text</font>  <font color=#6c3e67>-command</font> ::aloupe::my::Button2Click <font color=#6c3e67>-font</font> TkFixedFont] <font color=#6c3e67>-row</font> 3 <font color=#6c3e67>-column</font> 0 <font color=#6c3e67>-sticky</font> ew
  <b><font color=#134070>grid</font></b> [<b><font color=#134070>button</font></b> <font color=#1b1baa>$data(WDISP)</font>.but1 <font color=#6c3e67>-text</font> [::msgcat::mc Save]  <font color=#6c3e67>-command</font> ::aloupe::my::Save <font color=#6c3e67>-fg</font> <font color=#1b1baa>$fg</font> <font color=#6c3e67>-bg</font> <font color=#1b1baa>$bg</font> <font color=#6c3e67>-font</font> TkFixedFont] <font color=#6c3e67>-row</font> 3 <font color=#6c3e67>-column</font> 1 <font color=#6c3e67>-sticky</font> ew
  <b><font color=#3a6797>set</font></b> data(-geometry) [<b><font color=#3a6797>regexp</font></b> <font color=#6c3e67>-inline</font> \\+.* <font color=#1b1baa>$data(-geometry)</font>]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$data(-geometry)</font> ne <font color=#8b2a0e>&quot;&quot;</font>} {
    <b><font color=#134070>wm</font></b> geometry <font color=#1b1baa>$data(WDISP)</font> <font color=#1b1baa>$data(-geometry)</font>
  } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$data(-parent)</font> ne <font color=#8b2a0e>&quot;&quot;</font>} {
    ::tk::PlaceWindow <font color=#1b1baa>$data(WDISP)</font> widget <font color=#1b1baa>$data(-parent)</font>
  } <b><font color=#3a6797>else</font></b> {
    ::tk::PlaceWindow <font color=#1b1baa>$data(WDISP)</font>
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$start</font>} {
    <b><font color=#3a6797>set</font></b> defargs [<b><font color=#3a6797>list</font></b> <font color=#6c3e67>-foreground</font> <font color=#1b1baa>$fg</font> <font color=#6c3e67>-background</font> <font color=#1b1baa>$bg</font>]
    <b><font color=#3a6797>set</font></b> data(BUTCFG) [StyleButton2 {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$defargs</font>]
    <b><font color=#3a6797>lappend</font></b> data(BUTCFG) {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$defargs</font> <font color=#6c3e67>-text</font> <font color=#1b1baa>$but2text</font>
  }
  <b><font color=#134070>bind</font></b> <font color=#1b1baa>$data(LABEL)</font> &lt;ButtonPress-1&gt; {::aloupe::my::PickColor %W %X %Y}
  <b><font color=#134070>bind</font></b> <font color=#1b1baa>$data(WDISP)</font> &lt;Escape&gt; ::aloupe::my::Exit
  <b><font color=#134070>wm</font></b> resizable <font color=#1b1baa>$data(WDISP)</font> 0 0
  <b><font color=#134070>wm</font></b> protocol <font color=#1b1baa>$data(WDISP)</font> WM_DELETE_WINDOW ::aloupe::my::Exit
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$data(-ontop)</font>} {<b><font color=#134070>wm</font></b> attributes <font color=#1b1baa>$data(WDISP)</font> <font color=#6c3e67>-topmost</font> 1}
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::CreateLoupe'>CreateLoupe</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Creates the loupe window.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>CreateLoupe</span> <span class='ruff_arg'>?geom?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>geom</code></code></td><td class='ruff_defitem'>the predefined geometry; <i>optional, default</i> <code>&quot;&quot;</code></td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_CreateLoupe' href="javascript:toggleSource('aloupe_my_CreateLoupe')">Show source</a></p>
<div id='aloupe_my_CreateLoupe' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::CreateLoupe {{geom {}}} {
  <i><font color=#4b5d50># Creates the loupe window.</font></i>
  <i><font color=#4b5d50>#   geom - the predefined geometry</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#134070>frame</font></b> <font color=#1b1baa>$data(WLOUP)</font>
  <b><font color=#134070>wm</font></b> manage <font color=#1b1baa>$data(WLOUP)</font>
  <b><font color=#134070>wm</font></b> withdraw <font color=#1b1baa>$data(WLOUP)</font>
  <b><font color=#134070>wm</font></b> overrideredirect <font color=#1b1baa>$data(WLOUP)</font> 1
  <b><font color=#3a6797>set</font></b> canvas <font color=#1b1baa>$data(WLOUP)</font>.c
  <b><font color=#134070>canvas</font></b> <font color=#1b1baa>$canvas</font> <font color=#6c3e67>-width</font> 100 <font color=#6c3e67>-height</font> 100 <font color=#6c3e67>-background</font> <font color=#1b1baa>$data(-background)</font>  <font color=#6c3e67>-relief</font> flat <font color=#6c3e67>-bd</font> 0 <font color=#6c3e67>-highlightthickness</font> 1 <font color=#6c3e67>-highlightbackground</font> red
  <b><font color=#134070>pack</font></b> <font color=#1b1baa>$canvas</font> <font color=#6c3e67>-fill</font> both <font color=#6c3e67>-expand</font> true
  <b><font color=#134070>bind</font></b> <font color=#1b1baa>$canvas</font> &lt;ButtonPress-1&gt;   {::aloupe::my::DragStart %W %X %Y}
  <b><font color=#134070>bind</font></b> <font color=#1b1baa>$canvas</font> &lt;B1-Motion&gt;       {::aloupe::my::Drag %W %X %Y}
  <b><font color=#134070>bind</font></b> <font color=#1b1baa>$canvas</font> &lt;ButtonRelease-1&gt; {::aloupe::my::DragEnd %W}
  <b><font color=#134070>bind</font></b> <font color=#1b1baa>$canvas</font> &lt;Escape&gt;          {::aloupe::my::Exit}
  <b><font color=#3a6797>after</font></b> 50 <font color=#8b2a0e>&quot;</font>
<font color=#8b2a0e>    ::aloupe::my::InitGeometry <font color=#1b1baa>$</font>geom</font>
<font color=#8b2a0e>    wm deiconify <font color=#1b1baa>$</font>data(WLOUP)</font>
<font color=#8b2a0e>    wm attributes <font color=#1b1baa>$</font>data(WLOUP) -topmost 1 -alpha <font color=#1b1baa>$</font>data(-alpha)</font>
<font color=#8b2a0e>    &quot;</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::DisplayImage'>DisplayImage</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Ends the frag-and-drop of the loupe and displays its magnified image.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>DisplayImage</span> <span class='ruff_arg'>w</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>w</code></code></td><td class='ruff_defitem'>the loupe window's path</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_DisplayImage' href="javascript:toggleSource('aloupe_my_DisplayImage')">Show source</a></p>
<div id='aloupe_my_DisplayImage' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::DisplayImage {w} {
  <i><font color=#4b5d50># Ends the frag-and-drop of the loupe and displays its magnified image.</font></i>
  <i><font color=#4b5d50>#   w - the loupe window's path</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>info</font></b> exists data(dragX)]} <b><font color=#ca14ca>return</font></b>
  <b><font color=#134070>wm</font></b> withdraw <font color=#1b1baa>$data(WLOUP)</font>
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$data(-ontop)</font> && ![<b><font color=#3a6797>string</font></b> match <font color=#1b1baa>$data(WDISP)</font>* <font color=#1b1baa>$data(FOCUS)</font>] &&
  <font color=#1b1baa>$::tcl_platform(platform)</font> eq <font color=#8b2a0e>&quot;unix&quot;</font>} {
    <i><font color=#4b5d50># the disp window can be overlapped by others =&gt; it should be deiconified</font></i>
    <b><font color=#134070>wm</font></b> withdraw <font color=#1b1baa>$data(WDISP)</font>
  }
  <b><font color=#3a6797>set</font></b> curX [<b><font color=#134070>winfo</font></b> rootx <font color=#1b1baa>$w</font>]
  <b><font color=#3a6797>set</font></b> curY [<b><font color=#134070>winfo</font></b> rooty <font color=#1b1baa>$w</font>]
  <b><font color=#3a6797>set</font></b> curW [<b><font color=#134070>winfo</font></b> width <font color=#1b1baa>$w</font>]
  <b><font color=#3a6797>set</font></b> curH [<b><font color=#134070>winfo</font></b> height <font color=#1b1baa>$w</font>]
  <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>image</font></b> delete <font color=#1b1baa>$data(CAPTURE)</font>}
  <b><font color=#3a6797>set</font></b> sz [<b><font color=#3a6797>expr</font></b> {2*<font color=#1b1baa>$data(-size)</font>}]
  <b><font color=#3a6797>set</font></b> sZ [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$sz</font>*<font color=#1b1baa>$data(-zoom)</font>}]
  <b><font color=#3a6797>set</font></b> data(CAPTURE) [<b><font color=#134070>image</font></b> create photo <font color=#6c3e67>-width</font> <font color=#1b1baa>$sz</font> <font color=#6c3e67>-height</font> <font color=#1b1baa>$sz</font>]
  <b><font color=#3a6797>set</font></b> loupe_x [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$curX</font> + <font color=#1b1baa>$sz</font>/2}]
  <b><font color=#3a6797>set</font></b> loupe_y [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$curY</font> + <font color=#1b1baa>$sz</font>/2}]
  <b><font color=#3a6797>after</font></b> 40 <font color=#8b2a0e>&quot;loupe <font color=#1b1baa>$</font>data(CAPTURE) <font color=#1b1baa>$</font>loupe_x <font color=#1b1baa>$</font>loupe_y <font color=#1b1baa>$</font>sz <font color=#1b1baa>$</font>sz 1&quot;</font>
  <b><font color=#3a6797>after</font></b> 50
  <b><font color=#3a6797>update</font></b>   ;<i><font color=#4b5d50># enough time to hide the window and capture the image</font></i>
  <b><font color=#3a6797>after</font></b> 50
  <b><font color=#3a6797>catch</font></b> {
    <font color=#1b1baa>$data(IMAGE)</font> copy <font color=#1b1baa>$data(CAPTURE)</font> <font color=#6c3e67>-from</font> 0 0 <font color=#1b1baa>$sz</font> <font color=#1b1baa>$sz</font>  <font color=#6c3e67>-to</font> 0 0 <font color=#1b1baa>$sZ</font> <font color=#1b1baa>$sZ</font> <font color=#6c3e67>-zoom</font> <font color=#1b1baa>$data(-zoom)</font>
  }
  <b><font color=#134070>wm</font></b> deiconify <font color=#1b1baa>$data(WDISP)</font>
  <b><font color=#134070>wm</font></b> deiconify <font color=#1b1baa>$data(WLOUP)</font>
  <b><font color=#134070>focus</font></b> <font color=#6c3e67>-force</font> <font color=#1b1baa>$data(WDISP)</font>.but2
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::Drag'>Drag</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Performs the frag-and-drop of the loupe.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Drag</span> <span class='ruff_arg'>w X Y</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>w</code></code></td><td class='ruff_defitem'>the loupe window's path</td></tr>
<tr><td class='ruff_defitem'><code><code>X</code></code></td><td class='ruff_defitem'>X-coordinate of the mouse pointer</td></tr>
<tr><td class='ruff_defitem'><code><code>Y</code></code></td><td class='ruff_defitem'>Y-coordinate of the mouse pointer</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_Drag' href="javascript:toggleSource('aloupe_my_Drag')">Show source</a></p>
<div id='aloupe_my_Drag' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::Drag {w X Y} {
  <i><font color=#4b5d50># Performs the frag-and-drop of the loupe.</font></i>
  <i><font color=#4b5d50>#   w - the loupe window's path</font></i>
  <i><font color=#4b5d50>#   X - X-coordinate of the mouse pointer</font></i>
  <i><font color=#4b5d50>#   Y - Y-coordinate of the mouse pointer</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>info</font></b> exists data(dragX)]} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>set</font></b> dx [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$X</font> - <font color=#1b1baa>$data(dragX)</font>}]
  <b><font color=#3a6797>set</font></b> dy [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$Y</font> - <font color=#1b1baa>$data(dragY)</font>}]
  <b><font color=#134070>wm</font></b> geometry <font color=#1b1baa>$data(WLOUP)</font> +<font color=#1b1baa>$dx</font>+<font color=#1b1baa>$dy</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::DragEnd'>DragEnd</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Ends the frag-and-drop of the loupe and displays its magnified image.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>DragEnd</span> <span class='ruff_arg'>w</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>w</code></code></td><td class='ruff_defitem'>the loupe window's path</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_DragEnd' href="javascript:toggleSource('aloupe_my_DragEnd')">Show source</a></p>
<div id='aloupe_my_DragEnd' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::DragEnd {w} {
  <i><font color=#4b5d50># Ends the frag-and-drop of the loupe and displays its magnified image.</font></i>
  <i><font color=#4b5d50>#   w - the loupe window's path</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$data(-pause)</font>} {
    <b><font color=#3a6797>after</font></b> 1000 [<b><font color=#3a6797>list</font></b> ::aloupe::my::CountDownPause <font color=#1b1baa>$data(-pause)</font>]
    <b><font color=#3a6797>after</font></b> [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$data(-pause)</font>*1000}] [<b><font color=#3a6797>list</font></b> ::aloupe::my::DisplayImage <font color=#1b1baa>$w</font>]
  } <b><font color=#3a6797>else</font></b> {
    ::aloupe::my::DisplayImage <font color=#1b1baa>$w</font>
  }
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::DragStart'>DragStart</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Initializes the frag-and-drop of the loupe.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>DragStart</span> <span class='ruff_arg'>w X Y</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>w</code></code></td><td class='ruff_defitem'>the loupe window's path</td></tr>
<tr><td class='ruff_defitem'><code><code>X</code></code></td><td class='ruff_defitem'>X-coordinate of the mouse pointer</td></tr>
<tr><td class='ruff_defitem'><code><code>Y</code></code></td><td class='ruff_defitem'>Y-coordinate of the mouse pointer</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_DragStart' href="javascript:toggleSource('aloupe_my_DragStart')">Show source</a></p>
<div id='aloupe_my_DragStart' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::DragStart {w X Y} {
  <i><font color=#4b5d50># Initializes the frag-and-drop of the loupe.</font></i>
  <i><font color=#4b5d50>#   w - the loupe window's path</font></i>
  <i><font color=#4b5d50>#   X - X-coordinate of the mouse pointer</font></i>
  <i><font color=#4b5d50>#   Y - Y-coordinate of the mouse pointer</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>variable</font></b> size
  <b><font color=#3a6797>variable</font></b> zoom
  <b><font color=#3a6797>variable</font></b> pause
  <b><font color=#3a6797>set</font></b> data(FOCUS) [<b><font color=#134070>focus</font></b>]
  <b><font color=#134070>focus</font></b> <font color=#6c3e67>-force</font> <font color=#1b1baa>$data(WDISP)</font>
  <b><font color=#3a6797>set</font></b> data(-size) <font color=#1b1baa>$size</font>
  <b><font color=#3a6797>set</font></b> data(-zoom) <font color=#1b1baa>$zoom</font>
  <b><font color=#3a6797>set</font></b> data(-pause) <font color=#1b1baa>$pause</font>
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$data(PREVZOOM)</font> != <font color=#1b1baa>$data(-zoom)</font> || <font color=#1b1baa>$data(PREVSIZE)</font> != <font color=#1b1baa>$data(-size)</font>} {
    SaveGeometry
    Create no
    <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>unset</font></b> data(dragX)}  ;<i><font color=#4b5d50># no drag-n-drop, update the loupe only</font></i>
    <b><font color=#3a6797>update</font></b>
    <b><font color=#ca14ca>return</font></b>
  }
  <b><font color=#3a6797>set</font></b> data(COLOR) [<b><font color=#3a6797>set</font></b> data(CAPTURE) <font color=#8b2a0e>&quot;&quot;</font>]
  StyleButton2 {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$data(BUTCFG)</font>
  InitGeometry
  <b><font color=#3a6797>update</font></b>
  <b><font color=#3a6797>set</font></b> data(dragX) [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$X</font> - [<b><font color=#134070>winfo</font></b> rootx <font color=#1b1baa>$w</font>]}]
  <b><font color=#3a6797>set</font></b> data(dragY) [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$Y</font> - [<b><font color=#134070>winfo</font></b> rooty <font color=#1b1baa>$w</font>]}]
  <b><font color=#3a6797>set</font></b> data(dragw) [<b><font color=#134070>winfo</font></b> width <font color=#1b1baa>$w</font>]
  <b><font color=#3a6797>set</font></b> data(dragh) [<b><font color=#134070>winfo</font></b> height <font color=#1b1baa>$w</font>]
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::Exit'>Exit</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Clears all and exits.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Exit</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_Exit' href="javascript:toggleSource('aloupe_my_Exit')">Show source</a></p>
<div id='aloupe_my_Exit' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::Exit {} {
  <i><font color=#4b5d50># Clears all and exits.</font></i>

  <b><font color=#3a6797>variable</font></b> data
  SaveOptions
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$data(-exit)</font>} <b><font color=#3a6797>exit</font></b>
  SaveGeometry
  <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>image</font></b> delete <font color=#1b1baa>$data(IMAGE)</font>}
  <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>image</font></b> delete <font color=#1b1baa>$data(CAPTURE)</font>}
  <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>destroy</font></b> <font color=#1b1baa>$data(WDISP)</font>}
  <b><font color=#3a6797>catch</font></b> {
    <b><font color=#134070>wm</font></b> withdraw <font color=#1b1baa>$data(WLOUP)</font>
    <b><font color=#134070>destroy</font></b> <font color=#1b1baa>$data(WLOUP)</font>
  }
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::HandleColor'>HandleColor</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Processes the image color under the mouse pointer, optionally saving it to the clipboard.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>HandleColor</span> <span class='ruff_arg'>?doclb?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>doclb</code></code></td><td class='ruff_defitem'>if 'yes', means &quot;put the color into the clipboard&quot; <i>optional, default</i> <code>yes</code></td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns 'yes' if the color was chosen.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_HandleColor' href="javascript:toggleSource('aloupe_my_HandleColor')">Show source</a></p>
<div id='aloupe_my_HandleColor' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::HandleColor {{doclb yes}} {
  <i><font color=#4b5d50># Processes the image color under the mouse pointer,</font></i>
  <i><font color=#4b5d50># optionally saving it to the clipboard.</font></i>
  <i><font color=#4b5d50>#   doclb - if 'yes', means &quot;put the color into the clipboard&quot;</font></i>
  <i><font color=#4b5d50># Returns 'yes' if the color was chosen.</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>set</font></b> res no
  <b><font color=#3a6797>if</font></b> {[IsCapture]} {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$data(COLOR)</font> eq <font color=#8b2a0e>&quot;&quot;</font>} {
      Message <font color=#6c3e67>-title</font> [msgcat::mc {Color of Image}] <font color=#6c3e67>-icon</font> warning  <font color=#6c3e67>-message</font> [msgcat::mc <font color=#8b2a0e>&quot;Click the magnified image\nto get a pixel's color.\n\nThen hit this button.&quot;</font>]
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$doclb</font> && <font color=#1b1baa>$data(-commandname)</font> eq <font color=#8b2a0e>&quot;&quot;</font>} {
        <b><font color=#134070>clipboard</font></b> clear
        <b><font color=#134070>clipboard</font></b> append <font color=#6c3e67>-type</font> STRING <font color=#1b1baa>$data(COLOR)</font>
      }
      StyleButton2 <font color=#6c3e67>-background</font> <font color=#1b1baa>$data(COLOR)</font> <font color=#6c3e67>-foreground</font> <font color=#1b1baa>$data(INVCOLOR)</font>  <font color=#6c3e67>-text</font> <font color=#1b1baa>$data(COLOR)</font>
      <b><font color=#3a6797>set</font></b> res yes
    }
  }
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$res</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::InitGeometry'>InitGeometry</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets and sets the geometry of the loupe window, based on the image label's sizes and the zoom factor.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>InitGeometry</span> <span class='ruff_arg'>?geom?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>geom</code></code></td><td class='ruff_defitem'>the predefined geometry; <i>optional, default</i> <code>&quot;&quot;</code></td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_InitGeometry' href="javascript:toggleSource('aloupe_my_InitGeometry')">Show source</a></p>
<div id='aloupe_my_InitGeometry' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::InitGeometry {{geom {}}} {
  <i><font color=#4b5d50># Gets and sets the geometry of the loupe window,</font></i>
  <i><font color=#4b5d50># based on the image label's sizes and the zoom factor.</font></i>
  <i><font color=#4b5d50>#   geom - the predefined geometry</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$geom</font> eq <font color=#8b2a0e>&quot;&quot;</font>} {
    <b><font color=#3a6797>set</font></b> sz [<b><font color=#3a6797>expr</font></b> {2*<font color=#1b1baa>$data(-size)</font>}]
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#134070>winfo</font></b> pointerxy .] x y
    <b><font color=#3a6797>set</font></b> x [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$x</font>-<font color=#1b1baa>$sz</font>/2}]
    <b><font color=#3a6797>set</font></b> y [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$y</font>-<font color=#1b1baa>$sz</font>/2}]
    <b><font color=#3a6797>set</font></b> geom <font color=#1b1baa>${sz}</font>x<font color=#1b1baa>${sz}</font>+<font color=#1b1baa>$x</font>+<font color=#1b1baa>$y</font>
  }
  <b><font color=#134070>wm</font></b> geometry <font color=#1b1baa>$data(WLOUP)</font> <font color=#1b1baa>$geom</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::InvertBg'>InvertBg</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Inverts colors from light to dark and vice versa to get &quot;fg&quot; from &quot;bg&quot;. It's simplified way, just to not include the bulky HSV code.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>InvertBg</span> <span class='ruff_arg'>r g b</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>r</code></code></td><td class='ruff_defitem'>red component</td></tr>
<tr><td class='ruff_defitem'><code><code>g</code></code></td><td class='ruff_defitem'>green component</td></tr>
<tr><td class='ruff_defitem'><code><code>b</code></code></td><td class='ruff_defitem'>blue component</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns {R G B} list of inverted colors.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_InvertBg' href="javascript:toggleSource('aloupe_my_InvertBg')">Show source</a></p>
<div id='aloupe_my_InvertBg' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::InvertBg {r g b} {
  <i><font color=#4b5d50># Inverts colors from light to dark and vice versa to get &quot;fg&quot; from &quot;bg&quot;.</font></i>
  <i><font color=#4b5d50># It's simplified way, just to not include the bulky HSV code.</font></i>
  <i><font color=#4b5d50>#  r - red component</font></i>
  <i><font color=#4b5d50>#  g - green component</font></i>
  <i><font color=#4b5d50>#  b - blue component</font></i>
  <i><font color=#4b5d50># Returns {R G B} list of inverted colors.</font></i>

  <b><font color=#3a6797>set</font></b> c [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$r</font>&lt;100 && <font color=#1b1baa>$g</font>&lt;100 || <font color=#1b1baa>$r</font>&lt;100 && <font color=#1b1baa>$b</font>&lt;100 || <font color=#1b1baa>$b</font>&lt;100 && <font color=#1b1baa>$g</font>&lt;100 ||
    (<font color=#1b1baa>$r</font>+<font color=#1b1baa>$g</font>+<font color=#1b1baa>$b</font>)&lt;300 ? 255 : 0}]
  <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$c</font> <font color=#1b1baa>$c</font> <font color=#1b1baa>$c</font>]
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::IsCapture'>IsCapture</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Checks if the image was captured.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>IsCapture</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_IsCapture' href="javascript:toggleSource('aloupe_my_IsCapture')">Show source</a></p>
<div id='aloupe_my_IsCapture' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::IsCapture {} {
  <i><font color=#4b5d50># Checks if the image was captured.</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$data(CAPTURE)</font> eq <font color=#8b2a0e>&quot;&quot;</font>} {
    Message <font color=#6c3e67>-title</font> [msgcat::mc {Color of Image}] <font color=#6c3e67>-icon</font> warning  <font color=#6c3e67>-message</font>  [msgcat::mc <font color=#8b2a0e>&quot;Click, then drag and drop\nthe loupe to get the image.&quot;</font>]
    <b><font color=#ca14ca>return</font></b> no
  }
  <b><font color=#ca14ca>return</font></b> yes
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::Message'>Message</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Displays a message, with the loupe hidden.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Message</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>args</code></code></td><td class='ruff_defitem'>Optional arguments.</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_Message' href="javascript:toggleSource('aloupe_my_Message')">Show source</a></p>
<div id='aloupe_my_Message' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::Message {args} {
  <i><font color=#4b5d50># Displays a message, with the loupe hidden.</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#134070>wm</font></b> withdraw <font color=#1b1baa>$data(WLOUP)</font>
  <b><font color=#134070>tk_messageBox</font></b> <font color=#6c3e67>-parent</font> <font color=#1b1baa>$data(WDISP)</font> <font color=#6c3e67>-type</font> ok {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
  <b><font color=#134070>wm</font></b> deiconify <font color=#1b1baa>$data(WLOUP)</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::PickColor'>PickColor</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets the image color under the mouse pointer.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>PickColor</span> <span class='ruff_arg'>w X Y</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>w</code></code></td><td class='ruff_defitem'>the image label's path</td></tr>
<tr><td class='ruff_defitem'><code><code>X</code></code></td><td class='ruff_defitem'>X-coordinate of the mouse pointer</td></tr>
<tr><td class='ruff_defitem'><code><code>Y</code></code></td><td class='ruff_defitem'>Y-coordinate of the mouse pointer</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_PickColor' href="javascript:toggleSource('aloupe_my_PickColor')">Show source</a></p>
<div id='aloupe_my_PickColor' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::PickColor {w X Y} {
  <i><font color=#4b5d50># Gets the image color under the mouse pointer.</font></i>
  <i><font color=#4b5d50>#   w - the image label's path</font></i>
  <i><font color=#4b5d50>#   X - X-coordinate of the mouse pointer</font></i>
  <i><font color=#4b5d50>#   Y - Y-coordinate of the mouse pointer</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>if</font></b> {![IsCapture]} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>set</font></b> x [<b><font color=#3a6797>expr</font></b> {max((<font color=#1b1baa>$X</font> - [<b><font color=#134070>winfo</font></b> rootx <font color=#1b1baa>$w</font>] -4),0)}]
  <b><font color=#3a6797>set</font></b> y [<b><font color=#3a6797>expr</font></b> {max((<font color=#1b1baa>$Y</font> - [<b><font color=#134070>winfo</font></b> rooty <font color=#1b1baa>$w</font>] -4),0)}]
  <b><font color=#3a6797>catch</font></b> {
    <b><font color=#3a6797>lassign</font></b> [<font color=#1b1baa>$data(IMAGE)</font> get <font color=#1b1baa>$x</font> <font color=#1b1baa>$y</font>] r g b
    <b><font color=#3a6797>set</font></b> data(COLOR) [<b><font color=#3a6797>format</font></b> <font color=#8b2a0e>&quot;#%02x%02x%02x&quot;</font> <font color=#1b1baa>$r</font> <font color=#1b1baa>$g</font> <font color=#1b1baa>$b</font>]
    <b><font color=#3a6797>set</font></b> data(INVCOLOR) [<b><font color=#3a6797>format</font></b> <font color=#8b2a0e>&quot;#%02x%02x%02x&quot;</font> {<b><font color=#3a6797>*</font></b>}[InvertBg <font color=#1b1baa>$r</font> <font color=#1b1baa>$g</font> <font color=#1b1baa>$b</font>]]
    HandleColor no
    <b><font color=#3a6797>set</font></b> msec [<b><font color=#3a6797>clock</font></b> milliseconds]
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> exists data(MSEC)] && [<b><font color=#3a6797>expr</font></b> {(<font color=#1b1baa>$msec</font>-<font color=#1b1baa>$data(MSEC)</font>)&lt;400}]} {
      Button2Click
    }
    <b><font color=#3a6797>set</font></b> data(MSEC) <font color=#1b1baa>$msec</font>
  }
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::RestoreOptions'>RestoreOptions</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Restores options of appearance from a file.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>RestoreOptions</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_RestoreOptions' href="javascript:toggleSource('aloupe_my_RestoreOptions')">Show source</a></p>
<div id='aloupe_my_RestoreOptions' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::RestoreOptions {} {
  <i><font color=#4b5d50># Restores options of appearance from a file.</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$data(-save)</font>} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$data(-inifile)</font>]} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>set</font></b> chan [<b><font color=#3a6797>open</font></b> <font color=#1b1baa>$data(-inifile)</font>]
  <b><font color=#3a6797>set</font></b> data(CONFIG) [<b><font color=#3a6797>read</font></b> <font color=#1b1baa>$chan</font>]
  <b><font color=#3a6797>close</font></b> <font color=#1b1baa>$chan</font>
  <b><font color=#3a6797>set</font></b> svd <font color=#1b1baa>$data(DEFAULTS)</font>
  <b><font color=#3a6797>foreach</font></b> line [<b><font color=#3a6797>split</font></b> <font color=#1b1baa>$data(CONFIG)</font> \n] {
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> match <font color=#8b2a0e>&quot;*=*&quot;</font> <font color=#1b1baa>$line</font>]} {
      <b><font color=#3a6797>set</font></b> opt -[<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$line</font> 0 [<b><font color=#3a6797>string</font></b> first = <font color=#1b1baa>$line</font>]-1]
      <b><font color=#3a6797>set</font></b> val [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$line</font> [<b><font color=#3a6797>string</font></b> length <font color=#1b1baa>$opt</font>] end]
      <b><font color=#3a6797>set</font></b> <font color=#1b1baa>${svd}</font>(<font color=#1b1baa>$opt</font>) [<b><font color=#3a6797>set</font></b> data(<font color=#1b1baa>$opt</font>) <font color=#1b1baa>$val</font>]
    }
  }
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::Save'>Save</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Saves the magnified image to a file.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Save</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_Save' href="javascript:toggleSource('aloupe_my_Save')">Show source</a></p>
<div id='aloupe_my_Save' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::Save {} {
  <i><font color=#4b5d50># Saves the magnified image to a file.</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>if</font></b> {![IsCapture]} <b><font color=#ca14ca>return</font></b>
  <b><font color=#134070>wm</font></b> withdraw <font color=#1b1baa>$data(WLOUP)</font>
  <b><font color=#3a6797>set</font></b> filetypes { {<font color=#8b2a0e>&quot;PNG Images&quot;</font> .png} {<font color=#8b2a0e>&quot;All Image Files&quot;</font> {.png .gif}} }
  <b><font color=#3a6797>set</font></b> file [<b><font color=#3a6797>file</font></b> tail <font color=#1b1baa>$::aloupe::filename</font>]
  <b><font color=#3a6797>set</font></b> argl [<b><font color=#3a6797>list</font></b> <font color=#6c3e67>-parent</font> <font color=#1b1baa>$data(WDISP)</font> <font color=#6c3e67>-title</font> [::msgcat::mc <font color=#8b2a0e>&quot;Save the Loupe&quot;</font>]  <font color=#6c3e67>-filetypes</font> <font color=#1b1baa>$filetypes</font> <font color=#6c3e67>-defaultextension</font> .png <font color=#6c3e67>-initialfile</font> <font color=#1b1baa>$file</font>]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$data(-fcgeom)</font> ne {}} {
    <b><font color=#3a6797>set</font></b> file [::apave::obj chooser tk_getSaveFile ::aloupe::filename {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$argl</font>]
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>catch</font></b> {::apave::obj themeExternal <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>data(WLOUP)*&quot;</font>}  ;<i><font color=#4b5d50># theme the file chooser</font></i>
    <b><font color=#3a6797>set</font></b> file [<b><font color=#134070>tk_getSaveFile</font></b> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$argl</font>]
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$file</font> ne <font color=#8b2a0e>&quot;&quot;</font>} {
    <b><font color=#3a6797>set</font></b> ::aloupe::filename <font color=#1b1baa>$file</font>
    <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>regexp</font></b> <font color=#6c3e67>-nocase</font> {\.(png|gif)$} <font color=#1b1baa>$file</font> -&gt; ext]} {
      <b><font color=#3a6797>set</font></b> ext <font color=#8b2a0e>&quot;png&quot;</font>
      <b><font color=#3a6797>append</font></b> file <font color=#8b2a0e>&quot;.<font color=#1b1baa>${</font>ext<font color=#1b1baa>}</font>&quot;</font>
    }
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<font color=#1b1baa>$data(IMAGE)</font> write <font color=#1b1baa>$file</font> <font color=#6c3e67>-format</font> [<b><font color=#3a6797>string</font></b> tolower <font color=#1b1baa>$ext</font>]} err]} {
      Message <font color=#6c3e67>-title</font> <font color=#8b2a0e>&quot;Error Writing File&quot;</font> <font color=#6c3e67>-icon</font> error  <font color=#6c3e67>-message</font> <font color=#8b2a0e>&quot;Error writing to file \&quot;<font color=#1b1baa>$</font>file\&quot;:\n<font color=#1b1baa>$</font>err&quot;</font>
    }
  }
  ShowLoupe
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::SaveGeometry'>SaveGeometry</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Saves the displaying window's geometry.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>SaveGeometry</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_SaveGeometry' href="javascript:toggleSource('aloupe_my_SaveGeometry')">Show source</a></p>
<div id='aloupe_my_SaveGeometry' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::SaveGeometry {} {
  <i><font color=#4b5d50># Saves the displaying window's geometry.</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>set</font></b> data(-geometry) <font color=#8b2a0e>&quot;&quot;</font>
  <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> data(-geometry) [<b><font color=#134070>wm</font></b> geometry <font color=#1b1baa>$data(WDISP)</font>]}
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::SaveOptions'>SaveOptions</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Saves options of appearance to a file.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>SaveOptions</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_SaveOptions' href="javascript:toggleSource('aloupe_my_SaveOptions')">Show source</a></p>
<div id='aloupe_my_SaveOptions' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::SaveOptions {} {
  <i><font color=#4b5d50># Saves options of appearance to a file.</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>variable</font></b> size
  <b><font color=#3a6797>variable</font></b> zoom
  <b><font color=#3a6797>variable</font></b> pause
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$data(-save)</font>} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>set</font></b> data(-size) <font color=#1b1baa>$size</font>
  <b><font color=#3a6797>set</font></b> data(-zoom) <font color=#1b1baa>$zoom</font>
  <b><font color=#3a6797>set</font></b> data(-pause) <font color=#1b1baa>$pause</font>
  <b><font color=#3a6797>set</font></b> w <font color=#1b1baa>$data(WDISP)</font>
  <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>file</font></b> mkdir [<b><font color=#3a6797>file</font></b> dirname <font color=#1b1baa>$data(-inifile)</font>]}
  <b><font color=#3a6797>catch</font></b> {
    <b><font color=#3a6797>append</font></b> opts {[<b><font color=#134070>options</font></b>]} \n
    <b><font color=#3a6797>foreach</font></b> opt [<b><font color=#3a6797>array</font></b> names data] {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$opt</font> in {<font color=#6c3e67>-size</font> <font color=#6c3e67>-geometry</font> <font color=#6c3e67>-background</font> <font color=#6c3e67>-zoom</font> <font color=#6c3e67>-pause</font> <font color=#6c3e67>-alpha</font> <font color=#6c3e67>-ontop</font>}} {
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$opt</font> eq <font color=#8b2a0e>&quot;-geometry&quot;</font>} {
          <b><font color=#3a6797>set</font></b> val [<b><font color=#134070>wm</font></b> geometry <font color=#1b1baa>$w</font>]
        } <b><font color=#3a6797>else</font></b> {
          <b><font color=#3a6797>set</font></b> val <font color=#1b1baa>$data($opt)</font>
        }
        <b><font color=#3a6797>append</font></b> opts <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>string range <font color=#1b1baa>$</font>opt 1 end<font color=#1b1baa>]</font>=<font color=#1b1baa>$</font>val&quot;</font> \n
      }
    }
    <b><font color=#3a6797>set</font></b> chan [<b><font color=#3a6797>open</font></b> <font color=#1b1baa>$data(-inifile)</font> w]
    <b><font color=#3a6797>puts</font></b> <font color=#6c3e67>-nonewline</font> <font color=#1b1baa>$chan</font> <font color=#1b1baa>$opts</font>
    <b><font color=#3a6797>close</font></b> <font color=#1b1baa>$chan</font>
  }
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::ShowLoupe'>ShowLoupe</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Re-displays the loupe at changing its size.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>ShowLoupe</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_ShowLoupe' href="javascript:toggleSource('aloupe_my_ShowLoupe')">Show source</a></p>
<div id='aloupe_my_ShowLoupe' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::ShowLoupe {} {
  <i><font color=#4b5d50># Re-displays the loupe at changing its size.</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>variable</font></b> size
  <b><font color=#3a6797>set</font></b> data(-size) <font color=#1b1baa>$size</font>
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#3a6797>split</font></b> [<b><font color=#134070>wm</font></b> geometry <font color=#1b1baa>$data(WLOUP)</font>] +] -&gt; x y
  <b><font color=#3a6797>set</font></b> sz [<b><font color=#3a6797>expr</font></b> {2*<font color=#1b1baa>$size</font>}]
  <b><font color=#134070>destroy</font></b> <font color=#1b1baa>$data(WLOUP)</font>
  CreateLoupe <font color=#1b1baa>${sz}</font>x<font color=#1b1baa>${sz}</font>+<font color=#1b1baa>$x</font>+<font color=#1b1baa>$y</font>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::StyleButton2'>StyleButton2</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Makes a style for Tbutton.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>StyleButton2</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>args</code></code></td><td class='ruff_defitem'>options (&quot;name value&quot; pairs)</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns the TButton's configuration options.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_StyleButton2' href="javascript:toggleSource('aloupe_my_StyleButton2')">Show source</a></p>
<div id='aloupe_my_StyleButton2' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::StyleButton2 {args} {
  <i><font color=#4b5d50># Makes a style for Tbutton.</font></i>
  <i><font color=#4b5d50>#   args - options (&quot;name value&quot; pairs)</font></i>
  <i><font color=#4b5d50># Returns the TButton's configuration options.</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>dict</font></b> exists <font color=#1b1baa>$args</font> <font color=#6c3e67>-text</font>]} {
    <font color=#1b1baa>$data(BUT2)</font> configure <font color=#6c3e67>-text</font> [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$args</font> <font color=#6c3e67>-text</font>]
    <b><font color=#3a6797>set</font></b> args [<b><font color=#3a6797>dict</font></b> remove <font color=#1b1baa>$args</font> <font color=#6c3e67>-text</font>]
  }
  <b><font color=#3a6797>set</font></b> fg [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$args</font> <font color=#6c3e67>-foreground</font>]
  <b><font color=#3a6797>set</font></b> bg [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$args</font> <font color=#6c3e67>-background</font>]
  <font color=#1b1baa>$data(BUT2)</font> configure <font color=#6c3e67>-foreground</font> <font color=#1b1baa>$fg</font> <font color=#6c3e67>-background</font> <font color=#1b1baa>$bg</font>
  <b><font color=#ca14ca>return</font></b> {}
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::Synopsis'>Synopsis</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Short info about usage.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Synopsis</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_Synopsis' href="javascript:toggleSource('aloupe_my_Synopsis')">Show source</a></p>
<div id='aloupe_my_Synopsis' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::Synopsis {} {
  <i><font color=#4b5d50># Short info about usage.</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot;</font>
<font color=#8b2a0e>Syntax:</font>
<font color=#8b2a0e>  tclsh aloupe.tcl ?option value ...?</font>
<font color=#8b2a0e>where 'option' may be <font color=#1b1baa>[</font>array names <font color=#1b1baa>$</font>data(DEFAULTS)<font color=#1b1baa>]</font>.</font>
<font color=#8b2a0e>&quot;</font>
  <b><font color=#3a6797>exit</font></b>
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::aloupe::my::Theme'>Theme</a><span class='ns_scope'> [<a href="aloupe.html#::aloupe::my" title="::aloupe::my" class='ruff_cmd'>::aloupe::my</a>]</span><span class='tinylink'><a href='aloupe.html#::aloupe::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Themes the utility</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Theme</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_aloupe_my_Theme' href="javascript:toggleSource('aloupe_my_Theme')">Show source</a></p>
<div id='aloupe_my_Theme' class='ruff_dyn_src'><pre><br><code class="tcl"><b><font color=#ca14ca>proc</font></b> ::aloupe::my::Theme {} {
  <i><font color=#4b5d50># Themes the utility</font></i>

  <b><font color=#3a6797>variable</font></b> data
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$data(-apavedir)</font> eq {}} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$data(-apavedir)</font> apave.tcl]
  ::apave::initWM <font color=#6c3e67>-cs</font> <font color=#1b1baa>$data(-cs)</font> <font color=#6c3e67>-theme</font> alt
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$data(-fcgeom)</font> ne {}} {
    ::apave::obj chooserGeomVars {} ::aloupe::my::data(-fcgeom)
  }
}<br><br></code></pre></div>
</div></div></div><div class='yui-b navbox' ><h1><a href='#::aloupe'>aloupe</a></h1><h2><a href='#::aloupe-Usage'>Usage</a></h2><h2><a href='#::aloupe-Options'>Options</a></h2><h2><a href='#::aloupe-Links'>Links</a></h2><h2><a href='#::aloupe-License'>License</a></h2><h2><a href='#::aloupe-Commands'>Commands</a></h2><h4 class='tooltip'><a href='aloupe.html#::aloupe::option'>option</a><span class='tooltiptext'>Returns a value of aloupe option.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::run'>run</a><span class='tooltiptext'>Runs the loupe.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::RunSolo'>RunSolo</a><span class='tooltiptext'>Runs aloupe as a sole Tcl script. When aloupe runs from tclkit, it may fail. So try it with tclsh deployed.
</span></h4><h1><a href='#::aloupe::my'>aloupe::my</a></h1><h2><a href='#::aloupe::my-Commands'>Commands</a></h2><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::Button2Click'>Button2Click</a><span class='tooltiptext'>Processes the click on 'Clipboard' button.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::CountDownPause'>CountDownPause</a><span class='tooltiptext'>Counts down a pause.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::Create'>Create</a><span class='tooltiptext'>Initializes and creates the utility's windows.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::CreateDisplay'>CreateDisplay</a><span class='tooltiptext'>Creates the displaying window.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::CreateLoupe'>CreateLoupe</a><span class='tooltiptext'>Creates the loupe window.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::DisplayImage'>DisplayImage</a><span class='tooltiptext'>Ends the frag-and-drop of the loupe and displays its magnified image.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::Drag'>Drag</a><span class='tooltiptext'>Performs the frag-and-drop of the loupe.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::DragEnd'>DragEnd</a><span class='tooltiptext'>Ends the frag-and-drop of the loupe and displays its magnified image.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::DragStart'>DragStart</a><span class='tooltiptext'>Initializes the frag-and-drop of the loupe.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::Exit'>Exit</a><span class='tooltiptext'>Clears all and exits.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::HandleColor'>HandleColor</a><span class='tooltiptext'>Processes the image color under the mouse pointer, optionally saving it to the clipboard.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::InitGeometry'>InitGeometry</a><span class='tooltiptext'>Gets and sets the geometry of the loupe window, based on the image label's sizes and the zoom factor.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::InvertBg'>InvertBg</a><span class='tooltiptext'>Inverts colors from light to dark and vice versa to get &quot;fg&quot; from &quot;bg&quot;. It's simplified way, just to not include the bulky HSV code.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::IsCapture'>IsCapture</a><span class='tooltiptext'>Checks if the image was captured.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::Message'>Message</a><span class='tooltiptext'>Displays a message, with the loupe hidden.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::PickColor'>PickColor</a><span class='tooltiptext'>Gets the image color under the mouse pointer.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::RestoreOptions'>RestoreOptions</a><span class='tooltiptext'>Restores options of appearance from a file.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::Save'>Save</a><span class='tooltiptext'>Saves the magnified image to a file.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::SaveGeometry'>SaveGeometry</a><span class='tooltiptext'>Saves the displaying window's geometry.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::SaveOptions'>SaveOptions</a><span class='tooltiptext'>Saves options of appearance to a file.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::ShowLoupe'>ShowLoupe</a><span class='tooltiptext'>Re-displays the loupe at changing its size.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::StyleButton2'>StyleButton2</a><span class='tooltiptext'>Makes a style for Tbutton.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::Synopsis'>Synopsis</a><span class='tooltiptext'>Short info about usage.
</span></h4><h4 class='tooltip'><a href='aloupe.html#::aloupe::my::Theme'>Theme</a><span class='tooltiptext'>Themes the utility
</span></h4></div></div><div id='ft'><div style='float: right;'>Document generated by <a href='https://ruff.magicsplat.com'>Ruff!</a></div></div>
</div></body></html>
