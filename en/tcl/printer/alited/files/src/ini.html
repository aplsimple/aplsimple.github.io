<!DOCTYPE html><html><head><meta charset="utf-8"/>
<meta name="author" content="aplsimple">
<meta name="description" content="aplsimple's home page">
<meta name="keywords" content="aplsimple,home">
</head>
<style>
table{
background-color: #f9f9f9;
margin: 0%;
margin-bottom: 2%;
padding: 0%;
box-shadow: none;
filter: none;
}
pre{
margin: 0%;
margin-bottom: 2%;
padding: 0%;
}
</style>
<script>
function homeLINK() {
  homelink = document.baseURI;
  ilen = 19
  ibase = homelink.indexOf('aplsimple.github');
  if (ibase<0) { ibase = homelink.indexOf('aplsimple_github'); ilen += 10 };
  if (ibase>=0) { homelink = homelink.substring(0,ibase+ilen) };
  return homelink;
};
document.write(' \
<link rel="stylesheet" href="'+homeLINK()+'/en/tcl/printer/zoo/style.css">');
document.write(' \
<link rel="icon" type="image/jpg" href="'+homeLINK()+'/zoo/favicon.jpg">');
document.write('<'+'script src="'+homeLINK()+'/zoo/funcs.js">'+'<'+'/script>');
document.write('<'+'script src="'+homeLINK()+'/en/tcl/printer/zoo/this.js">'+'<'+'/script>');
</script>
<body>
<div id="wrapper">
<div name="divd1" ALIGN="CENTER"> <FONT SIZE=5em color=#b01c20><B>
<noscript>THIS PAGE IS NOT WORKING WITHOUT JAVASCRIPT!
<BR>
<BR>PLEASE, SWITCH ON JAVASCRIPT IN SETTINGS OF YOUR BROWSER AND RELOAD THE PAGE.
</noscript>
</B></FONT></div>
<div id='doc3' class='yui-t2'>
<section id=sec2>
<div id='hd' class='banner'>

<title>ini.tcl</title>

<table border=0 cellPadding=4 cellSpacing=0 width=100%>  <td border=0 bgColor=#bdd7e7><div style=text-align:center>  <a href="../../index.html"><font color=#1a1a1a size=6>  <b>README.md</b></font></div></td></table>

<div id="bodyContent" class="dokuwiki">
<div id="dw__toc" class="dw__toc">
<h3 class="toggle open" style="cursor: pointer;">ini.tcl</h3>
<div aria-expanded="true" style="">

<ul class="toc">
<li><b><a href="#ini.tcl">ini.tcl</a></b></li>
<li><b><a href="#Default_settings_of_alited_app">Default settings of alited app</a></b></li>
<li><b><a href="#Variables">Variables</a></b></li>
<li><b><a href="#Reading_common_settings">Reading common settings</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#ini::ReadIni">ReadIni</a><span class=tooltiptext> ini::ReadIni : Reads alited application's and project's settings.
projectfile - project file's name</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ReadIniGeometry">ReadIniGeometry</a><span class=tooltiptext> ini::ReadIniGeometry : Gets the geometry options of alited.
nam - name of option
val - value of option</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ReadIniOptions">ReadIniOptions</a><span class=tooltiptext> ini::ReadIniOptions : Gets various options of alited.
nam - name of option
val - value of option</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ReadIniTemplates">ReadIniTemplates</a><span class=tooltiptext> ini::ReadIniTemplates : Sets new or updates old templates.
nam - name of option
val - value of option
updwc - if yes, sets wild cards for templates</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ReadIniKeys">ReadIniKeys</a><span class=tooltiptext> ini::ReadIniKeys : Gets keys options of alited.
nam - name of option
val - value of option</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ReadIniEM">ReadIniEM</a><span class=tooltiptext> ini::ReadIniEM : Gets e_menu options of alited.
nam - name of option
val - value of option
emiName - name of em_i (index in arrays of e_menu data)</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ReadIniTkcon">ReadIniTkcon</a><span class=tooltiptext> ini::ReadIniTkcon : Gets tkcon options of alited.
nam - name of option
val - value of option</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ReadIniMisc">ReadIniMisc</a><span class=tooltiptext> ini::ReadIniMisc : Gets miscellaneous options of alited.
nam - name of option
val - value of option</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ReadIniFormats">ReadIniFormats</a><span class=tooltiptext> ini::ReadIniFormats : Gets pluginable formatters of alited.
nam - name of option
val - value of option</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::Em_Number">Em_Number</a><span class=tooltiptext> ini::Em_Number : Gets a real number of e_menu items counting non-empty ones only.
em_N - current number of e_menu items</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::InitXterminal">InitXterminal</a><span class=tooltiptext> ini::InitXterminal : Gets Linux terminal called by x-terminal-emulator, saves the result to al(EM,tt).
See also: tool::EM_Options</span></div></li></ul>
<li><b><a href="#Reading_project_settings">Reading project settings</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#ini::ReadIniPrj">ReadIniPrj</a><span class=tooltiptext> ini::ReadIniPrj : Reads a project's settings.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ReadPrjTabs">ReadPrjTabs</a><span class=tooltiptext> ini::ReadPrjTabs : Gets tabs of project.
nam - name of option
val - value of option</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ReadPrjOptions">ReadPrjOptions</a><span class=tooltiptext> ini::ReadPrjOptions : Gets options of project.
nam - name of option
val - value of option</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ReadPrjFavorites">ReadPrjFavorites</a><span class=tooltiptext> ini::ReadPrjFavorites : Gets favorites of project.
nam - name of option
val - value of option</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ReadPrjMisc">ReadPrjMisc</a><span class=tooltiptext> ini::ReadPrjMisc : Gets favorites of project.
nam - name of option
val - value of option</span></div></li></ul>
<li><b><a href="#Saving_settings">Saving settings</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#ini::SaveCurrentIni">SaveCurrentIni</a><span class=tooltiptext> ini::SaveCurrentIni : Saves a current configuration of alited on various events.
saveon - flag "save on event"
doit - serves to run this procedure after idle
See also: project::Ok</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::SaveIni">SaveIni</a><span class=tooltiptext> ini::SaveIni : Saves a current configuration of alited.
newproject - flag "for a new project"</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::SaveIniPrj">SaveIniPrj</a><span class=tooltiptext> ini::SaveIniPrj : Saves settings of project.
newproject - flag "for a new project"</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::SaveIniGlob">SaveIniGlob</a><span class=tooltiptext> ini::SaveIniGlob : Save 3 lines of global configuration of alited:
current .ini file, current project's path, list of config dirs</span></div></li></ul>
<li><b><a href="#Updating_alited's_data">Updating alited's data</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#ini::AlitedVersion">AlitedVersion</a><span class=tooltiptext> ini::AlitedVersion : Gets current version of alited.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ViewUpdates">ViewUpdates</a><span class=tooltiptext> ini::ViewUpdates : Views changes for updating.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::UpdateTemplates">UpdateTemplates</a><span class=tooltiptext> ini::UpdateTemplates : Updates templates.
inideffile - ini file name of default templates</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::CheckUpdates">CheckUpdates</a><span class=tooltiptext> ini::CheckUpdates : Updates significant data of current version of alited.
doit - yes, if it's called from menu</span></div></li></ul>
<li><b><a href="#Configuring_alited">Configuring alited</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#ini::GetConfiguration">GetConfiguration</a><span class=tooltiptext> ini::GetConfiguration : Gets the configuration directory's name.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::AddConfigDir">AddConfigDir</a><span class=tooltiptext> ini::AddConfigDir : Adds a config directory to the list of all config dirs.
confdir - config directory
configs - list of config dirs
Returns -1, if *confdir* was absent in *configs*.</span></div></li></ul>
<li><b><a href="#Initializing_alited_app">Initializing alited app</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#ini::CheckIni">CheckIni</a><span class=tooltiptext> ini::CheckIni : Checks if the configuration directory exists and if not asks for it.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::GetUserDirs">GetUserDirs</a><span class=tooltiptext> ini::GetUserDirs : Gets names of user directories for settings.
initmnu - yes, if called to initialize mnu dir</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::CreateUserDirs">CreateUserDirs</a><span class=tooltiptext> ini::CreateUserDirs : Creates main directories for settings.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::CreateMacrosDir">CreateMacrosDir</a><span class=tooltiptext> ini::CreateMacrosDir : Creates macros' directory.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::CreatePossibleNewDirs">CreatePossibleNewDirs</a><span class=tooltiptext> ini::CreatePossibleNewDirs : Creates a user directories, possibly new after v1.4.0 (e.g. macro).</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::CreateIcon">CreateIcon</a><span class=tooltiptext> ini::CreateIcon : Create an icon (of normal and big size).
icon - name of icon</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::EditSettings">EditSettings</a><span class=tooltiptext> ini::EditSettings : Displays the settings file, just to look behind the wall.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::HighlightFileText">HighlightFileText</a><span class=tooltiptext> ini::HighlightFileText : Highlights a text of a file.
wtxt - the text's path
fname - the file name (extension)
ro - flag "readonly text"
args - additional options</span></div></li></ul>
<li><b><a href="#Main_(+_tool_bar)">Main (+ tool bar)</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#ini::InitGUI">InitGUI</a><span class=tooltiptext> ini::InitGUI : Initializes GUI.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::InitFonts">InitFonts</a><span class=tooltiptext> ini::InitFonts : Loads main fonts for alited to use as default and mono.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::initStyles">initStyles</a><span class=tooltiptext> ini::initStyles : Initializes widget styles for alited.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::TipToolHotkeys">TipToolHotkeys</a><span class=tooltiptext> ini::TipToolHotkeys : Adds hotkeys to toolbar tips.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::_init">_init</a><span class=tooltiptext> ini::_init : Initializes alited app.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ToolbarTip">ToolbarTip</a><span class=tooltiptext> ini::ToolbarTip : Gets a toolbar button's tip, mapping %f / %D to a current file / directory.
i - index of e_menu item</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::Help">Help</a><span class=tooltiptext> ini::Help : Shows "Configurations" help.</span></div></li></ul>
<li><b><a href="#Projects'_toolbar">Projects' toolbar</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#ini::ProjectsToolbar">ProjectsToolbar</a><span class=tooltiptext> ini::ProjectsToolbar : Tool bar for Projects (subset of main toolbar).
See also: _init, project::Tab5</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::TooltipPrjRun">TooltipPrjRun</a><span class=tooltiptext> ini::TooltipPrjRun : Gets a tip for "Projects' Run" tool.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ToolPrjRun">ToolPrjRun</a><span class=tooltiptext> ini::ToolPrjRun : Runs current file from toolbar.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ToolPrjEM">ToolPrjEM</a><span class=tooltiptext> ini::ToolPrjEM : Calls e_menu from toolbar.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ToolPrjTkcon">ToolPrjTkcon</a><span class=tooltiptext> ini::ToolPrjTkcon : Runs tkcon from toolbar.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ToolPrjFilename">ToolPrjFilename</a><span class=tooltiptext> ini::ToolPrjFilename : Gets file name of current file.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ToolPrjDirname">ToolPrjDirname</a><span class=tooltiptext> ini::ToolPrjDirname : Gets dir name of current file.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ToolPrjTip">ToolPrjTip</a><span class=tooltiptext> ini::ToolPrjTip : Gets a toolbar button's tip, mapping %f / %D to a current file / directory.
i - index of e_menu item</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ToolPrjCommand">ToolPrjCommand</a><span class=tooltiptext> ini::ToolPrjCommand : Executes project toolbar's command.
im - index in toolbar</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ini::ToolByKey">ToolByKey</a><span class=tooltiptext> ini::ToolByKey : Runs a command after its hot key pressing in f5 tab of Projects.
nbk - notebook's path
com - command
See also: project::_create</span></div></li></ul>
<li><b><a href="#EOF">EOF</a></b></li>

</ul>

</div>
</div>
</div>
<!-- TOC END -->

<h1><font color=#ca14ca> alited's source</font></h1>
</p><p>
The <a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/about.html">alited/src</a> directory contains alited's own source files.
</p><p>
Some additional alited's files are also contained in <a href="https://aplsimple.github.io/en/tcl/printer/alited/files/lib/addon/hl_alm.html">alited/lib/addon</a> directory (<i><font color=#1b1baa>alited/lib</font></i> directory contains all library files).
</p><p>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/about.html">about.tcl</a> - "About alited" dialogue.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/alited.html">alited.tcl</a> - The alited's main script to start.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/bar.html">bar.tcl</a> - Handles the bar of tabs.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/check.html">check.tcl</a> - "Check Tcl" dialogue and procedures.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/complete.html">complete.tcl</a> - Handles auto-completion.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/edit.html">edit.tcl</a> - "Edit" menu's procedures.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/favor.html">favor.tcl</a> - Handles the favorite and last visited units.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/favor_ls.html">favor_ls.tcl</a> - "Saved lists of favorites" dialogue and procedures.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/file.html">file.tcl</a> - "File" menu's procedures.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/find.html">find.tcl</a> - "Find / Replace" dialogue and procedures.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/format.html">format.tcl</a> - "Edit / Formats" menu's procedures.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/img.html">img.tcl</a> - List of images used by alited.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/indent.html">indent.tcl</a> - Handles text indentation.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/info.html">info.tcl</a> - Handles the info bar.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/ini.html">ini.tcl</a> - Handles initializing alited.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/keys.html">keys.tcl</a> - Handles keyboard (mapping etc.).</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/main.html">main.tcl</a> - Handles the main form of alited.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/menu.html">menu.tcl</a> - Handles alited's menus.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/msgs.html">msgs.tcl</a> - Localized messages used in several places.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/paver.html">paver.tcl</a> - "Tools / Paver" tool.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/pkgIndex.html">pkgIndex.tcl</a> - Includes README.md text (for Ruff doc generator).</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/pref.html">pref.tcl</a> - "Preferences" dialogue and procedures.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/preview.html">preview.tcl</a> - "Preview (theme, CS)" dialogue called by "Preferences".</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/printer.html">printer.tcl</a> - "Tools / Project Printer" dialogue and procedures.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/project.html">project.tcl</a> - "Projects" dialogue and procedures.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/run.html">run.tcl</a> - "Tools / Run..." dialogue and procedures.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/todolist.html">todolist.tcl</a> - Handles pending TODOs of Projects dialogue.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/tool.html">tool.tcl</a> - "Tools" menu's procedures.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/tree.html">tree.tcl</a> - Handles the tree of units and files.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/unit.html">unit.tcl</a> - Handles the unit tree.</li>
<li><a href="https://aplsimple.github.io/en/tcl/printer/alited/files/src/unit_tpl.html">unit_tpl.tcl</a> - "Templates" dialogue and procedures.</li>
</p><p>

</p>

<table border=0 cellPadding=4 cellSpacing=0 width=100%>  <td border=0 bgColor=#bdd7e7><div style=text-align:center>  <a href="../../index.html"><font color=#1a1a1a size=6>  <b>ini.tcl</b></font></div></td></table>

<pre class="code"><i><font color=#4b5d50>###########################################################<a id=ini.tcl></a></font></i>
<i><font color=#4b5d50># Name:    ini.tcl</font></i>
<i><font color=#4b5d50># Author:  Alex Plotnikov  (aplsimple@gmail.com)</font></i>
<i><font color=#4b5d50># Date:    06/30/2021</font></i>
<i><font color=#4b5d50># Brief:   Handles settings (of alited and projects).</font></i>
<i><font color=#4b5d50># License: MIT.</font></i>
<i><font color=#4b5d50>###########################################################</font></i>
<a id=Default_settings_of_alited_app></a>
<i><font color=#4b5d50># ___________ Default settings of alited app ____________ #</font></i>

<b><font color=#ca14ca>namespace</font></b> eval ::alited {

  <b><font color=#3a6797>set</font></b> al(MAXFILES) 5000     ;<i><font color=#4b5d50># maximum size of file tree (max size of project)</font></i>
  <b><font color=#3a6797>set</font></b> al(ED,sp1) 0          ;<i><font color=#4b5d50># -spacing1 option of texts</font></i>
  <b><font color=#3a6797>set</font></b> al(ED,sp2) 1          ;<i><font color=#4b5d50># -spacing2 option of texts</font></i>
  <b><font color=#3a6797>set</font></b> al(ED,sp3) 1          ;<i><font color=#4b5d50># -spacing3 option of texts</font></i>
  <b><font color=#3a6797>set</font></b> al(ED,TclKeyWords) {} ;<i><font color=#4b5d50># user's key words for Tcl</font></i>
  <b><font color=#3a6797>set</font></b> al(ED,CKeyWords) {}   ;<i><font color=#4b5d50># user's key words for C/C++</font></i>
  <b><font color=#3a6797>set</font></b> al(ED,gutterwidth) 5  ;<i><font color=#4b5d50># gutter's windth in chars</font></i>
  <b><font color=#3a6797>set</font></b> al(ED,guttershift) 3  ;<i><font color=#4b5d50># space between gutter and text</font></i>
  <b><font color=#3a6797>set</font></b> al(ED,btsbd) 0        ;<i><font color=#4b5d50># borderwidth for bartabs</font></i>
  <b><font color=#3a6797>set</font></b> al(ED,BlinkCurs) 1    ;<i><font color=#4b5d50># blinking cursor</font></i>
  <b><font color=#3a6797>set</font></b> al(TREE,isunits) yes  ;<i><font color=#4b5d50># current mode of tree: units/files</font></i>
  <b><font color=#3a6797>set</font></b> al(TREE,units) no     ;<i><font color=#4b5d50># flag &quot;is a unit tree created&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(TREE,files) no     ;<i><font color=#4b5d50># flag &quot;is a file tree created&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(TREE,cw0) 200      ;<i><font color=#4b5d50># tree column #0 width</font></i>
  <b><font color=#3a6797>set</font></b> al(TREE,cw1) 70       ;<i><font color=#4b5d50># tree column #1 width</font></i>
  <b><font color=#3a6797>set</font></b> al(TREE,showinfo) 0   ;<i><font color=#4b5d50># flag &quot;show info on a file in tips&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(expandUT) [<b><font color=#3a6797>dict</font></b> create] ;<i><font color=#4b5d50># current mode of unit tree: expanded or not</font></i>
  <b><font color=#3a6797>set</font></b> al(expandFT) 0        ;<i><font color=#4b5d50># current mode of file tree: expanded or not</font></i>
  <b><font color=#3a6797>set</font></b> al(FONT) {}           ;<i><font color=#4b5d50># default font's options</font></i>
  <b><font color=#3a6797>set</font></b> al(FONT,txt)          TkFixedFont
  <b><font color=#3a6797>set</font></b> al(FONT,defsmall)     TkDefaultFont
  <b><font color=#3a6797>set</font></b> al(FONTSIZE,small) 9  ;<i><font color=#4b5d50># small font size</font></i>
  <b><font color=#3a6797>set</font></b> al(FONTSIZE,std) 10   ;<i><font color=#4b5d50># middle font size</font></i>
  <b><font color=#3a6797>set</font></b> al(THEME) default     ;<i><font color=#4b5d50># ttk theme</font></i>
  <b><font color=#3a6797>set</font></b> al(defCS) [::apave::DefaultCS]
  <b><font color=#3a6797>set</font></b> al(INI,CS) <font color=#1b1baa>$al(defCS)</font> ;<i><font color=#4b5d50># color scheme</font></i>
  <b><font color=#3a6797>set</font></b> al(INI,HUE) 0         ;<i><font color=#4b5d50># tint of color scheme</font></i>
  <b><font color=#3a6797>set</font></b> al(INI,ICONS) {middle icons} ;<i><font color=#4b5d50># sets tollbar icons' size as middle</font></i>
  <b><font color=#3a6797>set</font></b> al(INI,save_onselect) no ;<i><font color=#4b5d50># do saving alited configuration at tab selection</font></i>
  <b><font color=#3a6797>set</font></b> al(INI,save_onadd) no    ;<i><font color=#4b5d50># do saving alited configuration at tab adding</font></i>
  <b><font color=#3a6797>set</font></b> al(INI,save_onmove) no   ;<i><font color=#4b5d50># do saving alited configuration at tab  moving</font></i>
  <b><font color=#3a6797>set</font></b> al(INI,save_onclose) no  ;<i><font color=#4b5d50># do saving alited configuration at tab closing</font></i>
  <b><font color=#3a6797>set</font></b> al(INI,save_onsave) yes  ;<i><font color=#4b5d50># do saving alited configuration at file saving</font></i>
  <b><font color=#3a6797>set</font></b> al(INI,maxfind) 32       ;<i><font color=#4b5d50># size for comboboxes of &quot;Find/Replace&quot; dialogue</font></i>
  <b><font color=#3a6797>set</font></b> al(INI,barlablen) 16     ;<i><font color=#4b5d50># width of tab labels in chars</font></i>
  <b><font color=#3a6797>set</font></b> al(INI,bartiplen) 32     ;<i><font color=#4b5d50># size of tips for tab bar's arrows & of tabs submenu</font></i>
  <b><font color=#3a6797>set</font></b> al(INI,confirmexit) 1    ;<i><font color=#4b5d50># flag &quot;confirm exiting alited&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(INI,belltoll) 1       ;<i><font color=#4b5d50># flag &quot;bell at warnings&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(INI,LINES1) 10        ;<i><font color=#4b5d50># number of initial &quot;untouched&quot; lines (to ban moves in it)</font></i>
  <b><font color=#3a6797>set</font></b> al(INI,isfindrepl) 0     ;<i><font color=#4b5d50># Find/Replace shown at starting</font></i>
  <b><font color=#3a6797>set</font></b> al(PTP,text) {}          ;<i><font color=#4b5d50># project template's text</font></i>
  <b><font color=#3a6797>set</font></b> al(PTP,name) {}          ;<i><font color=#4b5d50># current template name</font></i>
  <b><font color=#3a6797>set</font></b> al(PTP,names) [<b><font color=#3a6797>list</font></b>]     ;<i><font color=#4b5d50># all template names</font></i>
  <b><font color=#3a6797>set</font></b> al(PTP,list) [<b><font color=#3a6797>list</font></b>]      ;<i><font color=#4b5d50># list of pairs &quot;name contents&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(moveall) 1            ;<i><font color=#4b5d50># &quot;move all&quot; of color chooser</font></i>
  <b><font color=#3a6797>set</font></b> al(tonemoves) 1          ;<i><font color=#4b5d50># &quot;tone moves&quot; of color chooser</font></i>
  <b><font color=#3a6797>set</font></b> al(checkgeo) {}          ;<i><font color=#4b5d50># geometry of &quot;Check Tcl&quot; window</font></i>
  <b><font color=#3a6797>set</font></b> al(gotoline) {}          ;<i><font color=#4b5d50># geometry of &quot;Go to line&quot; window</font></i>
  <b><font color=#3a6797>set</font></b> al(cmdNum) 6             ;<i><font color=#4b5d50># number of commands on Commands tab</font></i>

  <i><font color=#4b5d50># flag &quot;use special RE for leafs of unit tree&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(INI,LEAF) 0

  <i><font color=#4b5d50># RE for branches of unit tree ( # _ lev 1 _..)</font></i>
  <b><font color=#3a6797>set</font></b> al(RE,branchDEF) {^\s*(#+) [_]+\s+([^_]+[^[:blank:]]*)\s+[_]+ (#+)$}
  <b><font color=#3a6797>set</font></b> al(RE,branch) <font color=#1b1baa>$al(RE,branchDEF)</font>

  <i><font color=#4b5d50># special RE for leafs</font></i>
  <b><font color=#3a6797>set</font></b> al(RE,leafDEF) {^\s*#\s*=+\s*([^=\s]+)\s*=+$}
  <b><font color=#3a6797>set</font></b> al(RE,leaf) <font color=#1b1baa>$al(RE,leafDEF)</font>

  <i><font color=#4b5d50># RE for Tcl leaf units</font></i>
  <b><font color=#3a6797>set</font></b> al(RE,procDEF) {^\s*(((proc|method|test)\s+([^[:blank:]]+))|((constructor|destructor)\s+))}
  <b><font color=#3a6797>set</font></b> al(RE,proc) <font color=#1b1baa>$al(RE,procDEF)</font>

  <i><font color=#4b5d50># RE to check for leaf units (# _  / # _ abc)</font></i>
  <b><font color=#3a6797>set</font></b> al(RE,leaf2DEF) {^\s*(#+) [_]+}
  <b><font color=#3a6797>set</font></b> al(RE,leaf2) <font color=#1b1baa>$al(RE,leaf2DEF)</font>

  <i><font color=#4b5d50># RE to check for Tcl leaf units (proc abc {}...)</font></i>
  <b><font color=#3a6797>set</font></b> al(RE,proc2DEF) {^\s*(proc|method|test|constructor|destructor)\s+}
  <b><font color=#3a6797>set</font></b> al(RE,proc2) <font color=#1b1baa>$al(RE,proc2DEF)</font>

  <i><font color=#4b5d50># list of current favorite units</font></i>
  <b><font color=#3a6797>set</font></b> al(FAV,current) [<b><font color=#3a6797>list</font></b>]

  <i><font color=#4b5d50># list of current visited units</font></i>
  <b><font color=#3a6797>set</font></b> al(FAV,visited) [<b><font color=#3a6797>list</font></b>]

  <i><font color=#4b5d50># flag &quot;is now favorites (not last visited)&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(FAV,IsFavor) 0

  <i><font color=#4b5d50># maximum of &quot;last visited&quot; items</font></i>
  <b><font color=#3a6797>set</font></b> al(FAV,MAXLAST) 32

  <i><font color=#4b5d50># templates' list</font></i>
  <b><font color=#3a6797>set</font></b> al(TPL,list) [<b><font color=#3a6797>list</font></b>]

  <i><font color=#4b5d50># wildcards for templates</font></i>
  <b><font color=#3a6797>set</font></b> al(TPL,%d) %D
  <b><font color=#3a6797>set</font></b> al(TPL,%t) %T
  <b><font color=#3a6797>set</font></b> al(TPL,%u) aplsimple
  <b><font color=#3a6797>set</font></b> al(TPL,%U) {Alex Plotnikov}
  <b><font color=#3a6797>set</font></b> al(TPL,%m) aplsimple@gmail.com
  <b><font color=#3a6797>set</font></b> al(TPL,%w) https://aplsimple.github.io
  <b><font color=#3a6797>set</font></b> al(TPL,%a) {#   %a - \n}

  <i><font color=#4b5d50># key bindings</font></i>
  <b><font color=#3a6797>set</font></b> al(KEYS,bind) [<b><font color=#3a6797>list</font></b>]

  <i><font color=#4b5d50># e_menu settings and arguments</font></i>
  <b><font color=#3a6797>set</font></b> al(EM,geometry) {}
  <b><font color=#3a6797>set</font></b> al(EM,save) 2
  <b><font color=#3a6797>set</font></b> al(EM,PD=) [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::CONFIGDIRSTD</font> alited e_menu em_projects]
  <b><font color=#3a6797>set</font></b> al(EM,Tcl) {}
  <b><font color=#3a6797>set</font></b> al(EM,TclList) [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>set</font></b> al(EM,h=) [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::HOMEDIR</font> DOC www.tcl.tk man tcl8.6]
  <b><font color=#3a6797>set</font></b> al(EM,tt=) x-terminal-emulator
  <b><font color=#3a6797>set</font></b> al(EM,tt=List) <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>al(EM,tt=)\txfce4-terminal\tlxterminal --geometry=220x55\tgnome-terminal --wait\tkonsole\tqterminal\tEterm\tmlterm\txgterm&quot;</font>
  <b><font color=#3a6797>set</font></b> al(EM,wt=) cmd.exe
  <b><font color=#3a6797>set</font></b> al(EM,wt=List) <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>al(EM,wt=)\tpowershell.exe&quot;</font>
  <b><font color=#3a6797>set</font></b> al(EM,mnu) menu.em
  <b><font color=#3a6797>set</font></b> al(EM,mnudir) {}
  <b><font color=#3a6797>set</font></b> al(EM,CS) 33
  <b><font color=#3a6797>set</font></b> al(EM,ownCS) no
  <b><font color=#3a6797>set</font></b> al(EM,exec) yes
  <b><font color=#3a6797>set</font></b> al(EM,DiffTool) kdiff3

  <i><font color=#4b5d50># data of tabs</font></i>
  <b><font color=#3a6797>set</font></b> al(tablist) [<b><font color=#3a6797>list</font></b>]

  <i><font color=#4b5d50># list &quot;Recent files&quot; and its max length</font></i>
  <b><font color=#3a6797>set</font></b> al(RECENTFILES) [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>set</font></b> al(INI,RECENTFILES) 16

  <i><font color=#4b5d50># this is used at closing tabs to disable registering in &quot;Recent files&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(closefunc) 0

  <i><font color=#4b5d50># initial color of &quot;Choose color&quot; dialogue</font></i>
  <b><font color=#3a6797>set</font></b> al(chosencolor) green

  <i><font color=#4b5d50># subdirectory of project to backup files at modifications</font></i>
  <i><font color=#4b5d50># and maximum of backups</font></i>
  <b><font color=#3a6797>set</font></b> al(BACKUP) .bak
  <b><font color=#3a6797>set</font></b> al(MAXBACKUP) 1

  <i><font color=#4b5d50># enables/disables call of LastVisited in tree::NewSelection</font></i>
  <b><font color=#3a6797>set</font></b> al(dolastvisited) yes

  <i><font color=#4b5d50># current text's wrap words mode</font></i>
  <b><font color=#3a6797>set</font></b> al(wrapwords) 1

  <i><font color=#4b5d50># cursor's width & color</font></i>
  <b><font color=#3a6797>set</font></b> al(CURSORWIDTH) 2
  <b><font color=#3a6797>set</font></b> al(CURSORCOLOR) {}

  <i><font color=#4b5d50># defaults for projects</font></i>
  <b><font color=#3a6797>foreach</font></b> _ <font color=#1b1baa>$::alited::OPTS</font> {<b><font color=#3a6797>set</font></b> prjinfo(DEFAULT,<font color=#1b1baa>$_</font>) <font color=#1b1baa>$::alited::al($_)</font>}
  <b><font color=#3a6797>set</font></b> al(PRJDEFAULT) 1  ;<i><font color=#4b5d50># is Preferences/General/Projects/Default values for new projects</font></i>

  <i><font color=#4b5d50># use localized messages</font></i>
  <b><font color=#3a6797>set</font></b> al(LOCAL) {}
  <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> al(LOCAL) [<b><font color=#3a6797>string</font></b> range [::msgcat::mclocale] 0 1]}

  <i><font color=#4b5d50># data for &quot;Search by list&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(listSBL) {}
  <b><font color=#3a6797>set</font></b> al(matchSBL) {}
  <b><font color=#3a6797>set</font></b> al(wordonlySBL) 0
  <b><font color=#3a6797>set</font></b> al(caseSBL) 1

  <i><font color=#4b5d50># info about current unit</font></i>
  <b><font color=#3a6797>set</font></b> al(CURRUNIT,line) 0
  <b><font color=#3a6797>set</font></b> al(CURRUNIT,line1) 0
  <b><font color=#3a6797>set</font></b> al(CURRUNIT,line2) 0
  <b><font color=#3a6797>set</font></b> al(CURRUNIT,wtxt) {}
  <b><font color=#3a6797>set</font></b> al(CURRUNIT,itemID) {}

  <i><font color=#4b5d50># list of &quot;Find Unit&quot; combobox's values</font></i>
  <b><font color=#3a6797>set</font></b> al(findunitvals) {}

  <i><font color=#4b5d50># commands after starting alited</font></i>
  <b><font color=#3a6797>set</font></b> al(afterstart) {}

  <i><font color=#4b5d50># index of syntax colors</font></i>
  <b><font color=#3a6797>set</font></b> al(syntaxidx) 0

  <i><font color=#4b5d50># preferrable command to run</font></i>
  <b><font color=#3a6797>set</font></b> al(comForce) {}
  <b><font color=#3a6797>set</font></b> al(comForceCh) 1
  <b><font color=#3a6797>set</font></b> al(comForceLs) {}
  <b><font color=#3a6797>set</font></b> al(runGeometry) {}

  <i><font color=#4b5d50># flags of tip show</font></i>
  <b><font color=#3a6797>set</font></b> al(TIPS,Tree) 1
  <b><font color=#3a6797>set</font></b> al(TIPS,TreeFavor) 1
  <b><font color=#3a6797>set</font></b> al(TIPS,Projects) 1
  <b><font color=#3a6797>set</font></b> al(TIPS,Preferences) 1
  <b><font color=#3a6797>set</font></b> al(TIPS,Templates) 1
  <b><font color=#3a6797>set</font></b> al(TIPS,SavedFavorites) 1
  <b><font color=#3a6797>set</font></b> al(TIPS,Marks) 1

  <i><font color=#4b5d50># flag &quot;sorted file list&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(sortList) 0

  <i><font color=#4b5d50># modes to sort bartabs</font></i>
  <b><font color=#3a6797>set</font></b> al(incdecName) increasing
  <b><font color=#3a6797>set</font></b> al(incdecDate) decreasing
  <b><font color=#3a6797>set</font></b> al(incdecSize) decreasing
  <b><font color=#3a6797>set</font></b> al(incdecExtn) increasing

  <i><font color=#4b5d50># mode &quot;place tabs to the beginning of bar&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(lifo) 1

  <i><font color=#4b5d50># options for macro play</font></i>
  <b><font color=#3a6797>set</font></b> al(activemacro) {}  ;<i><font color=#4b5d50># active macro's name</font></i>
  <b><font color=#3a6797>set</font></b> al(macroext) {.alm} ;<i><font color=#4b5d50># macro extension</font></i>
  <b><font color=#3a6797>set</font></b> al(macromouse) no   ;<i><font color=#4b5d50># use mouse actions</font></i>

  <i><font color=#4b5d50># flag &quot;Paver tool is auto-updated&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(paverauto) 0

  <i><font color=#4b5d50># rectangular selection</font></i>
  <b><font color=#3a6797>set</font></b> al(rectSel) 0           ;<i><font color=#4b5d50># flag &quot;it was started&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(rectSel,TID) {}      ;<i><font color=#4b5d50># tab ID where it was started</font></i>
  <b><font color=#3a6797>set</font></b> al(rectSel,text) [<b><font color=#3a6797>list</font></b>] ;<i><font color=#4b5d50># selected rectangle</font></i>

  <i><font color=#4b5d50># &quot;TODO ahead&quot; setting of Projects</font></i>
  <b><font color=#3a6797>set</font></b> al(todoahead) 0

  <i><font color=#4b5d50># Handler of &quot;Run as Is&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(runAsIs) {alited::tool::RunFile; <b><font color=#ca14ca>break</font></b>}

  <i><font color=#4b5d50># Commenting mode: 0 - TODO, 1 - Classic, 2 - Sticky</font></i>
  <b><font color=#3a6797>set</font></b> al(commentmode) 0

  <i><font color=#4b5d50># options for Edit/Formats submenu</font></i>
  <b><font color=#3a6797>set</font></b> al(format_separ1DEF) \
    {# == N (70)=============================================================================}
  <b><font color=#3a6797>set</font></b> al(format_separ2DEF) #_______________________
  <b><font color=#3a6797>set</font></b> al(format_separ1) <font color=#1b1baa>$al(format_separ1DEF)</font>
  <b><font color=#3a6797>set</font></b> al(format_separ2) <font color=#1b1baa>$al(format_separ2DEF)</font>

  <i><font color=#4b5d50># width of mark bar</font></i>
  <b><font color=#3a6797>set</font></b> al(markwidth) 8

  <i><font color=#4b5d50># switch &quot;show week numbers in calendar&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(klndweeks) 0

  <i><font color=#4b5d50># -topmost attribute of Find/Replace dialog</font></i>
  <b><font color=#3a6797>set</font></b> al(topFindRepl) [::asKDE]

  <i><font color=#4b5d50># flag &quot;middle font size in detached editor&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(fontdetach) 1

}
<a id=Variables></a>
<i><font color=#4b5d50># ________________________ Variables _________________________ #</font></i>

<b><font color=#ca14ca>namespace</font></b> eval ini {
  <b><font color=#3a6797>variable</font></b> afterID {}  ;<i><font color=#4b5d50># after ID used by SaveCurrentIni proc</font></i>
  <b><font color=#3a6797>variable</font></b> configs {}  ;<i><font color=#4b5d50># list of configurations</font></i>
}
<a id=Reading_common_settings></a>
<i><font color=#4b5d50># ________________________ Reading common settings _________________________ #</font></i>
<a id=ini::ReadIni></a>
<b><font color=#ca14ca>proc</font></b> ini::ReadIni {{projectfile <font color=#8b2a0e>&quot;&quot;</font>}} {
  <i><font color=#4b5d50># Reads alited application's and project's settings.</font></i>
  <i><font color=#4b5d50>#   projectfile - project file's name</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>namespace</font></b> upvar ::alited::pref em_Num em_Num em_NumMax em_NumMax \
    em_ico em_ico em_inf em_inf em_mnu em_mnu
  <b><font color=#3a6797>namespace</font></b> upvar ::alited::project prjlist prjlist prjinfo prjinfo
  alited::pref::Tkcon_Default
  <b><font color=#3a6797>set</font></b> prjlist [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>set</font></b> al(TPL,list) [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>set</font></b> al(KEYS,bind) [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>set</font></b> em_i 0
  <b><font color=#3a6797>set</font></b> fontsize [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$al(FONTSIZE,std)</font>+1}]
  <b><font color=#3a6797>set</font></b> al(FONT,txt) <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>obj basicTextFont<font color=#1b1baa>]</font> -size <font color=#1b1baa>$</font>fontsize&quot;</font>
  <b><font color=#3a6797>lassign</font></b> <font color=#8b2a0e>&quot;&quot;</font> ::alited::Pan_wh ::alited::PanL_wh ::alited::PanR_wh \
    ::alited::PanBM_wh ::alited::PanTop_wh ::alited::al(GEOM)
  <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot;alited pwd    : <font color=#1b1baa>[</font>pwd<font color=#1b1baa>]</font>&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot;alited reading: <font color=#1b1baa>$</font>al(INI)&quot;</font>
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$al(ini_file)</font> eq {}} {
    <i><font color=#4b5d50># al(ini_file) may be already filled (see alited.tcl)</font></i>
    <b><font color=#3a6797>set</font></b> al(ini_file) [<b><font color=#3a6797>split</font></b> [readTextFile <font color=#1b1baa>$::alited::al(INI)</font>] \n]
  }
  <b><font color=#3a6797>set</font></b> mode <font color=#8b2a0e>&quot;&quot;</font>
  <b><font color=#3a6797>foreach</font></b> stini <font color=#1b1baa>$al(ini_file)</font> {
    <b><font color=#3a6797>switch</font></b> <font color=#653760>-exact</font> <font color=#1b1baa>$stini</font> {
      {[Geometry]} - {[Options]} - {[Projects]} - {[Templates]} - {[Keys]} - {[EM]} - {[Tkcon]} - {[Misc]} - {[Formats]} {
        <b><font color=#3a6797>set</font></b> mode <font color=#1b1baa>$stini</font>
        <b><font color=#ca14ca>continue</font></b>
      }
    }
    <i><font color=#4b5d50># any line may be potentially bad formed =&gt; catch errors</font></i>
    <b><font color=#3a6797>catch</font></b> {
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>string</font></b> first = <font color=#1b1baa>$stini</font>]]&gt;0} {
        <b><font color=#3a6797>set</font></b> nam [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$stini</font> 0 <font color=#1b1baa>$i</font>-1]
        <b><font color=#3a6797>set</font></b> val [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$stini</font> <font color=#1b1baa>$i</font>+1 end]
        <b><font color=#3a6797>switch</font></b> <font color=#653760>-exact</font> <font color=#1b1baa>$mode</font> {
          {[Geometry]}  {ReadIniGeometry <font color=#1b1baa>$nam</font> <font color=#1b1baa>$val</font>}
          {[Options]}   {ReadIniOptions <font color=#1b1baa>$nam</font> <font color=#1b1baa>$val</font>}
          {[Templates]} {ReadIniTemplates <font color=#1b1baa>$nam</font> <font color=#1b1baa>$val</font>}
          {[Keys]}      {ReadIniKeys <font color=#1b1baa>$nam</font> <font color=#1b1baa>$val</font>}
          {[EM]}        {ReadIniEM <font color=#1b1baa>$nam</font> <font color=#1b1baa>$val</font> em_i}
          {[Tkcon]}     {ReadIniTkcon <font color=#1b1baa>$nam</font> <font color=#1b1baa>$val</font>}
          {[Misc]}      {ReadIniMisc <font color=#1b1baa>$nam</font> <font color=#1b1baa>$val</font>}
          {[Formats]}   {ReadIniFormats <font color=#1b1baa>$nam</font> <font color=#1b1baa>$val</font>}
        }
      }
    }
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> al(PTP,text) [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$al(PTP,list)</font> 1]] eq {}} {
    <b><font color=#3a6797>set</font></b> al(PTP,text) [alited::project::TplDefaultText]
    <b><font color=#3a6797>set</font></b> al(PTP,list) [<b><font color=#3a6797>list</font></b> Default <font color=#1b1baa>$al(PTP,text)</font>]
  }
  <b><font color=#3a6797>set</font></b> al(PTP,name) [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$al(PTP,list)</font> 0]
  <b><font color=#3a6797>set</font></b> al(PTP,names) [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>foreach</font></b> {n c} <font color=#1b1baa>$al(PTP,list)</font> {<b><font color=#3a6797>lappend</font></b> al(PTP,names) <font color=#1b1baa>$n</font>}
  <b><font color=#3a6797>set</font></b> em_Num [<b><font color=#3a6797>expr</font></b> {min(<font color=#1b1baa>$em_NumMax</font>,[Em_Number <font color=#1b1baa>$em_i</font>]+3)}]
  <b><font color=#3a6797>while</font></b> {<font color=#1b1baa>$em_i</font> &lt; <font color=#1b1baa>$em_Num</font>} {
    <b><font color=#3a6797>lassign</font></b> {} em_ico(<font color=#1b1baa>$em_i</font>) em_inf(<font color=#1b1baa>$em_i</font>) em_mnu(<font color=#1b1baa>$em_i</font>)
    <b><font color=#3a6797>incr</font></b> em_i
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$projectfile</font> eq {} && <font color=#1b1baa>$al(prjfile)</font> eq {}} {
    <i><font color=#4b5d50># some options may be active outside of any project; fill them with defaults</font></i>
    <b><font color=#3a6797>foreach</font></b> opt {multiline indent indentAuto EOL trailwhite} {
      <b><font color=#3a6797>set</font></b> al(prj<font color=#1b1baa>$opt</font>) <font color=#1b1baa>$al(DEFAULT,prj$opt)</font>
    }
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$projectfile</font> eq {}} {
      <b><font color=#3a6797>set</font></b> projectfile <font color=#1b1baa>$al(prjfile)</font>
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> al(prjfile) <font color=#1b1baa>$projectfile</font>
    }
    ReadIniOptions project <font color=#1b1baa>$projectfile</font>
  }
  <b><font color=#3a6797>catch</font></b> {
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#3a6797>split</font></b> <font color=#1b1baa>$::alited::PanR_wh</font>] - w1 - h1
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#3a6797>split</font></b> <font color=#1b1baa>$::alited::PanTop_wh</font>] - w2 - h2
    <b><font color=#3a6797>if</font></b> {(<font color=#1b1baa>$h1</font>-<font color=#1b1baa>$h2</font>)&lt;60} {
      <b><font color=#3a6797>set</font></b> h2 [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$h1</font>-60}]
      <b><font color=#3a6797>set</font></b> ::alited::PanTop_wh <font color=#8b2a0e>&quot;-w <font color=#1b1baa>$</font>w2 -h <font color=#1b1baa>$</font>h2&quot;</font> ;<i><font color=#4b5d50># the status bar is wanted</font></i>
    }
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$al(RE,leaf)</font> eq {}} {<b><font color=#3a6797>set</font></b> al(RE,leaf) <font color=#1b1baa>$al(RE,leafDEF)</font>}
  ReadIniPrj
  <b><font color=#3a6797>lassign</font></b> [::apave::defaultAttrs tex] - atrs
  <b><font color=#3a6797>set</font></b> pad [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$al(CURSORWIDTH)</font> + 2}]
  <b><font color=#3a6797>append</font></b> atrs <font color=#8b2a0e>&quot; -spacing1 <font color=#1b1baa>$</font>al(ED,sp1) -spacing2 <font color=#1b1baa>$</font>al(ED,sp2) -spacing3 <font color=#1b1baa>$</font>al(ED,sp3) -padx <font color=#1b1baa>$</font>pad -pady <font color=#1b1baa>$</font>pad -insertwidth <font color=#1b1baa>$</font>al(CURSORWIDTH) -bd 0&quot;</font>
  ::apave::defaultAttrs tex <font color=#8b2a0e>&quot;&quot;</font> <font color=#1b1baa>$atrs</font>
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$al(INI,belltoll)</font>} {
    ; <b><font color=#ca14ca>proc</font></b> ::bell args {}  ;<i><font color=#4b5d50># no bells</font></i>
  }
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>string</font></b> is digit <font color=#653760>-strict</font> <font color=#1b1baa>$al(INI,confirmexit)</font>]} {
    <b><font color=#3a6797>set</font></b> al(INI,confirmexit) 1
  }
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>info</font></b> exists al(tkcon,clrbg)]} {
    alited::pref::Tkcon_Default
    alited::pref::Tkcon_Default1
  }
  InitXterminal
  <b><font color=#3a6797>set</font></b> al(ini_file) {}  ;<i><font color=#4b5d50># to reread alited.ini contents, at need in next time</font></i>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ReadIniGeometry></a>
<b><font color=#ca14ca>proc</font></b> ini::ReadIniGeometry {nam val} {
  <i><font color=#4b5d50># Gets the geometry options of alited.</font></i>
  <i><font color=#4b5d50>#   nam - name of option</font></i>
  <i><font color=#4b5d50>#   val - value of option</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>switch</font></b> <font color=#653760>-glob</font> -- <font color=#1b1baa>$nam</font> {
    Pan* {
      <b><font color=#3a6797>lassign</font></b> [::apave::splitGeometry <font color=#1b1baa>$val</font>] w h
      <b><font color=#3a6797>set</font></b> ::alited::<font color=#1b1baa>${nam}</font>_wh <font color=#8b2a0e>&quot;-w <font color=#1b1baa>$</font>w -h <font color=#1b1baa>$</font>h&quot;</font>
    }
    GEOM {
      <b><font color=#3a6797>lassign</font></b> [::apave::splitGeometry <font color=#1b1baa>$val</font>] w h x y
      <b><font color=#3a6797>set</font></b> ::alited::al(GEOM) <font color=#8b2a0e>&quot;-geometry <font color=#1b1baa>$</font>x<font color=#1b1baa>$</font>y&quot;</font>
    }
    geomfind       {<b><font color=#3a6797>set</font></b> ::alited::find::geo <font color=#1b1baa>$val</font>}
    geomfind2      {<b><font color=#3a6797>set</font></b> ::alited::find::geo2 <font color=#1b1baa>$val</font>}
    geomproject    {<b><font color=#3a6797>set</font></b> ::alited::project::geo <font color=#1b1baa>$val</font>}
    geomtodolist   {<b><font color=#3a6797>set</font></b> ::alited::project::geotodolist <font color=#1b1baa>$val</font>}
    geompref       {<b><font color=#3a6797>set</font></b> ::alited::pref::geo <font color=#1b1baa>$val</font>}
    dirgeometry    {<b><font color=#3a6797>set</font></b> ::alited::DirGeometry <font color=#1b1baa>$val</font>}
    filgeometry    {<b><font color=#3a6797>set</font></b> ::alited::FilGeometry <font color=#1b1baa>$val</font>}
    favgeometry    {<b><font color=#3a6797>set</font></b> ::alited::favgeometry <font color=#1b1baa>$val</font>}
    tplgeometry    {<b><font color=#3a6797>set</font></b> ::alited::tplgeometry <font color=#1b1baa>$val</font>}
    treecw0        {
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> exists ::alited::al(OLDTHEME)]
      && <font color=#1b1baa>$::alited::al(OLDTHEME)</font> ne <font color=#1b1baa>$::alited::al(THEME)</font>} {
        <i><font color=#4b5d50># this adjusts unit tree column #1 to make scroll bar visible</font></i>
        <b><font color=#3a6797>set</font></b> val [<b><font color=#3a6797>expr</font></b> {max(100,<font color=#1b1baa>$val</font>-20)}]
      }
      <b><font color=#3a6797>set</font></b> al(TREE,cw0) <font color=#1b1baa>$val</font>
    }
    treecw1        {<b><font color=#3a6797>set</font></b> al(TREE,cw1) <font color=#1b1baa>$val</font>}
    runGeometry    {<b><font color=#3a6797>set</font></b> al(runGeometry) <font color=#1b1baa>$val</font>}
    fontdetach     {<b><font color=#3a6797>set</font></b> al(fontdetach) <font color=#1b1baa>$val</font>}
    detach*        {
      <b><font color=#3a6797>set</font></b> id [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$nam</font> 6 end]
      <b><font color=#3a6797>lassign</font></b> [alited::file::DetachedInfo <font color=#1b1baa>$id</font>] pobj
      <b><font color=#3a6797>set</font></b> <font color=#1b1baa>$pobj</font> <font color=#1b1baa>$val</font>
    }
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ReadIniOptions></a>
<b><font color=#ca14ca>proc</font></b> ini::ReadIniOptions {nam val} {
  <i><font color=#4b5d50># Gets various options of alited.</font></i>
  <i><font color=#4b5d50>#   nam - name of option</font></i>
  <i><font color=#4b5d50>#   val - value of option</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>set</font></b> clrnames [::hl_tcl::hl_colorNames]
  <b><font color=#3a6797>foreach</font></b> lng {{} C} {
    <b><font color=#3a6797>set</font></b> nam1 [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$nam</font> [<b><font color=#3a6797>string</font></b> length <font color=#1b1baa>$lng</font>] end]
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>lsearch</font></b> <font color=#1b1baa>$clrnames</font> <font color=#1b1baa>$nam1</font>]&gt;-1} {
      <b><font color=#3a6797>set</font></b> al(ED,<font color=#1b1baa>$nam</font>) <font color=#1b1baa>$val</font>
      <b><font color=#ca14ca>return</font></b>
    }
  }
  <b><font color=#3a6797>switch</font></b> <font color=#653760>-glob</font> -- <font color=#1b1baa>$nam</font> {
    comm_port_list {<b><font color=#3a6797>set</font></b> al(comm_port_list) <font color=#1b1baa>$val</font>}
    project {
      <b><font color=#3a6797>set</font></b> al(prjfile) [::apave::UnixPath <font color=#1b1baa>$val</font>]
      <b><font color=#3a6797>set</font></b> al(prjname) [<b><font color=#3a6797>file</font></b> tail [<b><font color=#3a6797>file</font></b> rootname <font color=#1b1baa>$val</font>]]
    }
    theme         {<b><font color=#3a6797>set</font></b> al(THEME) <font color=#1b1baa>$val</font>}
    cs            {<b><font color=#3a6797>set</font></b> al(INI,CS) <font color=#1b1baa>$val</font>}
    hue           {<b><font color=#3a6797>set</font></b> al(INI,HUE) <font color=#1b1baa>$val</font>}
    local         {<b><font color=#3a6797>set</font></b> al(LOCAL) <font color=#1b1baa>$val</font>}
    deffont       {<b><font color=#3a6797>set</font></b> al(FONT) <font color=#1b1baa>$val</font>}
    smallfontsize {<b><font color=#3a6797>set</font></b> al(FONTSIZE,small) <font color=#1b1baa>$val</font>}
    stdfontsize   {<b><font color=#3a6797>set</font></b> al(FONTSIZE,std) <font color=#1b1baa>$val</font>}
    txtfont       {<b><font color=#3a6797>set</font></b> al(FONT,txt) <font color=#1b1baa>$val</font>; obj basicTextFont <font color=#1b1baa>$val</font>}
    maxfind       {<b><font color=#3a6797>set</font></b> al(INI,maxfind) <font color=#1b1baa>$val</font>}
    confirmexit   {<b><font color=#3a6797>set</font></b> al(INI,confirmexit) <font color=#1b1baa>$val</font>}
    belltoll      {<b><font color=#3a6797>set</font></b> al(INI,belltoll) <font color=#1b1baa>$val</font>}
    spacing1      {<b><font color=#3a6797>set</font></b> al(ED,sp1) <font color=#1b1baa>$val</font>}
    spacing2      {<b><font color=#3a6797>set</font></b> al(ED,sp2) <font color=#1b1baa>$val</font>}
    spacing3      {<b><font color=#3a6797>set</font></b> al(ED,sp3) <font color=#1b1baa>$val</font>}
    TclKeyWords   {<b><font color=#3a6797>set</font></b> al(ED,TclKeyWords) <font color=#1b1baa>$val</font>}
    CKeyWords     {<b><font color=#3a6797>set</font></b> al(ED,CKeyWords) <font color=#1b1baa>$val</font>}
    clrDark       {<b><font color=#3a6797>set</font></b> al(ED,Dark) <font color=#1b1baa>$val</font>}
    save_onadd - save_onclose - save_onsave {<b><font color=#3a6797>set</font></b> al(INI,<font color=#1b1baa>$nam</font>) <font color=#1b1baa>$val</font>}
    TclExts       {
      <b><font color=#3a6797>set</font></b> al(TclExts) [<b><font color=#3a6797>split</font></b> <font color=#1b1baa>$val</font>]
      <b><font color=#3a6797>foreach</font></b> e <font color=#1b1baa>$al(TclExtsDef)</font> {
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$e</font> ni <font color=#1b1baa>$al(TclExts)</font>} {<b><font color=#3a6797>lappend</font></b> al(TclExts) <font color=#1b1baa>$e</font>}
      }
    }
    ClangExts     {<b><font color=#3a6797>set</font></b> al(ClangExts) <font color=#1b1baa>$val</font>}
    TextExts      {<b><font color=#3a6797>set</font></b> al(TextExts) <font color=#1b1baa>$val</font>}
    REbranch      {<b><font color=#3a6797>set</font></b> al(RE,branch) <font color=#1b1baa>$val</font>}
    REproc        {<b><font color=#3a6797>set</font></b> al(RE,proc) <font color=#1b1baa>$val</font>}
    REproc2       {<b><font color=#3a6797>set</font></b> al(RE,proc2) <font color=#1b1baa>$val</font>}
    REleaf        {<b><font color=#3a6797>set</font></b> al(RE,leaf) <font color=#1b1baa>$val</font>}
    REleaf2       {<b><font color=#3a6797>set</font></b> al(RE,leaf2) <font color=#1b1baa>$val</font>}
    UseLeaf       {<b><font color=#3a6797>set</font></b> al(INI,LEAF) [<b><font color=#3a6797>string</font></b> is true <font color=#653760>-strict</font> <font color=#1b1baa>$val</font>]}
    Lines1        {<b><font color=#3a6797>set</font></b> al(INI,LINES1) <font color=#1b1baa>$val</font>}
    RecentFiles   {<b><font color=#3a6797>set</font></b> al(INI,RECENTFILES) <font color=#1b1baa>$val</font>}
    MaxLast       {<b><font color=#3a6797>set</font></b> al(FAV,MAXLAST) <font color=#1b1baa>$val</font>}
    MaxFiles      {<b><font color=#3a6797>set</font></b> al(MAXFILES) <font color=#1b1baa>$val</font>}
    barlablen     {<b><font color=#3a6797>set</font></b> al(INI,barlablen) <font color=#1b1baa>$val</font>}
    bartiplen     {<b><font color=#3a6797>set</font></b> al(INI,bartiplen) <font color=#1b1baa>$val</font>}
    isfindrepl    {<b><font color=#3a6797>set</font></b> al(INI,isfindrepl) <font color=#1b1baa>$val</font>}
    prjtpls       {<b><font color=#3a6797>set</font></b> al(PTP,list) [::alited::ProcEOL <font color=#1b1baa>$val</font> in]}
    backup        {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$val</font> ne {.bak}} {<b><font color=#3a6797>set</font></b> val {}}
      <b><font color=#3a6797>set</font></b> al(BACKUP) <font color=#1b1baa>$val</font>
    }
    maxbackup     {<b><font color=#3a6797>set</font></b> al(MAXBACKUP) <font color=#1b1baa>$val</font>}
    gutterwidth   {<b><font color=#3a6797>set</font></b> al(ED,gutterwidth) <font color=#1b1baa>$val</font>}
    guttershift   {<b><font color=#3a6797>set</font></b> al(ED,guttershift) <font color=#1b1baa>$val</font>}
    btsbd         {<b><font color=#3a6797>set</font></b> al(ED,btsbd) <font color=#1b1baa>$val</font>}
    BlinkCurs     {<b><font color=#3a6797>set</font></b> al(ED,BlinkCurs) <font color=#1b1baa>$val</font>}
    ClrCurs       {<b><font color=#3a6797>set</font></b> al(CURSORCOLOR) <font color=#1b1baa>$val</font>}
    cursorwidth   {<b><font color=#3a6797>set</font></b> al(CURSORWIDTH) <font color=#1b1baa>$val</font>}
    prjdefault    {<b><font color=#3a6797>set</font></b> al(PRJDEFAULT) <font color=#1b1baa>$val</font>}
    DEFAULT,*     {<b><font color=#3a6797>set</font></b> al(<font color=#1b1baa>$nam</font>) <font color=#1b1baa>$val</font>}
    findunit      {<b><font color=#3a6797>set</font></b> al(findunitvals) <font color=#1b1baa>$val</font>}
    afterstart    {<b><font color=#3a6797>set</font></b> al(afterstart) <font color=#1b1baa>$val</font>}
    ALEversion    {<b><font color=#3a6797>set</font></b> al(ALEversion) <font color=#1b1baa>$val</font>}
    todoahead     {<b><font color=#3a6797>set</font></b> al(todoahead) <font color=#1b1baa>$val</font>}
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ReadIniTemplates></a>
<b><font color=#ca14ca>proc</font></b> ini::ReadIniTemplates {nam val {updwc yes}} {
  <i><font color=#4b5d50># Sets new or updates old templates.</font></i>
  <i><font color=#4b5d50>#   nam - name of option</font></i>
  <i><font color=#4b5d50>#   val - value of option</font></i>
  <i><font color=#4b5d50>#   updwc - if yes, sets wild cards for templates</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>switch</font></b> <font color=#653760>-exact</font> -- <font color=#1b1baa>$nam</font> {
    tpl {
      <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$val</font> tplname tplkey
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>lsearch</font></b> <font color=#653760>-exact</font> <font color=#653760>-index</font> 0 <font color=#1b1baa>$al(TPL,list)</font> <font color=#1b1baa>$tplname</font>]]&lt;0} {
        <i><font color=#4b5d50># at inserting new, check for possible duplicate 'tplkey'</font></i>
        <b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>lsearch</font></b> <font color=#653760>-exact</font> <font color=#653760>-index</font> 1 <font color=#1b1baa>$al(TPL,list)</font> <font color=#1b1baa>$tplkey</font>]
        <b><font color=#3a6797>lappend</font></b> al(TPL,list) <font color=#1b1baa>$val</font>
        <i><font color=#4b5d50># key bindings</font></i>
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tplkey</font> ne {}} {
          <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$i</font>&lt;0} {
            <i><font color=#4b5d50># add a new key binding, for this template</font></i>
            <b><font color=#3a6797>set</font></b> kbval <font color=#8b2a0e>&quot;template <font color=#1b1baa>{$</font>tplname<font color=#1b1baa>}</font> <font color=#1b1baa>$</font>tplkey <font color=#1b1baa>{[</font>lrange <font color=#1b1baa>$</font>val 2 end<font color=#1b1baa>]}</font>&quot;</font>
            <b><font color=#3a6797>lappend</font></b> al(KEYS,bind) <font color=#1b1baa>$kbval</font>
          } <b><font color=#3a6797>else</font></b> {
            <i><font color=#4b5d50># duplicate 'tplkey' =&gt; clear it in the new template, no key binding</font></i>
            <b><font color=#3a6797>set</font></b> val [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$val</font> 1 1 {}]
            <b><font color=#3a6797>set</font></b> al(TPL,list) [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$al(TPL,list)</font> end end <font color=#1b1baa>$val</font>]
          }
        }
      } <b><font color=#3a6797>else</font></b> {
        <i><font color=#4b5d50># at updating old, replace the contents only (remaining 'tplname tplkey')</font></i>
        <b><font color=#3a6797>set</font></b> val2 [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$al(TPL,list)</font> <font color=#1b1baa>$i</font>]
        <b><font color=#3a6797>set</font></b> val [<b><font color=#3a6797>list</font></b> {<b><font color=#3a6797>*</font></b>}[<b><font color=#3a6797>lrange</font></b> <font color=#1b1baa>$val2</font> 0 1] {<b><font color=#3a6797>*</font></b>}[<b><font color=#3a6797>lrange</font></b> <font color=#1b1baa>$val</font> 2 end]]
        <b><font color=#3a6797>set</font></b> al(TPL,list) [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$al(TPL,list)</font> <font color=#1b1baa>$i</font> <font color=#1b1baa>$i</font> <font color=#1b1baa>$val</font>]
      }
    }
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$updwc</font>} {
    <b><font color=#3a6797>foreach</font></b> n {%d %t %u %U %m %w} {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$n</font> eq <font color=#1b1baa>$nam</font>} {
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$val</font> ne <font color=#8b2a0e>&quot;&quot;</font>} {<b><font color=#3a6797>set</font></b> al(TPL,<font color=#1b1baa>$n</font>) <font color=#1b1baa>$val</font>}
        <b><font color=#ca14ca>break</font></b>
      }
    }
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ReadIniKeys></a>
<b><font color=#ca14ca>proc</font></b> ini::ReadIniKeys {nam val} {
  <i><font color=#4b5d50># Gets keys options of alited.</font></i>
  <i><font color=#4b5d50>#   nam - name of option</font></i>
  <i><font color=#4b5d50>#   val - value of option</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>switch</font></b> <font color=#653760>-exact</font> -- <font color=#1b1baa>$nam</font> {
    key {<b><font color=#3a6797>lappend</font></b> al(KEYS,bind) <font color=#1b1baa>$val</font>}
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ReadIniEM></a>
<b><font color=#ca14ca>proc</font></b> ini::ReadIniEM {nam val emiName} {
  <i><font color=#4b5d50># Gets e_menu options of alited.</font></i>
  <i><font color=#4b5d50>#   nam - name of option</font></i>
  <i><font color=#4b5d50>#   val - value of option</font></i>
  <i><font color=#4b5d50>#   emiName - name of em_i (index in arrays of e_menu data)</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>namespace</font></b> upvar ::alited::pref em_NumMax em_NumMax \
    em_ico em_ico em_inf em_inf em_mnu em_mnu
  <b><font color=#3a6797>upvar</font></b> <font color=#1b1baa>$emiName</font> em_i
  <b><font color=#3a6797>switch</font></b> <font color=#653760>-exact</font> <font color=#1b1baa>$nam</font> {
    emPD       {<b><font color=#3a6797>set</font></b> al(EM,PD=) [::apave::UnixPath <font color=#1b1baa>$val</font>]}
    emTcl      {
      <b><font color=#3a6797>set</font></b> val [::apave::UnixPath <font color=#1b1baa>$val</font>]
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> first { } <font color=#1b1baa>$val</font>]&gt;0} {
        <b><font color=#134070>tk_messageBox</font></b> <font color=#653760>-title</font> Warning <font color=#653760>-icon</font> warning <font color=#653760>-message</font> \
          <font color=#8b2a0e>&quot;The path to Tcl executable\n\n\&quot;<font color=#1b1baa>$</font>val\&quot;\n\ncontains spaces.\n \</font>
<font color=#8b2a0e>          \nThis path doesn't fit alited. Only 'non-space' ones do.\n \</font>
<font color=#8b2a0e>          \n==&gt; Change this setting:\nPreferences/Tools/tclsh...&quot;</font>
      } <b><font color=#3a6797>else</font></b> {
        <b><font color=#3a6797>set</font></b> al(EM,Tcl) <font color=#1b1baa>$val</font>
      }
    }
    emTclList  {
      <b><font color=#3a6797>set</font></b> al(EM,TclList) {}
      <b><font color=#3a6797>foreach</font></b> t [<b><font color=#3a6797>split</font></b> [<b><font color=#3a6797>string</font></b> trim <font color=#1b1baa>$val</font>] \t] {
        <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> trim <font color=#1b1baa>$t</font>] ne {}} {
          <b><font color=#3a6797>append</font></b> al(EM,TclList) \t [::apave::UnixPath <font color=#1b1baa>$t</font>]
        }
      }
    }
    em_run {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$em_i</font> &lt; <font color=#1b1baa>$em_NumMax</font>} {
        <b><font color=#3a6797>lassign</font></b> [<b><font color=#3a6797>split</font></b> <font color=#1b1baa>$val</font> \t] v1 v2 v3
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$v1</font> eq <font color=#8b2a0e>&quot;1&quot;</font> && <font color=#1b1baa>$v2</font> eq {}} {
          <b><font color=#3a6797>lassign</font></b> {} em_ico(<font color=#1b1baa>$em_i</font>) em_inf(<font color=#1b1baa>$em_i</font>)  ;<i><font color=#4b5d50># it's a separator in alited v1.6.1</font></i>
        } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$v1</font> eq <font color=#8b2a0e>&quot;0&quot;</font> && <font color=#1b1baa>$v3</font> ne {}} {
          <b><font color=#3a6797>set</font></b> em_ico(<font color=#1b1baa>$em_i</font>) <font color=#1b1baa>$v2</font>
          <b><font color=#3a6797>set</font></b> em_inf(<font color=#1b1baa>$em_i</font>) <font color=#1b1baa>$v3</font>  ;<i><font color=#4b5d50># it's an item in alited v1.6.1</font></i>
        } <b><font color=#3a6797>else</font></b> {
          <b><font color=#3a6797>set</font></b> em_ico(<font color=#1b1baa>$em_i</font>) <font color=#1b1baa>$v1</font> ;<i><font color=#4b5d50># it's a separator / item in v1.6.2</font></i>
          <b><font color=#3a6797>set</font></b> em_inf(<font color=#1b1baa>$em_i</font>) <font color=#1b1baa>$v2</font>
        }
        <b><font color=#3a6797>set</font></b> em_mnu(<font color=#1b1baa>$em_i</font>) [::apave::NormalizeName [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$em_inf($em_i)</font> end]]
        <b><font color=#3a6797>incr</font></b> em_i
      }
    }
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> trim <font color=#1b1baa>$val</font>] eq {}} <b><font color=#ca14ca>return</font></b>  ;<i><font color=#4b5d50># options below should be non-empty</font></i>
  <b><font color=#3a6797>switch</font></b> <font color=#653760>-exact</font> <font color=#1b1baa>$nam</font> {
    emgeometry {<b><font color=#3a6797>set</font></b> al(EM,geometry) <font color=#1b1baa>$val</font>}
    emsave     {  ;<i><font color=#4b5d50># messy for compatibility:</font></i>
      <b><font color=#3a6797>switch</font></b> <font color=#1b1baa>$val</font> [<b><font color=#3a6797>list</font></b> \
        3 - {} {<b><font color=#3a6797>set</font></b> al(EM,save) 3} \
        2 - Current - {Current file} - <font color=#1b1baa>$al(MC,currfile)</font> {<b><font color=#3a6797>set</font></b> al(EM,save) 2} \
        <b><font color=#3a6797>default</font></b> {<b><font color=#3a6797>set</font></b> al(EM,save) 1} \
      ]
    }
    emtt       {<b><font color=#3a6797>set</font></b> al(EM,tt=) <font color=#1b1baa>$val</font>}
    emttList   {
      <b><font color=#3a6797>foreach</font></b> tt [<b><font color=#3a6797>split</font></b> <font color=#1b1baa>$al(EM,tt=List)</font> \t] {
        <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> first \t<font color=#1b1baa>$tt</font> \t<font color=#1b1baa>$val</font>]&lt;0} {
          <b><font color=#3a6797>append</font></b> val \t<font color=#1b1baa>$tt</font>  ;<i><font color=#4b5d50># let default items be in the list</font></i>
        }
      }
      <b><font color=#3a6797>set</font></b> al(EM,tt=List) <font color=#1b1baa>$val</font>
    }
    emwt       {<b><font color=#3a6797>set</font></b> al(EM,wt=) <font color=#1b1baa>$val</font>}
    emmenu     {<b><font color=#3a6797>set</font></b> al(EM,mnu) [::apave::UnixPath <font color=#1b1baa>$val</font>]}
    emmenudir  {
      <b><font color=#3a6797>set</font></b> val [::apave::UnixPath <font color=#1b1baa>$val</font>]
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$val</font>]} {<b><font color=#3a6797>set</font></b> al(EM,mnudir) <font color=#1b1baa>$val</font>}
    }
    emcs       {<b><font color=#3a6797>set</font></b> al(EM,CS) <font color=#1b1baa>$val</font>}
    emowncs    {<b><font color=#3a6797>set</font></b> al(EM,ownCS) <font color=#1b1baa>$val</font>}
    emdiff     {<b><font color=#3a6797>set</font></b> al(EM,DiffTool) <font color=#1b1baa>$val</font>}
    emh        {<b><font color=#3a6797>set</font></b> al(EM,h=) [::apave::UnixPath <font color=#1b1baa>$val</font>]}
  }
<i><font color=#4b5d50>#    emexec     #\{set al(EM,exec) $val#\}</font></i>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ReadIniTkcon></a>
<b><font color=#ca14ca>proc</font></b> ini::ReadIniTkcon {nam val} {
  <i><font color=#4b5d50># Gets tkcon options of alited.</font></i>
  <i><font color=#4b5d50>#   nam - name of option</font></i>
  <i><font color=#4b5d50>#   val - value of option</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>set</font></b> al(tkcon,<font color=#1b1baa>$nam</font>) <font color=#1b1baa>$val</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ReadIniMisc></a>
<b><font color=#ca14ca>proc</font></b> ini::ReadIniMisc {nam val} {
  <i><font color=#4b5d50># Gets miscellaneous options of alited.</font></i>
  <i><font color=#4b5d50>#   nam - name of option</font></i>
  <i><font color=#4b5d50>#   val - value of option</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>switch</font></b> <font color=#653760>-glob</font> -- <font color=#1b1baa>$nam</font> {
    isfavor {<b><font color=#3a6797>set</font></b> al(FAV,IsFavor) <font color=#1b1baa>$val</font>}
    showinfo {<b><font color=#3a6797>set</font></b> al(TREE,showinfo) <font color=#1b1baa>$val</font>}
    HelpedMe {<b><font color=#3a6797>set</font></b> ::alited::helpedMe <font color=#1b1baa>$val</font>}
    listSBL - checkgeo - gotoline - tonemoves - moveall - chosencolor \
    - sortList - activemacro - commentmode - format_separ1 - format_separ2 \
    - TIPS,* - MNUGEO,* - markwidth - klndweeks - topFindRepl \
    - DockGeo - DockLayout - ApaveLayout {
      <b><font color=#3a6797>set</font></b> al(<font color=#1b1baa>$nam</font>) <font color=#1b1baa>$val</font>
    }

    tplilast {<b><font color=#3a6797>set</font></b> ::alited::unit::ilast <font color=#1b1baa>$val</font>}
    incdec {<b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$val</font> al(incdecName) al(incdecDate) al(incdecSize) al(incdecExtn)}
    blifo {<b><font color=#3a6797>set</font></b> al(lifo) [<b><font color=#3a6797>string</font></b> is true <font color=#1b1baa>$val</font>]}
    InRE2 {<b><font color=#3a6797>set</font></b> ::alited::find::InRE2 [::alited::ProcEOL <font color=#1b1baa>$val</font> in]}
    ExRE2 {<b><font color=#3a6797>set</font></b> ::alited::find::ExRE2 [::alited::ProcEOL <font color=#1b1baa>$val</font> in]}
    chInRE2 {<b><font color=#3a6797>set</font></b> ::alited::find::chInRE2 [<b><font color=#3a6797>string</font></b> is true <font color=#1b1baa>$val</font>]}
    chExRE2 {<b><font color=#3a6797>set</font></b> ::alited::find::chExRE2 [<b><font color=#3a6797>string</font></b> is true <font color=#1b1baa>$val</font>]}
    geoRE2 {<b><font color=#3a6797>set</font></b> ::alited::find::geoRE2 <font color=#1b1baa>$val</font>}
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ReadIniFormats></a>
<b><font color=#ca14ca>proc</font></b> ini::ReadIniFormats {nam val} {
  <i><font color=#4b5d50># Gets pluginable formatters of alited.</font></i>
  <i><font color=#4b5d50>#   nam - name of option</font></i>
  <i><font color=#4b5d50>#   val - value of option</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$nam</font> eq {pluginable}} {
    <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$val</font> fullformname ev
    <b><font color=#3a6797>set</font></b> fform [alited::edit::FormatterName <font color=#1b1baa>$fullformname</font>]
    <b><font color=#3a6797>set</font></b> al(FORMATS,<font color=#1b1baa>$fform</font>,<font color=#1b1baa>$ev</font>) <font color=#1b1baa>$val</font>
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::Em_Number></a>
<b><font color=#ca14ca>proc</font></b> ini::Em_Number {em_N} {
  <i><font color=#4b5d50># Gets a real number of e_menu items counting non-empty ones only.</font></i>
  <i><font color=#4b5d50>#   em_N - current number of e_menu items</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited::pref em_inf em_inf
  <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i <font color=#1b1baa>$em_N</font>} {<font color=#1b1baa>$i</font>&gt;0} {} {
    <b><font color=#3a6797>set</font></b> em_N <font color=#1b1baa>$i</font>
    <b><font color=#3a6797>incr</font></b> i -1
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> exists em_inf(<font color=#1b1baa>$i</font>)] && <font color=#1b1baa>$em_inf($i)</font> ne {}} {
      <b><font color=#ca14ca>break</font></b>
    }
  }
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$em_N</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::InitXterminal></a>
<b><font color=#ca14ca>proc</font></b> ini::InitXterminal {} {
  <i><font color=#4b5d50># Gets Linux terminal called by x-terminal-emulator, saves the result to al(EM,tt).</font></i>
  <i><font color=#4b5d50># See also: tool::EM_Options</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>set</font></b> al(EM,tt) <font color=#1b1baa>$al(EM,tt=)</font>
  <b><font color=#3a6797>set</font></b> tty [<b><font color=#3a6797>lindex</font></b> [<b><font color=#3a6797>split</font></b> <font color=#1b1baa>$al(EM,tt)</font>] 0]
  <b><font color=#3a6797>set</font></b> xte x-terminal-emulator
  <b><font color=#3a6797>if</font></b> {[::isunix] && [<b><font color=#3a6797>file</font></b> tail <font color=#1b1baa>$tty</font>] eq <font color=#1b1baa>$xte</font>} {
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>auto_execok</font></b> <font color=#1b1baa>$tty</font>] eq {} || [<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> man [<b><font color=#3a6797>exec</font></b> man <font color=#1b1baa>$xte</font>]}]} {
      <i><font color=#4b5d50># no x-terminal-emulator command ?</font></i>
      <b><font color=#ca14ca>return</font></b>
    }
    <b><font color=#3a6797>switch</font></b> <font color=#653760>-glob</font> <font color=#1b1baa>$man</font> {
      GNOME-TERMINAL* {<b><font color=#3a6797>set</font></b> tt {gnome-terminal <font color=#653760>--wait</font>}}
      XFCE4-TERMINAL* {<b><font color=#3a6797>set</font></b> tt xfce4-terminal}
      <b><font color=#3a6797>default</font></b> {<b><font color=#ca14ca>return</font></b>}
    }
    <b><font color=#3a6797>set</font></b> al(EM,tt) <font color=#1b1baa>$tt</font>[<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$al(EM,tt=)</font> [<b><font color=#3a6797>string</font></b> length <font color=#1b1baa>$tty</font>] end]
  }
}
<a id=Reading_project_settings></a>
<i><font color=#4b5d50># _______________________ Reading project settings _________________________ #</font></i>
<a id=ini::ReadIniPrj></a>
<b><font color=#ca14ca>proc</font></b> ini::ReadIniPrj {} {
  <i><font color=#4b5d50># Reads a project's settings.</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al PRJEXT PRJEXT
  <b><font color=#3a6797>set</font></b> al(tabs) [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>set</font></b> al(curtab) 0
  <b><font color=#3a6797>set</font></b> al(_check_menu_state_) 1
  <b><font color=#3a6797>set</font></b> al(comForce) [<b><font color=#3a6797>set</font></b> al(comForceLs) {}]
  <b><font color=#3a6797>set</font></b> al(expandFT) 0
  <b><font color=#3a6797>set</font></b> al(FAV,current) [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>set</font></b> al(FAV,visited) [<b><font color=#3a6797>list</font></b>]
  alited::favor::InitFavorites [<b><font color=#3a6797>list</font></b>]
  alited::favor_ls::GetIni {}
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$al(prjfile)</font>]} {
    <b><font color=#3a6797>set</font></b> al(prjfile) [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::PRJDIR</font> default<font color=#1b1baa>$PRJEXT</font>]
  }
  <b><font color=#3a6797>set</font></b> al(prjname) [<b><font color=#3a6797>file</font></b> tail [<b><font color=#3a6797>file</font></b> rootname <font color=#1b1baa>$al(prjfile)</font>]]
  <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot;alited project: <font color=#1b1baa>$</font>al(prjfile)&quot;</font>
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {
    <b><font color=#3a6797>set</font></b> chan [<b><font color=#3a6797>open</font></b> <font color=#1b1baa>$::alited::al(prjfile)</font> r]
    <b><font color=#3a6797>set</font></b> mode <font color=#8b2a0e>&quot;&quot;</font>
    <b><font color=#3a6797>while</font></b> {![<b><font color=#3a6797>eof</font></b> <font color=#1b1baa>$chan</font>]} {
      <b><font color=#3a6797>set</font></b> stini [<b><font color=#3a6797>string</font></b> trim [<b><font color=#3a6797>gets</font></b> <font color=#1b1baa>$chan</font>]]
      <b><font color=#3a6797>switch</font></b> <font color=#653760>-exact</font> <font color=#1b1baa>$stini</font> {
        {[Tabs]} - {[Options]} - {[Favorites]} - {[Misc]} {
          <b><font color=#3a6797>set</font></b> mode <font color=#1b1baa>$stini</font>
          <b><font color=#ca14ca>continue</font></b>
        }
      }
      <b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>string</font></b> first = <font color=#1b1baa>$stini</font>]
      <b><font color=#3a6797>set</font></b> nam [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$stini</font> 0 <font color=#1b1baa>$i</font>-1]
      <b><font color=#3a6797>set</font></b> val [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$stini</font> <font color=#1b1baa>$i</font>+1 end]
      <i><font color=#4b5d50># any line may be potentially bad formed =&gt; catch errors</font></i>
      <b><font color=#3a6797>catch</font></b> {
        <b><font color=#3a6797>switch</font></b> <font color=#653760>-exact</font> <font color=#1b1baa>$mode</font> {
          {[Tabs]} {ReadPrjTabs <font color=#1b1baa>$nam</font> <font color=#1b1baa>$val</font>}
          {[Options]} {ReadPrjOptions <font color=#1b1baa>$nam</font> <font color=#1b1baa>$val</font>}
          {[Favorites]} {ReadPrjFavorites <font color=#1b1baa>$nam</font> <font color=#1b1baa>$val</font>}
          {[Misc]} {ReadPrjMisc <font color=#1b1baa>$nam</font> <font color=#1b1baa>$val</font>}
        }
      }
    }
  } e]} <b><font color=#3a6797>then</font></b> {
    <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot;Not open: <font color=#1b1baa>$</font>al(prjfile)\n<font color=#1b1baa>$</font>e&quot;</font>
    <b><font color=#3a6797>set</font></b> al(prjname) {}
    <b><font color=#3a6797>set</font></b> al(prjfile) {}
    <b><font color=#3a6797>set</font></b> al(prjroot) {}
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$al(prjroot)</font> eq {} && <font color=#1b1baa>$al(prjname)</font> eq {<b><font color=#3a6797>default</font></b>}} {<b><font color=#3a6797>set</font></b> al(prjroot) <font color=#1b1baa>$::alited::DIR</font>}
  alited::favor::InitFavorites <font color=#1b1baa>$al(FAV,current)</font>
  <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>close</font></b> <font color=#1b1baa>$chan</font>}
  <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>cd</font></b> <font color=#1b1baa>$al(prjroot)</font>}
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>string</font></b> is digit <font color=#653760>-strict</font> <font color=#1b1baa>$al(curtab)</font>] || \
  <font color=#1b1baa>$al(curtab)</font>&lt;0 || <font color=#1b1baa>$al(curtab)</font>&gt;=[<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$al(tabs)</font>]} {
    <b><font color=#3a6797>set</font></b> al(curtab) 0
  }
  ::apave::textEOL <font color=#1b1baa>$al(prjEOL)</font>
  alited::SaveRunOptions
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ReadPrjTabs></a>
<b><font color=#ca14ca>proc</font></b> ini::ReadPrjTabs {nam val} {
  <i><font color=#4b5d50># Gets tabs of project.</font></i>
  <i><font color=#4b5d50>#   nam - name of option</font></i>
  <i><font color=#4b5d50>#   val - value of option</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> trim <font color=#1b1baa>$val</font>] ne {}} {
    <b><font color=#3a6797>switch</font></b> <font color=#653760>-exact</font> -- <font color=#1b1baa>$nam</font> {
      tab {
        <b><font color=#3a6797>set</font></b> fname [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$val</font> 0]
        <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>lsearch</font></b> <font color=#653760>-exact</font> <font color=#653760>-index</font> 0 <font color=#1b1baa>$al(tabs)</font> <font color=#1b1baa>$fname</font>]&lt;0} {
          <b><font color=#3a6797>lappend</font></b> al(tabs) <font color=#1b1baa>$val</font>
          <b><font color=#3a6797>lassign</font></b> [<b><font color=#3a6797>split</font></b> <font color=#1b1baa>$val</font> \t] - - isexp
          <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> is boolean <font color=#653760>-strict</font> <font color=#1b1baa>$isexp</font>]} {
            <b><font color=#3a6797>dict</font></b> set al(expandUT) <font color=#1b1baa>$fname</font> <font color=#1b1baa>$isexp</font>
          }
        }
      }
      recent {alited::file::InsertRecent <font color=#1b1baa>$val</font> end}
      encode - eol {
        <b><font color=#3a6797>lassign</font></b> [<b><font color=#3a6797>split</font></b> <font color=#1b1baa>$val</font> \t] k v
        <b><font color=#3a6797>set</font></b> al(<font color=#1b1baa>$k</font>) <font color=#1b1baa>$v</font>
      }
    }
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ReadPrjOptions></a>
<b><font color=#ca14ca>proc</font></b> ini::ReadPrjOptions {nam val} {
  <i><font color=#4b5d50># Gets options of project.</font></i>
  <i><font color=#4b5d50>#   nam - name of option</font></i>
  <i><font color=#4b5d50>#   val - value of option</font></i>

  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$nam</font> in {{} prjfile prjname}} {
    <b><font color=#ca14ca>return</font></b> ;<i><font color=#4b5d50># to avoid resetting the current project file name</font></i>
  }
  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>set</font></b> al(<font color=#1b1baa>$nam</font>) <font color=#1b1baa>$val</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ReadPrjFavorites></a>
<b><font color=#ca14ca>proc</font></b> ini::ReadPrjFavorites {nam val} {
  <i><font color=#4b5d50># Gets favorites of project.</font></i>
  <i><font color=#4b5d50>#   nam - name of option</font></i>
  <i><font color=#4b5d50>#   val - value of option</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>switch</font></b> <font color=#653760>-exact</font> -- <font color=#1b1baa>$nam</font> {
    current - visited {<b><font color=#3a6797>lappend</font></b> al(FAV,<font color=#1b1baa>$nam</font>) <font color=#1b1baa>$val</font>}
    saved   {alited::favor_ls::GetIni <font color=#1b1baa>$val</font>}
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ReadPrjMisc></a>
<b><font color=#ca14ca>proc</font></b> ini::ReadPrjMisc {nam val} {
  <i><font color=#4b5d50># Gets favorites of project.</font></i>
  <i><font color=#4b5d50>#   nam - name of option</font></i>
  <i><font color=#4b5d50>#   val - value of option</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>switch</font></b> <font color=#653760>-exact</font> -- <font color=#1b1baa>$nam</font> {
    datafind {
      <b><font color=#3a6797>catch</font></b> {
        <i><font color=#4b5d50># lists of find/replace strings to be restored only</font></i>
        <b><font color=#3a6797>set</font></b> ::alited::find::data(en1) {}
        <b><font color=#3a6797>set</font></b> ::alited::find::data(en2) {}
        <b><font color=#3a6797>array</font></b> set data [::alited::ProcEOL <font color=#1b1baa>$val</font> in]
        <b><font color=#3a6797>set</font></b> ::alited::find::data(vals1) <font color=#1b1baa>$data(vals1)</font>
        <b><font color=#3a6797>set</font></b> ::alited::find::data(vals2) <font color=#1b1baa>$data(vals2)</font>
      }
    }
    comforce   {<b><font color=#3a6797>set</font></b> al(comForce) <font color=#1b1baa>$val</font>}
    comforcech {<b><font color=#3a6797>set</font></b> al(comForceCh) <font color=#1b1baa>$val</font>}
    comforcels {<b><font color=#3a6797>set</font></b> al(comForceLs) <font color=#1b1baa>$val</font>}
    expandFT   {<b><font color=#3a6797>set</font></b> al(expandFT) <font color=#1b1baa>$val</font>}
  }
}
<a id=Saving_settings></a>
<i><font color=#4b5d50># ____________________________ Saving settings ____________________________ #</font></i>
<a id=ini::SaveCurrentIni></a>
<b><font color=#ca14ca>proc</font></b> ini::SaveCurrentIni {{saveon yes} {doit no}} {
  <i><font color=#4b5d50># Saves a current configuration of alited on various events.</font></i>
  <i><font color=#4b5d50>#   saveon - flag &quot;save on event&quot;</font></i>
  <i><font color=#4b5d50>#   doit - serves to run this procedure after idle</font></i>
  <i><font color=#4b5d50># See also: project::Ok</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <i><font color=#4b5d50># for sessions to come</font></i>
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>expr</font></b> <font color=#1b1baa>$saveon</font>]} <b><font color=#ca14ca>return</font></b>
  <i><font color=#4b5d50># al(project::Ok) is set at switching projects and closing old project's files</font></i>
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> exists al(project::Ok)]} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>variable</font></b> afterID
  <i><font color=#4b5d50># run this code after updating GUI</font></i>
  <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>after</font></b> cancel <font color=#1b1baa>$afterID</font>}
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$doit</font>} {
    SaveIni
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> afterID [<b><font color=#3a6797>after</font></b> idle ::alited::ini::SaveCurrentIni yes yes]
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::SaveIni></a>
<b><font color=#ca14ca>proc</font></b> ini::SaveIni {{newproject no}} {
  <i><font color=#4b5d50># Saves a current configuration of alited.</font></i>
  <i><font color=#4b5d50>#   newproject - flag &quot;for a new project&quot;</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al obPav obPav
  <b><font color=#3a6797>namespace</font></b> upvar ::alited::pref em_Num em_Num em_ico em_ico em_inf em_inf
  <b><font color=#3a6797>namespace</font></b> upvar ::alited::project prjlist prjlist prjinfo prjinfo
  <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot;alited storing: <font color=#1b1baa>$</font>al(INI)&quot;</font>
  <b><font color=#3a6797>set</font></b> chan [<b><font color=#3a6797>open</font></b> <font color=#1b1baa>$::alited::al(INI)</font> w]
  <b><font color=#3a6797>chan</font></b> configure <font color=#1b1baa>$chan</font> <font color=#653760>-buffering</font> full <font color=#653760>-buffersize</font> 131072
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {[Options]}
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;comm_port=<font color=#1b1baa>$</font>al(comm_port)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;comm_port_list=<font color=#1b1baa>$</font>al(comm_port_list)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;project=<font color=#1b1baa>$</font>al(prjfile)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;theme=<font color=#1b1baa>$</font>al(THEME)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;cs=<font color=#1b1baa>$</font>al(INI,CS)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;hue=<font color=#1b1baa>$</font>al(INI,HUE)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;local=<font color=#1b1baa>$</font>al(LOCAL)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;deffont=<font color=#1b1baa>$</font>al(FONT)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;smallfontsize=<font color=#1b1baa>$</font>al(FONTSIZE,small)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;stdfontsize=<font color=#1b1baa>$</font>al(FONTSIZE,std)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;txtfont=<font color=#1b1baa>$</font>al(FONT,txt)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;maxfind=<font color=#1b1baa>$</font>al(INI,maxfind)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;confirmexit=<font color=#1b1baa>$</font>al(INI,confirmexit)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;belltoll=<font color=#1b1baa>$</font>al(INI,belltoll)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;spacing1=<font color=#1b1baa>$</font>al(ED,sp1)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;spacing2=<font color=#1b1baa>$</font>al(ED,sp2)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;spacing3=<font color=#1b1baa>$</font>al(ED,sp3)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;CKeyWords=<font color=#1b1baa>$</font>al(ED,CKeyWords)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;TclKeyWords=<font color=#1b1baa>$</font>al(ED,TclKeyWords)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;cursorwidth=<font color=#1b1baa>$</font>al(CURSORWIDTH)&quot;</font>
  <b><font color=#3a6797>set</font></b> clrnams [::hl_tcl::hl_colorNames]
  <b><font color=#3a6797>foreach</font></b> lng {{} C} {
    <b><font color=#3a6797>foreach</font></b> nam <font color=#1b1baa>$clrnams</font> {<b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>lng<font color=#1b1baa>$</font>nam=<font color=#1b1baa>$</font>al(ED,<font color=#1b1baa>$</font>lng<font color=#1b1baa>$</font>nam)&quot;</font>}
  }
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;clrDark=<font color=#1b1baa>$</font>al(ED,Dark)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;save_onadd=<font color=#1b1baa>$</font>al(INI,save_onadd)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;save_onclose=<font color=#1b1baa>$</font>al(INI,save_onclose)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;save_onsave=<font color=#1b1baa>$</font>al(INI,save_onsave)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;TclExts=<font color=#1b1baa>$</font>al(TclExts)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;ClangExts=<font color=#1b1baa>$</font>al(ClangExts)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;TextExts=<font color=#1b1baa>$</font>al(TextExts)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;REbranch=<font color=#1b1baa>$</font>al(RE,branch)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;REproc=<font color=#1b1baa>$</font>al(RE,proc)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;REproc2=<font color=#1b1baa>$</font>al(RE,proc2)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;REleaf=<font color=#1b1baa>$</font>al(RE,leaf)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;REleaf2=<font color=#1b1baa>$</font>al(RE,leaf2)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;UseLeaf=<font color=#1b1baa>$</font>al(INI,LEAF)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;Lines1=<font color=#1b1baa>$</font>al(INI,LINES1)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;RecentFiles=<font color=#1b1baa>$</font>al(INI,RECENTFILES)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;MaxLast=<font color=#1b1baa>$</font>al(FAV,MAXLAST)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;MaxFiles=<font color=#1b1baa>$</font>al(MAXFILES)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;barlablen=<font color=#1b1baa>$</font>al(INI,barlablen)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;bartiplen=<font color=#1b1baa>$</font>al(INI,bartiplen)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;isfindrepl=<font color=#1b1baa>$</font>al(INI,isfindrepl)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> prjtpls=[::alited::ProcEOL <font color=#1b1baa>$al(PTP,list)</font> out]
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;backup=<font color=#1b1baa>$</font>al(BACKUP)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;maxbackup=<font color=#1b1baa>$</font>al(MAXBACKUP)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;gutterwidth=<font color=#1b1baa>$</font>al(ED,gutterwidth)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;guttershift=<font color=#1b1baa>$</font>al(ED,guttershift)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;btsbd=<font color=#1b1baa>$</font>al(ED,btsbd)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;BlinkCurs=<font color=#1b1baa>$</font>al(ED,BlinkCurs)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;ClrCurs=<font color=#1b1baa>$</font>al(CURSORCOLOR)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;prjdefault=<font color=#1b1baa>$</font>al(PRJDEFAULT)&quot;</font>
  <b><font color=#3a6797>foreach</font></b> k [<b><font color=#3a6797>array</font></b> names al DEFAULT,*] {
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>k=<font color=#1b1baa>$</font>al(<font color=#1b1baa>$</font>k)&quot;</font>
  }
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;findunit=<font color=#1b1baa>$</font>al(findunitvals)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;afterstart=<font color=#1b1baa>$</font>al(afterstart)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;ALEversion=<font color=#1b1baa>[</font>AlitedVersion<font color=#1b1baa>]</font>&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;todoahead=<font color=#1b1baa>$</font>al(todoahead)&quot;</font>

  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {}
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {[Templates]}
  <b><font color=#3a6797>foreach</font></b> t <font color=#1b1baa>$al(TPL,list)</font> {
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;tpl=<font color=#1b1baa>$</font>t&quot;</font>
  }
  <b><font color=#3a6797>foreach</font></b> n {%d %t %u %U %m %w} {
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>n=<font color=#1b1baa>$</font>al(TPL,<font color=#1b1baa>$</font>n)&quot;</font>
  }
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {}
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {[Keys]}
  <b><font color=#3a6797>foreach</font></b> k <font color=#1b1baa>$al(KEYS,bind)</font> {
    <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>string</font></b> match template* <font color=#1b1baa>$k</font>] && ![<b><font color=#3a6797>string</font></b> match action* <font color=#1b1baa>$k</font>]} {
      <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;key=<font color=#1b1baa>$</font>k&quot;</font>
    }
  }
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {}
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {[EM]}
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;emsave=<font color=#1b1baa>$</font>al(EM,save)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;emPD=<font color=#1b1baa>$</font>al(EM,PD=)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;emTcl=<font color=#1b1baa>$</font>al(EM,Tcl)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;emTclList=<font color=#1b1baa>$</font>al(EM,TclList)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;emh=<font color=#1b1baa>$</font>al(EM,h=)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;emtt=<font color=#1b1baa>$</font>al(EM,tt=)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;emttList=<font color=#1b1baa>$</font>al(EM,tt=List)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;emwt=<font color=#1b1baa>$</font>al(EM,wt=)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;emmenu=<font color=#1b1baa>$</font>al(EM,mnu)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;emmenudir=<font color=#1b1baa>$</font>al(EM,mnudir)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;emcs=<font color=#1b1baa>$</font>al(EM,CS)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;emowncs=<font color=#1b1baa>$</font>al(EM,ownCS)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;emgeometry=<font color=#1b1baa>$</font>al(EM,geometry)&quot;</font>
  <i><font color=#4b5d50>#  puts $chan &quot;emexec=$al(EM,exec)&quot;</font></i>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;emdiff=<font color=#1b1baa>$</font>al(EM,DiffTool)&quot;</font>
  <b><font color=#3a6797>set</font></b> em_N [Em_Number <font color=#1b1baa>$em_Num</font>]
  <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i 0} {<font color=#1b1baa>$i</font>&lt;<font color=#1b1baa>$em_N</font>} {<b><font color=#3a6797>incr</font></b> i} {
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> exists em_inf(<font color=#1b1baa>$i</font>)]} {
      <b><font color=#3a6797>set</font></b> em_run em_run=
      <b><font color=#3a6797>append</font></b> em_run [alited::TextIcon <font color=#1b1baa>$em_ico($i)</font> in] \t <font color=#1b1baa>$em_inf($i)</font>
      <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#1b1baa>$em_run</font>
    }
  }
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {}
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {[Tkcon]}
  <b><font color=#3a6797>foreach</font></b> k [<b><font color=#3a6797>array</font></b> names al tkcon,*] {
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>string range <font color=#1b1baa>$</font>k 6 end<font color=#1b1baa>]</font>=<font color=#1b1baa>$</font>al(<font color=#1b1baa>$</font>k)&quot;</font>
  }
  <i><font color=#4b5d50># save misc settings</font></i>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {}
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {[Misc]}
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;isfavor=<font color=#1b1baa>$</font>al(FAV,IsFavor)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;chosencolor=<font color=#1b1baa>$</font>al(chosencolor)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;showinfo=<font color=#1b1baa>$</font>al(TREE,showinfo)&quot;</font>
  <b><font color=#3a6797>set</font></b> al(listSBL) [::alited::ProcEOL <font color=#1b1baa>$al(listSBL)</font> out]
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;listSBL=<font color=#1b1baa>$</font>al(listSBL)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;moveall=<font color=#1b1baa>$</font>al(moveall)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;tonemoves=<font color=#1b1baa>$</font>al(tonemoves)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;checkgeo=<font color=#1b1baa>$</font>al(checkgeo)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;gotoline=<font color=#1b1baa>$</font>al(gotoline)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;HelpedMe=<font color=#1b1baa>$</font>::alited::helpedMe&quot;</font>
  <b><font color=#3a6797>foreach</font></b> k [<b><font color=#3a6797>array</font></b> names al <font color=#653760>-glob</font> TIPS,*] {
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>k=<font color=#1b1baa>$</font>al(<font color=#1b1baa>$</font>k)&quot;</font>
  }
  <b><font color=#3a6797>foreach</font></b> k [<b><font color=#3a6797>array</font></b> names al <font color=#653760>-glob</font> MNUGEO,*] {
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>k=<font color=#1b1baa>$</font>al(<font color=#1b1baa>$</font>k)&quot;</font>
  }
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;sortList=<font color=#1b1baa>$</font>al(sortList)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;tplilast=<font color=#1b1baa>$</font>::alited::unit::ilast&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;incdec=<font color=#1b1baa>$</font>al(incdecName) <font color=#1b1baa>$</font>al(incdecDate) <font color=#1b1baa>$</font>al(incdecSize) <font color=#1b1baa>$</font>al(incdecExtn)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;blifo=<font color=#1b1baa>$</font>al(lifo)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;activemacro=<font color=#1b1baa>$</font>al(activemacro)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> InRE2=[::alited::ProcEOL <font color=#1b1baa>$::alited::find::InRE2</font> out]
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> ExRE2=[::alited::ProcEOL <font color=#1b1baa>$::alited::find::ExRE2</font> out]
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;chInRE2=<font color=#1b1baa>$</font>::alited::find::chInRE2&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;chExRE2=<font color=#1b1baa>$</font>::alited::find::chExRE2&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;geoRE2=<font color=#1b1baa>$</font>::alited::find::geoRE2&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;commentmode=<font color=#1b1baa>$</font>al(commentmode)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;format_separ1=<font color=#1b1baa>$</font>al(format_separ1)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;format_separ2=<font color=#1b1baa>$</font>al(format_separ2)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;markwidth=<font color=#1b1baa>$</font>al(markwidth)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;klndweeks=<font color=#1b1baa>$</font>al(klndweeks)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;topFindRepl=<font color=#1b1baa>$</font>al(topFindRepl)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;DockGeo=<font color=#1b1baa>$</font>al(DockGeo)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;DockLayout=<font color=#1b1baa>$</font>al(DockLayout)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;ApaveLayout=<font color=#1b1baa>$</font>al(ApaveLayout)&quot;</font>
  <i><font color=#4b5d50># save the Edit/Formats pluginables</font></i>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {}
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {[Formats]}
  <b><font color=#3a6797>foreach</font></b> n [<b><font color=#3a6797>array</font></b> names al <font color=#653760>-glob</font> FORMATS,*] {
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;pluginable=<font color=#1b1baa>$</font>al(<font color=#1b1baa>$</font>n)&quot;</font>
  }
  <i><font color=#4b5d50># save the geometry options</font></i>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {}
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {[Geometry]}
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;runGeometry=<font color=#1b1baa>$</font>al(runGeometry)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;geomfind=<font color=#1b1baa>$</font>::alited::find::geo&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;geomfind2=<font color=#1b1baa>$</font>::alited::find::geo2&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;geomproject=<font color=#1b1baa>$</font>::alited::project::geo&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;geomtodolist=<font color=#1b1baa>$</font>::alited::project::geotodolist&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;geompref=<font color=#1b1baa>$</font>::alited::pref::geo&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;dirgeometry=<font color=#1b1baa>$</font>::alited::DirGeometry&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;filgeometry=<font color=#1b1baa>$</font>::alited::FilGeometry&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;favgeometry=<font color=#1b1baa>$</font>::alited::favgeometry&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;tplgeometry=<font color=#1b1baa>$</font>::alited::tplgeometry&quot;</font>
  <b><font color=#3a6797>set</font></b> wtree [<font color=#1b1baa>$obPav</font> Tree]
  <b><font color=#3a6797>set</font></b> al(TREE,cw0) [<font color=#1b1baa>$wtree</font> column #0 <font color=#653760>-width</font>]
  <b><font color=#3a6797>set</font></b> al(TREE,cw1) [<font color=#1b1baa>$wtree</font> column #1 <font color=#653760>-width</font>]
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;treecw0=<font color=#1b1baa>$</font>al(TREE,cw0)&quot;</font>
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;treecw1=<font color=#1b1baa>$</font>al(TREE,cw1)&quot;</font>
  <b><font color=#3a6797>foreach</font></b> v {Pan PanL PanR PanBM PanTop} {
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> exists al(width<font color=#1b1baa>$v</font>)]} {
      <b><font color=#3a6797>set</font></b> w <font color=#1b1baa>$al(width$v)</font>
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> w [<b><font color=#134070>winfo</font></b> geometry [<font color=#1b1baa>$obPav</font> <font color=#1b1baa>$v</font>]]
    }
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#1b1baa>$v</font>=<font color=#1b1baa>$w</font>
  }
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;GEOM=<font color=#1b1baa>[</font>wm geometry <font color=#1b1baa>$</font>al(WIN)<font color=#1b1baa>]</font>&quot;</font>
  <b><font color=#3a6797>foreach</font></b> id {1 2 3 4 5 6 7 8} {
    <b><font color=#3a6797>lassign</font></b> [alited::file::DetachedInfo <font color=#1b1baa>$id</font>] pobj win
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> exists <font color=#1b1baa>$pobj</font>]} {
      <b><font color=#3a6797>if</font></b> {[<b><font color=#134070>winfo</font></b> exists <font color=#1b1baa>$win</font>]} {
        <b><font color=#3a6797>set</font></b> geo [<b><font color=#134070>wm</font></b> geometry <font color=#1b1baa>$win</font>]
      } <b><font color=#3a6797>else</font></b> {
        <b><font color=#3a6797>set</font></b> geo [<b><font color=#3a6797>set</font></b> <font color=#1b1baa>$pobj</font>]
      }
      <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;detach<font color=#1b1baa>$</font>id=<font color=#1b1baa>$</font>geo&quot;</font>
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#ca14ca>break</font></b>
    }
  }
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;fontdetach=<font color=#1b1baa>$</font>al(fontdetach)&quot;</font>
  <b><font color=#3a6797>close</font></b> <font color=#1b1baa>$chan</font>
  SaveIniPrj <font color=#1b1baa>$newproject</font>
  SaveIniGlob
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::SaveIniPrj></a>
<b><font color=#ca14ca>proc</font></b> ini::SaveIniPrj {{newproject no}} {
  <i><font color=#4b5d50># Saves settings of project.</font></i>
  <i><font color=#4b5d50>#   newproject - flag &quot;for a new project&quot;</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$al(prjroot)</font> eq {}} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>set</font></b> tabs <font color=#1b1baa>$al(tabs)</font>
  <b><font color=#3a6797>set</font></b> al(tabs) [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot;alited storing: <font color=#1b1baa>$</font>al(prjfile)&quot;</font>
  <b><font color=#3a6797>set</font></b> chan [<b><font color=#3a6797>open</font></b> <font color=#1b1baa>$al(prjfile)</font> w]
  <b><font color=#3a6797>chan</font></b> configure <font color=#1b1baa>$chan</font> <font color=#653760>-buffering</font> full <font color=#653760>-buffersize</font> 262144
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {[Tabs]}
  <b><font color=#3a6797>lassign</font></b> [alited::bar::GetBarState] TIDcur - wtxt
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$newproject</font>} {
    <b><font color=#3a6797>set</font></b> tabs [alited::bar::BAR listTab]
  }
  <b><font color=#3a6797>foreach</font></b> tab <font color=#1b1baa>$tabs</font> {  ;<i><font color=#4b5d50># save the current files' list & states</font></i>
    <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$newproject</font>} {
      <b><font color=#3a6797>set</font></b> TID [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tab</font> 0]
      <b><font color=#3a6797>set</font></b> tab [alited::bar::FileName <font color=#1b1baa>$TID</font>]
      <b><font color=#3a6797>if</font></b> {[alited::file::IsNoName <font color=#1b1baa>$tab</font>]} <b><font color=#ca14ca>continue</font></b>
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$TID</font> eq <font color=#1b1baa>$TIDcur</font>} {
        <b><font color=#3a6797>set</font></b> pos [<font color=#1b1baa>$wtxt</font> index insert]
      } <b><font color=#3a6797>else</font></b> {
        <b><font color=#3a6797>set</font></b> pos [alited::bar::GetTabState <font color=#1b1baa>$TID</font> <font color=#653760>--pos</font>]
      }
      <i><font color=#4b5d50># save the current cursor position (fit to all files)</font></i>
      <b><font color=#3a6797>append</font></b> tab \t <font color=#1b1baa>$pos</font> \t [alited::tree::IsExpandUT <font color=#1b1baa>$tab</font>]
      <b><font color=#3a6797>catch</font></b> {
        <b><font color=#3a6797>set</font></b> wrap [[alited::main::GetWTXT <font color=#1b1baa>$TID</font>] cget <font color=#653760>-wrap</font>]
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$wrap</font> ne {word}} {
          <b><font color=#3a6797>append</font></b> tab \t <font color=#1b1baa>$wrap</font>  ;<i><font color=#4b5d50># save the current wrap!=word (fit to strange files)</font></i>
        }
      }
    }
    <b><font color=#3a6797>lappend</font></b> al(tabs) <font color=#1b1baa>$tab</font>
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> tab=<font color=#1b1baa>$tab</font>
  }
  <b><font color=#3a6797>foreach</font></b> rf <font color=#1b1baa>$al(RECENTFILES)</font> {
    <b><font color=#3a6797>if</font></b> {![alited::file::IsNoName <font color=#1b1baa>$rf</font>]} {
      <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> recent=<font color=#1b1baa>$rf</font>
    }
  }
  <b><font color=#3a6797>foreach</font></b> {key1 key2} {ENCODING encode EOL eol} {
    <b><font color=#3a6797>foreach</font></b> k [<b><font color=#3a6797>array</font></b> names al <font color=#1b1baa>$key1</font>,*] {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$al($k)</font> ni {utf-8 auto}} {
        <i><font color=#4b5d50># restrict the saved with currently used files only</font></i>
        <b><font color=#3a6797>set</font></b> fname [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$k</font> [<b><font color=#3a6797>string</font></b> first , <font color=#1b1baa>$k</font>]+1 end]
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$fname</font> in <font color=#1b1baa>$al(RECENTFILES)</font> || [alited::bar::FileTID <font color=#1b1baa>$fname</font>] ne {}} {
          <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>key2=<font color=#1b1baa>$</font>k\t<font color=#1b1baa>$</font>al(<font color=#1b1baa>$</font>k)&quot;</font>
        }
      }
    }
  }
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {}
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {[Options]}
  <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> curtab=[alited::bar::CurrentTab 3]
  <b><font color=#3a6797>foreach</font></b> {opt val} [<b><font color=#3a6797>array</font></b> get al prj*] {
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> <font color=#1b1baa>$opt</font>=<font color=#1b1baa>$val</font>
  }
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$newproject</font>} {
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {}
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {[Favorites]}
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$al(FAV,IsFavor)</font>} {
      <b><font color=#3a6797>set</font></b> favlist [alited::tree::GetTree {} TreeFavor]
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> favlist <font color=#1b1baa>$al(FAV,current)</font>
    }
    <b><font color=#3a6797>foreach</font></b> curfav <font color=#1b1baa>$favlist</font> {
      <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> current=<font color=#1b1baa>$curfav</font>
    }
    <b><font color=#3a6797>foreach</font></b> savfav [::alited::favor_ls::PutIni] {
      <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> saved=<font color=#1b1baa>$savfav</font>
    }
    <b><font color=#3a6797>foreach</font></b> visited <font color=#1b1baa>$al(FAV,visited)</font> {
      <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> visited=<font color=#1b1baa>$visited</font>
    }
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {}
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> {[Misc]}
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> datafind=[::alited::ProcEOL [<b><font color=#3a6797>array</font></b> get ::alited::find::data] out]
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> comforce=<font color=#1b1baa>$al(comForce)</font>
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> comforcech=<font color=#1b1baa>$al(comForceCh)</font>
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> comforcels=<font color=#1b1baa>$al(comForceLs)</font>
    <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$chan</font> expandFT=<font color=#1b1baa>$al(expandFT)</font>
  }
  <b><font color=#3a6797>puts</font></b> \n
  <b><font color=#3a6797>close</font></b> <font color=#1b1baa>$chan</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::SaveIniGlob></a>
<b><font color=#ca14ca>proc</font></b> ini::SaveIniGlob {} {
  <i><font color=#4b5d50># Save 3 lines of global configuration of alited:</font></i>
  <i><font color=#4b5d50># current .ini file, current project's path, list of config dirs</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>set</font></b> cont [<b><font color=#3a6797>file</font></b> dirname <font color=#1b1baa>$al(INI)</font>]\n[<b><font color=#3a6797>file</font></b> dirname <font color=#1b1baa>$al(prjfile)</font>]\n<font color=#1b1baa>$::alited::CONFIGS</font>
  writeTextFile <font color=#1b1baa>$::alited::USERLASTINI</font> cont
}
<a id=Updating_alited's_data></a>
<i><font color=#4b5d50># ______________________ Updating alited's data ______________________ #</font></i>
<a id=ini::AlitedVersion></a>
<b><font color=#ca14ca>proc</font></b> ini::AlitedVersion {} {
  <i><font color=#4b5d50># Gets current version of alited.</font></i>

  <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>package</font></b> require alited]
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ViewUpdates></a>
<b><font color=#ca14ca>proc</font></b> ini::ViewUpdates {} {
  <i><font color=#4b5d50># Views changes for updating.</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited DATADIR DATADIR
  obj vieweditFile [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$DATADIR</font> to-update.txt] {} <font color=#653760>-rotext</font> 1 <font color=#653760>-h</font> 25
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::UpdateTemplates></a>
<b><font color=#ca14ca>proc</font></b> ini::UpdateTemplates {inideffile} {
  <i><font color=#4b5d50># Updates templates.</font></i>
  <i><font color=#4b5d50>#   inideffile - ini file name of default templates</font></i>

  <b><font color=#3a6797>set</font></b> tplmode 0
  <i><font color=#4b5d50># read new templates: from [Templates] to [Keys]</font></i>
  <b><font color=#3a6797>foreach</font></b> stini [<b><font color=#3a6797>split</font></b> [readTextFile <font color=#1b1baa>$inideffile</font> {} 1] \n] {
    <b><font color=#3a6797>switch</font></b> <font color=#653760>-exact</font> <font color=#1b1baa>$stini</font> {
      {[Templates]} {<b><font color=#3a6797>set</font></b> tplmode 1}
      {[Keys]} <b><font color=#ca14ca>break</font></b>
    }
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tplmode</font> && [<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>string</font></b> first = <font color=#1b1baa>$stini</font>]]&gt;0} {
      <b><font color=#3a6797>set</font></b> nam [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$stini</font> 0 <font color=#1b1baa>$i</font>-1]
      <b><font color=#3a6797>set</font></b> val [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$stini</font> <font color=#1b1baa>$i</font>+1 end]
      ReadIniTemplates <font color=#1b1baa>$nam</font> <font color=#1b1baa>$val</font> no
    }
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::CheckUpdates></a>
<b><font color=#ca14ca>proc</font></b> ini::CheckUpdates {doit} {
  <i><font color=#4b5d50># Updates significant data of current version of alited.</font></i>
  <i><font color=#4b5d50>#   doit - yes, if it's called from menu</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al DATAUSERINIFILE DATAUSERINIFILE MNUDIR MNUDIR
  <b><font color=#3a6797>set</font></b> al(_updmnu_) [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$doit</font> || [<b><font color=#3a6797>package</font></b> vcompare <font color=#1b1baa>$al(ALEversion)</font> <font color=#1b1baa>$al(MNUversion)</font>]&lt;0}]
  <b><font color=#3a6797>set</font></b> al(_updini_) [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$doit</font> || [<b><font color=#3a6797>package</font></b> vcompare <font color=#1b1baa>$al(ALEversion)</font> <font color=#1b1baa>$al(INIversion)</font>]&lt;0}]
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$al(_updmnu_)</font> && !<font color=#1b1baa>$al(_updini_)</font>} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>set</font></b> head <font color=#8b2a0e>&quot;\n <font color=#1b1baa>[</font>msgcat::mc <font color=#1b1baa>{</font>Some things have been changed in alited %v.<font color=#1b1baa>}]</font> &quot;</font>
  <b><font color=#3a6797>set</font></b> head [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %v v[AlitedVersion]] <font color=#1b1baa>$head</font>]
  <b><font color=#3a6797>set</font></b> date _[<b><font color=#3a6797>clock</font></b> format [<b><font color=#3a6797>clock</font></b> seconds] <font color=#653760>-format</font> %Y-%m-%d]
  <b><font color=#3a6797>set</font></b> al(_updDirMnu_) [<b><font color=#3a6797>file</font></b> normalize <font color=#1b1baa>$al(EM,mnudir)$date</font>]
  <b><font color=#3a6797>set</font></b> inidir [<b><font color=#3a6797>file</font></b> dirname <font color=#1b1baa>$al(INI)</font>]
  <b><font color=#3a6797>set</font></b> inifile [<b><font color=#3a6797>file</font></b> tail <font color=#1b1baa>$al(INI)</font>]
  <b><font color=#3a6797>set</font></b> iniext [<b><font color=#3a6797>file</font></b> extension <font color=#1b1baa>$inifile</font>]
  <b><font color=#3a6797>set</font></b> inifile [<b><font color=#3a6797>file</font></b> rootname <font color=#1b1baa>$inifile</font>]
  <b><font color=#3a6797>set</font></b> al(_updFileIni_) [<b><font color=#3a6797>file</font></b> normalize [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$inidir</font> <font color=#1b1baa>$inifile$date$iniext</font>]]
  <b><font color=#3a6797>set</font></b> pobj alitedObjToDel
  ::apave::APave create <font color=#1b1baa>$pobj</font> <font color=#1b1baa>$al(WIN)</font>
  <b><font color=#3a6797>set</font></b> mnudo [<b><font color=#3a6797>expr</font></b> {![<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$al(_updDirMnu_)</font>]}]
  <b><font color=#3a6797>set</font></b> inido [<b><font color=#3a6797>expr</font></b> {![<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$al(_updFileIni_)</font>]}]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$doit</font>} {
    <b><font color=#3a6797>set</font></b> lab5 {}
    <b><font color=#3a6797>set</font></b> ::alited::al(_updmnu_) <font color=#1b1baa>$mnudo</font>
    <b><font color=#3a6797>set</font></b> ::alited::al(_updini_) <font color=#1b1baa>$inido</font>
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> lab5 [<b><font color=#3a6797>list</font></b> \
      seh2  {{} {<font color=#653760>-pady</font> 10} {}} {} \
      lab5  {{} {<font color=#653760>-padx</font> 5} {<font color=#653760>-t</font> {<font color=#1b1baa>$::alited::al(MC,restart)</font>}}} {} \
    ]
  }
  <b><font color=#3a6797>lassign</font></b> [<font color=#1b1baa>$pobj</font> input {} <font color=#1b1baa>$al(MC,updateALE)</font>\ v<font color=#1b1baa>$al(ALEversion)</font> [<b><font color=#3a6797>list</font></b> \
    lab1  {{} {} {<font color=#653760>-t</font> {<font color=#1b1baa>$::alited::al(MC,updLab1)</font>}}}  {} \
    chb1  {{} {<font color=#653760>-padx</font> 10} {<font color=#653760>-t</font> {<font color=#1b1baa>$::alited::al(MC,updmnu)</font>}}} {<font color=#1b1baa>$::alited::al(_updmnu_)</font>} \
    chb2  {{} {<font color=#653760>-padx</font> 10} {<font color=#653760>-t</font> {<font color=#1b1baa>$::alited::al(MC,updini)</font>}}} {<font color=#1b1baa>$::alited::al(_updini_)</font>} \
    seh1  {{} {<font color=#653760>-pady</font> 10} {}} {} \
    lab2  {{} {} {<font color=#653760>-t</font> {<font color=#1b1baa>$::alited::al(MC,updLab2)</font>}}} {} \
    lab3  {{} {<font color=#653760>-padx</font> 20} {<font color=#653760>-t</font> {<font color=#1b1baa>$::alited::al(_updDirMnu_)</font>}}} {} \
    lab4  {{} {<font color=#653760>-padx</font> 20} {<font color=#653760>-t</font> {<font color=#1b1baa>$::alited::al(_updFileIni_)</font>}}} {} \
    {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$lab5</font> \
    ] <font color=#653760>-head</font> <font color=#1b1baa>$head</font> {<b><font color=#3a6797>*</font></b>}[obj basicTextFont] <font color=#653760>-weight</font> bold <font color=#653760>-buttons</font> <font color=#8b2a0e>&quot;butHELP <font color=#1b1baa>{</font>View Changes<font color=#1b1baa>}</font> \</font>
<font color=#8b2a0e>    ::alited::ini::ViewUpdates&quot;</font> <font color=#653760>-resizable</font> no <font color=#653760>-focus</font> *YES] \
    res updmnu updini
  <b><font color=#3a6797>catch</font></b> {<font color=#1b1baa>$pobj</font> destroy}
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$res</font>} {<b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$doit</font>} <b><font color=#ca14ca>return</font></b> else exit}
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$updmnu</font> && !<font color=#1b1baa>$updini</font>} <b><font color=#ca14ca>return</font></b>
  CreatePossibleNewDirs ;<i><font color=#4b5d50># it's good to do it here</font></i>
  <b><font color=#3a6797>set</font></b> err {}
  <b><font color=#3a6797>set</font></b> mnudone 0
  <b><font color=#3a6797>set</font></b> inidone 0
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$updmnu</font> && <font color=#1b1baa>$mnudo</font> && \
  ![<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>file</font></b> rename <font color=#1b1baa>$al(EM,mnudir)</font> <font color=#1b1baa>$al(_updDirMnu_)</font>} err]} {
    <b><font color=#3a6797>set</font></b> err {}
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$err</font> eq {} && <font color=#1b1baa>$updmnu</font> && <font color=#1b1baa>$mnudo</font>} {
    <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>file</font></b> copy <font color=#1b1baa>$MNUDIR</font> <font color=#1b1baa>$al(EM,mnudir)</font>} err]} {
      <b><font color=#3a6797>set</font></b> err {}
      <b><font color=#3a6797>set</font></b> mnudone 1
    }
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$err</font> eq {} && <font color=#1b1baa>$updini</font> && <font color=#1b1baa>$inido</font> && \
  ![<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>file</font></b> copy <font color=#1b1baa>$al(INI)</font> <font color=#1b1baa>$al(_updFileIni_)</font>} err]} {
    <b><font color=#3a6797>set</font></b> err {}
    <b><font color=#3a6797>set</font></b> inidone 1
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$err</font> eq {} && <font color=#1b1baa>$inidone</font>} {
    UpdateTemplates <font color=#1b1baa>$DATAUSERINIFILE</font>
  }
  alited::ini::SaveIni
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$doit</font>} {
    alited::Exit - 1 no
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$err</font> ne {}} {
      ::apave::APave create <font color=#1b1baa>$pobj</font> <font color=#1b1baa>$al(WIN)</font>
      <font color=#1b1baa>$pobj</font> ok err Error <font color=#1b1baa>$err</font> <font color=#653760>-text</font> 1 <font color=#653760>-w</font> 50 <font color=#653760>-h</font> {3 5}
      <b><font color=#3a6797>catch</font></b> {<font color=#1b1baa>$pobj</font> destroy}
    } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$mnudone</font> || <font color=#1b1baa>$inidone</font>} {
      <b><font color=#3a6797>set</font></b> msg <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>al(MC,updateALE):&quot;</font>
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$mnudone</font>} {<b><font color=#3a6797>append</font></b> msg <font color=#8b2a0e>&quot;   <font color=#1b1baa>$</font>al(MC,updmnu)&quot;</font>}
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$inidone</font>} {<b><font color=#3a6797>append</font></b> msg <font color=#8b2a0e>&quot;   <font color=#1b1baa>$</font>al(MC,updini)&quot;</font>}
      alited::Message <font color=#8b2a0e>&quot;\n <font color=#1b1baa>$</font>msg \n&quot;</font> 3
    }
  }
}
<a id=Configuring_alited></a>
<i><font color=#4b5d50># ______________________ Configuring alited ______________________ #</font></i>
<a id=ini::GetConfiguration></a>
<b><font color=#ca14ca>proc</font></b> ini::GetConfiguration {} {
  <i><font color=#4b5d50># Gets the configuration directory's name.</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al obDl2 obDl2
  <b><font color=#3a6797>variable</font></b> configs
  <b><font color=#3a6797>set</font></b> configs <font color=#1b1baa>$::alited::CONFIGS</font>
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$configs</font>]} {<b><font color=#3a6797>lappend</font></b> configs <font color=#1b1baa>$::alited::CONFIGDIR</font>}
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$configs</font> 0] eq {-}} {
    <b><font color=#3a6797>set</font></b> configs [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$configs</font> 0 0]  ;<i><font color=#4b5d50># legacy</font></i>
  }
  <b><font color=#3a6797>set</font></b> head [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %d <font color=#1b1baa>$::alited::CONFIGDIRSTD</font>] <font color=#1b1baa>$al(MC,chini2)</font>]
  <b><font color=#3a6797>set</font></b> pobj <font color=#1b1baa>$obDl2</font>
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> commands <font color=#1b1baa>$pobj</font>] eq {}} {
    <i><font color=#4b5d50># at first start, there are no apave objects bound to the main window of alited</font></i>
    <i><font color=#4b5d50># -&gt; create an independent one to be deleted afterwards</font></i>
    <b><font color=#3a6797>set</font></b> pobj alitedObjToDel
    ::apave::APave create <font color=#1b1baa>$pobj</font>
  }
  <b><font color=#3a6797>set</font></b> res [<font color=#1b1baa>$pobj</font> input {} <font color=#1b1baa>$al(MC,chini1)</font> \
    [<b><font color=#3a6797>list</font></b> \
      diR1 [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$al(MC,chini3)</font> {} [<b><font color=#3a6797>list</font></b> <font color=#653760>-title</font> <font color=#1b1baa>$al(MC,chini3)</font> <font color=#653760>-w</font> 50 \
        <font color=#653760>-values</font> <font color=#1b1baa>$configs</font> <font color=#653760>-clearcom</font> {alited::main::ClearCbx %w ::alited::ini::configs}]] \
        <font color=#8b2a0e>&quot;<font color=#1b1baa>{$</font>::alited::CONFIGDIR<font color=#1b1baa>}</font>&quot;</font> \
    ] <font color=#653760>-head</font> <font color=#1b1baa>$head</font> <font color=#653760>-help</font> alited::ini::Help <font color=#653760>-resizable</font> no {<b><font color=#3a6797>*</font></b>}[obj basicTextFont]]
  <b><font color=#3a6797>catch</font></b> {alitedObjToDel destroy}
  <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$res</font> ok confdir
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$ok</font>} {
    <b><font color=#3a6797>set</font></b> confdir [<b><font color=#3a6797>file</font></b> normalize [<b><font color=#3a6797>string</font></b> trim <font color=#1b1baa>$confdir</font>]]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$confdir</font> eq {}} {
      <b><font color=#3a6797>set</font></b> ok no
    } <b><font color=#3a6797>else</font></b> {
      AddConfigDir <font color=#1b1baa>$confdir</font> <font color=#1b1baa>$configs</font>
    }
  }
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$ok</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::AddConfigDir></a>
<b><font color=#ca14ca>proc</font></b> ini::AddConfigDir {confdir configs} {
  <i><font color=#4b5d50># Adds a config directory to the list of all config dirs.</font></i>
  <i><font color=#4b5d50>#   confdir - config directory</font></i>
  <i><font color=#4b5d50>#   configs - list of config dirs</font></i>
  <i><font color=#4b5d50># Returns -1, if *confdir* was absent in *configs*.</font></i>

  <b><font color=#3a6797>set</font></b> ::alited::CONFIGDIR <font color=#1b1baa>$confdir</font>
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> res [::apave::lsearchFile <font color=#1b1baa>$configs</font> <font color=#1b1baa>$confdir</font>]]&gt;-1} {
    <b><font color=#3a6797>set</font></b> configs [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$configs</font> <font color=#1b1baa>$res</font> <font color=#1b1baa>$res</font>]
  }
  <b><font color=#3a6797>set</font></b> ::alited::CONFIGS [<b><font color=#3a6797>linsert</font></b> <font color=#1b1baa>$configs</font> 0 <font color=#1b1baa>$confdir</font>]
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$res</font>
}
<a id=Initializing_alited_app></a>
<i><font color=#4b5d50># ______________________ Initializing alited app ______________________ #</font></i>
<a id=ini::CheckIni></a>
<b><font color=#ca14ca>proc</font></b> ini::CheckIni {} {
  <i><font color=#4b5d50># Checks if the configuration directory exists and if not asks for it.</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$::alited::INIDIR</font>] || ![<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$::alited::PRJDIR</font>]} {
    ::apave::initWM <font color=#653760>-cursorwidth</font> <font color=#1b1baa>$al(CURSORWIDTH)</font>
    InitGUI
    <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>destroy</font></b> .tex}
    <b><font color=#3a6797>if</font></b> {![GetConfiguration]} <b><font color=#3a6797>exit</font></b>
    ::alited::main_user_dirs
    GetUserDirs yes
    CreateUserDirs
    <b><font color=#3a6797>set</font></b> al(ALEversion) [AlitedVersion]
  }
  <b><font color=#3a6797>if</font></b> {[AddConfigDir <font color=#1b1baa>$::alited::CONFIGDIR</font> <font color=#1b1baa>$::alited::CONFIGS</font>]&lt;0} {
    SaveIniGlob
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::GetUserDirs></a>
<b><font color=#ca14ca>proc</font></b> ini::GetUserDirs {{initmnu no}} {
  <i><font color=#4b5d50># Gets names of user directories for settings.</font></i>
  <i><font color=#4b5d50>#  initmnu - yes, if called to initialize mnu dir</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  ::alited::main_user_dirs
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$al(prjroot)</font> eq {}} {
    <b><font color=#3a6797>set</font></b> ::alited::BAKDIR [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::USERDIR</font> .bak]
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> ::alited::BAKDIR [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$al(prjroot)</font> .bak]
  }
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$::alited::BAKDIR</font>]} {
    <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>file</font></b> mkdir <font color=#1b1baa>$::alited::BAKDIR</font>}
  }
  <b><font color=#3a6797>set</font></b> mnudir [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::USERDIR</font> e_menu menus]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$initmnu</font> && ![<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$mnudir</font>]} {
    <b><font color=#3a6797>set</font></b> al(EM,mnudir) <font color=#1b1baa>$mnudir</font>  ;<i><font color=#4b5d50># to have e_menu in each config dir</font></i>
  }
  <b><font color=#3a6797>set</font></b> al(INI) [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::INIDIR</font> alited.ini]
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::CreateUserDirs></a>
<b><font color=#ca14ca>proc</font></b> ini::CreateUserDirs {} {
  <i><font color=#4b5d50># Creates main directories for settings.</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al USERDIR USERDIR INIDIR INIDIR PRJDIR PRJDIR \
    MNUDIR MNUDIR DATAUSER DATAUSER DATAUSERINIFILE DATAUSERINIFILE PRJEXT PRJEXT
  <b><font color=#3a6797>foreach</font></b> dir {USERDIR INIDIR PRJDIR} {
    <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>file</font></b> mkdir [<b><font color=#3a6797>set</font></b> <font color=#1b1baa>$dir</font>]}
  }
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$al(INI)</font>]} {
    <b><font color=#3a6797>file</font></b> copy <font color=#1b1baa>$DATAUSERINIFILE</font> <font color=#1b1baa>$al(INI)</font>
    <b><font color=#3a6797>file</font></b> copy [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$DATAUSER</font> prj default<font color=#1b1baa>$PRJEXT</font>] \
      [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$PRJDIR</font> default<font color=#1b1baa>$PRJEXT</font>]
    <b><font color=#3a6797>file</font></b> copy [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$DATAUSER</font> notes.txt] [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$USERDIR</font> notes.txt]
    ReadIni
  }
  <b><font color=#3a6797>set</font></b> emdir [<b><font color=#3a6797>file</font></b> dirname <font color=#1b1baa>$al(EM,mnudir)</font>]
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$emdir</font>]} {
    <b><font color=#3a6797>file</font></b> mkdir <font color=#1b1baa>$emdir</font>
    <b><font color=#3a6797>file</font></b> copy <font color=#1b1baa>$MNUDIR</font> <font color=#1b1baa>$emdir</font>
    <b><font color=#3a6797>file</font></b> copy [<b><font color=#3a6797>file</font></b> join [<b><font color=#3a6797>file</font></b> dirname <font color=#1b1baa>$MNUDIR</font>] em_projects] <font color=#1b1baa>$emdir</font>
  }
  CreatePossibleNewDirs
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::CreateMacrosDir></a>
<b><font color=#ca14ca>proc</font></b> ini::CreateMacrosDir {} {
  <i><font color=#4b5d50># Creates macros' directory.</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al DATAUSER DATAUSER
  <b><font color=#3a6797>set</font></b> macrodir [<b><font color=#3a6797>file</font></b> dirname [alited::edit::MacroFileName -]]
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$macrodir</font>]} {
    <b><font color=#3a6797>file</font></b> mkdir <font color=#1b1baa>$macrodir</font>
    <b><font color=#3a6797>foreach</font></b> f [<b><font color=#3a6797>glob</font></b> <font color=#653760>-nocomplain</font> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$DATAUSER</font> macro *]] {
      <b><font color=#3a6797>file</font></b> copy <font color=#1b1baa>$f</font> <font color=#1b1baa>$macrodir</font>
    }
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::CreatePossibleNewDirs></a>
<b><font color=#ca14ca>proc</font></b> ini::CreatePossibleNewDirs {} {
  <i><font color=#4b5d50># Creates a user directories, possibly new after v1.4.0 (e.g. macro).</font></i>

  CreateMacrosDir
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::CreateIcon></a>
<b><font color=#ca14ca>proc</font></b> ini::CreateIcon {icon} {
  <i><font color=#4b5d50># Create an icon (of normal and big size).</font></i>
  <i><font color=#4b5d50>#   icon - name of icon</font></i>

  <b><font color=#3a6797>set</font></b> img alimg_<font color=#1b1baa>$icon</font>
  <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>image</font></b> create photo <font color=#1b1baa>$img</font>-big <font color=#653760>-data</font> [::apave::iconData <font color=#1b1baa>$icon</font>]}
  <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>image</font></b> create photo <font color=#1b1baa>$img</font> <font color=#653760>-data</font> [::apave::iconData <font color=#1b1baa>$icon</font> small]}
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$img</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::EditSettings></a>
<b><font color=#ca14ca>proc</font></b> ini::EditSettings {} {
  <i><font color=#4b5d50># Displays the settings file, just to look behind the wall.</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al obPav obPav
  <b><font color=#3a6797>after</font></b> idle alited::ini::HighlightFileText
  <font color=#1b1baa>$obPav</font> vieweditFile <font color=#1b1baa>$al(INI)</font> {} <font color=#653760>-rotext</font> 1 <font color=#653760>-h</font> 25
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::HighlightFileText></a>
<b><font color=#ca14ca>proc</font></b> ini::HighlightFileText {{wtxt <font color=#8b2a0e>&quot;&quot;</font>} {fname <font color=#8b2a0e>&quot;&quot;</font>} {ro 1} args} {
  <i><font color=#4b5d50># Highlights a text of a file.</font></i>
  <i><font color=#4b5d50>#   wtxt - the text's path</font></i>
  <i><font color=#4b5d50>#   fname - the file name (extension)</font></i>
  <i><font color=#4b5d50>#   ro - flag &quot;readonly text&quot;</font></i>
  <i><font color=#4b5d50>#   args - additional options</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al obPav obPav
  <b><font color=#3a6797>set</font></b> colors [alited::Hl_Colors]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$wtxt</font> eq {}} {<b><font color=#3a6797>set</font></b> wtxt [<font color=#1b1baa>$obPav</font> TexM]}
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$fname</font> eq {}} {<b><font color=#3a6797>set</font></b> fname <font color=#1b1baa>$al(INI)</font>}
  <b><font color=#3a6797>set</font></b> plcom [alited::HighlightAddon <font color=#1b1baa>$wtxt</font> <font color=#1b1baa>$fname</font> <font color=#1b1baa>$colors</font>]
  ::hl_tcl::hl_init <font color=#1b1baa>$wtxt</font> <font color=#653760>-font</font> <font color=#1b1baa>$al(FONT,txt)</font> <font color=#653760>-dark</font> [<font color=#1b1baa>$obPav</font> csDark] \
    <font color=#653760>-multiline</font> 1 <font color=#653760>-colors</font> <font color=#1b1baa>$colors</font> <font color=#653760>-readonly</font> <font color=#1b1baa>$ro</font> <font color=#653760>-plaintext</font> 0 <font color=#653760>-plaincom</font> <font color=#1b1baa>$plcom</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
  ::hl_tcl::hl_text <font color=#1b1baa>$wtxt</font>
  alited::main::SetTabs <font color=#1b1baa>$wtxt</font> [<b><font color=#3a6797>lindex</font></b> [alited::main::CalcIndentation] 0]
}
<a id=Main_(+_tool_bar)></a>
<i><font color=#4b5d50># ________________________ Main (+ tool bar) _________________________ #</font></i>
<a id=ini::InitGUI></a>
<b><font color=#ca14ca>proc</font></b> ini::InitGUI {} {
  <i><font color=#4b5d50># Initializes GUI.</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  obj basicFontSize <font color=#1b1baa>$al(FONTSIZE,std)</font>
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$al(INI,HUE)</font>} {obj csToned <font color=#1b1baa>$al(INI,CS)</font> <font color=#1b1baa>$al(INI,HUE)</font>}
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$al(CURSORCOLOR)</font> eq {}} {
    <b><font color=#3a6797>set</font></b> al(CURSORCOLOR) [<b><font color=#3a6797>lindex</font></b> [obj csGet <font color=#1b1baa>$al(INI,CS)</font>] 7]
  }
  obj csSet <font color=#1b1baa>$al(INI,CS)</font> . <font color=#653760>-doit</font> <font color=#653760>-clrcurs</font> <font color=#1b1baa>$al(CURSORCOLOR)</font>
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$al(INI,HUE)</font>} {obj csToned <font color=#1b1baa>$al(INI,CS)</font> <font color=#1b1baa>$al(INI,HUE)</font> yes}
  <b><font color=#3a6797>set</font></b> Dark [obj csDark]
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>info</font></b> exists al(ED,clrCOM)] || ![<b><font color=#3a6797>info</font></b> exists al(ED,CclrCOM)] || \
  ![<b><font color=#3a6797>info</font></b> exists al(ED,Dark)] || <font color=#1b1baa>$al(ED,Dark)</font> != <font color=#1b1baa>$Dark</font>} {
    alited::pref::Tcl_Default <font color=#1b1baa>$al(syntaxidx)</font> yes
    alited::pref::C_Default <font color=#1b1baa>$al(syntaxidx)</font> yes
  }
  <b><font color=#3a6797>set</font></b> clrnams [::hl_tcl::hl_colorNames]
  <b><font color=#3a6797>set</font></b> clrvals [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>foreach</font></b> clr <font color=#1b1baa>$clrnams</font> {
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> exists al(ED,<font color=#1b1baa>$clr</font>)]} {
      <b><font color=#3a6797>lappend</font></b> clrvals [<b><font color=#3a6797>set</font></b> al(ED,<font color=#1b1baa>$clr</font>)]
    }
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$clrvals</font>]==[<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$clrnams</font>]} {
    ::hl_tcl::hl_colors <font color=#653760>-AddTags</font> <font color=#1b1baa>$Dark</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$clrvals</font>
  }
  ::hl_tcl::hl_colors . <font color=#1b1baa>$Dark</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$clrvals</font> ;<i><font color=#4b5d50># default Tcl syntax colors</font></i>
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$al(ED,BlinkCurs)</font>} {
    <b><font color=#3a6797>lassign</font></b> [obj defaultATTRS tex] texopts texattrs
    obj defaultATTRS tex <font color=#1b1baa>$texopts</font> [<b><font color=#3a6797>dict</font></b> set texattrs <font color=#653760>-insertofftime</font> 0]
  }
  obj setShowOption <font color=#653760>-resizable</font> 0
  <b><font color=#3a6797>if</font></b> {[::asKDE]} {  ;<i><font color=#4b5d50># esp. for KDE:</font></i>
    <i><font color=#4b5d50># dialogue windows should be topmost, otherwise KDE hides them at losing focus</font></i>
    obj setShowOption <font color=#653760>-ontop</font> yes
  }
  <b><font color=#3a6797>lassign</font></b> [::apave::defaultAttrs spx] opts atrs
  ::apave::defaultAttrs spx <font color=#1b1baa>$opts</font> <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>atrs -justify center -w 9&quot;</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::InitFonts></a>
<b><font color=#ca14ca>proc</font></b> ini::InitFonts {} {
  <i><font color=#4b5d50># Loads main fonts for alited to use as default and mono.</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al MSGSDIR MSGSDIR

  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$al(FONT)</font> ne {}} {
    obj basicDefFont <font color=#1b1baa>$al(FONT)</font>
    <b><font color=#3a6797>set</font></b> smallfont <font color=#1b1baa>$al(FONT)</font>
    <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>dict</font></b> set smallfont <font color=#653760>-size</font> <font color=#1b1baa>$al(FONTSIZE,small)</font>}
    <b><font color=#3a6797>foreach</font></b> font {TkDefaultFont TkMenuFont TkHeadingFont TkCaptionFont} {
      <b><font color=#134070>font</font></b> configure <font color=#1b1baa>$font</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$al(FONT)</font>
    }
    <b><font color=#3a6797>foreach</font></b> font {TkSmallCaptionFont TkIconFont TkTooltipFont} {
      <b><font color=#134070>font</font></b> configure <font color=#1b1baa>$font</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$smallfont</font>
    }
    ::baltip::configure <font color=#653760>-font</font> <font color=#1b1baa>$smallfont</font>
  }
  <b><font color=#3a6797>set</font></b> statusfont [obj basicSmallFont]
  <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>dict</font></b> set statusfont <font color=#653760>-size</font> <font color=#1b1baa>$al(FONTSIZE,small)</font>}
  obj basicSmallFont <font color=#1b1baa>$statusfont</font>
  obj basicFontSize <font color=#1b1baa>$al(FONTSIZE,std)</font>
  <b><font color=#3a6797>set</font></b> gl [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$MSGSDIR</font> <font color=#1b1baa>$al(LOCAL)</font>]
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> flist [<b><font color=#3a6797>glob</font></b> <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>gl.msg&quot;</font>]}] || <font color=#1b1baa>$flist</font> eq {}} {
    <b><font color=#3a6797>set</font></b> al(LOCAL) en
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$al(LOCAL)</font> ni {en {}}} {
    <i><font color=#4b5d50># load localized messages</font></i>
    msgcat::mcload <font color=#1b1baa>$MSGSDIR</font>
    msgcat::mclocale <font color=#1b1baa>$al(LOCAL)</font>
    alited::msgcatMessages
  } <b><font color=#3a6797>else</font></b> {
    msgcat::mclocale en
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::initStyles></a>
<b><font color=#ca14ca>proc</font></b> ini::initStyles {} {
  <i><font color=#4b5d50># Initializes widget styles for alited.</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  ::apave::initStyles
  ::apave::initStylesFS <font color=#653760>-size</font> <font color=#1b1baa>$al(FONTSIZE,small)</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::TipToolHotkeys></a>
<b><font color=#ca14ca>proc</font></b> ini::TipToolHotkeys {} {
  <i><font color=#4b5d50># Adds hotkeys to toolbar tips.</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>append</font></b> al(MC,icoSaveFile) \n <font color=#1b1baa>$al(acc_0)</font>
  <b><font color=#3a6797>append</font></b> al(MC,icorun)      \n <font color=#1b1baa>$al(acc_3)</font>
  <b><font color=#3a6797>append</font></b> al(MC,icoe_menu)   \n <font color=#1b1baa>$al(acc_2)</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::_init></a>
<b><font color=#ca14ca>proc</font></b> ini::_init {} {
  <i><font color=#4b5d50># Initializes alited app.</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al obPav obPav obDlg obDlg obDl2 obDl2 \
    obFND obFND obFN2 obFN2 obCHK obCHK obGTL obGTL obDFW obDFW obRun obRun
  <b><font color=#3a6797>namespace</font></b> upvar ::alited::pref em_Num em_Num em_ico em_ico em_inf em_inf em_mnu em_mnu

  ::apave::initBaltip
  obj chooserGeomVars ::alited::DirGeometry ::alited::FilGeometry
  GetUserDirs
  CheckIni
  ReadIni
  InitFonts

  <b><font color=#3a6797>lassign</font></b> [::apave::InitTheme <font color=#1b1baa>$al(THEME)</font> <font color=#1b1baa>$::alited::LIBDIR</font>] theme lbd
  ::apave::initWM <font color=#653760>-cursorwidth</font> <font color=#1b1baa>$al(CURSORWIDTH)</font> <font color=#653760>-theme</font> <font color=#1b1baa>$theme</font> <font color=#653760>-labelborder</font> <font color=#1b1baa>$lbd</font>
  ::apave::iconImage <font color=#653760>-init</font> <font color=#1b1baa>$al(INI,ICONS)</font> yes
  <b><font color=#3a6797>set</font></b> ::apave::MC_NS ::alited
  InitGUI
  GetUserDirs

  <i><font color=#4b5d50># get hotkeys</font></i>
  alited::pref::IniKeys
  alited::pref::RegisterKeys
  alited::pref::KeyAccelerators

  <i><font color=#4b5d50># create main apave objects</font></i>
  ::apave::APave create <font color=#1b1baa>$obPav</font> <font color=#1b1baa>$al(WIN)</font>
  <b><font color=#3a6797>foreach</font></b> ob [::alited::ListPaved] {
    ::apave::APave create [<b><font color=#3a6797>set</font></b> <font color=#1b1baa>$ob</font>] <font color=#1b1baa>$al(WIN)</font>
  }

  <i><font color=#4b5d50># here, the order of icons defines their order in the toolbar</font></i>
  <b><font color=#3a6797>set</font></b> listIcons [::apave::iconImage]
  <i><font color=#4b5d50># the below icons' order defines their order in the toolbar</font></i>
  TipToolHotkeys
  <b><font color=#3a6797>foreach</font></b> {icon} {none gulls heart add change delete up down paste plus minus retry \
  misc previous previous2 next next2 folder file OpenFile SaveFile saveall undo redo \
  box replace ok color date help run e_menu other trash actions paste copy more} {
    <b><font color=#3a6797>set</font></b> img [CreateIcon <font color=#1b1baa>$icon</font>]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$icon</font> in {<b><font color=#3a6797>file</font></b> OpenFile SaveFile saveall box undo redo replace \
    ok color date help run e_menu other}} {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$icon</font> eq {run}} {
        <b><font color=#3a6797>set</font></b> com <font color=#8b2a0e>&quot;-command alited::tool::TooltipRun&quot;</font>
      } <b><font color=#3a6797>else</font></b> {
        <b><font color=#3a6797>set</font></b> com <font color=#8b2a0e>&quot;&quot;</font>
      }
      <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot; <font color=#1b1baa>$</font>img-big \{<font color=#1b1baa>{}</font> -tip <font color=#1b1baa>{$</font>::alited::al(MC,ico<font color=#1b1baa>$</font>icon)@@ -under 4 <font color=#1b1baa>$</font>com<font color=#1b1baa>}</font> \</font>
<font color=#8b2a0e>        -popup <font color=#1b1baa>{</font>alited::tool::PopupBar %X %Y<font color=#1b1baa>}</font> &quot;</font>
      <b><font color=#3a6797>switch</font></b> <font color=#1b1baa>$icon</font> {
        <b><font color=#3a6797>file</font></b> {
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::file::NewFile\}&quot;</font>
        }
        OpenFile {
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::file::OpenFile\} sev 6&quot;</font>
        }
        SaveFile {
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::file::SaveFile -state disabled\}&quot;</font>
        }
        saveall {
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::file::SaveAll -state disabled\} sev 6&quot;</font>
        }
        undo {
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::tool::Undo -state disabled\}&quot;</font>
        }
        redo {
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::tool::Redo -state disabled\} sev 6&quot;</font>
        }
        box {
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::project::_run\} sev 6&quot;</font>
        }
        replace {
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::find::_run\}&quot;</font>
        }
        ok {
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::CheckRun\}&quot;</font>
        }
        color {
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::tool::ColorPicker\}&quot;</font>
        }
        date {
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::tool::DatePicker\}&quot;</font>
        }
        help {
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::tool::Help\} sev 6&quot;</font>
        }
        run {
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com <font color=#1b1baa>{</font>alited::tool::_run <font color=#1b1baa>{}</font> <font color=#1b1baa>{}</font> -doit yes<font color=#1b1baa>}</font>\}&quot;</font>
        }
        e_menu {
          <b><font color=#134070>image</font></b> create photo <font color=#1b1baa>$img</font>-big <font color=#653760>-data</font> <font color=#1b1baa>$::alited::img::_AL_IMG(e_menu)</font>
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com <font color=#1b1baa>{</font>alited::tool::e_menu o=0<font color=#1b1baa>}</font>\}&quot;</font>
        }
        other {
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::tool::tkcon\}&quot;</font>
        }
      }
    }
  }
  <i><font color=#4b5d50># e_menu items for the toolbar</font></i>
  <b><font color=#3a6797>set</font></b> limgs [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>set</font></b> em_N [Em_Number <font color=#1b1baa>$em_Num</font>]
  <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>set</font></b> was 0]} {<font color=#1b1baa>$i</font>&lt;<font color=#1b1baa>$em_N</font>} {<b><font color=#3a6797>incr</font></b> i} {
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> exists em_ico(<font color=#1b1baa>$i</font>)] && (<font color=#1b1baa>$em_ico($i)</font> ni {none {}} || <font color=#1b1baa>$em_inf($i)</font> eq {})} {
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>incr</font></b> was]==1 && <font color=#1b1baa>$em_inf($i)</font> ne {}} {
        <b><font color=#3a6797>append</font></b> al(atools) { sev 6}
      }
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$em_inf($i)</font> eq {}} {
        <b><font color=#3a6797>append</font></b> al(atools) { sev 6}
      } <b><font color=#3a6797>else</font></b> {
        <b><font color=#3a6797>set</font></b> tico [alited::TextIcon <font color=#1b1baa>$em_ico($i)</font>]
        <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> length <font color=#1b1baa>$tico</font>]==1 || ![<b><font color=#3a6797>string</font></b> is ascii <font color=#1b1baa>$tico</font>]} {
          <b><font color=#3a6797>set</font></b> em_ico(<font color=#1b1baa>$i</font>) <font color=#1b1baa>$tico</font>
          <b><font color=#3a6797>set</font></b> img _<font color=#1b1baa>$i</font>
          <b><font color=#3a6797>set</font></b> txt <font color=#8b2a0e>&quot;-t <font color=#1b1baa>$</font>tico&quot;</font>
        } <b><font color=#3a6797>else</font></b> {
          <b><font color=#3a6797>set</font></b> img [CreateIcon <font color=#1b1baa>$tico</font>]-big
          <b><font color=#3a6797>set</font></b> txt {}
        }
        <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>lsearch</font></b> <font color=#653760>-exact</font> <font color=#1b1baa>$limgs</font> <font color=#1b1baa>$img</font>]&gt;-1} {
          <b><font color=#3a6797>set</font></b> msg [msgcat::mc {ERROR! Duplicate tool icon: }]
          <b><font color=#3a6797>append</font></b> msg [<b><font color=#3a6797>string</font></b> map {<font color=#653760>-big</font> {}} [<b><font color=#3a6797>lindex</font></b> [<b><font color=#3a6797>split</font></b> <font color=#1b1baa>$img</font> _] end]]
          <b><font color=#3a6797>after</font></b> idle [<b><font color=#3a6797>list</font></b> alited::Message <font color=#1b1baa>$msg</font> 4]
          <b><font color=#ca14ca>continue</font></b>
        }
        <b><font color=#3a6797>set</font></b> com [alited::tool::EM_command <font color=#1b1baa>$i</font>]
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$com</font> ne {}} {
          <b><font color=#3a6797>lappend</font></b> limgs <font color=#1b1baa>$img</font>
          <b><font color=#3a6797>set</font></b> tip <font color=#1b1baa>$em_mnu($i)</font>
          <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot; <font color=#1b1baa>$</font>img \{<font color=#1b1baa>{}</font> -tip <font color=#1b1baa>{$</font>tip@@ -under 4 \</font>
<font color=#8b2a0e>            -command <font color=#1b1baa>{</font>alited::ini::ToolbarTip <font color=#1b1baa>$</font>i<font color=#1b1baa>}}</font> <font color=#1b1baa>$</font>txt \</font>
<font color=#8b2a0e>            -popup <font color=#1b1baa>{</font>alited::tool::PopupBar %X %Y<font color=#1b1baa>}</font> -com <font color=#1b1baa>{$</font>com<font color=#1b1baa>}</font>\}&quot;</font>
        }
      }
    }
  }
  <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i 0} {<font color=#1b1baa>$i</font>&lt;8} {<b><font color=#3a6797>incr</font></b> i} {
    <b><font color=#134070>image</font></b> create photo alimg_pro<font color=#1b1baa>$i</font> <font color=#653760>-data</font> [<b><font color=#3a6797>set</font></b> ::alited::img::_AL_IMG(<font color=#1b1baa>$i</font>)]
  }
  <b><font color=#134070>image</font></b> create photo alimg_tclfile <font color=#653760>-data</font> [<b><font color=#3a6797>set</font></b> ::alited::img::_AL_IMG(Tcl)]
  <b><font color=#134070>image</font></b> create photo alimg_kbd <font color=#653760>-data</font> [<b><font color=#3a6797>set</font></b> ::alited::img::_AL_IMG(kbd)]
  <i><font color=#4b5d50># styles & fonts used in &quot;small&quot; dialogues</font></i>
  initStyles
  <b><font color=#3a6797>lassign</font></b> [obj create_FontsType small <font color=#653760>-size</font> <font color=#1b1baa>$al(FONTSIZE,small)</font>] \
     al(FONT,defsmall) al(FONT,monosmall)
  <b><font color=#3a6797>lassign</font></b> [alited::FgFgBold] -&gt; al(FG,Bold)
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ToolbarTip></a>
<b><font color=#ca14ca>proc</font></b> ini::ToolbarTip {i} {
  <i><font color=#4b5d50># Gets a toolbar button's tip, mapping %f / %D to a current file / directory.</font></i>
  <i><font color=#4b5d50>#   i - index of e_menu item</font></i>

  <b><font color=#3a6797>set</font></b> maplist [alited::menu::MapRunItems [alited::bar::FileName]]
  <b><font color=#3a6797>string</font></b> map <font color=#1b1baa>$maplist</font> <font color=#1b1baa>$::alited::pref::em_mnu($i)</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::Help></a>
<b><font color=#ca14ca>proc</font></b> ini::Help {} {
  <i><font color=#4b5d50># Shows &quot;Configurations&quot; help.</font></i>

  alited::Help <font color=#1b1baa>$::alited::al(WIN)</font>
}
<a id=Projects'_toolbar></a>
<i><font color=#4b5d50># ________________________ Projects' toolbar _________________________ #</font></i>

<i><font color=#4b5d50># This branch contains procedures for project::Tab5 (Projects' tab of Files).</font></i>
<i><font color=#4b5d50># It uses much of the stuff found in this script.</font></i>
<a id=ini::ProjectsToolbar></a>
<b><font color=#ca14ca>proc</font></b> ini::ProjectsToolbar {} {
  <i><font color=#4b5d50># Tool bar for Projects (subset of main toolbar).</font></i>
  <i><font color=#4b5d50># See also: _init, project::Tab5</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>namespace</font></b> upvar ::alited::pref em_Num em_Num em_ico em_ico em_inf em_inf em_mnu em_mnu
  <b><font color=#3a6797>set</font></b> e_menu_icon {iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAADFBMVEUAAAAASZL///8Atv8UVAVH
AAAAAXRSTlMAQObYZgAAACZJREFUCNdjYA0NDQAS9ReARN4FKDdr1QQGtvz/E8AsZLHUUAJiAI6+
FtcEguWyAAAAAElFTkSuQmCC}
  <b><font color=#3a6797>set</font></b> al(atools) [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>foreach</font></b> {icon} {run e_menu other} {
    <b><font color=#3a6797>set</font></b> img [CreateIcon <font color=#1b1baa>$icon</font>]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$icon</font> eq {run}} {
      <b><font color=#3a6797>set</font></b> com <font color=#8b2a0e>&quot;-command alited::tool::TooltipPrjRun&quot;</font>
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> com <font color=#8b2a0e>&quot;&quot;</font>
    }
    <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot; <font color=#1b1baa>$</font>img \{<font color=#1b1baa>{}</font> -tip <font color=#1b1baa>{$</font>::alited::al(MC,ico<font color=#1b1baa>$</font>icon)@@ -under 4 <font color=#1b1baa>$</font>com<font color=#1b1baa>}</font> &quot;</font>
    <b><font color=#3a6797>switch</font></b> <font color=#1b1baa>$icon</font> {
      run {
        <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::ini::ToolPrjRun\}&quot;</font>
      }
      e_menu {
        <b><font color=#134070>image</font></b> create photo <font color=#1b1baa>$img</font> <font color=#653760>-data</font> <font color=#1b1baa>$e_menu_icon</font>
        <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::ini::ToolPrjEM\}&quot;</font>
      }
      other {
        <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot;-com alited::ini::ToolPrjTkcon\}&quot;</font>
      }
    }
  }
  <i><font color=#4b5d50># e_menu items for the toolbar</font></i>
  <b><font color=#3a6797>set</font></b> limgs [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>set</font></b> em_N [Em_Number <font color=#1b1baa>$em_Num</font>]
  <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>set</font></b> was 0]} {<font color=#1b1baa>$i</font>&lt;<font color=#1b1baa>$em_N</font>} {<b><font color=#3a6797>incr</font></b> i} {
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> exists em_ico(<font color=#1b1baa>$i</font>)] && (<font color=#1b1baa>$em_ico($i)</font> ni {none {}} || <font color=#1b1baa>$em_inf($i)</font> eq {})} {
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>incr</font></b> was]==1 && <font color=#1b1baa>$em_inf($i)</font> ne {}} {
        <b><font color=#3a6797>append</font></b> al(atools) { sev 6}
      }
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$em_inf($i)</font> eq {}} {
        <b><font color=#3a6797>append</font></b> al(atools) { sev 6}
      } <b><font color=#3a6797>else</font></b> {
        <b><font color=#3a6797>set</font></b> tico [alited::TextIcon <font color=#1b1baa>$em_ico($i)</font>]
        <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> length <font color=#1b1baa>$tico</font>]==1 || ![<b><font color=#3a6797>string</font></b> is ascii <font color=#1b1baa>$tico</font>]} {
          <b><font color=#3a6797>set</font></b> em_ico(<font color=#1b1baa>$i</font>) <font color=#1b1baa>$tico</font>
          <b><font color=#3a6797>set</font></b> img _<font color=#1b1baa>$i</font>
          <b><font color=#3a6797>set</font></b> txt <font color=#8b2a0e>&quot;-t <font color=#1b1baa>$</font>tico -font <font color=#1b1baa>{[</font>obj boldTextFont 12<font color=#1b1baa>]}</font>&quot;</font>
        } <b><font color=#3a6797>else</font></b> {
          <b><font color=#3a6797>set</font></b> img [CreateIcon <font color=#1b1baa>$tico</font>]
          <b><font color=#3a6797>set</font></b> txt {}
        }
        <b><font color=#3a6797>lappend</font></b> limgs <font color=#1b1baa>$img</font>
        <b><font color=#3a6797>set</font></b> tip <font color=#1b1baa>$em_mnu($i)</font>
        <b><font color=#3a6797>append</font></b> al(atools) <font color=#8b2a0e>&quot; <font color=#1b1baa>$</font>img \{<font color=#1b1baa>{}</font> -tip <font color=#1b1baa>{$</font>tip@@ -under 4 \</font>
<font color=#8b2a0e>          -command <font color=#1b1baa>{</font>alited::ini::ToolPrjTip <font color=#1b1baa>$</font>i<font color=#1b1baa>}}</font> <font color=#1b1baa>$</font>txt \</font>
<font color=#8b2a0e>          -com <font color=#1b1baa>{</font>alited::ini::ToolPrjCommand <font color=#1b1baa>$</font>i<font color=#1b1baa>}</font>\}&quot;</font>
      }
    }
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::TooltipPrjRun></a>
<b><font color=#ca14ca>proc</font></b> ini::TooltipPrjRun {} {
  <i><font color=#4b5d50># Gets a tip for &quot;Projects' Run&quot; tool.</font></i>

  <b><font color=#3a6797>namespace</font></b> upvar ::alited al al
  <b><font color=#3a6797>set</font></b> res <font color=#1b1baa>$al(MC,icorun)</font>
  <b><font color=#3a6797>append</font></b> res [AddTooltipRun]
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ToolPrjRun></a>
<b><font color=#ca14ca>proc</font></b> ini::ToolPrjRun {} {
  <i><font color=#4b5d50># Runs current file from toolbar.</font></i>

  alited::tool::_run 1 {} <font color=#653760>-doit</font> yes f=[ToolPrjFilename]
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ToolPrjEM></a>
<b><font color=#ca14ca>proc</font></b> ini::ToolPrjEM {} {
  <i><font color=#4b5d50># Calls e_menu from toolbar.</font></i>

  alited::tool::e_menu o=0 f=[ToolPrjFilename] d=[ToolPrjDirname]
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ToolPrjTkcon></a>
<b><font color=#ca14ca>proc</font></b> ini::ToolPrjTkcon {} {
  <i><font color=#4b5d50># Runs tkcon from toolbar.</font></i>

  alited::tool::tkcon <font color=#653760>-dir</font> [ToolPrjDirname]
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ToolPrjFilename></a>
<b><font color=#ca14ca>proc</font></b> ini::ToolPrjFilename {} {
  <i><font color=#4b5d50># Gets file name of current file.</font></i>

  alited::project::CurrentFile
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ToolPrjDirname></a>
<b><font color=#ca14ca>proc</font></b> ini::ToolPrjDirname {} {
  <i><font color=#4b5d50># Gets dir name of current file.</font></i>

  <b><font color=#3a6797>file</font></b> dirname [ToolPrjFilename]
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ToolPrjTip></a>
<b><font color=#ca14ca>proc</font></b> ini::ToolPrjTip {i} {
  <i><font color=#4b5d50># Gets a toolbar button's tip, mapping %f / %D to a current file / directory.</font></i>
  <i><font color=#4b5d50>#   i - index of e_menu item</font></i>

  <b><font color=#3a6797>set</font></b> maplist [alited::menu::MapRunItems [ToolPrjFilename]]
  <b><font color=#3a6797>string</font></b> map <font color=#1b1baa>$maplist</font> <font color=#1b1baa>$::alited::pref::em_mnu($i)</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ToolPrjCommand></a>
<b><font color=#ca14ca>proc</font></b> ini::ToolPrjCommand {im} {
  <i><font color=#4b5d50># Executes project toolbar's command.</font></i>
  <i><font color=#4b5d50>#   im - index in toolbar</font></i>

  <b><font color=#3a6797>set</font></b> com [alited::tool::EM_command <font color=#1b1baa>$im</font>]
  <b><font color=#3a6797>append</font></b> com <font color=#8b2a0e>&quot; \&quot;f=<font color=#1b1baa>[</font>ToolPrjFilename<font color=#1b1baa>]</font>\&quot; \&quot;d=<font color=#1b1baa>[</font>ToolPrjDirname<font color=#1b1baa>]</font>\&quot; \&quot;TF=<font color=#1b1baa>[</font>ToolPrjFilename<font color=#1b1baa>]</font>\&quot;&quot;</font>
  {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$com</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ini::ToolByKey></a>
<b><font color=#ca14ca>proc</font></b> ini::ToolByKey {nbk com} {
  <i><font color=#4b5d50># Runs a command after its hot key pressing in f5 tab of Projects.</font></i>
  <i><font color=#4b5d50>#   nbk - notebook's path</font></i>
  <i><font color=#4b5d50>#   com - command</font></i>
  <i><font color=#4b5d50># See also: project::_create</font></i>

  <b><font color=#3a6797>if</font></b> {[<font color=#1b1baa>$nbk</font> select] eq <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>nbk.f5&quot;</font>} <font color=#1b1baa>$com</font>
}
<a id=EOF></a>
<i><font color=#4b5d50># _________________________________ EOF _________________________________ #</font></i>

</pre>

<table border=0 cellPadding=4 cellSpacing=0 width=100%>  <td border=0 bgColor=#bdd7e7><div style=text-align:center>  <a href="../../index.html"><font color=#1a1a1a size=6>  <b>ini.tcl</b></font></div></td></table>

</section>
<script>
  writeFooter('Generated by <a href="'+homeLINK()+'/en/tcl/alited/index.html">alited</a> &amp; <a href="'+homeLINK()+'/en/tcl/mulster/index.html">mulster</a></a>');
</script>
</div>
</body>
</html>