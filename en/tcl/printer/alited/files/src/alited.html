<!DOCTYPE html><html><head><meta charset="utf-8"/>
<meta name="author" content="aplsimple">
<meta name="description" content="aplsimple's home page">
<meta name="keywords" content="aplsimple,home">
</head>
<style>
table{
background-color: #f9f9f9;
margin: 0%;
margin-bottom: 2%;
padding: 0%;
box-shadow: none;
filter: none;
}
pre{
margin: 0%;
margin-bottom: 2%;
padding: 0%;
}
</style>
<script>
function homeLINK() {
  homelink = document.baseURI;
  ilen = 19
  ibase = homelink.indexOf('aplsimple.github');
  if (ibase<0) { ibase = homelink.indexOf('aplsimple_github'); ilen += 10 };
  if (ibase>=0) { homelink = homelink.substring(0,ibase+ilen) };
  return homelink;
};
document.write(' \
<link rel="icon" type="image/jpg" href="'+homeLINK()+'/zoo/favicon.jpg">');
document.write('<'+'script src="'+homeLINK()+'/zoo/funcs.js">'+'<'+'/script>');
document.write('<'+'script src="'+homeLINK()+'/en/tcl/printer/zoo/this.js">'+'<'+'/script>');
</script>
<body>
<div id="wrapper">
<div name="divd1" ALIGN="CENTER"> <FONT SIZE=5em color=#b01c20><B>
<noscript>THIS PAGE IS NOT WORKING WITHOUT JAVASCRIPT!
<BR>
<BR>PLEASE, SWITCH ON JAVASCRIPT IN SETTINGS OF YOUR BROWSER AND RELOAD THE PAGE.
</noscript>
</B></FONT></div>
<div id='doc3' class='yui-t2'>
<section id=sec2>
<div id='hd' class='banner'>
<script>document.write(' \
<link rel="stylesheet" href="'+homeLINK()+'/en/tcl/printer/zoo/style.css">');
</script>
<link rel="stylesheet" href="../../css/style.css">

<title>alited.tcl</title>

<table border=0 cellPadding=4 cellSpacing=0 width=100%>  <td border=0 bgColor=#87bcd3><div style=text-align:center>  <a href="../../index.html"><font color=#1a1a1a size=6>  <b>README.md</b></font></div></td></table>

<div id="bodyContent" class="dokuwiki">
<div id="dw__toc" class="dw__toc">
<h3 class="toggle open" style="cursor: pointer;">alited.tcl</h3>
<div aria-expanded="true" style="">

<ul class="toc">
<li><b><a href="#alited.tcl">alited.tcl</a></b></li>
<li><b><a href="#Remove_installed_(perhaps)_packages_used_in_alited">Remove_installed_(perhaps)_packages_used_in_alited</a></b></li>
<li><b><a href="#alited::_Main">alited::_Main</a></b></li>
<li><b><a href="#Main_variables">Main_variables</a></b></li>
<li><b><a href="#Procs_to_raise_the_alited_app">Procs_to_raise_the_alited_app</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#raise_window">raise_window</a><span class=tooltiptext> raise_window : Raises the app's window.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#open_files_and_raise">open_files_and_raise</a><span class=tooltiptext> open_files_and_raise : Opens files of CLI.
iin - count of call
args - list of file names
See also: bar::FillBar</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#run_remote">run_remote</a><span class=tooltiptext> run_remote : Runs a command that was started by another process.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#main_user_dirs">main_user_dirs</a><span class=tooltiptext> main_user_dirs : Gets names of main user directories for settings.</span></div></li></ul>
<li><b><a href="#EONS:_Main">EONS:_Main</a></b></li>
<li><b><a href="#Packages_used">Packages_used</a></b></li>
<li><b><a href="#::argv,_::argc">::argv,_::argc</a></b></li>
<li><b><a href="#Last_configuration">Last_configuration</a></b></li>
<li><b><a href="#Port_to_listen">Port_to_listen</a></b></li>
<li><b><a href="#Open_an_existing_app">Open_an_existing_app</a></b></li>
<li><b><a href="#alited::">alited::</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#FgFgBold">FgFgBold</a><span class=tooltiptext> FgFgBold : Gets foregrounds of normal and colored text of current color scheme
and red color of TODOs.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ListPaved">ListPaved</a><span class=tooltiptext> ListPaved : Return a list of apave objects for dialogues.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#SyntaxColors">SyntaxColors</a><span class=tooltiptext> SyntaxColors : Gets colors for syntax highlighting.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#SyntaxHighlight">SyntaxHighlight</a><span class=tooltiptext> SyntaxHighlight : Makes a text being syntax highlighted.
lng - language (tcl, c)
wtxt - text's path
colors - highlighting colors
cs - color scheme
args - other options</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#TextIcon">TextIcon</a><span class=tooltiptext> TextIcon : Gets a picture from a character and vice versa.
ico - picture or character
to - "in" gets in-chars, "out" gets out-chars</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tnext">Tnext</a><span class=tooltiptext> Tnext : Returns "next & prev widgets" for Tab & Shift/Tab keys, just to skip "Help".
wprev - widget for Shift/Tab
Used by obPrf & obPrj objects.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#TmpFile">TmpFile</a><span class=tooltiptext> TmpFile : Gets a temporary file's name.
tname - tailing part of the name</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ProcEOL">ProcEOL</a><span class=tooltiptext> ProcEOL : Transforms \n to "EOL chars" and vise versa.
val - string to transform
mode - if "in", gets \n-valued; if "out", gets EOL-valued.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ProcessFiles">ProcessFiles</a><span class=tooltiptext> ProcessFiles : Processes files according to Selected/All choice.
procname - name of command to run on files (TID passed)
what - what to process: 1 - selected, 2 - all
Returns numbers of all and processed files.
See also: SessionList</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#SessionList">SessionList</a><span class=tooltiptext> SessionList : Returns a list of all tabs or selected tabs (if set).
mode - 0 get selected or all, 1 force selected, 2 force all</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#isTclScript">isTclScript</a><span class=tooltiptext> isTclScript : Check if the tab's file is of .tcl type.
tab - tab's info</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#SessionTclList">SessionTclList</a><span class=tooltiptext> SessionTclList : Returns a list of all tabs or selected tabs of .tcl files.
mode - 0 get selected or all, 1 force selected, 2 force all</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#EnsureArray">EnsureArray</a><span class=tooltiptext> EnsureArray : Ensures restoring an array at calling a proc.
arName - fully qualified array name
args - proc name & arguments</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#InitUnitTree">InitUnitTree</a><span class=tooltiptext> InitUnitTree : Initializes the unit tree of file to be processed.
TID - tab's ID</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#MapWildCards">MapWildCards</a><span class=tooltiptext> MapWildCards : Maps some common wildcards in a command
com - the command
Wildcards:
%H - home directory
%P - directory of current project
%F - current file name
%D - directory of current file
%A - directory of alited
%M - directory of e_menu's menus
%E - Tcl/Tk executable as set in Preferences/Tools</span></div></li></ul>
<li><b><a href="#Messages">Messages</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#MessageTags">MessageTags</a><span class=tooltiptext> MessageTags : Gets tags for texts shown with messages.
Returns "-tags option" for messages.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#TipMessage">TipMessage</a><span class=tooltiptext> TipMessage : Shows a tip on status message and clears the status message.
lab - message label's path
tip - text of tip</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#msg">msg</a><span class=tooltiptext> msg : Shows a message and asks for an answer.
type - ok/yesno/okcancel/yesnocancel
icon - info/warn/err
message - the message
defb - default button (for not "ok" dialogs)
args - additional arguments (-title and font's option)
For "ok" dialogue, 'defb' is omitted (being a part of args).</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Msg">Msg</a><span class=tooltiptext> Msg : Shows a message in text box.
inf - the message
ic - icon</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Message">Message</a><span class=tooltiptext> Message : Displays a message in statusbar.
msg - message
mode - 1: simple; 2: bold; 3: bold color; 4: bold red bell; 5: static; 6: bold red
lab - label's name to display the message in
first - serves to recursively erase the message</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#MessageNotDisturb">MessageNotDisturb</a><span class=tooltiptext> MessageNotDisturb : Show "Don't disturb" message.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Balloon">Balloon</a><span class=tooltiptext> Balloon : Displays a message in a balloon window.
msg - message
red - yes for red background
timo - millisec. before showing the message
args - options of baltip::tip</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Balloon1">Balloon1</a><span class=tooltiptext> Balloon1 : Shows a balloon about non-existing file.
fname - file's name</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#IsTipable">IsTipable</a><span class=tooltiptext> IsTipable : Checks if a tip on the tree/favorites can be shown.</span></div></li></ul>
<li><b><a href="#Helps">Helps</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#HelpAbout">HelpAbout</a><span class=tooltiptext> HelpAbout : Shows "About..." dialogue.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#HelpAlited">HelpAlited</a><span class=tooltiptext> HelpAlited : Shows a main help of alited.
ilink - internal link</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#HelpFile">HelpFile</a><span class=tooltiptext> HelpFile : Reads and shows a help file.
win - currently active window
fname - the file's name
args - option of msg</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#HelpOnce">HelpOnce</a><span class=tooltiptext> HelpOnce : Handles "Help" window to have the only instance of it.
mode - 1 to check for existance the help; 0 to register it
fname - file of help</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#HelpFname">HelpFname</a><span class=tooltiptext> HelpFname : Gets a help file's name.
win - currently active window
suff - suffix for a help file's name</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#HelpMe">HelpMe</a><span class=tooltiptext> HelpMe : Shows a help file for a procedure with "Don't show again" checkbox.
win - currently active window
suff - suffix for a help file's name</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Help">Help</a><span class=tooltiptext> Help : Shows a help file for a procedure.
win - currently active window
suff - suffix for a help file's name
args - options of HelpFile</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#destroyWindow">destroyWindow</a><span class=tooltiptext> destroyWindow : Destroys current window and focuses on previously focused widget.
win - current window passed as %w
foc - previously focused widget</span></div></li></ul>
<li><b><a href="#Runs_&_exits">Runs_&_exits</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#SaveRunOptions">SaveRunOptions</a><span class=tooltiptext> SaveRunOptions : Saves options of "Run..." dialogue.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#RestoreRunOptions">RestoreRunOptions</a><span class=tooltiptext> RestoreRunOptions : Restores options of "Run..." dialogue.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Source_e_menu">Source_e_menu</a><span class=tooltiptext> Source_e_menu : Sources e_menu.tcl at need.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ExtTrans">ExtTrans</a><span class=tooltiptext> ExtTrans : Gets a file's extention and translation attributes (istrans, from, to).
fname - the file name</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#HighlightAddon">HighlightAddon</a><span class=tooltiptext> HighlightAddon : Tries to highlight add-on extensions.
wtxt - text's path
fname - current file's name
colors - colors of highlighting</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Hl_Colors">Hl_Colors</a><span class=tooltiptext> Hl_Colors : Gets highlighting colors.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tclexe">Tclexe</a><span class=tooltiptext> Tclexe : Gets Tcl's executable file.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Run">Run</a><span class=tooltiptext> Run : Runs Tcl/Tk script.
args - script's name and arguments</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Runtime">Runtime</a><span class=tooltiptext> Runtime : Runs Tcl/Tk script by alited's Tcl/Tk runtime.
args - script's name and arguments</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#CloseDlg">CloseDlg</a><span class=tooltiptext> CloseDlg : Tries to close a Help dialogue, open non-modal aside by the current dialogue.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ScriptSource">ScriptSource</a><span class=tooltiptext> ScriptSource : Sources script.tcl (at need).
script - the script name</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#CheckSource">CheckSource</a><span class=tooltiptext> CheckSource : Sources check.tcl (at need).</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#CheckRun">CheckRun</a><span class=tooltiptext> CheckRun : Runs "Check Tcl".</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#PrinterRun">PrinterRun</a><span class=tooltiptext> PrinterRun : Runs "Project Printer".</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Exit">Exit</a><span class=tooltiptext> Exit : Closes alited application.
w - not used
res - result of running of main window
ask - if "yes", requests the confirmation of the exit</span></div></li></ul>
<li><b><a href="#Sources_in_alited::">Sources_in_alited::</a></b></li>
<li><b><a href="#EONS_alited">EONS_alited</a></b></li>
<li><b><a href="#Run_the_app">Run_the_app</a></b></li>
<li><b><a href="#EOF">EOF</a></b></li>

</ul>

</div>
</div>
</div>
<!-- TOC END -->

<h1><font color=#ca14ca> alited's source</font></h1>
</p><p>
The <a href="about.html">alited/src</a> directory contains alited's own source files.
</p><p>
Some additional alited's files are also contained in <a href="../lib/addon/hl_alm.html">alited/lib/addon</a> directory (<i><font color=#1b1baa>alited/lib</font></i> directory contains all library files).
</p><p>
<li><a href="about.html">about.tcl</a> - "About alited" dialogue.</li>
<li><a href="alited.html">alited.tcl</a> - The alited's main script to start.</li>
<li><a href="bar.html">bar.tcl</a> - Handles the bar of tabs.</li>
<li><a href="check.html">check.tcl</a> - "Check Tcl" dialogue and procedures.</li>
<li><a href="complete.html">complete.tcl</a> - Handles auto-completion.</li>
<li><a href="edit.html">edit.tcl</a> - "Edit" menu's procedures.</li>
<li><a href="favor.html">favor.tcl</a> - Handles the favorite and last visited units.</li>
<li><a href="favor_ls.html">favor_ls.tcl</a> - "Saved lists of favorites" dialogue and procedures.</li>
<li><a href="file.html">file.tcl</a> - "File" menu's procedures.</li>
<li><a href="find.html">find.tcl</a> - "Find / Replace" dialogue and procedures.</li>
<li><a href="format.html">format.tcl</a> - "Edit / Formats" menu's procedures.</li>
<li><a href="img.html">img.tcl</a> - List of images used by alited.</li>
<li><a href="indent.html">indent.tcl</a> - Handles text indentation.</li>
<li><a href="info.html">info.tcl</a> - Handles the info bar.</li>
<li><a href="ini.html">ini.tcl</a> - Handles initializing alited.</li>
<li><a href="keys.html">keys.tcl</a> - Handles keyboard (mapping etc.).</li>
<li><a href="main.html">main.tcl</a> - Handles the main form of alited.</li>
<li><a href="menu.html">menu.tcl</a> - Handles alited's menus.</li>
<li><a href="msgs.html">msgs.tcl</a> - Localized messages used in several places.</li>
<li><a href="paver.html">paver.tcl</a> - "Tools / Paver" tool.</li>
<li><a href="pkgIndex.html">pkgIndex.tcl</a> - Includes README.md text (for Ruff doc generator).</li>
<li><a href="pref.html">pref.tcl</a> - "Preferences" dialogue and procedures.</li>
<li><a href="preview.html">preview.tcl</a> - "Preview (theme, CS)" dialogue called by "Preferences".</li>
<li><a href="printer.html">printer.tcl</a> - "Tools / Project Printer" dialogue and procedures.</li>
<li><a href="project.html">project.tcl</a> - "Projects" dialogue and procedures.</li>
<li><a href="run.html">run.tcl</a> - "Tools / Run..." dialogue and procedures.</li>
<li><a href="tool.html">tool.tcl</a> - "Tools" menu's procedures.</li>
<li><a href="tree.html">tree.tcl</a> - Handles the tree of units and files.</li>
<li><a href="unit.html">unit.tcl</a> - Handles the unit tree.</li>
<li><a href="unit_tpl.html">unit_tpl.tcl</a> - "Templates" dialogue and procedures.</li>
</p><p>

</p>

<table border=0 cellPadding=4 cellSpacing=0 width=100%>  <td border=0 bgColor=#87bcd3><div style=text-align:center>  <a href="../../index.html"><font color=#1a1a1a size=6>  <b>alited.tcl</b></font></div></td></table>

<pre class="code"><i><font color=#ff0000>#! /usr/bin/env tclsh<a id=alited.tcl></a></font></i>
<i><font color=#4b5d50>###########################################################</font></i>
<i><font color=#4b5d50># Name:    alited.tcl</font></i>
<i><font color=#4b5d50># Author:  Alex Plotnikov  (aplsimple@gmail.com)</font></i>
<i><font color=#4b5d50># Date:    03/01/2021</font></i>
<i><font color=#4b5d50># Brief:   Starting actions, alited's common procedures.</font></i>
<i><font color=#4b5d50># License: MIT.</font></i>
<i><font color=#4b5d50>###########################################################</font></i>

<b><font color=#3a6797>package</font></b> provide alited 1.8.0b5  ;<i><font color=#4b5d50># for documentation (esp. for Ruff!)</font></i>

<b><font color=#ca14ca>namespace</font></b> eval alited {

  <b><font color=#3a6797>variable</font></b> tcltk_version [<b><font color=#3a6797>package</font></b> require Tk]
  <b><font color=#3a6797>variable</font></b> isTcl90 [<b><font color=#3a6797>package</font></b> vsatisfies <font color=#1b1baa>$tcltk_version</font> 9.0-]
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>package</font></b> vsatisfies <font color=#1b1baa>$tcltk_version</font> 8.6.10-]} {
    <b><font color=#134070>tk_messageBox</font></b> <font color=#653760>-message</font> <font color=#8b2a0e>&quot;\nalited needs Tcl/Tk v8.6.10+ \</font>
<font color=#8b2a0e>      \n\nwhile the current is v<font color=#1b1baa>$</font>tcltk_version\n&quot;</font>
    <b><font color=#3a6797>exit</font></b>
  }
  <b><font color=#3a6797>set</font></b> _ [<b><font color=#3a6797>info</font></b> nameofexecutable]
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> first { } <font color=#1b1baa>$_</font>]&gt;0} {
    <b><font color=#3a6797>set</font></b> res [<b><font color=#134070>tk_messageBox</font></b> <font color=#653760>-title</font> Warning <font color=#653760>-icon</font> warning <font color=#653760>-message</font> \
      <font color=#8b2a0e>&quot;The Tcl runtime path\n\n\&quot;<font color=#1b1baa>$</font>_\&quot;\n\ncontains spaces.\n \</font>
<font color=#8b2a0e>      \nThis path doesn't fit alited. Only 'non-space' ones do.\n \</font>
<font color=#8b2a0e>      \n==&gt; Some tools won't work.&quot;</font> <font color=#653760>-type</font> okcancel]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$res</font> ne {ok}} <b><font color=#3a6797>exit</font></b>
  }

  <b><font color=#3a6797>variable</font></b> al; <b><font color=#3a6797>array</font></b> set al [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>variable</font></b> al2; <b><font color=#3a6797>array</font></b> set al2 [<b><font color=#3a6797>list</font></b>] ;<i><font color=#4b5d50># alternative array, just to not touch &quot;al&quot;</font></i>

  <i><font color=#4b5d50># versions of mnu/ini to update to</font></i>
  <b><font color=#3a6797>set</font></b> al(MNUversion) 1.6.0a1
  <b><font color=#3a6797>set</font></b> al(INIversion) 1.4.7

  <i><font color=#4b5d50># previous version of alited to update from</font></i>
  <b><font color=#3a6797>set</font></b> al(ALEversion) 0.0.1
}
<b><font color=#134070>wm</font></b> withdraw .

<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>package</font></b> require comm}  ;<i><font color=#4b5d50># Generic message transport</font></i>
<a id=Remove_installed_(perhaps)_packages_used_in_alited></a>
<i><font color=#4b5d50># _____ Remove installed (perhaps) packages used in alited _____ #</font></i>

<b><font color=#3a6797>foreach</font></b> _ {baltip bartabs hl_tcl} {
  <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>package</font></b> forget <font color=#1b1baa>$_</font>}
  <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>namespace</font></b> delete ::<font color=#1b1baa>$_</font>}
}
<b><font color=#3a6797>unset</font></b> <font color=#653760>-nocomplain</font> _
<a id=alited::_Main></a>
<i><font color=#4b5d50># __________________________ alited:: Main _________________________ #</font></i>

<b><font color=#ca14ca>namespace</font></b> eval alited {
<a id=Main_variables></a>
  <i><font color=#4b5d50>## ________________________ Main variables _________________________ ##</font></i>

  <b><font color=#3a6797>set</font></b> DEBUG no  ;<i><font color=#4b5d50># debug mode</font></i>
  <b><font color=#3a6797>set</font></b> LOG {}    ;<i><font color=#4b5d50># log file in develop mode</font></i>

  <b><font color=#3a6797>set</font></b> al(WIN) .alwin    ;<i><font color=#4b5d50># main form's path</font></i>
  <b><font color=#3a6797>set</font></b> al(comm_port) 51807  ;<i><font color=#4b5d50># port to listen</font></i>
  <b><font color=#3a6797>set</font></b> al(comm_port_list) [<b><font color=#3a6797>list</font></b> {} <font color=#1b1baa>$al(comm_port)</font> 51817 51827 51837] ;<i><font color=#4b5d50># ports to listen</font></i>
  <b><font color=#3a6797>set</font></b> al(ini_file) {}  ;<i><font color=#4b5d50># alited.ini contents</font></i>

  <i><font color=#4b5d50># main data of alited (others are in ini.tcl)</font></i>

  <b><font color=#3a6797>variable</font></b> SCRIPT [<b><font color=#3a6797>info</font></b> script]
  <b><font color=#3a6797>variable</font></b> SCRIPTNORMAL [<b><font color=#3a6797>file</font></b> normalize <font color=#1b1baa>$SCRIPT</font>]
  <b><font color=#3a6797>variable</font></b> FILEDIR [<b><font color=#3a6797>file</font></b> dirname <font color=#1b1baa>$SCRIPTNORMAL</font>]
  <b><font color=#3a6797>variable</font></b> DIR [<b><font color=#3a6797>file</font></b> dirname <font color=#1b1baa>$FILEDIR</font>]

  <i><font color=#4b5d50># directories of sources</font></i>
  <b><font color=#3a6797>variable</font></b> SRCDIR [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$DIR</font> src]
  <b><font color=#3a6797>variable</font></b> LIBDIR [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$DIR</font> lib]

  <i><font color=#4b5d50># directories of required packages</font></i>
  <b><font color=#3a6797>variable</font></b> BARSDIR [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$LIBDIR</font> bartabs]
  <b><font color=#3a6797>variable</font></b> HLDIR   [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$LIBDIR</font> hl_tcl]

  <b><font color=#3a6797>set</font></b> ::e_menu_dir [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$LIBDIR</font> e_menu]
  <b><font color=#3a6797>variable</font></b> MNUDIR [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::e_menu_dir</font> menus]

  <i><font color=#4b5d50># apave & baltip packages are located in e_menu's subdirectory</font></i>
  <b><font color=#3a6797>variable</font></b> PAVEDIR [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::e_menu_dir</font> src]
  <b><font color=#3a6797>variable</font></b> BALTDIR [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$PAVEDIR</font> baltip]

  <i><font color=#4b5d50># directories of key data</font></i>
  <b><font color=#3a6797>variable</font></b> DATADIR [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$DIR</font> data]
  <b><font color=#3a6797>variable</font></b> IMGDIR  [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$DATADIR</font> img]
  <b><font color=#3a6797>variable</font></b> MSGSDIR [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$DATADIR</font> msgs]
  <b><font color=#3a6797>variable</font></b> DATAUSER [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$DATADIR</font> user]
  <b><font color=#3a6797>variable</font></b> DATAUSERINI [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$DATAUSER</font> ini]
  <b><font color=#3a6797>variable</font></b> DATAUSERINIFILE [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$DATAUSERINI</font> alited.ini]
  <b><font color=#3a6797>variable</font></b> HOMEDIR ~
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> exists ::env(HOME)]} {<b><font color=#3a6797>set</font></b> HOMEDIR <font color=#1b1baa>$::env(HOME)</font>}

  <i><font color=#4b5d50># directories of user's data</font></i>
  <b><font color=#3a6797>variable</font></b> CONFIGDIRSTD [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$HOMEDIR</font> .config]
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$CONFIGDIRSTD</font>] && \
  (<font color=#1b1baa>$::tcl_platform(platform)</font> eq {windows} || [<b><font color=#3a6797>info</font></b> exists ::env(LOCALAPPDATA)])} {
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> exists ::env(LOCALAPPDATA)]} {
      <b><font color=#3a6797>set</font></b> CONFIGDIRSTD <font color=#1b1baa>$::env(LOCALAPPDATA)</font>
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> CONFIGDIRSTD [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$HOMEDIR</font> AppData Local]
    }
  }
  <b><font color=#3a6797>set</font></b> CONFIGDIRSTD [<b><font color=#3a6797>file</font></b> normalize <font color=#1b1baa>$CONFIGDIRSTD</font>]
  <b><font color=#3a6797>variable</font></b> USERLASTINI [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$CONFIGDIRSTD</font> alited last.ini]

  <i><font color=#4b5d50># configurations</font></i>
  <b><font color=#3a6797>variable</font></b> CONFIGDIR <font color=#1b1baa>$CONFIGDIRSTD</font>
  <b><font color=#3a6797>variable</font></b> CONFIGS [<b><font color=#3a6797>list</font></b>]

  <i><font color=#4b5d50># two main objects to build forms (just some unique names)</font></i>
  <b><font color=#3a6797>variable</font></b> obPav ::alited::alitedpav
  <b><font color=#3a6797>variable</font></b> obDlg ::alited::aliteddlg  ;<i><font color=#4b5d50># dialog of 1st level</font></i>
  <b><font color=#3a6797>variable</font></b> obDl2 ::alited::aliteddl2  ;<i><font color=#4b5d50># dialog of 2nd level</font></i>
  <b><font color=#3a6797>variable</font></b> obCHK ::alited::alitedCHK  ;<i><font color=#4b5d50># dialog of &quot;Check Tcl&quot;</font></i>
  <b><font color=#3a6797>variable</font></b> obFND ::alited::alitedFND  ;<i><font color=#4b5d50># dialog of &quot;Find/Replace&quot;</font></i>
  <b><font color=#3a6797>variable</font></b> obFN2 ::alited::alitedFN2  ;<i><font color=#4b5d50># dialog of &quot;Find by list&quot;</font></i>
  <b><font color=#3a6797>variable</font></b> obRun ::alited::alitedRun  ;<i><font color=#4b5d50># dialog of &quot;Run...&quot;</font></i>

  <i><font color=#4b5d50># misc. vars</font></i>
  <b><font color=#3a6797>variable</font></b> DirGeometry {}  ;<i><font color=#4b5d50># saved geometry of &quot;Choose Directory&quot; dialogue (for Linux)</font></i>
  <b><font color=#3a6797>variable</font></b> FilGeometry {}  ;<i><font color=#4b5d50># saved geometry of &quot;Choose File&quot; dialogue (for Linux)</font></i>
  <b><font color=#3a6797>variable</font></b> tplgeometry {}  ;<i><font color=#4b5d50># saved geometry of &quot;Template&quot; dialogue</font></i>
  <b><font color=#3a6797>variable</font></b> favgeometry {}  ;<i><font color=#4b5d50># saved geometry of &quot;Saved favorites&quot; dialogue</font></i>
  <b><font color=#3a6797>variable</font></b> pID 0

  <i><font color=#4b5d50># misc. consts</font></i>
  <b><font color=#3a6797>variable</font></b> PRJEXT .ale     ;<i><font color=#4b5d50># project file's extension</font></i>
  <b><font color=#3a6797>variable</font></b> EOL {@~}        ;<i><font color=#4b5d50># &quot;end of line&quot; for ini-files</font></i>

  <i><font color=#4b5d50># project options' names</font></i>
  <b><font color=#3a6797>variable</font></b> OPTS [<b><font color=#3a6797>list</font></b> \
    prjname prjroot prjdirign prjEOL prjindent prjindentAuto prjredunit \
    prjmultiline prjbeforerun prjtrailwhite prjincons prjmaxcoms prjtran \
    prjtrans prjtransadd prjuseleafRE prjleafRE]

  <i><font color=#4b5d50># directory tree's content</font></i>
  <b><font color=#3a6797>variable</font></b> _dirtree [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>set</font></b> al(_dirignore) [<b><font color=#3a6797>list</font></b>]

  <i><font color=#4b5d50># project options' values</font></i>
  <b><font color=#3a6797>set</font></b> al(prjname) {}      ;<i><font color=#4b5d50># current project's name</font></i>
  <b><font color=#3a6797>set</font></b> al(prjfile) {}      ;<i><font color=#4b5d50># current project's file name</font></i>
  <b><font color=#3a6797>set</font></b> al(prjroot) {}      ;<i><font color=#4b5d50># current project's directory name</font></i>
  <b><font color=#3a6797>set</font></b> al(prjindent) 4     ;<i><font color=#4b5d50># current project's indentation</font></i>
  <b><font color=#3a6797>set</font></b> al(prjindentAuto) 1 ;<i><font color=#4b5d50># auto detection of indentation</font></i>
  <b><font color=#3a6797>set</font></b> al(prjmultiline) 0  ;<i><font color=#4b5d50># current project's multiline mode</font></i>
  <b><font color=#3a6797>set</font></b> al(prjEOL) {}       ;<i><font color=#4b5d50># current project's end of line</font></i>
  <b><font color=#3a6797>set</font></b> al(prjredunit) 20   ;<i><font color=#4b5d50># current project's unit lines per 1 red bar</font></i>
  <b><font color=#3a6797>set</font></b> al(minredunit) 4    ;<i><font color=#4b5d50># minimum project's unit lines per 1 red bar</font></i>
  <b><font color=#3a6797>set</font></b> al(prjbeforerun) {} ;<i><font color=#4b5d50># a command to be run before &quot;Tools/Run&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(prjtrailwhite) 0 ;<i><font color=#4b5d50># &quot;remove trailing whitespaces&quot; flag</font></i>
  <b><font color=#3a6797>set</font></b> al(prjincons) 1     ;<i><font color=#4b5d50># &quot;run Tcl scripts in console&quot; flag</font></i>
  <b><font color=#3a6797>set</font></b> al(prjdirign) {.git .bak} ;<i><font color=#4b5d50># ignored subdirectories of project</font></i>
  <b><font color=#3a6797>set</font></b> al(prjmaxcoms) 20   ;<i><font color=#4b5d50># maximum of &quot;Run...&quot; commands</font></i>
  <b><font color=#3a6797>set</font></b> al(prjuseleafRE) 0  ;<i><font color=#4b5d50># &quot;use leaf's RE&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(prjleafRE) {}    ;<i><font color=#4b5d50># &quot;leaf's RE&quot;</font></i>
  <b><font color=#3a6797>set</font></b> al(ED,TRAN) https://libretranslate.de/translate
  <b><font color=#3a6797>set</font></b> al(ED,TRANS) [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$al(ED,TRAN)</font> \
    https://translate.argosopentech.com/translate \
    https://translate.terraprint.co/translate]
  <b><font color=#3a6797>set</font></b> al(ED,TRANSADD) 1
  <b><font color=#3a6797>set</font></b> al(prjtran) <font color=#1b1baa>$al(ED,TRAN)</font>   ;<i><font color=#4b5d50># current translation site</font></i>
  <b><font color=#3a6797>set</font></b> al(prjtrans) <font color=#1b1baa>$al(ED,TRANS)</font> ;<i><font color=#4b5d50># list of translation sites</font></i>
  <b><font color=#3a6797>set</font></b> al(prjtransadd) <font color=#1b1baa>$al(ED,TRANSADD)</font>   ;<i><font color=#4b5d50>#</font></i>
  <b><font color=#3a6797>foreach</font></b> _ <font color=#1b1baa>$OPTS</font> {<b><font color=#3a6797>set</font></b> al(DEFAULT,<font color=#1b1baa>$_</font>) <font color=#1b1baa>$al($_)</font>}

  <b><font color=#3a6797>set</font></b> al(TITLE) {%f :: %d :: %p}           ;<i><font color=#4b5d50># alited title's template</font></i>
  <b><font color=#3a6797>set</font></b> al(TclExtsDef) {.tcl .tm .msg .test} ;<i><font color=#4b5d50># extensions of Tcl files</font></i>
  <b><font color=#3a6797>set</font></b> al(ClangExtsDef) {.c .h .cpp .hpp}   ;<i><font color=#4b5d50># extensions of C/C++ files</font></i>
  <b><font color=#3a6797>set</font></b> al(TextExtsDef) {html htm css md txt sh bat ini alm em ale conf wiki ui} ;<i><font color=#4b5d50># ... plain texts</font></i>
  <b><font color=#3a6797>set</font></b> al(TclExts) <font color=#1b1baa>$al(TclExtsDef)</font>
  <b><font color=#3a6797>set</font></b> al(ClangExts) <font color=#1b1baa>$al(ClangExtsDef)</font>
  <b><font color=#3a6797>set</font></b> al(TextExts) <font color=#1b1baa>$al(TextExtsDef)</font>
  <b><font color=#3a6797>set</font></b> al(MOVEFG) black
  <b><font color=#3a6797>set</font></b> al(MOVEBG) #7eeeee

<a id=Procs_to_raise_the_alited_app></a>
  <i><font color=#4b5d50>## __________________ Procs to raise the alited app ___________________ ##</font></i>
<a id=raise_window></a>
  <b><font color=#ca14ca>proc</font></b> raise_window {} {
    <i><font color=#4b5d50># Raises the app's window.</font></i>

    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>catch</font></b> {
      <b><font color=#134070>wm</font></b> withdraw <font color=#1b1baa>$al(WIN)</font>
      <b><font color=#134070>wm</font></b> deiconify <font color=#1b1baa>$al(WIN)</font>
    }
  }
<a id=open_files_and_raise></a>
  <b><font color=#ca14ca>proc</font></b> open_files_and_raise {iin args} {
    <i><font color=#4b5d50># Opens files of CLI.</font></i>
    <i><font color=#4b5d50>#   iin - count of call</font></i>
    <i><font color=#4b5d50>#   args - list of file names</font></i>
    <i><font color=#4b5d50># See also: bar::FillBar</font></i>

    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$iin</font>&lt;10} {
      <i><font color=#4b5d50># let the tab bar be filled first</font></i>
      <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>info</font></b> exists ::alited::al(BID)]} {
        <b><font color=#3a6797>after</font></b> idle [<b><font color=#3a6797>list</font></b> after 1000 [<b><font color=#3a6797>list</font></b> ::alited::open_files_and_raise [<b><font color=#3a6797>incr</font></b> iin] {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>]]
        <b><font color=#ca14ca>return</font></b>
      }
      <b><font color=#3a6797>foreach</font></b> fname [<b><font color=#3a6797>lreverse</font></b> <font color=#1b1baa>$args</font>] {
        <b><font color=#3a6797>set</font></b> fname [<b><font color=#3a6797>string</font></b> trim <font color=#1b1baa>$fname</font> <font color=#8b2a0e>&quot;\&quot;\{\}&quot;</font>]
        <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>file</font></b> isfile <font color=#1b1baa>$fname</font>]} {
          file::OpenFile <font color=#1b1baa>$fname</font> yes
        } <b><font color=#3a6797>else</font></b> {
          Balloon1 <font color=#1b1baa>$fname</font>
          file::NewFile <font color=#1b1baa>$fname</font>
        }
      }
    }
    raise_window
  }
<a id=run_remote></a>
  <b><font color=#ca14ca>proc</font></b> run_remote {cmd args} {
    <i><font color=#4b5d50># Runs a command that was started by another process.</font></i>

    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> { <font color=#1b1baa>$cmd</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font> } err]} {
      <b><font color=#3a6797>puts</font></b> <font color=#1b1baa>$err</font>
      <b><font color=#ca14ca>return</font></b> <font color=#653760>-code</font> error
    }
  }
<a id=main_user_dirs></a>
  <b><font color=#ca14ca>proc</font></b> main_user_dirs {} {
    <i><font color=#4b5d50># Gets names of main user directories for settings.</font></i>

    <b><font color=#3a6797>set</font></b> ::alited::USERDIR [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::CONFIGDIR</font> alited]
    <b><font color=#3a6797>set</font></b> ::alited::INIDIR [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::USERDIR</font> ini]
    <b><font color=#3a6797>set</font></b> ::alited::PRJDIR [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::USERDIR</font> prj]
  }
<a id=EONS:_Main></a>
  <i><font color=#4b5d50>## _ EONS: Main _ ##</font></i>
}
<a id=Packages_used></a>
<i><font color=#4b5d50># _____________________________ Packages used __________________________ #</font></i>

<b><font color=#3a6797>lappend</font></b> auto_path <font color=#1b1baa>$::alited::LIBDIR</font> <font color=#1b1baa>$::alited::PAVEDIR</font>

<b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::BARSDIR</font> bartabs.tcl]
<b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::PAVEDIR</font> apave.tcl]
<b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::HLDIR</font>  hl_tcl.tcl]
<b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::HLDIR</font>  hl_c.tcl]

::apave::mainWindowOfApp <font color=#1b1baa>$::alited::al(WIN)</font>
<a id=::argv,_::argc></a>
<i><font color=#4b5d50># ________________________ ::argv, ::argc _________________________ #</font></i>

<b><font color=#3a6797>set</font></b> ::alited::ARGV <font color=#1b1baa>$::argv</font>
<b><font color=#3a6797>set</font></b> ::alited::al(IsWindows) [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$::tcl_platform(platform)</font> eq {windows}}]

<i><font color=#4b5d50># The following &quot;if&quot; counts on the Ruff! doc generator:</font></i>
<i><font color=#4b5d50>#   - Ruff! uses &quot;package require&quot; for a documented package (&quot;alited&quot;, e.g.)</font></i>
<i><font color=#4b5d50>#   - alited should not be run when Ruff! sources it</font></i>
<i><font color=#4b5d50>#   - so, without 'package require alited', it's a regular run of alited</font></i>

<b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>package</font></b> versions alited] eq {}} {
  <b><font color=#134070>wm</font></b> withdraw .
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$::alited::al(IsWindows)</font>} {
    <b><font color=#134070>wm</font></b> attributes . <font color=#653760>-alpha</font> 0.0
  }
  <b><font color=#3a6797>set</font></b> ALITED_PORT yes
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> _ [<b><font color=#3a6797>lsearch</font></b> <font color=#653760>-exact</font> <font color=#1b1baa>$::argv</font> <font color=#653760>-NOPORT</font>]]&gt;-1} {
    <b><font color=#3a6797>set</font></b> ::argv [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$::argv</font> <font color=#1b1baa>$_</font> <font color=#1b1baa>$_</font>]
    <b><font color=#3a6797>incr</font></b> ::argc -1
    <b><font color=#3a6797>set</font></b> ALITED_PORT no
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> _ [<b><font color=#3a6797>lsearch</font></b> <font color=#653760>-glob</font> <font color=#1b1baa>$::argv</font> LOG=*]]&gt;-1} {
    <b><font color=#3a6797>set</font></b> ::alited::LOG [<b><font color=#3a6797>string</font></b> range [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$::argv</font> <font color=#1b1baa>$_</font>] 4 end]
    <b><font color=#3a6797>set</font></b> ::argv [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$::argv</font> <font color=#1b1baa>$_</font> <font color=#1b1baa>$_</font>]
    <b><font color=#3a6797>incr</font></b> ::argc -1
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> _ [<b><font color=#3a6797>lsearch</font></b> <font color=#653760>-exact</font> <font color=#1b1baa>$::argv</font> DEBUG]]&gt;-1} {
    <b><font color=#3a6797>set</font></b> ::alited::DEBUG yes
    <b><font color=#3a6797>set</font></b> ::argv [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$::argv</font> <font color=#1b1baa>$_</font> <font color=#1b1baa>$_</font>]
    <b><font color=#3a6797>incr</font></b> ::argc -1
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>file</font></b> isdirectory <font color=#1b1baa>$::argv</font>]} {
    <i><font color=#4b5d50># if alited run with &quot;config dir containing spaces&quot;</font></i>
    <b><font color=#3a6797>set</font></b> ::argv [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$::argv</font>]
  } <b><font color=#3a6797>elseif</font></b> {[<b><font color=#3a6797>file</font></b> isdirectory [<b><font color=#3a6797>set</font></b> _ [<b><font color=#3a6797>lrange</font></b> <font color=#1b1baa>$::argv</font> 0 end-1]]]} {
    <i><font color=#4b5d50># if alited run with &quot;config dir containing spaces&quot; + &quot;filename&quot;</font></i>
    <b><font color=#3a6797>set</font></b> ::argv [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$_</font> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$::argv</font> end]]
  }
<a id=Last_configuration></a>
  <i><font color=#4b5d50>## ____________________ Last configuration __________________ ##</font></i>

  <b><font color=#3a6797>set</font></b> readalitedCONFIGS no
  <b><font color=#3a6797>set</font></b> isalitedCONFIGS [<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$::alited::USERLASTINI</font>]
  <b><font color=#3a6797>set</font></b> _ [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$::argv</font> 0]
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$::argv</font>] || ![<b><font color=#3a6797>file</font></b> isdirectory <font color=#1b1baa>$_</font>]} {
    alited::main_user_dirs
    <b><font color=#3a6797>if</font></b> {(![<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$::alited::INIDIR</font>] || ![<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$::alited::PRJDIR</font>]) && \
    <font color=#1b1baa>$isalitedCONFIGS</font>} {
      <i><font color=#4b5d50># read INIDIR & PRJDIR that were last entered</font></i>
      <b><font color=#3a6797>lassign</font></b> [<b><font color=#3a6797>split</font></b> [::apave::readTextFile <font color=#1b1baa>$::alited::USERLASTINI</font>] \n] \
        ::alited::INIDIR ::alited::PRJDIR ::alited::CONFIGS
      <b><font color=#3a6797>set</font></b> ::alited::CONFIGDIR [<b><font color=#3a6797>file</font></b> dirname [<b><font color=#3a6797>file</font></b> dirname <font color=#1b1baa>$::alited::INIDIR</font>]]
      <b><font color=#3a6797>set</font></b> readalitedCONFIGS yes
    }
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> ::alited::CONFIGDIR <font color=#1b1baa>$_</font>
    <b><font color=#3a6797>set</font></b> ::argv [<b><font color=#3a6797>lrange</font></b> <font color=#1b1baa>$::argv</font> 1 end]
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> index <font color=#1b1baa>$::argv</font> 0] eq {'} && [<b><font color=#3a6797>string</font></b> index <font color=#1b1baa>$::argv</font> end] eq {'}} {
    <i><font color=#4b5d50># when run from menu.em &quot;Edit/create file&quot;</font></i>
    <b><font color=#3a6797>set</font></b> ::argv [<b><font color=#3a6797>list</font></b> [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$::argv</font> 1 end-1]]
  } <b><font color=#3a6797>elseif</font></b> {[<b><font color=#3a6797>file</font></b> isfile <font color=#1b1baa>$::argv</font>]} {
    <b><font color=#3a6797>set</font></b> ::argv [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$::argv</font>]
  }
  <b><font color=#3a6797>set</font></b> ALITED_ARGV [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>foreach</font></b> _ <font color=#1b1baa>$::argv</font> {<b><font color=#3a6797>lappend</font></b> ALITED_ARGV [<b><font color=#3a6797>file</font></b> normalize <font color=#1b1baa>$_</font>]}
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$ALITED_ARGV</font>]==1 && [<b><font color=#3a6797>llength</font></b> [<b><font color=#3a6797>split</font></b> <font color=#1b1baa>$ALITED_ARGV</font>]]&gt;1} {
    <b><font color=#3a6797>set</font></b> ALITED_ARGV [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$ALITED_ARGV</font>]  ;<i><font color=#4b5d50># file name contains spaces</font></i>
  }
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$readalitedCONFIGS</font> && <font color=#1b1baa>$isalitedCONFIGS</font>} {
    <i><font color=#4b5d50># read configurations used</font></i>
    <b><font color=#3a6797>set</font></b> ::alited::CONFIGS [<b><font color=#3a6797>lindex</font></b> [<b><font color=#3a6797>split</font></b> [::apave::readTextFile <font color=#1b1baa>$::alited::USERLASTINI</font>] \n] 2]
  }
  <b><font color=#3a6797>unset</font></b> <font color=#653760>-nocomplain</font> readalitedCONFIGS
  <b><font color=#3a6797>unset</font></b> <font color=#653760>-nocomplain</font> isalitedCONFIGS
<a id=Port_to_listen></a>
  <i><font color=#4b5d50>## ____________________ Port to listen __________________ ##</font></i>

  <i><font color=#4b5d50># try to read alited.ini</font></i>
  <b><font color=#3a6797>set</font></b> _ [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$_</font> alited ini alited.ini]
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> _ [<b><font color=#3a6797>open</font></b> <font color=#1b1baa>$_</font>]}]} {
    <b><font color=#3a6797>set</font></b> ::alited::al(ini_file) [<b><font color=#3a6797>split</font></b> [<b><font color=#3a6797>read</font></b> <font color=#1b1baa>$_</font>] \n]
    <b><font color=#3a6797>close</font></b> <font color=#1b1baa>$_</font>
    <b><font color=#3a6797>set</font></b> _ [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$::alited::al(ini_file)</font> 1]
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> match comm_port=* <font color=#1b1baa>$_</font>]} {
      <b><font color=#3a6797>set</font></b> ::alited::al(comm_port) [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$_</font> 10 end]
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> ::alited::al(comm_port) 51837 ;<i><font color=#4b5d50># to be compatible with old style</font></i>
    }
  }
  <b><font color=#3a6797>unset</font></b> <font color=#653760>-nocomplain</font> _
<a id=Open_an_existing_app></a>
  <i><font color=#4b5d50>## ____________________ Open an existing app __________________ ##</font></i>

  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> is integer <font color=#653760>-strict</font> <font color=#1b1baa>$::alited::al(comm_port)</font>]} {
    <i><font color=#4b5d50># Code borrowed from TKE editor.</font></i>
    <i><font color=#4b5d50># Set the comm port that we will use</font></i>
    <i><font color=#4b5d50># Change our comm port to a known value</font></i>
    <i><font color=#4b5d50># (if we fail, the app is already running at that port so connect to it)</font></i>
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$::alited::al(IsWindows)</font> && \
    ![<b><font color=#3a6797>catch</font></b> { ::comm::comm config <font color=#653760>-port</font> <font color=#1b1baa>$::alited::al(comm_port)</font> }]} {
      <b><font color=#3a6797>set</font></b> ALITED_PORT no ;<i><font color=#4b5d50># no running app</font></i>
    }
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> ALITED_PORT no
  }
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$::alited::DEBUG</font> && <font color=#1b1baa>$ALITED_PORT</font>} {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$::alited::al(IsWindows)</font>} {
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$ALITED_ARGV</font>]} {
        <i><font color=#4b5d50># Attempt to add files & raise the existing application</font></i>
        <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>catch</font></b> {::comm::comm send <font color=#1b1baa>$::alited::al(comm_port)</font> ::alited::run_remote \
        ::alited::open_files_and_raise 0 <font color=#1b1baa>$ALITED_ARGV</font>}]} {
          <b><font color=#134070>destroy</font></b> .
          <b><font color=#3a6797>exit</font></b>
        }
      } <b><font color=#3a6797>else</font></b> {
        <i><font color=#4b5d50># Attempt to raise the existing application</font></i>
        <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>catch</font></b> { ::comm::comm send <font color=#1b1baa>$::alited::al(comm_port)</font> ::alited::run_remote \
        ::alited::raise_window }]} {
          <b><font color=#134070>destroy</font></b> .
          <b><font color=#3a6797>exit</font></b>
        }
      }
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>if</font></b> {[<b><font color=#134070>tk</font></b> appname alited] ne <font color=#8b2a0e>&quot;alited&quot;</font>} {
        <b><font color=#134070>send</font></b> <font color=#653760>-async</font> alited ::alited::open_files_and_raise 0 {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$ALITED_ARGV</font>
        <b><font color=#134070>destroy</font></b> .
        <b><font color=#3a6797>exit</font></b>
      }
    }
  }

}
<a id=alited::></a>
<i><font color=#4b5d50># __________________________ alited:: ________________________ #</font></i>

<b><font color=#ca14ca>namespace</font></b> eval alited {
<a id=FgFgBold></a>
  <b><font color=#ca14ca>proc</font></b> FgFgBold {} {
    <i><font color=#4b5d50># Gets foregrounds of normal and colored text of current color scheme</font></i>
    <i><font color=#4b5d50># and red color of TODOs.</font></i>

    <b><font color=#3a6797>variable</font></b> obPav
    <b><font color=#3a6797>lassign</font></b> [::hl_tcl::addingColors] -&gt; fgred
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> lst [<font color=#1b1baa>$obPav</font> csGet]}]} {
      <b><font color=#3a6797>set</font></b> fg [<b><font color=#134070>ttk::style</font></b> lookup <font color=#8b2a0e>&quot;.&quot;</font> <font color=#653760>-foreground</font>]
      <b><font color=#3a6797>set</font></b> bg [<b><font color=#134070>ttk::style</font></b> lookup <font color=#8b2a0e>&quot;.&quot;</font> <font color=#653760>-background</font>]
      <b><font color=#3a6797>set</font></b> fgbold <font color=#1b1baa>$fgred</font>
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$lst</font> - fg - bg fgbold
    }
    <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$fg</font> <font color=#1b1baa>$fgbold</font> <font color=#1b1baa>$fgred</font> <font color=#1b1baa>$bg</font>]
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=ListPaved></a>
  <b><font color=#ca14ca>proc</font></b> ListPaved {} {
    <i><font color=#4b5d50># Return a list of apave objects for dialogues.</font></i>

    <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>list</font></b> obDlg obDl2 obFND obFN2 obCHK obRun]
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=SyntaxColors></a>
  <b><font color=#ca14ca>proc</font></b> SyntaxColors {} {
    <i><font color=#4b5d50># Gets colors for syntax highlighting.</font></i>

    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>foreach</font></b> nam [::hl_tcl::hl_colorNames] {<b><font color=#3a6797>lappend</font></b> colors <font color=#1b1baa>$al(ED,$nam)</font>}
    <b><font color=#3a6797>lassign</font></b> [::hl_tcl::addingColors] clrCURL clrCMN2
    <b><font color=#3a6797>lappend</font></b> colors <font color=#1b1baa>$clrCURL</font> <font color=#1b1baa>$clrCMN2</font>
    <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$colors</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=SyntaxHighlight></a>
  <b><font color=#ca14ca>proc</font></b> SyntaxHighlight {lng wtxt colors {cs <font color=#8b2a0e>&quot;&quot;</font>} args} {
    <i><font color=#4b5d50># Makes a text being syntax highlighted.</font></i>
    <i><font color=#4b5d50>#   lng - language (tcl, c)</font></i>
    <i><font color=#4b5d50>#   wtxt - text's path</font></i>
    <i><font color=#4b5d50>#   colors - highlighting colors</font></i>
    <i><font color=#4b5d50>#   cs - color scheme</font></i>
    <i><font color=#4b5d50>#   args - other options</font></i>

    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$cs</font> eq {}} {<b><font color=#3a6797>set</font></b> cs [::apave::obj csCurrent]}
    ::hl_<font color=#1b1baa>${lng}</font>::hl_init <font color=#1b1baa>$wtxt</font> <font color=#653760>-dark</font> [::apave::obj csDark <font color=#1b1baa>$cs</font>] <font color=#653760>-colors</font> <font color=#1b1baa>$colors</font> \
      <font color=#653760>-multiline</font> 1 <font color=#653760>-font</font> <font color=#1b1baa>$al(FONT,txt)</font> <font color=#653760>-insertwidth</font> <font color=#1b1baa>$al(CURSORWIDTH)</font> \
      <font color=#653760>-cmdpos</font> ::apave::None <font color=#653760>-dobind</font> yes {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
    ::hl_<font color=#1b1baa>${lng}</font>::hl_text <font color=#1b1baa>$wtxt</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=TextIcon></a>
  <b><font color=#ca14ca>proc</font></b> TextIcon {ico {to out}} {
    <i><font color=#4b5d50># Gets a picture from a character and vice versa.</font></i>
    <i><font color=#4b5d50>#   ico - picture or character</font></i>
    <i><font color=#4b5d50>#   to - &quot;in&quot; gets in-chars, &quot;out&quot; gets out-chars</font></i>

    <b><font color=#3a6797>variable</font></b> isTcl90
    <b><font color=#3a6797>set</font></b> in [<b><font color=#3a6797>list</font></b> 0 1 2 3 4 5 6 7 8 9 & ~ = @]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$isTcl90</font>} {  ;<i><font color=#4b5d50># codes instead of pictures available in Tcl 9.0</font></i>
      <b><font color=#3a6797>set</font></b> out [<b><font color=#3a6797>list</font></b> \U0001f4a5 \U0001f4bb \U0001f3d7 \U0001f4f6 \U0001f4e1 \U0001f4d6 \
        \U0001f300 \U0001f4f7 \U0001f4d0 \U0001f426 \U0001f381 \U0001f3c1 \U0001f511 \U0001f4be]
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> out [<b><font color=#3a6797>list</font></b> 💥 💻 🏗 📶 📡 📖 🌀 📷 📐 🐦 🎁 🏁 🔑 💾]
    }
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$to</font> eq {out}} {
      <b><font color=#3a6797>set</font></b> lfrom <font color=#1b1baa>$in</font>
      <b><font color=#3a6797>set</font></b> lto <font color=#1b1baa>$out</font>
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> lfrom <font color=#1b1baa>$out</font>
      <b><font color=#3a6797>set</font></b> lto <font color=#1b1baa>$in</font>
    }
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>lsearch</font></b> <font color=#653760>-exact</font> <font color=#1b1baa>$lfrom</font> <font color=#1b1baa>$ico</font>]]&gt;-1} {
      <b><font color=#3a6797>set</font></b> tico [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$lto</font> <font color=#1b1baa>$i</font>]
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> tico <font color=#1b1baa>$ico</font>
    }
    <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$tico</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=Tnext></a>
  <b><font color=#ca14ca>proc</font></b> Tnext {{wprev <font color=#8b2a0e>&quot;&quot;</font>}} {
    <i><font color=#4b5d50># Returns &quot;next & prev widgets&quot; for Tab & Shift/Tab keys, just to skip &quot;Help&quot;.</font></i>
    <i><font color=#4b5d50>#   wprev - widget for Shift/Tab</font></i>
    <i><font color=#4b5d50># Used by obPrf & obPrj objects.</font></i>

    <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>list</font></b> *.ButOK <font color=#1b1baa>$wprev</font>]
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=TmpFile></a>
  <b><font color=#ca14ca>proc</font></b> TmpFile {tname} {
    <i><font color=#4b5d50># Gets a temporary file's name.</font></i>
    <i><font color=#4b5d50>#   tname - tailing part of the name</font></i>

    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$al(EM,mnudir)</font> <font color=#1b1baa>$tname</font>]
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=ProcEOL></a>
  <b><font color=#ca14ca>proc</font></b> ProcEOL {val mode} {
    <i><font color=#4b5d50># Transforms \n to &quot;EOL chars&quot; and vise versa.</font></i>
    <i><font color=#4b5d50>#   val - string to transform</font></i>
    <i><font color=#4b5d50>#   mode - if &quot;in&quot;, gets \n-valued; if &quot;out&quot;, gets EOL-valued.</font></i>

    <b><font color=#3a6797>variable</font></b> EOL
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$mode</font> eq {in}} {
      <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$EOL</font> \n] <font color=#1b1baa>$val</font>]
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> \n <font color=#1b1baa>$EOL</font>] <font color=#1b1baa>$val</font>]
    }
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=ProcessFiles></a>
  <b><font color=#ca14ca>proc</font></b> ProcessFiles {procname what} {
    <i><font color=#4b5d50># Processes files according to Selected/All choice.</font></i>
    <i><font color=#4b5d50>#   procname - name of command to run on files (TID passed)</font></i>
    <i><font color=#4b5d50>#   what - what to process: 1 - selected, 2 - all</font></i>
    <i><font color=#4b5d50># Returns numbers of all and processed files.</font></i>
    <i><font color=#4b5d50># See also: SessionList</font></i>

    <b><font color=#3a6797>variable</font></b> da
    <b><font color=#3a6797>set</font></b> all [<b><font color=#3a6797>set</font></b> processed 0]
    <b><font color=#3a6797>foreach</font></b> tab [alited::SessionList <font color=#1b1baa>$what</font>] {
      <b><font color=#3a6797>incr</font></b> all
      <b><font color=#3a6797>incr</font></b> processed [<font color=#1b1baa>$procname</font> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tab</font> 0]]
    }
    <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$all</font> <font color=#1b1baa>$processed</font>]
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=SessionList></a>
  <b><font color=#ca14ca>proc</font></b> SessionList {{mode 0}} {
    <i><font color=#4b5d50># Returns a list of all tabs or selected tabs (if set).</font></i>
    <i><font color=#4b5d50>#   mode - 0 get selected or all, 1 force selected, 2 force all</font></i>

    <b><font color=#3a6797>set</font></b> res [alited::bar::BAR listFlag s]
    <b><font color=#3a6797>if</font></b> {(!<font color=#1b1baa>$mode</font> && [<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$res</font>]==1) || <font color=#1b1baa>$mode</font>==2} {
      <b><font color=#3a6797>set</font></b> res [alited::bar::BAR listTab]
    }
    <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$res</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=isTclScript></a>
  <b><font color=#ca14ca>proc</font></b> isTclScript {tab} {
    <i><font color=#4b5d50># Check if the tab's file is of .tcl type.</font></i>
    <i><font color=#4b5d50>#   tab - tab's info</font></i>

    <b><font color=#3a6797>set</font></b> TID [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tab</font> 0]
    <b><font color=#3a6797>set</font></b> fn [alited::bar::FileName <font color=#1b1baa>$TID</font>]
    <b><font color=#3a6797>expr</font></b> {[<b><font color=#3a6797>string</font></b> tolower [<b><font color=#3a6797>file</font></b> extension <font color=#1b1baa>$fn</font>]] eq {.tcl}}
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=SessionTclList></a>
  <b><font color=#ca14ca>proc</font></b> SessionTclList {{mode 0}} {
    <i><font color=#4b5d50># Returns a list of all tabs or selected tabs of .tcl files.</font></i>
    <i><font color=#4b5d50>#   mode - 0 get selected or all, 1 force selected, 2 force all</font></i>

    <b><font color=#3a6797>set</font></b> ltabs [<b><font color=#3a6797>list</font></b>]
    <b><font color=#3a6797>foreach</font></b> tab [alited::SessionList <font color=#1b1baa>$mode</font>] {
      <b><font color=#3a6797>if</font></b> {[alited::isTclScript <font color=#1b1baa>$tab</font>]} {
        <b><font color=#3a6797>lappend</font></b> ltabs <font color=#1b1baa>$tab</font>
      }
    }
    <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$ltabs</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=EnsureArray></a>
  <b><font color=#ca14ca>proc</font></b> EnsureArray {arName args} {
    <i><font color=#4b5d50># Ensures restoring an array at calling a proc.</font></i>
    <i><font color=#4b5d50>#   arName - fully qualified array name</font></i>
    <i><font color=#4b5d50>#   args - proc name & arguments</font></i>

    <b><font color=#3a6797>set</font></b> foc [<b><font color=#134070>focus</font></b>]
    ::apave::EnsureArray <font color=#1b1baa>$arName</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
    <b><font color=#3a6797>after</font></b> 100 <font color=#8b2a0e>&quot;::apave::FocusByForce <font color=#1b1baa>$</font>foc&quot;</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=InitUnitTree></a>
  <b><font color=#ca14ca>proc</font></b> InitUnitTree {TID} {
    <i><font color=#4b5d50># Initializes the unit tree of file to be processed.</font></i>
    <i><font color=#4b5d50>#   TID - tab's ID</font></i>

    <b><font color=#3a6797>set</font></b> wtxt [main::GetWTXT <font color=#1b1baa>$TID</font>]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$wtxt</font> ne {}} {unit::RecreateUnits <font color=#1b1baa>$TID</font> <font color=#1b1baa>$wtxt</font>}
    <b><font color=#ca14ca>return</font></b> 1
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=MapWildCards></a>
  <b><font color=#ca14ca>proc</font></b> MapWildCards {com} {
    <i><font color=#4b5d50># Maps some common wildcards in a command</font></i>
    <i><font color=#4b5d50>#   com - the command</font></i>
    <i><font color=#4b5d50># Wildcards:</font></i>
    <i><font color=#4b5d50>#   %H - home directory</font></i>
    <i><font color=#4b5d50>#   %P - directory of current project</font></i>
    <i><font color=#4b5d50>#   %F - current file name</font></i>
    <i><font color=#4b5d50>#   %D - directory of current file</font></i>
    <i><font color=#4b5d50>#   %A - directory of alited</font></i>
    <i><font color=#4b5d50>#   %M - directory of e_menu's menus</font></i>
    <i><font color=#4b5d50>#   %E - Tcl/Tk executable as set in Preferences/Tools</font></i>

    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>variable</font></b> DIR
    <b><font color=#3a6797>set</font></b> filename [bar::FileName]
    <b><font color=#3a6797>set</font></b> dirname [<b><font color=#3a6797>file</font></b> dirname <font color=#1b1baa>$filename</font>]
    <b><font color=#3a6797>set</font></b> abra {<b><font color=#3a6797>*</font></b>^e!`i@U50=|}
    <b><font color=#3a6797>set</font></b> com [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %% <font color=#1b1baa>$abra</font>] <font color=#1b1baa>$com</font>]
    <b><font color=#3a6797>set</font></b> com [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %H [apave::HomeDir]] <font color=#1b1baa>$com</font>]
    <b><font color=#3a6797>set</font></b> com [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %P <font color=#1b1baa>$al(prjroot)</font>] <font color=#1b1baa>$com</font>]
    <b><font color=#3a6797>set</font></b> com [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %F <font color=#1b1baa>$filename</font>] <font color=#1b1baa>$com</font>]
    <b><font color=#3a6797>set</font></b> com [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %D <font color=#1b1baa>$dirname</font>] <font color=#1b1baa>$com</font>]
    <b><font color=#3a6797>set</font></b> com [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %A <font color=#1b1baa>$DIR</font>] <font color=#1b1baa>$com</font>]
    <b><font color=#3a6797>set</font></b> com [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %M <font color=#1b1baa>$al(EM,mnudir)</font>] <font color=#1b1baa>$com</font>]
    <b><font color=#3a6797>set</font></b> com [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %E [Tclexe]] <font color=#1b1baa>$com</font>]
    <b><font color=#3a6797>set</font></b> com [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$abra</font> %] <font color=#1b1baa>$com</font>]
  }
<a id=Messages></a>
  <i><font color=#4b5d50>## ________________________ Messages _________________________ ##</font></i>
<a id=MessageTags></a>
  <b><font color=#ca14ca>proc</font></b> MessageTags {} {
    <i><font color=#4b5d50># Gets tags for texts shown with messages.</font></i>
    <i><font color=#4b5d50># Returns &quot;-tags option&quot; for messages.</font></i>

    <b><font color=#3a6797>lassign</font></b> [FgFgBold] -&gt; fS
    <b><font color=#3a6797>set</font></b> ::alited::textTags [<b><font color=#3a6797>list</font></b> \
      [<b><font color=#3a6797>list</font></b> <font color=#8b2a0e>&quot;r&quot;</font> <font color=#8b2a0e>&quot;-font <font color=#1b1baa>{$</font>::apave::FONTMAINBOLD<font color=#1b1baa>}</font> -foreground <font color=#1b1baa>$</font>fS&quot;</font>] \
      [<b><font color=#3a6797>list</font></b> <font color=#8b2a0e>&quot;b&quot;</font> <font color=#8b2a0e>&quot;-foreground <font color=#1b1baa>$</font>fS&quot;</font>] \
      [<b><font color=#3a6797>list</font></b> <font color=#8b2a0e>&quot;link&quot;</font> <font color=#8b2a0e>&quot;::apave::openDoc %t@@https://%l@@&quot;</font>] \
      ]
    <b><font color=#ca14ca>return</font></b> <font color=#8b2a0e>&quot;-tags ::alited::textTags&quot;</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=TipMessage></a>
  <b><font color=#ca14ca>proc</font></b> TipMessage {lab tip} {
    <i><font color=#4b5d50># Shows a tip on status message and clears the status message.</font></i>
    <i><font color=#4b5d50>#   lab - message label's path</font></i>
    <i><font color=#4b5d50>#   tip - text of tip</font></i>

    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tip</font> ne {}} {<font color=#1b1baa>$lab</font> configure <font color=#653760>-text</font> {}}
    <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$tip</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=msg></a>
  <b><font color=#ca14ca>proc</font></b> msg {type icon message {defb <font color=#8b2a0e>&quot;&quot;</font>} args} {
    <i><font color=#4b5d50># Shows a message and asks for an answer.</font></i>
    <i><font color=#4b5d50>#   type - ok/yesno/okcancel/yesnocancel</font></i>
    <i><font color=#4b5d50>#   icon - info/warn/err</font></i>
    <i><font color=#4b5d50>#   message - the message</font></i>
    <i><font color=#4b5d50>#   defb - default button (for not &quot;ok&quot; dialogs)</font></i>
    <i><font color=#4b5d50>#   args - additional arguments (-title and font's option)</font></i>
    <i><font color=#4b5d50># For &quot;ok&quot; dialogue, 'defb' is omitted (being a part of args).</font></i>

    <b><font color=#3a6797>variable</font></b> obDlg
    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$type</font> eq {ok}} {
      <b><font color=#3a6797>set</font></b> args [<b><font color=#3a6797>linsert</font></b> <font color=#1b1baa>$args</font> 0 <font color=#1b1baa>$defb</font>]
      <b><font color=#3a6797>set</font></b> defb {}
    } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$defb</font> eq {}} {
      <b><font color=#3a6797>set</font></b> defb YES
    }
    <b><font color=#3a6797>lappend</font></b> defb <font color=#653760>-centerme</font> [::apave::rootModalWindow <font color=#1b1baa>$al(WIN)</font>]
    <b><font color=#3a6797>lassign</font></b> [::apave::extractOptions args <font color=#653760>-title</font> {} <font color=#653760>-noesc</font> 0] title noesc
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$title</font> eq {}} {
      <b><font color=#3a6797>switch</font></b> <font color=#1b1baa>$icon</font> {
        warn {<b><font color=#3a6797>set</font></b> title <font color=#1b1baa>$al(MC,warning)</font>}
        err  {<b><font color=#3a6797>set</font></b> title <font color=#1b1baa>$al(MC,error)</font>}
        ques {<b><font color=#3a6797>set</font></b> title <font color=#1b1baa>$al(MC,question)</font>}
        <b><font color=#3a6797>default</font></b> {<b><font color=#3a6797>set</font></b> title <font color=#1b1baa>$al(MC,info)</font>}
      }
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> title [msgcat::mc <font color=#1b1baa>$title</font>]
    }
    <b><font color=#3a6797>set</font></b> message [msgcat::mc <font color=#1b1baa>$message</font>]
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> exists al(obDlg-BUSY)]} {
      <i><font color=#4b5d50># the obDlg is engaged: no actions, just a message</font></i>
      Message <font color=#1b1baa>$message</font> 4
      <b><font color=#3a6797>set</font></b> res 0
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> al(obDlg-BUSY) yes
      <b><font color=#3a6797>set</font></b> res [<font color=#1b1baa>$obDlg</font> <font color=#1b1baa>$type</font> <font color=#1b1baa>$icon</font> <font color=#1b1baa>$title</font> <font color=#8b2a0e>&quot;\n<font color=#1b1baa>$</font>message\n&quot;</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$defb</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>]
      <b><font color=#3a6797>unset</font></b> <font color=#653760>-nocomplain</font> al(obDlg-BUSY)
    }
    <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$res</font> 0]
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=Msg></a>
  <b><font color=#ca14ca>proc</font></b> Msg {inf {ic info} args} {
    <i><font color=#4b5d50># Shows a message in text box.</font></i>
    <i><font color=#4b5d50>#   inf - the message</font></i>
    <i><font color=#4b5d50>#   ic - icon</font></i>

    msg ok <font color=#1b1baa>$ic</font> <font color=#1b1baa>$inf</font> <font color=#653760>-text</font> 1 <font color=#653760>-w</font> 50 {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=Message></a>
  <b><font color=#ca14ca>proc</font></b> Message {msg {mode 1} {lab <font color=#8b2a0e>&quot;&quot;</font>} {first yes}} {
    <i><font color=#4b5d50># Displays a message in statusbar.</font></i>
    <i><font color=#4b5d50>#   msg - message</font></i>
    <i><font color=#4b5d50>#   mode - 1: simple; 2: bold; 3: bold color; 4: bold red bell; 5: static; 6: bold red</font></i>
    <i><font color=#4b5d50>#   lab - label's name to display the message in</font></i>
    <i><font color=#4b5d50>#   first - serves to recursively erase the message</font></i>

    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>variable</font></b> obPav
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> commands <font color=#1b1baa>$obPav</font>] eq {} || [<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>lassign</font></b> [FgFgBold] fg fgbold fgred bg}]} {
      <b><font color=#ca14ca>return</font></b>  ;<i><font color=#4b5d50># at exiting app</font></i>
    }
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$lab</font> eq {}} {<b><font color=#3a6797>set</font></b> lab [<font color=#1b1baa>$obPav</font> Labstat3]}
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$first</font>} {<b><font color=#3a6797>set</font></b> msg [msgcat::mc <font color=#1b1baa>$msg</font>]}
    <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$first</font> && <font color=#1b1baa>$msg</font> ne {} && [<b><font color=#134070>winfo</font></b> exists <font color=#1b1baa>$lab</font>]} {
      <b><font color=#3a6797>set</font></b> curmsg [<font color=#1b1baa>$lab</font> cget <font color=#653760>-text</font>]
      <i><font color=#4b5d50># if a message changed or expired, don't touch it (don't cover it with old 'msg')</font></i>
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> first <font color=#1b1baa>$msg</font> <font color=#1b1baa>$curmsg</font>]&lt;0} <b><font color=#ca14ca>return</font></b>
    }
    <b><font color=#3a6797>set</font></b> font [[<font color=#1b1baa>$obPav</font> Labstat2] cget <font color=#653760>-font</font>]
    <b><font color=#3a6797>set</font></b> fontB [<b><font color=#3a6797>list</font></b> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$font</font> <font color=#653760>-weight</font> bold]
    <b><font color=#3a6797>set</font></b> msg [<b><font color=#3a6797>string</font></b> range [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> \n { } \r {}] <font color=#1b1baa>$msg</font>] 0 500]
    <b><font color=#3a6797>set</font></b> slen [<b><font color=#3a6797>string</font></b> length <font color=#1b1baa>$msg</font>]
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<font color=#1b1baa>$lab</font> configure <font color=#653760>-text</font> <font color=#1b1baa>$msg</font>}] || !<font color=#1b1baa>$slen</font>} <b><font color=#ca14ca>return</font></b>
    <font color=#1b1baa>$lab</font> configure <font color=#653760>-font</font> <font color=#1b1baa>$font</font> <font color=#653760>-foreground</font> <font color=#1b1baa>$fg</font>
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$mode</font> in {2 3 4 5 6}} {
      <font color=#1b1baa>$lab</font> configure <font color=#653760>-font</font> <font color=#1b1baa>$fontB</font>
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$mode</font> eq {4}} {
        <font color=#1b1baa>$lab</font> configure <font color=#653760>-foreground</font> <font color=#1b1baa>$fgred</font>
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$first</font>} <b><font color=#134070>bell</font></b>
      } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$mode</font> in {3 5}} {
        <font color=#1b1baa>$lab</font> configure <font color=#653760>-foreground</font> <font color=#1b1baa>$fgbold</font>
      } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$mode</font> eq {6}} {
        <font color=#1b1baa>$lab</font> configure <font color=#653760>-foreground</font> <font color=#1b1baa>$fgred</font>
      }
    }
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$mode</font> eq {5}} {
      <b><font color=#3a6797>update</font></b>
      <b><font color=#ca14ca>return</font></b>
    }
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$first</font>} {
      <b><font color=#3a6797>set</font></b> msec [<b><font color=#3a6797>expr</font></b> {200*<font color=#1b1baa>$slen</font>}]
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$mode</font> in {2 3 4 5}} {
        <b><font color=#3a6797>set</font></b> opts <font color=#8b2a0e>&quot;-font <font color=#1b1baa>{$</font>fontB<font color=#1b1baa>}</font>&quot;</font>
      } <b><font color=#3a6797>else</font></b> {
        <b><font color=#3a6797>set</font></b> opts {}
      }
      <b><font color=#3a6797>set</font></b> tip [<b><font color=#3a6797>string</font></b> trim [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$msg</font> 0 130]]
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> trim [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$msg</font> [<b><font color=#3a6797>string</font></b> length <font color=#1b1baa>$tip</font>] end]] ne {}} {
        <b><font color=#3a6797>append</font></b> tip ...
      }
      baltip::tip <font color=#1b1baa>$lab</font> <font color=#1b1baa>$tip</font> <font color=#653760>-command</font> [<b><font color=#3a6797>list</font></b> alited::TipMessage %w %t] <font color=#653760>-per10</font> 0 {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$opts</font>
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> msg [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$msg</font> 0 end-1]
      <b><font color=#3a6797>set</font></b> msec 10
    }
    <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>after</font></b> cancel <font color=#1b1baa>$al(afterID)</font>}
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$msec</font>&gt;0} {
      <b><font color=#3a6797>set</font></b> al(afterID) [<b><font color=#3a6797>after</font></b> <font color=#1b1baa>$msec</font> [<b><font color=#3a6797>list</font></b> ::alited::Message <font color=#1b1baa>$msg</font> <font color=#1b1baa>$mode</font> <font color=#1b1baa>$lab</font> no]]
    }
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=MessageNotDisturb></a>
  <b><font color=#ca14ca>proc</font></b> MessageNotDisturb {} {
    <i><font color=#4b5d50># Show &quot;Don't disturb&quot; message.</font></i>

    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>lassign</font></b> [alited::complete::TextCursorCoordinates] X Y
    <b><font color=#3a6797>set</font></b> msg <font color=#8b2a0e>&quot;Working...\nDon't disturb.&quot;</font>
    Message <font color=#1b1baa>$msg</font> 3
    ::baltip::showBalloon <font color=#1b1baa>$msg</font> \
      <font color=#653760>-geometry</font> <font color=#8b2a0e>&quot;+<font color=#1b1baa>$</font>X+<font color=#1b1baa>$</font>Y&quot;</font> <font color=#653760>-fg</font> <font color=#1b1baa>$al(MOVEFG)</font> <font color=#653760>-bg</font> <font color=#1b1baa>$al(MOVEBG)</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=Balloon></a>
  <b><font color=#ca14ca>proc</font></b> Balloon {msg {red no} {timo 100} args} {
    <i><font color=#4b5d50># Displays a message in a balloon window.</font></i>
    <i><font color=#4b5d50>#   msg - message</font></i>
    <i><font color=#4b5d50>#   red - yes for red background</font></i>
    <i><font color=#4b5d50>#   timo - millisec. before showing the message</font></i>
    <i><font color=#4b5d50>#   args - options of baltip::tip</font></i>

    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>variable</font></b> obPav
    <b><font color=#3a6797>set</font></b> cs [<font color=#1b1baa>$obPav</font> csGet]
    <b><font color=#3a6797>set</font></b> fg [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$cs</font> 14]  ;<i><font color=#4b5d50># colors of tips</font></i>
    <b><font color=#3a6797>set</font></b> bg [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$cs</font> 15]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$red</font>} {<b><font color=#3a6797>set</font></b> fg #6e0000}
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#3a6797>split</font></b> [<b><font color=#134070>winfo</font></b> geometry <font color=#1b1baa>$al(WIN)</font>] x+] w h x y
    <b><font color=#3a6797>set</font></b> geo <font color=#8b2a0e>&quot;+(<font color=#1b1baa>[</font>expr <font color=#1b1baa>{$</font>w+<font color=#1b1baa>$</font>x<font color=#1b1baa>}]</font>-W)+<font color=#1b1baa>$</font>y-60&quot;</font>
    <b><font color=#3a6797>set</font></b> msg [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> \n <font color=#8b2a0e>&quot;  \n  &quot;</font>] <font color=#1b1baa>$msg</font>]
    ::baltip clear <font color=#1b1baa>$al(WIN)</font>
    <b><font color=#3a6797>after</font></b> <font color=#1b1baa>$timo</font> [<b><font color=#3a6797>list</font></b> ::baltip tip <font color=#1b1baa>$al(WIN)</font> <font color=#1b1baa>$msg</font> <font color=#653760>-fg</font> <font color=#1b1baa>$fg</font> <font color=#653760>-bg</font> <font color=#1b1baa>$bg</font> <font color=#653760>-alpha</font> 0.9 \
        <font color=#653760>-font</font> {<font color=#653760>-weight</font> bold <font color=#653760>-size</font> 11} <font color=#653760>-pause</font> 1000 <font color=#653760>-fade</font> 1000 \
        <font color=#653760>-geometry</font> <font color=#1b1baa>$geo</font> <font color=#653760>-bell</font> <font color=#1b1baa>$red</font> <font color=#653760>-on</font> yes <font color=#653760>-relief</font> groove {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>]
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=Balloon1></a>
  <b><font color=#ca14ca>proc</font></b> Balloon1 {fname} {
    <i><font color=#4b5d50># Shows a balloon about non-existing file.</font></i>
    <i><font color=#4b5d50>#   fname - file's name</font></i>

    <b><font color=#3a6797>variable</font></b> al
    Balloon [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %f <font color=#1b1baa>$fname</font>] <font color=#1b1baa>$al(MC,filenoexist)</font>]
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=IsTipable></a>
  <b><font color=#ca14ca>proc</font></b> IsTipable {} {
    <i><font color=#4b5d50># Checks if a tip on the tree/favorites can be shown.</font></i>

    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> foc [<b><font color=#134070>focus</font></b>]] eq {} || [<b><font color=#3a6797>string</font></b> match *tearoff* <font color=#1b1baa>$foc</font>]} {
      <b><font color=#ca14ca>return</font></b> no  ;<i><font color=#4b5d50># no tips while focusing on a tearoff menu</font></i>
    }
    <b><font color=#3a6797>if</font></b> {[<b><font color=#134070>winfo</font></b> toplevel <font color=#1b1baa>$foc</font>] ne <font color=#1b1baa>$al(WIN)</font>} {
      <b><font color=#ca14ca>return</font></b> no  ;<i><font color=#4b5d50># no tips while focusing on a toplevel other than alited's main</font></i>
    }
    <b><font color=#ca14ca>return</font></b> yes
  }
<a id=Helps></a>
  <i><font color=#4b5d50>## ________________________ Helps _________________________ ##</font></i>
<a id=HelpAbout></a>
  <b><font color=#ca14ca>proc</font></b> HelpAbout {} {
    <i><font color=#4b5d50># Shows &quot;About...&quot; dialogue.</font></i>

    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> commands about::About] eq {}} {
      <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::SRCDIR</font> about.tcl]
    }
    about::About
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=HelpAlited></a>
  <b><font color=#ca14ca>proc</font></b> HelpAlited {{ilink <font color=#8b2a0e>&quot;&quot;</font>}} {
    <i><font color=#4b5d50># Shows a main help of alited.</font></i>
    <i><font color=#4b5d50>#   ilink - internal link</font></i>

    ::apave::openDoc file://[<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::DIR</font> doc index.html]<font color=#1b1baa>$ilink</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=HelpFile></a>
  <b><font color=#ca14ca>proc</font></b> HelpFile {win fname args} {
    <i><font color=#4b5d50># Reads and shows a help file.</font></i>
    <i><font color=#4b5d50>#   win - currently active window</font></i>
    <i><font color=#4b5d50>#   fname - the file's name</font></i>
    <i><font color=#4b5d50>#   args - option of msg</font></i>

    <b><font color=#3a6797>variable</font></b> obDlg
    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>if</font></b> {[HelpOnce 1 <font color=#1b1baa>$fname</font>]} <b><font color=#ca14ca>return</font></b>
    <b><font color=#3a6797>lassign</font></b> [::apave::extractOptions args <font color=#653760>-ale1Help</font> no <font color=#653760>-ontop</font> 0] ale1Help ontop
    <b><font color=#3a6797>set</font></b> tags [MessageTags]
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>file</font></b> exists <font color=#1b1baa>$fname</font>]} {
      <b><font color=#3a6797>set</font></b> msg [::apave::readTextFile <font color=#1b1baa>$fname</font>]
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> msg <font color=#8b2a0e>&quot;Here should be a text of\n\&quot;<font color=#1b1baa>$</font>fname\&quot;&quot;</font>
    }
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$::alited::DEBUG</font>} {<b><font color=#3a6797>puts</font></b> <font color=#8b2a0e>&quot;help file: <font color=#1b1baa>$</font>fname&quot;</font>}
    <b><font color=#3a6797>set</font></b> wmax 1
    <b><font color=#3a6797>foreach</font></b> ln [<b><font color=#3a6797>split</font></b> <font color=#1b1baa>$msg</font> \n] {
      <b><font color=#3a6797>set</font></b> oc 0
      <b><font color=#3a6797>foreach</font></b> tag {r b link} {
        <b><font color=#3a6797>foreach</font></b> yn {{} /} {
          <b><font color=#3a6797>set</font></b> ln2 <font color=#1b1baa>$ln</font>
          <b><font color=#3a6797>set</font></b> t &lt;<font color=#1b1baa>$yn$tag</font>&gt;
          <b><font color=#3a6797>set</font></b> ln [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$t</font> {}] <font color=#1b1baa>$ln</font>]
          <b><font color=#3a6797>incr</font></b> oc [<b><font color=#3a6797>expr</font></b> {([<b><font color=#3a6797>string</font></b> length <font color=#1b1baa>$ln2</font>]-[<b><font color=#3a6797>string</font></b> length <font color=#1b1baa>$ln</font>])/([<b><font color=#3a6797>string</font></b> length <font color=#1b1baa>$t</font>]+1)}]
        }
      }
      <b><font color=#3a6797>set</font></b> wmax [<b><font color=#3a6797>expr</font></b> {max(<font color=#1b1baa>$wmax</font>,[<b><font color=#3a6797>string</font></b> length <font color=#1b1baa>$ln</font>]+<font color=#1b1baa>$oc</font>)}]
    }
    <b><font color=#3a6797>set</font></b> pobj <font color=#1b1baa>$obDlg</font>
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> commands <font color=#1b1baa>$pobj</font>] eq {}} {
      <i><font color=#4b5d50># at first start, there are no apave objects bound to the main window of alited</font></i>
      <i><font color=#4b5d50># -&gt; create an independent one to be deleted afterwards</font></i>
      <b><font color=#3a6797>set</font></b> pobj alitedHelpObjToDel
      <b><font color=#3a6797>catch</font></b> {::apave::APave create <font color=#1b1baa>$pobj</font>}
    }
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>llength</font></b> [<b><font color=#3a6797>split</font></b> <font color=#1b1baa>$msg</font> \n]]&gt;30} {
      <b><font color=#3a6797>set</font></b> args [<b><font color=#3a6797>linsert</font></b> <font color=#1b1baa>$args</font> 0 <font color=#653760>-h</font> 30 <font color=#653760>-scroll</font> 1]
    }
    <b><font color=#3a6797>after</font></b> 200 [<b><font color=#3a6797>list</font></b> alited::HelpOnce 0 <font color=#1b1baa>$fname</font>]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$ale1Help</font> && [<b><font color=#3a6797>set</font></b> dlg [<font color=#1b1baa>$pobj</font> dlgPath]] ne <font color=#1b1baa>$al(WIN)</font>} {
      <b><font color=#134070>destroy</font></b> <font color=#1b1baa>$dlg</font>  ;<i><font color=#4b5d50># -ale1Help option permits the only Help window</font></i>
    }
    <b><font color=#3a6797>set</font></b> res [<font color=#1b1baa>$pobj</font> ok {} Help <font color=#8b2a0e>&quot;\n<font color=#1b1baa>$</font>msg\n&quot;</font> <font color=#653760>-modal</font> no <font color=#653760>-waitvar</font> no \
      <font color=#653760>-onclose</font> <font color=#8b2a0e>&quot;alited::destroyWindow %w <font color=#1b1baa>[</font>focus<font color=#1b1baa>]</font>&quot;</font> <font color=#653760>-centerme</font> <font color=#1b1baa>$win</font> <font color=#653760>-text</font> 1 <font color=#653760>-scroll</font> no \
      {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$tags</font> <font color=#653760>-ontop</font> <font color=#1b1baa>$ontop</font> <font color=#653760>-w</font> [<b><font color=#3a6797>incr</font></b> wmax] {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>]
    <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$res</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=HelpOnce></a>
  <b><font color=#ca14ca>proc</font></b> HelpOnce {mode fname} {
    <i><font color=#4b5d50># Handles &quot;Help&quot; window to have the only instance of it.</font></i>
    <i><font color=#4b5d50>#   mode - 1 to check for existance the help; 0 to register it</font></i>
    <i><font color=#4b5d50>#   fname - file of help</font></i>

    <b><font color=#3a6797>variable</font></b> al2
    <b><font color=#3a6797>variable</font></b> obDlg
    <b><font color=#3a6797>set</font></b> key _help_<font color=#1b1baa>$fname</font>
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$mode</font>} {
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> exists al2(<font color=#1b1baa>$key</font>)] && [<b><font color=#134070>winfo</font></b> exists <font color=#1b1baa>$al2($key)</font>]} {
        ::apave::deiconify <font color=#1b1baa>$al2($key)</font>
        <b><font color=#ca14ca>return</font></b> 1
      }
      <b><font color=#ca14ca>return</font></b> 0
    }
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> al2(<font color=#1b1baa>$key</font>) [<font color=#1b1baa>$obDlg</font> dlgPath]}]} {<b><font color=#3a6797>set</font></b> al2(<font color=#1b1baa>$key</font>) 0}
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=HelpFname></a>
  <b><font color=#ca14ca>proc</font></b> HelpFname {win {suff <font color=#8b2a0e>&quot;&quot;</font>}} {
    <i><font color=#4b5d50># Gets a help file's name.</font></i>
    <i><font color=#4b5d50>#   win - currently active window</font></i>
    <i><font color=#4b5d50>#   suff - suffix for a help file's name</font></i>

    <b><font color=#3a6797>variable</font></b> DATADIR
    <b><font color=#3a6797>set</font></b> fname [<b><font color=#3a6797>lindex</font></b> [<b><font color=#3a6797>split</font></b> [<b><font color=#3a6797>dict</font></b> get [<b><font color=#3a6797>info</font></b> frame -2] proc] :] end-2]
    <b><font color=#3a6797>set</font></b> fname [<b><font color=#3a6797>file</font></b> join [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$DATADIR</font> help] <font color=#1b1baa>$fname$suff</font>.txt]
    <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$fname</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=HelpMe></a>
  <b><font color=#ca14ca>proc</font></b> HelpMe {win {suff <font color=#8b2a0e>&quot;&quot;</font>}} {
    <i><font color=#4b5d50># Shows a help file for a procedure with &quot;Don't show again&quot; checkbox.</font></i>
    <i><font color=#4b5d50>#   win - currently active window</font></i>
    <i><font color=#4b5d50>#   suff - suffix for a help file's name</font></i>

    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>lsearch</font></b> <font color=#653760>-exact</font> <font color=#1b1baa>$al(HelpedMe)</font> <font color=#1b1baa>$win</font>]&gt;-1} <b><font color=#ca14ca>return</font></b>
    <b><font color=#3a6797>set</font></b> ans [HelpFile <font color=#1b1baa>$win</font> [HelpFname <font color=#1b1baa>$win</font> <font color=#1b1baa>$suff</font>] <font color=#653760>-ch</font> <font color=#1b1baa>$al(MC,noask)</font>]
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$ans</font> 0]==11} {
      <b><font color=#3a6797>lappend</font></b> al(HelpedMe) <font color=#1b1baa>$win</font>
    }
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=Help></a>
  <b><font color=#ca14ca>proc</font></b> Help {win {suff <font color=#8b2a0e>&quot;&quot;</font>} args} {
    <i><font color=#4b5d50># Shows a help file for a procedure.</font></i>
    <i><font color=#4b5d50>#   win - currently active window</font></i>
    <i><font color=#4b5d50>#   suff - suffix for a help file's name</font></i>
    <i><font color=#4b5d50>#   args - options of HelpFile</font></i>

    HelpFile <font color=#1b1baa>$win</font> [HelpFname <font color=#1b1baa>$win</font> <font color=#1b1baa>$suff</font>] {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=destroyWindow></a>
  <b><font color=#ca14ca>proc</font></b> destroyWindow {win foc args} {
    <i><font color=#4b5d50># Destroys current window and focuses on previously focused widget.</font></i>
    <i><font color=#4b5d50>#   win - current window passed as %w</font></i>
    <i><font color=#4b5d50>#   foc - previously focused widget</font></i>

    <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>destroy</font></b> <font color=#1b1baa>$win</font>}
    <b><font color=#3a6797>catch</font></b> {
      <b><font color=#3a6797>after</font></b> idle <font color=#8b2a0e>&quot;after 100 <font color=#1b1baa>{</font>::apave::FocusByForce <font color=#1b1baa>$</font>foc<font color=#1b1baa>}</font>&quot;</font>
    }
  }
<a id=Runs_&_exits></a>
  <i><font color=#4b5d50>## ________________________ Runs & exits _________________________ ##</font></i>
<a id=SaveRunOptions></a>
  <b><font color=#ca14ca>proc</font></b> SaveRunOptions {} {
    <i><font color=#4b5d50># Saves options of &quot;Run...&quot; dialogue.</font></i>

    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>set</font></b> al(_SavedRunOptions_) [<b><font color=#3a6797>list</font></b> \
      <font color=#1b1baa>$al(prjincons)</font> <font color=#1b1baa>$al(comForce)</font> <font color=#1b1baa>$al(comForceLs)</font> <font color=#1b1baa>$al(comForceCh)</font> <font color=#1b1baa>$al(prjbeforerun)</font>]
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=RestoreRunOptions></a>
  <b><font color=#ca14ca>proc</font></b> RestoreRunOptions {} {
    <i><font color=#4b5d50># Restores options of &quot;Run...&quot; dialogue.</font></i>

    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$al(_SavedRunOptions_)</font> \
      al(prjincons) al(comForce) al(comForceLs) al(comForceCh) al(prjbeforerun)
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=Source_e_menu></a>
  <b><font color=#ca14ca>proc</font></b> Source_e_menu {} {
    <i><font color=#4b5d50># Sources e_menu.tcl at need.</font></i>

    <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>info</font></b> exists ::em::geometry]} {
      <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::e_menu_dir</font> e_menu.tcl]
    }
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=ExtTrans></a>
  <b><font color=#ca14ca>proc</font></b> ExtTrans {{fname <font color=#8b2a0e>&quot;&quot;</font>}} {
    <i><font color=#4b5d50># Gets a file's extention and translation attributes (istrans, from, to).</font></i>
    <i><font color=#4b5d50>#   fname - the file name</font></i>

    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$fname</font> eq {}} {<b><font color=#3a6797>set</font></b> fname [bar::FileName]}
    <b><font color=#3a6797>set</font></b> ext [<b><font color=#3a6797>string</font></b> trimleft [<b><font color=#3a6797>file</font></b> extension <font color=#1b1baa>$fname</font>] .]
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#3a6797>split</font></b> <font color=#1b1baa>$ext</font> -] from to
    <b><font color=#3a6797>set</font></b> ismsg [<b><font color=#3a6797>expr</font></b> {[<b><font color=#3a6797>string</font></b> tolower <font color=#1b1baa>$ext</font>] eq {msg}}]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$ismsg</font>} {
      <b><font color=#3a6797>set</font></b> from en  ;<i><font color=#4b5d50># e.g. ru.msg is from English to Russian</font></i>
      <b><font color=#3a6797>set</font></b> to [<b><font color=#3a6797>file</font></b> rootname [<b><font color=#3a6797>file</font></b> tail <font color=#1b1baa>$fname</font>]]
    }
    <b><font color=#3a6797>set</font></b> istrans [<b><font color=#3a6797>regexp</font></b> {^[[:alpha:]][[:alpha:]]-[[:alpha:]][[:alpha:]]$} <font color=#1b1baa>$ext</font>]
    <b><font color=#3a6797>set</font></b> istrans [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$istrans</font> || <font color=#1b1baa>$ismsg</font>}]
    <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$ext</font> <font color=#1b1baa>$istrans</font> <font color=#1b1baa>$from</font> <font color=#1b1baa>$to</font>]
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=HighlightAddon></a>
  <b><font color=#ca14ca>proc</font></b> HighlightAddon {wtxt fname colors} {
    <i><font color=#4b5d50># Tries to highlight add-on extensions.</font></i>
    <i><font color=#4b5d50>#   wtxt - text's path</font></i>
    <i><font color=#4b5d50>#   fname - current file's name</font></i>
    <i><font color=#4b5d50>#   colors - colors of highlighting</font></i>

    <b><font color=#3a6797>namespace</font></b> upvar ::alited al al LIBDIR LIBDIR
    <b><font color=#3a6797>set</font></b> res {}
    <b><font color=#3a6797>lassign</font></b> [ExtTrans <font color=#1b1baa>$fname</font>] ext istrans
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$ext</font> ne {}} {
      <b><font color=#3a6797>catch</font></b> {
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$istrans</font>} {
          <i><font color=#4b5d50># it's a file to translate from language to language</font></i>
          <b><font color=#3a6797>set</font></b> ext trans
          HelpMe <font color=#1b1baa>$ext</font> <font color=#653760>-trans</font>
          <b><font color=#3a6797>after</font></b> idle alited::main::FocusText
        }
        <b><font color=#3a6797>switch</font></b> <font color=#1b1baa>$ext</font> {
          htm - ui - tpl1 {<b><font color=#3a6797>set</font></b> ext html}
          ale - conf {<b><font color=#3a6797>set</font></b> ext ini}
        }
        <b><font color=#3a6797>set</font></b> addon hl_<font color=#1b1baa>$ext</font>
        <b><font color=#3a6797>lassign</font></b> [<b><font color=#3a6797>glob</font></b> <font color=#653760>-nocomplain</font> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$LIBDIR</font> addon <font color=#1b1baa>$addon</font>.tcl]] fhl
        <b><font color=#3a6797>set</font></b> addon [<b><font color=#3a6797>file</font></b> rootname [<b><font color=#3a6797>file</font></b> tail <font color=#1b1baa>$fhl</font>]]
        <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>namespace</font></b> exists ::alited::<font color=#1b1baa>$addon</font>]} {
          <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>source</font></b> <font color=#1b1baa>$fhl</font>} err]} {
            alited::Message <font color=#1b1baa>$err</font> 4
            <b><font color=#ca14ca>return</font></b> {}
          }
        }
        <b><font color=#3a6797>lappend</font></b> colors [FgFgBold]
        <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>dict</font></b> exists <font color=#1b1baa>$al(FONT,txt)</font> <font color=#653760>-size</font>]} {
          <b><font color=#3a6797>set</font></b> fsz [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$al(FONT,txt)</font> <font color=#653760>-size</font>]
        } <b><font color=#3a6797>else</font></b> {
          <b><font color=#3a6797>set</font></b> fsz <font color=#1b1baa>$al(FONTSIZE,std)</font>
        }
        <b><font color=#3a6797>set</font></b> res [<font color=#1b1baa>${addon}</font>::init <font color=#1b1baa>$wtxt</font> <font color=#1b1baa>$al(FONT,txt)</font> <font color=#1b1baa>$fsz</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$colors</font>]
        ::apave::obj set_highlight_matches <font color=#1b1baa>$wtxt</font>
        <b><font color=#3a6797>foreach</font></b> tag {sel hilited hilited2} {<b><font color=#3a6797>after</font></b> idle <font color=#1b1baa>$wtxt</font> tag raise <font color=#1b1baa>$tag</font>}
      }
    }
    <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$res</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=Hl_Colors></a>
  <b><font color=#ca14ca>proc</font></b> Hl_Colors {} {
    <i><font color=#4b5d50># Gets highlighting colors.</font></i>

    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>foreach</font></b> nam [::hl_tcl::hl_colorNames] {<b><font color=#3a6797>lappend</font></b> colors <font color=#1b1baa>$al(ED,$nam)</font>}
    <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$colors</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=Tclexe></a>
  <b><font color=#ca14ca>proc</font></b> Tclexe {} {
    <i><font color=#4b5d50># Gets Tcl's executable file.</font></i>

    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$al(EM,Tcl)</font> eq {}} {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$al(IsWindows)</font>} {
        <i><font color=#4b5d50># important: refer to tclsh (not wish), to run it in Windows console</font></i>
        <i><font color=#4b5d50># though not good for deployed Tcl/Tk 8.6-</font></i>
        <b><font color=#3a6797>set</font></b> tclexe [::apave::autoexec tclsh .exe]
      } <b><font color=#3a6797>else</font></b> {
        <b><font color=#3a6797>set</font></b> tclexe [<b><font color=#3a6797>info</font></b> nameofexecutable]
      }
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> tclexe <font color=#1b1baa>$al(EM,Tcl)</font>
    }
    <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$tclexe</font>
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=Run></a>
  <b><font color=#ca14ca>proc</font></b> Run {args} {
    <i><font color=#4b5d50># Runs Tcl/Tk script.</font></i>
    <i><font color=#4b5d50>#   args - script's name and arguments</font></i>

    <b><font color=#3a6797>set</font></b> com [<b><font color=#3a6797>string</font></b> trimright <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>args&quot;</font> &]
    <b><font color=#3a6797>if</font></b> {{TEST_ALITED} in <font color=#1b1baa>$args</font>} {
      <b><font color=#3a6797>set</font></b> com [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> { TEST_ALITED} {}] <font color=#1b1baa>$com</font>]
      <b><font color=#3a6797>puts</font></b> [Tclexe]\ <font color=#1b1baa>$com</font>
    }
    <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>pid</font></b> [<b><font color=#3a6797>open</font></b> |[<b><font color=#3a6797>list</font></b> [Tclexe] {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$com</font>]]]
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=Runtime></a>
  <b><font color=#ca14ca>proc</font></b> Runtime {args} {
    <i><font color=#4b5d50># Runs Tcl/Tk script by alited's Tcl/Tk runtime.</font></i>
    <i><font color=#4b5d50>#   args - script's name and arguments</font></i>

    <b><font color=#3a6797>exec</font></b> -- [<b><font color=#3a6797>info</font></b> nameofexecutable] {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font> &
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=CloseDlg></a>
  <b><font color=#ca14ca>proc</font></b> CloseDlg {} {
    <i><font color=#4b5d50># Tries to close a Help dialogue, open non-modal aside by the current dialogue.</font></i>

    <b><font color=#3a6797>variable</font></b> obDlg
    <b><font color=#3a6797>catch</font></b> {[<font color=#1b1baa>$obDlg</font> ButOK] invoke}
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=ScriptSource></a>
  <b><font color=#ca14ca>proc</font></b> ScriptSource {script} {
    <i><font color=#4b5d50># Sources script.tcl (at need).</font></i>
    <i><font color=#4b5d50>#   script - the script name</font></i>

    <b><font color=#3a6797>variable</font></b> SRCDIR
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> commands ::alited::<font color=#1b1baa>${script}</font>::_run] eq {}} {
      <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> <font color=#1b1baa>$script</font>.tcl]
    }
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=CheckSource></a>
  <b><font color=#ca14ca>proc</font></b> CheckSource {} {
    <i><font color=#4b5d50># Sources check.tcl (at need).</font></i>

    ScriptSource check
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=CheckRun></a>
  <b><font color=#ca14ca>proc</font></b> CheckRun {} {
    <i><font color=#4b5d50># Runs &quot;Check Tcl&quot;.</font></i>

    CheckSource
    check::_run
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=PrinterRun></a>
  <b><font color=#ca14ca>proc</font></b> PrinterRun {} {
    <i><font color=#4b5d50># Runs &quot;Project Printer&quot;.</font></i>

    ScriptSource printer
    printer::_run
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=Exit></a>
  <b><font color=#ca14ca>proc</font></b> Exit {{w <font color=#8b2a0e>&quot;&quot;</font>} {res 0} {ask yes}} {
    <i><font color=#4b5d50># Closes alited application.</font></i>
    <i><font color=#4b5d50>#   w - not used</font></i>
    <i><font color=#4b5d50>#   res - result of running of main window</font></i>
    <i><font color=#4b5d50>#   ask - if &quot;yes&quot;, requests the confirmation of the exit</font></i>

    <b><font color=#3a6797>variable</font></b> al
    <b><font color=#3a6797>variable</font></b> obPav
    <b><font color=#3a6797>set</font></b> al(INI,isfindrepl) [<b><font color=#3a6797>expr</font></b> {[<b><font color=#134070>winfo</font></b> exist <font color=#1b1baa>$al(WIN)</font>.winFind]}]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$al(INI,confirmexit)</font>&gt;1} {
      <b><font color=#3a6797>set</font></b> timo <font color=#8b2a0e>&quot;-timeout <font color=#1b1baa>{$</font>al(INI,confirmexit) ButOK<font color=#1b1baa>}</font>&quot;</font>
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> timo {}
    }
    <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$ask</font> || !<font color=#1b1baa>$al(INI,confirmexit)</font> || \
    [msg okcancel info [msgcat::mc {Quitting alited.}] OK {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$timo</font>]} {
      <b><font color=#3a6797>if</font></b> {[file::AllSaved]} {
        alited::menu::SaveCascadeMenuGeo
        <b><font color=#3a6797>catch</font></b> {find::CloseFind}  ;<i><font color=#4b5d50># save Find/Replace geometry</font></i>
        <b><font color=#3a6797>catch</font></b> {ini::SaveIni}     ;<i><font color=#4b5d50># save alited's settings</font></i>
        tool::_close                     ;<i><font color=#4b5d50># close all of the</font></i>
        <b><font color=#3a6797>catch</font></b> {run::Cancel}              ;<i><font color=#4b5d50># possibly open</font></i>
        <b><font color=#3a6797>catch</font></b> {check::Cancel}            ;<i><font color=#4b5d50># non-modal</font></i>
        <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>destroy</font></b> <font color=#1b1baa>$::alited::find::win2</font>}    ;<i><font color=#4b5d50># windows</font></i>
        <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>destroy</font></b> <font color=#1b1baa>$::alited::al(FN2WINDOW)</font>} ;<i><font color=#4b5d50># and its possible children</font></i>
        <b><font color=#3a6797>catch</font></b> {paver::Destroy}
        <font color=#1b1baa>$obPav</font> res <font color=#1b1baa>$al(WIN)</font> <font color=#1b1baa>$res</font>
        ::apave::endWM
      }
    }
  }
<a id=Sources_in_alited::></a>
  <i><font color=#4b5d50>## _______________________ Sources in alited:: _______________________ ##</font></i>

  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> ini.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> img.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> msgs.tcl]
  msgcatMessages
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> main.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> bar.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> file.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> unit.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> tree.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> favor.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> favor_ls.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> find.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> keys.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> info.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> tool.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> menu.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> pref.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> project.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> complete.tcl]
  <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$SRCDIR</font> edit.tcl]
<a id=EONS_alited></a>
  <i><font color=#4b5d50>## _ EONS alited _ ##</font></i>

}
<a id=Run_the_app></a>
<i><font color=#4b5d50># _________________________ Run the app _________________________ #</font></i>

<b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$::alited::LOG</font> ne {}} {
  ::apave::logName <font color=#1b1baa>$::alited::LOG</font>
  ::apave::logMessage <font color=#8b2a0e>&quot;START ------------&quot;</font>
}

<i><font color=#4b5d50># The following &quot;if&quot; counts on the Ruff! doc generator:</font></i>
<i><font color=#4b5d50>#   - Ruff! uses &quot;package require&quot; for a documented package (&quot;alited&quot;, e.g.)</font></i>
<i><font color=#4b5d50>#   - alited should not be run when Ruff! sources it</font></i>
<i><font color=#4b5d50>#   - so, without 'package require alited', it's a regular run of alited</font></i>

<b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> exists ALITED_PORT]} {
  <b><font color=#3a6797>unset</font></b> <font color=#653760>-nocomplain</font> ALITED_PORT
<i><font color=#4b5d50>#  source [::apave::HomeDir]/PG/github/DEMO/alited/demo.tcl ;#! for demo: COMMENT OUT</font></i>
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$ALITED_ARGV</font>]} {
    <b><font color=#3a6797>set</font></b> ::argc 0
    <b><font color=#3a6797>set</font></b> ::argv {}
    <b><font color=#3a6797>after</font></b> 10 [<b><font color=#3a6797>list</font></b> ::alited::open_files_and_raise 0 {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$ALITED_ARGV</font>]
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$::alited::DEBUG</font>} {
    alited::ini::_init
  } <b><font color=#3a6797>elseif</font></b> {[<b><font color=#3a6797>catch</font></b> {alited::ini::_init} _]} {
    <i><font color=#4b5d50># initialize GUI & data:</font></i>
    <i><font color=#4b5d50># let a possible error of ini-file be shown, with attempt to continue</font></i>
    <b><font color=#3a6797>puts</font></b> \n<font color=#1b1baa>$::errorInfo</font>\n
    alited::ini::GetUserDirs
    <b><font color=#134070>tk_messageBox</font></b> <font color=#653760>-title</font> alited <font color=#653760>-icon</font> error <font color=#653760>-message</font> \
      <font color=#8b2a0e>&quot;Error of reading of alited's settings: \</font>
<font color=#8b2a0e>      \n<font color=#1b1baa>$</font>_\n\nProbable reason in the file:\n<font color=#1b1baa>$</font>::alited::al(INI) \</font>
<font color=#8b2a0e>      \n\nTry to rename/move it or take it from alited's source. \</font>
<font color=#8b2a0e>      \nThen restart alited.\n\nDetails are in stdout.&quot;</font>
  }
  alited::main::_create  ;<i><font color=#4b5d50># create the main form</font></i>
  alited::favor::_init   ;<i><font color=#4b5d50># initialize favorites</font></i>
  alited::tool::AfterStart
  <b><font color=#3a6797>unset</font></b> <font color=#653760>-nocomplain</font> _
  <b><font color=#3a6797>unset</font></b> <font color=#653760>-nocomplain</font> ALITED_ARGV
<i><font color=#4b5d50>#  source [::apave::HomeDir]/PG/github/DEMO/alited/demo.tcl ;#! for demo: COMMENT OUT</font></i>
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> res [alited::main::_run]} err]} {
    <b><font color=#3a6797>set</font></b> res 0
    <b><font color=#3a6797>set</font></b> msg <font color=#8b2a0e>&quot;\nERROR in alited:&quot;</font>
    <b><font color=#3a6797>puts</font></b> \n<font color=#1b1baa>$msg</font>\n\n<font color=#1b1baa>$::errorInfo</font>\n
    <b><font color=#3a6797>set</font></b> msg <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>msg\n\n<font color=#1b1baa>$</font>err\n\nPlease, inform authors.\nDetails are in stdout.&quot;</font>
    <b><font color=#134070>tk_messageBox</font></b> <font color=#653760>-title</font> alited <font color=#653760>-icon</font> error <font color=#653760>-message</font> <font color=#1b1baa>$msg</font>
  }
  <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>destroy</font></b> <font color=#1b1baa>$al(WIN)</font>}
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$res</font>} {     ;<i><font color=#4b5d50># run the main form</font></i>
    <i><font color=#4b5d50># restarting</font></i>
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>file</font></b> tail [<b><font color=#3a6797>file</font></b> dirname <font color=#1b1baa>$::alited::DIR</font>]] eq {alited.kit}} {
      <b><font color=#3a6797>set</font></b> ::alited::DIR [<b><font color=#3a6797>file</font></b> dirname [<b><font color=#3a6797>file</font></b> dirname <font color=#1b1baa>$::alited::DIR</font>]]
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> ::alited::SCRIPT <font color=#1b1baa>$::alited::SCRIPTNORMAL</font>
    }
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$::alited::LOG</font> ne {}} {
      ::apave::logMessage <font color=#8b2a0e>&quot;QUIT :: <font color=#1b1baa>$</font>::alited::DIR :: <font color=#1b1baa>$</font>::alited::SCRIPT PORT <font color=#1b1baa>$</font>::alited::ARGV&quot;</font>
    }
    <b><font color=#3a6797>cd</font></b> <font color=#1b1baa>$::alited::DIR</font>
    <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$::alited::ARGV</font>]} {<font color=#1b1baa>$i</font>} {} {
      <b><font color=#3a6797>incr</font></b> i -1
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>file</font></b> isfile [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$::alited::ARGV</font> <font color=#1b1baa>$i</font>]]} {  ;<i><font color=#4b5d50># remove file names passed to ALE</font></i>
        <b><font color=#3a6797>set</font></b> ::alited::ARGV [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$::alited::ARGV</font> <font color=#1b1baa>$i</font> <font color=#1b1baa>$i</font>]
      }
    }
    <b><font color=#3a6797>exec</font></b> -- [<b><font color=#3a6797>info</font></b> nameofexecutable] <font color=#1b1baa>$::alited::SCRIPT</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$::alited::ARGV</font> &
  } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$::alited::LOG</font> ne {}} {
    ::apave::logMessage {QUIT ------------}
  }
  <b><font color=#3a6797>exit</font></b> <font color=#1b1baa>$res</font>
} <b><font color=#3a6797>else</font></b> {
  <i><font color=#4b5d50># these scripts are sourced at need, here are listed:</font></i>
  <i><font color=#4b5d50>#  - for including them in Ruff!'s generated docs</font></i>
  <i><font color=#4b5d50>#  - as a useful info</font></i>
  <b><font color=#ca14ca>namespace</font></b> eval alited {
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::SRCDIR</font> about.tcl]
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::SRCDIR</font> check.tcl]
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::SRCDIR</font> indent.tcl]
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::SRCDIR</font> run.tcl]
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::SRCDIR</font> paver.tcl]
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::SRCDIR</font> preview.tcl]
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::SRCDIR</font> unit_tpl.tcl]
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::SRCDIR</font> format.tcl]
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::SRCDIR</font> printer.tcl]
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::LIBDIR</font> addon hl_md.tcl]
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::LIBDIR</font> addon hl_html.tcl]
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::LIBDIR</font> addon hl_em.tcl]
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::LIBDIR</font> addon hl_alm.tcl]
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::LIBDIR</font> addon hl_ini.tcl]
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::LIBDIR</font> addon hl_wiki.tcl]
    <b><font color=#3a6797>source</font></b> [<b><font color=#3a6797>file</font></b> join <font color=#1b1baa>$::alited::LIBDIR</font> addon hl_trans.tcl]
  }
}<a id=EOF></a>
<i><font color=#4b5d50># _________________________________ EOF _________________________________ #</font></i>

</pre>

<table border=0 cellPadding=4 cellSpacing=0 width=100%>  <td border=0 bgColor=#87bcd3><div style=text-align:center>  <a href="../../index.html"><font color=#1a1a1a size=6>  <b>alited.tcl</b></font></div></td></table>

</section>
<script>
  writeFooter('Document generated by <a href="'+homeLINK()+'/en/tcl/alited/index.html">alited</a> &amp; <a href="'+homeLINK()+'/en/tcl/mulster/index.html">mulster</a></a>');
</script>
</div>
</body>
</html>