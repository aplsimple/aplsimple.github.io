<!DOCTYPE html><html><head><meta charset="utf-8"/>
<meta name="author" content="aplsimple">
<meta name="description" content="aplsimple's home page">
<meta name="keywords" content="aplsimple,home">
</head>
<style>
table{
background-color: #f9f9f9;
margin: 0%;
margin-bottom: 2%;
padding: 0%;
box-shadow: none;
filter: none;
}
pre{
margin: 0%;
margin-bottom: 2%;
padding: 0%;
}
</style>
<script>
function homeLINK() {
  homelink = document.baseURI;
  ilen = 19
  ibase = homelink.indexOf('aplsimple.github');
  if (ibase<0) { ibase = homelink.indexOf('aplsimple_github'); ilen += 10 };
  if (ibase>=0) { homelink = homelink.substring(0,ibase+ilen) };
  return homelink;
};
document.write(' \
<link rel="stylesheet" href="'+homeLINK()+'/en/tcl/printer/zoo/style.css">');
document.write(' \
<link rel="icon" type="image/jpg" href="'+homeLINK()+'/zoo/favicon.jpg">');
document.write('<'+'script src="'+homeLINK()+'/zoo/funcs.js">'+'<'+'/script>');
document.write('<'+'script src="'+homeLINK()+'/en/tcl/printer/zoo/this.js">'+'<'+'/script>');
</script>
<body>
<div id="wrapper">
<div name="divd1" ALIGN="CENTER"> <FONT SIZE=5em color=#b01c20><B>
<noscript>THIS PAGE IS NOT WORKING WITHOUT JAVASCRIPT!
<BR>
<BR>PLEASE, SWITCH ON JAVASCRIPT IN SETTINGS OF YOUR BROWSER AND RELOAD THE PAGE.
</noscript>
</B></FONT></div>
<div id='doc3' class='yui-t2'>
<section id=sec2>
<div id='hd' class='banner'>

<title>bartabs.tcl</title>

<table border=0 cellPadding=4 cellSpacing=0 width=100%>  <td border=0 bgColor=#bdd7e7><div style=text-align:center>  <a href="../../index.html"><font color=#1a1a1a size=6>  <b>README.md</b></font></div></td></table>

<div id="bodyContent" class="dokuwiki">
<div id="dw__toc" class="dw__toc">
<h3 class="toggle open" style="cursor: pointer;">bartabs.tcl</h3>
<div aria-expanded="true" style="">

<ul class="toc">
<li><b><a href="#bartabs.tcl">bartabs.tcl</a></b></li>
<li><b><a href="#NS_bartabs">NS bartabs</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#messageBox">messageBox</a><span class=tooltiptext> messageBox : Runs Tk's or apave's ok/yes/no/cancel dialogue.
type - ok, yesno or yesnocancel
ttl - title
ttl - message
args - additional arguments of tk_messageBox
Returns 1 if 'yes' chosen, 2 if 'no', 0 otherwise.
try the apave package's dialogue</span></div></li></ul>
<li><b><a href="#EONS_bartabs">&nbsp;&nbsp;EONS bartabs</a></b></li>
<li><b><a href="#bartabs_class_hierarchy">bartabs class hierarchy</a></b></li>
<li><b><a href="#Tab">Tab</a></b></li>
<li><b><a href="#Private_methods_of_Tab">&nbsp;&nbsp;Private methods of Tab</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#My">My</a><span class=tooltiptext> My : Creates a caller of method.
ID - ID of caller</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ID">ID</a><span class=tooltiptext> ID : Returns ID of caller.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#IDs">IDs</a><span class=tooltiptext> IDs : Returns a pair of TID and BID.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_Create">Tab_Create</a><span class=tooltiptext> Tab_Create : Creates a tab widget (frame, label, button).
w - parent frame
text - tab's label
Returns a list of created widgets of the tab.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_create">Tab_create</a><span class=tooltiptext> Tab_create : Creates tab method and registers it. Defined by "My".</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_ExpandOption">Tab_ExpandOption</a><span class=tooltiptext> Tab_ExpandOption : Gets a real -expand option, counting that it may be set as a number>1
meaning "starting from this number do expanding, otherwise not"
expand - original value of -expand option</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_cget">Tab_cget</a><span class=tooltiptext> Tab_cget : Gets options of tab.
args - list of options
Returns a list of values or one value if args is one option.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_configure">Tab_configure</a><span class=tooltiptext> Tab_configure : Sets values of options for a tab.
args - list of pairs "option value"</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_DictItem">Tab_DictItem</a><span class=tooltiptext> Tab_DictItem : Gets item data from a tab item (ID + data).
TID - tab ID or the tab item (ID + data).
data - tab's data (list of option-value)
If 'data' omitted, TID is a tab item (ID + data).
If the tab's attribute is absent, it's meant to be "".
Returns a list of values: ID, text, wb, wb1, wb2, pf.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_ItemDict">Tab_ItemDict</a><span class=tooltiptext> Tab_ItemDict : Returns a tab item (ID + data) from item data.
text - tab's text;
wb - tab's frame widget
wb1 - tab's label widget
wb2 - tab's button widget
pf - "p" for tab packed, "" for tab forgotten</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_Data">Tab_Data</a><span class=tooltiptext> Tab_Data : Creates data of new tab.
text - new tab's label
The bar is checked for a duplicate of 'text'.
Returns a tab item or "" (if duplicated).</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_BID">Tab_BID</a><span class=tooltiptext> Tab_BID : Gets BID from TID.
act - if "check", only checks the existance of TID
If 'act' is "check" and a bar not found, -1 is returned, otherwise BID.
Returns a list of 1. BID (or -1 if no bar found) 2. index of the tab in tab list 3. the tab data.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_Bindings">Tab_Bindings</a><span class=tooltiptext> Tab_Bindings : Sets bindings on events of tabs.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_Font">Tab_Font</a><span class=tooltiptext> Tab_Font : Gets a font attributes for tab label.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_MarkAttrs">Tab_MarkAttrs</a><span class=tooltiptext> Tab_MarkAttrs : Gets image & mark attributes of marks.
TID - ID of current tab
withbg - if true, gets also background
wb2 - tab's button
Returns string of attributes if any.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_SelAttrs">Tab_SelAttrs</a><span class=tooltiptext> Tab_SelAttrs : Gets font attributes of selected tab.
fnt - original font attributes
fgsel - foreground for selection
bgsel - background for selection
If both set, fgsel and bgsel mean colors
If bgsel=="", fgsel!="", fgsel is a widget to get attributes
If fgsel=="", 'selection' is 'underlining'</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_MarkBar">Tab_MarkBar</a><span class=tooltiptext> Tab_MarkBar : Marks the tabs of a bar .
TID - ID of the current tab</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_MarkBars">Tab_MarkBars</a><span class=tooltiptext> Tab_MarkBars : Marks the tabs.
BID - bar ID (if omitted, all bars are scanned)
TID - ID of the current tab</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_TextEllipsed">Tab_TextEllipsed</a><span class=tooltiptext> Tab_TextEllipsed : Returns a tab's label and tip.
text - label
lneed - label length anyway</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_Iconic">Tab_Iconic</a><span class=tooltiptext> Tab_Iconic : Gets a flag "tabs with icons".
Returns "yes", if tabs are supplied with icons.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_Pack">Tab_Pack</a><span class=tooltiptext> Tab_Pack : Packs a tab widget.
wb, wb1, wb2 - tab's widgets</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_RemoveLinks">Tab_RemoveLinks</a><span class=tooltiptext> Tab_RemoveLinks : Removes a tab's links to lists.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_Is">Tab_Is</a><span class=tooltiptext> Tab_Is : Checks if 'wb' is an existing tab widget.
wb - path</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_CloseFew">Tab_CloseFew</a><span class=tooltiptext> Tab_CloseFew : Closes tabs of bar.
TID - ID of the current tab or -1 if to close all
left - "yes" if to close all at left of TID, "no" if at right
args - options (if contains -skipsel, selected tabs aren't closed)</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#PrepareCmd">PrepareCmd</a><span class=tooltiptext> PrepareCmd : Prepares a command bound to an action on a tab.
opt - command option (-csel, -cmov, -cdel)
args - additional argumens of the command
The commands can include wildcards: %b for bar ID, %t for tab ID, %l for tab label.
Returns "" or the command if 'opt' exists in 'args'.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_Cmd">Tab_Cmd</a><span class=tooltiptext> Tab_Cmd : Executes a command bound to an action on a tab.
opt - command option (-csel, -cmov, -cdel)
args - additional argumens of the command
The commands can include wildcards: %b for bar ID, %t for tab ID, %l for tab label.
Returns 1, if no command set; otherwise: 1 for Yes, 0 for No, -1 for Cancel.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Tab_BeCurrent">Tab_BeCurrent</a><span class=tooltiptext> Tab_BeCurrent : Makes the tab be currently visible.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Disabled">Disabled</a><span class=tooltiptext> Disabled : Checks if the tab is disabled.</span></div></li></ul>
<li><b><a href="#Event_handlers">&nbsp;&nbsp;Event handlers</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#DestroyMoveWindow">DestroyMoveWindow</a><span class=tooltiptext> DestroyMoveWindow : Destroys the moving window zombi.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#OnEnterTab">OnEnterTab</a><span class=tooltiptext> OnEnterTab : Handles the mouse pointer entering a tab.
wb1, wb2 - tab's widgets
fgo, bgo - colors of "mouse over the tab"</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#OnLeaveTab">OnLeaveTab</a><span class=tooltiptext> OnLeaveTab : Handles the mouse pointer leaving a tab.
wb1, wb2 - tab's widgets</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#OnButtonPress">OnButtonPress</a><span class=tooltiptext> OnButtonPress : Handles the mouse clicking a tab.
wb1 - tab's label
x - x position of the mouse pointer</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#OnButtonMotion">OnButtonMotion</a><span class=tooltiptext> OnButtonMotion : Handles the mouse moving over a tab.
wb - tab's frame
wb1 - tab's label
x, y - positions of the mouse pointer</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#OnButtonRelease">OnButtonRelease</a><span class=tooltiptext> OnButtonRelease : Handles the mouse releasing a tab.
wb1o - original tab's label
x - x position of the mouse pointer</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#OnCtrlClick">OnCtrlClick</a><span class=tooltiptext> OnCtrlClick : Handles a selection of tabs with Ctrl+click.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#OnPopup">OnPopup</a><span class=tooltiptext> OnPopup : Handles the mouse right-clicking on a tab.
X, Y - positions of the mouse pointer</span></div></li></ul>
<li><b><a href="#Public_methods_of_Tab">&nbsp;&nbsp;Public methods of Tab</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#show">show</a><span class=tooltiptext> show : Shows a tab in a bar and sets it current.
refill - if "yes", update the bar
lifo - if "yes", allows moving a tab to 0th position
When refill=no and lifo=no, just shows a tab in its current position.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#close">close</a><span class=tooltiptext> close : Closes a tab and updates the bar.
redraw - if "yes", update the bar and select the new tab
args - additional argumens of the -cdel command
Returns "1" if the deletion was successful, otherwise 0 (no) or -1 (cancel).</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#visible">visible</a><span class=tooltiptext> visible : Checks if a tab is visible.
Returns yes if the tab is visible,.</span></div></li></ul>
<li><b><a href="#EOC_Tab">&nbsp;&nbsp;EOC Tab</a></b></li>
<li><b><a href="#Bar">Bar</a></b></li>
<li><b><a href="#Private_methods_of_Bar">&nbsp;&nbsp;Private methods of Bar</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#Bar_Data">Bar_Data</a><span class=tooltiptext> Bar_Data : Puts data of new bar in btData.
barOptions - new bar's options
Returns BID of new bar.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Bar_DefaultMenu">Bar_DefaultMenu</a><span class=tooltiptext> Bar_DefaultMenu : Creates default menu items.
popName - variable name for popup's data</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Bar_MenuList">Bar_MenuList</a><span class=tooltiptext> Bar_MenuList : Tunes "List" menu item for colors & underlining.
popi - menu of tab items
ilist - list of "s" (separators) and TIDs
pop - menu to be themed in apave package</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Bar_Cmd2">Bar_Cmd2</a><span class=tooltiptext> Bar_Cmd2 : Executes a command after an action.
comopt2 - the command's option (-csel2, -cdel2, -cmov2)</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Mc_MenuItems">Mc_MenuItems</a><span class=tooltiptext> Mc_MenuItems : Returns localized menu items' label.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#InitColors">InitColors</a><span class=tooltiptext> InitColors : Initializes colors of a bar.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Style">Style</a><span class=tooltiptext> Style : Sets styles a bar's widgets.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ScrollCurr">ScrollCurr</a><span class=tooltiptext> ScrollCurr : Scrolls the current tab to the left/right.
dir - 1/-1 for scrolling to the right/left</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#ArrowsState">ArrowsState</a><span class=tooltiptext> ArrowsState : Sets a state of scrolling arrows.
tleft, tright - index of left/right tab
sright - state of a right arrow ("no" for disabled)</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#FillMenuList">FillMenuList</a><span class=tooltiptext> FillMenuList : Fills "List of tabs" item of popup menu.
popi - menu of tab items
TID - clicked tab ID
mnu - root menu
mustBeSorted - flag "sorted list"
Return a list of items types: s (separator) and TID.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Width">Width</a><span class=tooltiptext> Width : Calculates and returns the bar width to place tabs.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#FillFromLeft">FillFromLeft</a><span class=tooltiptext> FillFromLeft : Fills a bar with tabs from the left to the right (as much tabs as possible).
ileft - index of a left tab
tright - index of a right tab</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#FillFromRight">FillFromRight</a><span class=tooltiptext> FillFromRight : Fills a bar with tabs from the right to the left (as much tabs as possible).
tleft, tright - index of left/right tab
behind - flag "go behind the right tab"</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Locked">Locked</a><span class=tooltiptext> Locked : Checks for "draw locked" mode: protects the menu.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Refill">Refill</a><span class=tooltiptext> Refill : Fills a bar with tabs.
itab - index of tab
left - if "yes", fill from left to right
behind - flag "go behind the right tab"</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#CheckDsblPopup">CheckDsblPopup</a><span class=tooltiptext> CheckDsblPopup : Controls disabling of Close* menu items.
mnuit - menu label
Returns "yes" for disabled menu item</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#NeedDraw">NeedDraw</a><span class=tooltiptext> NeedDraw : Redraws a bar at need.</span></div></li></ul>
<li><b><a href="#Exported_methods_of_Bar">&nbsp;&nbsp;Exported methods of Bar</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#_runBound_">_runBound_</a><span class=tooltiptext> _runBound_ : Runs a method bound to an event occuring at a widget.
w - widget
ev - event
args - the bound method & its arguments</span></div></li></ul>
<li><b><a href="#Auxiliary_methods_of_Bar">&nbsp;&nbsp;Auxiliary methods of Bar</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#Aux_WidgetWidth">Aux_WidgetWidth</a><span class=tooltiptext> Aux_WidgetWidth : Calculates a widget's width.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Aux_InitDraw">Aux_InitDraw</a><span class=tooltiptext> Aux_InitDraw : Auxiliary method used before cycles drawing tabs.
Returns a list of main options of drawing tabs.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Aux_CheckTabVisible">Aux_CheckTabVisible</a><span class=tooltiptext> Aux_CheckTabVisible : Auxiliary method used to check if a tab is visible.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Aux_EndDraw">Aux_EndDraw</a><span class=tooltiptext> Aux_EndDraw : Auxiliary method used after cycles drawing tabs.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#Aux_IndexInList">Aux_IndexInList</a><span class=tooltiptext> Aux_IndexInList : Searches ID in list.</span></div></li></ul>
<li><b><a href="#Public_methods_of_Bar">&nbsp;&nbsp;Public methods of Bar</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#cget">cget</a><span class=tooltiptext> cget : Gets values of options of bars & tabs.
args - list of options, e.g. {-tabcurrent -MyOpt}
Return a list of values or one value if args is one option.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#configure">configure</a><span class=tooltiptext> configure : Sets values of options for bars & tabs.
args - list of pairs "option value"</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#draw">draw</a><span class=tooltiptext> draw : Draws the bar tabs at slight changes.
upd - if "yes", run "update" before redrawing</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#update">update</a><span class=tooltiptext> update : Updates the bar in hard way.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#clear">clear</a><span class=tooltiptext> clear : Forgets (hides) the shown tabs.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#scrollLeft">scrollLeft</a><span class=tooltiptext> scrollLeft : Scrolls tabs to the left.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#scrollRight">scrollRight</a><span class=tooltiptext> scrollRight : Scrolls tabs to the right.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#listTab">listTab</a><span class=tooltiptext> listTab : Gets a list of tabs.
Returns a list of TID, text, wb, wb1, wb2, pf.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#comparetext">comparetext</a><span class=tooltiptext> comparetext : Compares items (by -text attribute) for sort method.
it1 - 1st item to compare
it2 - 2nd item to compare
See also: sort</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#sort">sort</a><span class=tooltiptext> sort : Sorts a list of tabs by the tab names.
mode - option of sort
cmd - command to compare two items</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#listFlag">listFlag</a><span class=tooltiptext> listFlag : Gets a list of TID + flags "visible", "marked", "selected", "disabled".
filter - "" for all or "v","m","s","d" for visible, marked, selected, disabled
Returns a list "TID, text, visible, marked, selected, disabled" for all or a list of TID for filtered.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#insertTab">insertTab</a><span class=tooltiptext> insertTab : Inserts a new tab into a bar.
txt - tab's label
pos - tab's position in tab list
img - tab's image
Returns TID of new tab or "".</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#tabID">tabID</a><span class=tooltiptext> tabID : Gets TID by tab's label.
txt - label
Returns TID or -1.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#popList">popList</a><span class=tooltiptext> popList : Shows a menu of tabs.
X - x coordinate of mouse pointer
Y - y coordinate of mouse pointer
sortedList - flag "sorted list"</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#remove">remove</a><span class=tooltiptext> remove : Removes a bar.
Returns "yes" at success.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#moveTab">moveTab</a><span class=tooltiptext> moveTab : Moves a tab to a new position in the bar.
pos - the new position</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#checkDisabledMenu">checkDisabledMenu</a><span class=tooltiptext> checkDisabledMenu : Checks whether the popup menu's items are disabled.
func - close function
*func* equals to:
1 - for "Close All"
2 - for "Close All at Left"
3 - for "Close All at Right"
Returns "yes" if the menu's item is disabled.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#closeAll">closeAll</a><span class=tooltiptext> closeAll : Closes tabs of bar.
func - close function
*func* equals to:
1 - for "Close All"
2 - for "Close All at Left"
3 - for "Close All at Right"</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#bindToEvent">bindToEvent</a><span class=tooltiptext> bindToEvent : Binds an event on a widget to a command.
w - the widget's path
event - the event
args - the command</span></div></li></ul>
<li><b><a href="#EOC_Bar">&nbsp;&nbsp;EOC Bar</a></b></li>
<li><b><a href="#Bars">Bars</a></b></li>
<li><b><a href="#Methods_of_Bars">&nbsp;&nbsp;Methods of Bars</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#constructor">constructor</a><span class=tooltiptext> constructor</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#destructor">destructor</a><span class=tooltiptext> destructor</span></div></li></ul>
<li><b><a href="#Private_methods_of_Bars">&nbsp;&nbsp;Private methods of Bars</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#Bars_Method">Bars_Method</a><span class=tooltiptext> Bars_Method : Executes a method for all bars.
mtd - method's name
args - method's arguments</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#MarkTab">MarkTab</a><span class=tooltiptext> MarkTab : Sets option of tab(s).
opt - option
args - list of TID</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#UnmarkTab">UnmarkTab</a><span class=tooltiptext> UnmarkTab : Unsets option of tab(s).
opt - option
args - list of TID</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#TtkTheme">TtkTheme</a><span class=tooltiptext> TtkTheme : Checks if a standard ttk theme is used.</span></div></li></ul>
<li><b><a href="#Public_methods_of_Bars">&nbsp;&nbsp;Public methods of Bars</a></b></li>
<ul class=toc><li><div class=tooltip><a href="#create">create</a><span class=tooltiptext> create : Creates a bar.
barCom - bar command's name or barOpts
barOpts - list of bar's options
tab1 - tab to show after creating the bar
Returns BID.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#updateAll">updateAll</a><span class=tooltiptext> updateAll : Updates all bars in hard way.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#drawAll">drawAll</a><span class=tooltiptext> drawAll : Redraws all bars.
upd - if "yes", run "update" before redrawing</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#removeAll">removeAll</a><span class=tooltiptext> removeAll : Removes all bars.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#markTab">markTab</a><span class=tooltiptext> markTab : Marks tab(s).
args - list of TID</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#unmarkTab">unmarkTab</a><span class=tooltiptext> unmarkTab : Unmarks tab(s).
args - list of TID or {}</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#onSelectCmd">onSelectCmd</a><span class=tooltiptext> onSelectCmd : Runs a command (set by "-csel3") on a list of tabs.
args - list of TID</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#selectTab">selectTab</a><span class=tooltiptext> selectTab : Selects tab(s).
args - list of TID</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#unselectTab">unselectTab</a><span class=tooltiptext> unselectTab : Unselects tab(s).
args - list of TID or {}</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#enableTab">enableTab</a><span class=tooltiptext> enableTab : Enables tab(s).
args - list of TID or {}</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#disableTab">disableTab</a><span class=tooltiptext> disableTab : Disables tab(s).
args - list of TID</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#isTab">isTab</a><span class=tooltiptext> isTab : Checks if a tab exists.
TID - tab ID
Returns true if the tab exists.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#MoveTab">MoveTab</a><span class=tooltiptext> MoveTab : Changes a tab's position in bar.
TID1 - TID of the moved tab
TID2 - TID of a tab to move TID1 behind
TID1 and TID2 must be of the same bar.</span></div></li></ul>
<ul class=toc><li><div class=tooltip><a href="#moveSelTab">moveSelTab</a><span class=tooltiptext> moveSelTab : Changes a tab's or selected tabs' position in bar.
TID1 - TID of the moved tab
TID2 - TID of a tab to move TID1 behind
TID1 and TID2 must be of the same bar.</span></div></li></ul>
<li><b><a href="#EOC_Bars">&nbsp;&nbsp;EOC Bars</a></b></li>
<li><b><a href="#EOF">EOF</a></b></li>

</ul>

</div>
</div>
</div>
<!-- TOC END -->

<h1><font color=#ca14ca> What's that</font></h1>
</p><p>
The <i><font color=#1b1baa>bartabs</font></i> Tcl/Tk package provides a bar widget containing tabs that are
</p><p>
<li>scrollable</li>
<li>markable</li>
<li>moveable</li>
<li>closeable</li>
<li>disabled and enabled</li>
<li>static and changeable</li>
<li>selectable and multi-selectable</li>
<li>configureable</li>
<li>enhanceable with popup menu</li>
</p><p>
The <i><font color=#1b1baa>bartabs</font></i> defines three TclOO classes:
<li><i><font color=#1b1baa>Tab</font></i> deals with tabs</li>
<li><i><font color=#1b1baa>Bar</font></i> deals with a bar of tabs</li>
<li><i><font color=#1b1baa>Bars</font></i> deals with bars of tabs</li>
</p><p>
However, only the <i><font color=#1b1baa>Bars</font></i> class is used to create bars along with tabs. It can be also used to deal with any bars and tabs, providing all necessary interface.
</p><p>
The <i><font color=#1b1baa>Bar</font></i> does not create a real TclOO object, rather it provides <i><font color=#1b1baa>syntax sugar</font></i> for a convenient access to the bar methods.
</p><p>
The <i><font color=#1b1baa>Tab</font></i> does not create a real TclOO object as well. It serves actually for structuring <i><font color=#1b1baa>bartabs</font></i> code as for tab methods. Thus, its methods are accessible through the <i><font color=#1b1baa>Bars</font></i> ("real" TclOO) and <i><font color=#1b1baa>Bar</font></i> ("sugar") objects.
</p><p>
<h1><font color=#ca14ca> Work flow</font></h1>
</p><p>
A common work flow with <i><font color=#1b1baa>bartabs</font></i> looks like this:
</p><p>
Firstly, we create a <i><font color=#1b1baa>Bars</font></i> object, e.g.
</p><p>
 <code>bartabs::Bars create NS::bars</code>
</p><p>
Then we create a <i><font color=#1b1baa>Bar</font></i> object, e.g.
</p><p>
 <code>NS::bars create NS::bar <font color=#1b1baa>$barOptions</font></code>
</p><p>
If a tab of the bar should be displayed (with its possible contents), we show the bar and select the current tab:
</p><p>
  <code><b><font color=#3a6797>set</font></b> TID [NS::bar tabID <font color=#8b2a0e>&quot;tab label&quot;</font>]  ;<i><font color=#4b5d50># get the tab's ID by its label</font></i></code>
</p><p>
  <code>NS::bar <font color=#1b1baa>$TID</font> show  ;<i><font color=#4b5d50># show the bar and select the tab</font></i></code>
</p><p>
or just draw the bar without mind-breaking about a tab:
</p><p>
  <code>NS::bar draw  ;<i><font color=#4b5d50># show the bar without selecting a tab</font></i></code>
</p><p>
The rest actions include:
</p><p>
<li>responses to a selection of tab (through <code><font color=#653760>-csel</font> command</code> option of <i><font color=#1b1baa>Bar</font></i> object)</li>
<li>responses to a deletion of tab (through <code><font color=#653760>-cdel</font> command</code> option of <i><font color=#1b1baa>Bar</font></i> object)</li>
<li>responses to a reorganization of bar (through <code><font color=#653760>-cmov</font> command</code> option of <i><font color=#1b1baa>Bar</font></i> object)</li>
<li>inserting and renaming tabs</li>
<li>disabling and enabling tabs</li>
<li>marking tabs with colors or icons</li>
<li>processing the marked tabs</li>
<li>processing multiple tabs selected with Ctrl+click</li>
<li>scrolling tabs to left/right through key bindings</li>
<li>calling other handlers through key bindings and <i><font color=#1b1baa>bartabs</font></i> menu</li>
<li>using <code>cget</code> and <code>configure</code> methods to change the bar/tab appearance</li>
<li>redrawing bars at some events</li>
<li>removing and creating as much bars as required</li>
</p><p>
<h1><font color=#ca14ca> Tab class</font></h1>
</p><p>
The methods of <i><font color=#1b1baa>Tab</font></i> class are called from <i><font color=#1b1baa>Bars</font></i> or <i><font color=#1b1baa>Bar</font></i> object
 and are passed: <i><font color=#1b1baa>tab ID (TID), method name, arguments</font></i>. Syntax:
</p><p>
<code>OBJECT TID method arguments</code>
</p><p>
For example: <code>NS::bars <font color=#1b1baa>$TID</font> close</code> or <code>NS::bar <font color=#1b1baa>$TID</font> show false</code>
</p><p>
<h1><font color=#ca14ca> Bar class</font></h1>
</p><p>
The methods of <i><font color=#1b1baa>Bar</font></i> class are called from <i><font color=#1b1baa>Bar</font></i> object or (more wordy) from <i><font color=#1b1baa>Bars</font></i> object. Syntax:
</p><p>
<code>BAR_OBJECT method arguments</code>
</p><p>
<code>BARS_OBJECT BID method arguments</code>
</p><p>
For example: <code>NS::bar popList <font color=#1b1baa>$X</font> <font color=#1b1baa>$Y</font></code> or <code>NS::bars <font color=#1b1baa>$BID</font> popList <font color=#1b1baa>$X</font> <font color=#1b1baa>$Y</font></code>
</p><p>
<h1><font color=#ca14ca> Bars class</font></h1>
</p><p>
The methods of <i><font color=#1b1baa>Bars</font></i> class need no TID nor BID, though not protesting them passed before method name. Syntax:
</p><p>
<code>BARS_OBJECT method arguments</code>
</p><p>
For example:
</p><p>
<code>NS::bars drawAll        ;<i><font color=#4b5d50># good boy</font></i></code>
</p><p>
<code>NS::bars tab11 drawAll  ;<i><font color=#4b5d50># bad boy uses the useless tab11 (TID)</font></i></code>
</p><p>
<code>NS::bars bar1 drawAll   ;<i><font color=#4b5d50># bad boy's BID is useless as well</font></i></code>
</p><p>
<h1><font color=#ca14ca> Virtual methods</font></h1>
</p><p>
There are three "virtual" methods:
</p><p>
<li><code>NS::bar create NS::tab <font color=#1b1baa>$label</font></code> creates a tab object <i><font color=#1b1baa>NS::tab</font></i> for a tab labeled $label to access the tab methods, e.g. <code>NS::tab show</code></li>
</p><p>
<li><code>NS::tab cget <font color=#1b1baa>$option</font></code> gets an option of tab, e.g. <code>NS::tab cget <font color=#653760>-text</font></code></li>
</p><p>
<li><code>NS::tab configure <font color=#1b1baa>$option</font> <font color=#1b1baa>$value</font></code> sets an option of tab, e.g. <code>NS::tab configure <font color=#653760>-text</font> <font color=#8b2a0e>&quot;new label&quot;</font></code></li>
</p><p>
<h1><font color=#ca14ca> BID and TID</font></h1>
</p><p>
Few words about <i><font color=#1b1baa>BID</font></i> and <i><font color=#1b1baa>TID</font></i> mentioned throughout the <i><font color=#1b1baa>bartabs</font></i>.
</p><p>
These are identifiers of bars and tabs, of form <code>bar&lt;index&gt;</code> and <code>tab&lt;index&gt;</code> where <code>&lt;index&gt;</code> is integer increased from 0 in order of bar/tab creation. The bars and the tabs of all bars have unique IDs.
</p><p>
You can use these literals freely, along with BIDs and TIDs gotten from <i><font color=#1b1baa>bartabs</font></i> methods. For example, if you know that "some tab" was created third, you can show it straightforward:
</p><p>
  <code>NS::bar tab2 show ;<i><font color=#4b5d50># show the 3rd tab (TID=tab2)</font></i></code>
</p><p>
instead of
</p><p>
  <code>NS::bar [NS::bar tabID <font color=#8b2a0e>&quot;some tab&quot;</font>] show ;<i><font color=#4b5d50># find and show the tab by its name</font></i></code>
</p><p>
<h1><font color=#ca14ca> Links</font></h1>
</p><p>
<a href="https://aplsimple.github.io/en/tcl/bartabs">Documentation</a>
</p><p>
<a href="https://aplsimple.github.io/en/tcl/bartabs/bartabs.html">Reference on bartabs</a>
</p><p>
<a href="https://aplsimple.github.io/en/tcl/baltip/baltip.html">Reference on baltip</a> (package used by <i><font color=#1b1baa>bartabs</font></i>)
</p><p>

</p>

<table border=0 cellPadding=4 cellSpacing=0 width=100%>  <td border=0 bgColor=#bdd7e7><div style=text-align:center>  <a href="../../index.html"><font color=#1a1a1a size=6>  <b>bartabs.tcl</b></font></div></td></table>

<pre class="code"><i><font color=#4b5d50>###########################################################<a id=bartabs.tcl></a></font></i>
<i><font color=#4b5d50># Name:    bartabs.tcl</font></i>
<i><font color=#4b5d50># Author:  Alex Plotnikov  (aplsimple@gmail.com)</font></i>
<i><font color=#4b5d50># Date:    01/12/2023</font></i>
<i><font color=#4b5d50># Brief:   Handles the tab bar widget.</font></i>
<i><font color=#4b5d50># License: MIT.</font></i>
<i><font color=#4b5d50>###########################################################</font></i>

<b><font color=#3a6797>package</font></b> provide bartabs 1.6.9
<a id=NS_bartabs></a>
<i><font color=#4b5d50># ________________________ NS bartabs _________________________ #</font></i>

<b><font color=#ca14ca>namespace</font></b> eval ::bartabs {

  <i><font color=#4b5d50># IDs for new bars & tabs</font></i>
  <b><font color=#3a6797>variable</font></b> NewBarID -1 NewTabID -1 NewTabNo -1
  <b><font color=#3a6797>variable</font></b> NewAfterID;  <b><font color=#3a6797>array</font></b> set NewAfterID [<b><font color=#3a6797>list</font></b>]

  <i><font color=#4b5d50># images made by base64</font></i>
  <b><font color=#134070>image</font></b> create photo bts_ImgLeft \
  <font color=#653760>-data</font> {iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAElBMVEUAAABJSUmSkpJtbW22trbb
29vYK8X/AAAAAXRSTlMAQObYZgAAAEBJREFUCNdjAANGBigQhNKMjlCGEJTBqAplCIVCGIwqKopg
hrATjKGkZAiRMgIyIEJABlTIEGYDjMEoiGQp3BkAc58E+W1dC9QAAAAASUVORK5CYII=}
  <b><font color=#134070>image</font></b> create photo bts_ImgRight \
  <font color=#653760>-data</font> {iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAElBMVEUAAABJSUmSkpJtbW22trbb
29vYK8X/AAAAAXRSTlMAQObYZgAAAEBJREFUCNdjYGAQYIACQRhDRADGUIQxggSgjFCokJCTkwCU
oWIIZggrKcEYygIQBlAAwgAKQBiCMLsE0C2FCAAAa1IEzBjs2sUAAAAASUVORK5CYII=}
  <b><font color=#134070>image</font></b> create photo bts_ImgNone \
  <font color=#653760>-data</font> {iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA1BMVEUAAACnej3aAAAAAXRSTlMA
QObYZgAAAAtJREFUCNdjIBEAAAAwAAFletZ8AAAAAElFTkSuQmCC}
  <b><font color=#134070>image</font></b> create photo bts_ImgClose \
  <font color=#653760>-data</font> {iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAALVBMVEUAAAAAACTb29u2trbt4+Ll
4eHw4eD/6N/y3Nv85N/94t3m29vn0dPjz8/dyssim+gAAAAAAXRSTlMAQObYZgAAAEdJREFUCNdj
wAvaFZiWgWgORSUlYQcgg11QSFFQAchgUhQUFLoAkjskKKgNVqwkKKjHAJMCqeGEKWYzBGoPAMk5
KTCp4rURAEWmB5A5tzUJAAAAAElFTkSuQmCC}

  <b><font color=#3a6797>variable</font></b> BarsList [<b><font color=#3a6797>list</font></b>]
; <b><font color=#ca14ca>proc</font></b> drawAll {} {
    <i><font color=#4b5d50># Draws all bars. Used at updating themes etc.</font></i>
    <b><font color=#3a6797>foreach</font></b> bars <font color=#1b1baa>$::bartabs::BarsList</font> {<font color=#1b1baa>$bars</font> drawAll}
  }
  <i><font color=#4b5d50>#_______________________</font></i>
<a id=messageBox></a>
  <b><font color=#ca14ca>proc</font></b> messageBox {type ttl msg args} {
    <i><font color=#4b5d50># Runs Tk's or apave's ok/yes/no/cancel dialogue.</font></i>
    <i><font color=#4b5d50>#  type - ok, yesno or yesnocancel</font></i>
    <i><font color=#4b5d50>#  ttl - title</font></i>
    <i><font color=#4b5d50>#  ttl - message</font></i>
    <i><font color=#4b5d50># args - additional arguments of tk_messageBox</font></i>
    <i><font color=#4b5d50># Returns 1 if 'yes' chosen, 2 if 'no', 0 otherwise.</font></i>

    <i><font color=#4b5d50># try the apave package's dialogue</font></i>
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> res [::apave::obj <font color=#1b1baa>$type</font> ques <font color=#1b1baa>$ttl</font> <font color=#1b1baa>$msg</font>]}]} {
      <i><font color=#4b5d50># or run the standard tk_messageBox</font></i>
      <b><font color=#3a6797>set</font></b> res [<b><font color=#134070>tk_messageBox</font></b> <font color=#653760>-title</font> <font color=#1b1baa>$ttl</font> <font color=#653760>-message</font> <font color=#1b1baa>$msg</font> <font color=#653760>-type</font> <font color=#1b1baa>$type</font> \
        <font color=#653760>-icon</font> question {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>]
      <b><font color=#3a6797>set</font></b> res [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$res</font> eq {yes} ? 1 : (<font color=#1b1baa>$res</font> eq {no} ? 2 : 0)}]
    }
    <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$res</font>
  }
<a id=EONS_bartabs></a>
  <i><font color=#4b5d50>## ____________ EONS bartabs ____________ ##</font></i>

}
<a id=bartabs_class_hierarchy></a>
<i><font color=#4b5d50># ____________ bartabs class hierarchy ____________ #</font></i>

<b><font color=#ca14ca>oo::class</font></b> create ::bartabs::Tab {
}

<b><font color=#ca14ca>oo::class</font></b> create ::bartabs::Bar {
  superclass ::bartabs::Tab
}

<b><font color=#ca14ca>oo::class</font></b> create ::bartabs::Bars {
  superclass ::bartabs::Bar
}
<a id=Tab></a>
<i><font color=#4b5d50># ________________________ Tab _______________________ #</font></i>
<a id=Private_methods_of_Tab></a>
<i><font color=#4b5d50>## ____________ Private methods of Tab ____________ ##</font></i>

<b><font color=#ca14ca>oo::define</font></b> ::bartabs::Tab {
<a id=My></a>
<b><font color=#ca14ca>method</font></b> My {ID} {
<i><font color=#4b5d50># Creates a caller of method.</font></i>
<i><font color=#4b5d50>#   ID - ID of caller</font></i>

  <b><font color=#3a6797>set</font></b> t [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$ID</font> 0 2]
  <b><font color=#ca14ca>oo::objdefine</font></b> [<b><font color=#ca14ca>self</font></b>] <font color=#8b2a0e>&quot;method <font color=#1b1baa>$</font>ID <font color=#1b1baa>{</font>args<font color=#1b1baa>}</font> <font color=#1b1baa>{</font> \</font>
<font color=#8b2a0e>    set m \[lindex \$args 0\] ; \</font>
<font color=#8b2a0e>    if <font color=#1b1baa>{</font>\$m in <font color=#1b1baa>{{}</font> -1<font color=#1b1baa>}}</font> <font color=#1b1baa>{</font>return <font color=#1b1baa>{}}</font> ; \</font>
<font color=#8b2a0e>    if <font color=#1b1baa>{</font>\$m eq <font color=#1b1baa>{</font>create<font color=#1b1baa>}</font> && <font color=#1b1baa>{$</font>t<font color=#1b1baa>}</font> eq <font color=#1b1baa>{</font>bar<font color=#1b1baa>}</font> || \$m in <font color=#1b1baa>{</font>cget configure<font color=#1b1baa>}</font> && <font color=#1b1baa>{$</font>t<font color=#1b1baa>}</font> eq <font color=#1b1baa>{</font>tab<font color=#1b1baa>}}</font> <font color=#1b1baa>{</font> \</font>
<font color=#8b2a0e>    set args \[lreplace \$args 0 0 Tab_\$m\]<font color=#1b1baa>}</font> ; \</font>
<font color=#8b2a0e>    return \[my <font color=#1b1baa>{</font>*<font color=#1b1baa>}</font>\$args\]<font color=#1b1baa>}</font>&quot;</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ID></a>
<b><font color=#ca14ca>method</font></b> ID {} {
<i><font color=#4b5d50># Returns ID of caller.</font></i>

  <b><font color=#3a6797>lindex</font></b> [<b><font color=#3a6797>uplevel</font></b> 1 {<b><font color=#ca14ca>self</font></b> caller}] 2
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=IDs></a>
<b><font color=#ca14ca>method</font></b> IDs {TID} {
<i><font color=#4b5d50># Returns a pair of TID and BID.</font></i>

  <b><font color=#3a6797>list</font></b> <font color=#1b1baa>$TID</font> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-BID</font>]
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_Create></a>
<b><font color=#ca14ca>method</font></b> Tab_Create {BID TID w text} {
<i><font color=#4b5d50># Creates a tab widget (frame, label, button).</font></i>
<i><font color=#4b5d50>#   w - parent frame</font></i>
<i><font color=#4b5d50>#   text - tab's label</font></i>
<i><font color=#4b5d50># Returns a list of created widgets of the tab.</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-relief</font> <font color=#653760>-bd</font> <font color=#653760>-padx</font> <font color=#653760>-pady</font> <font color=#653760>-BGMAIN</font>] relief bd padx pady bgm
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-wb</font> <font color=#653760>-wb1</font> <font color=#653760>-wb2</font>] wb wb1 wb2
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$bd</font>} {<b><font color=#3a6797>set</font></b> relief flat}
  <b><font color=#3a6797>if</font></b> {![<b><font color=#ca14ca>my</font></b> Tab_Is <font color=#1b1baa>$wb</font>]} {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$wb</font> eq {}} {
      <b><font color=#3a6797>set</font></b> ::bartabs::NewTabNo [<b><font color=#3a6797>expr</font></b> {(<font color=#1b1baa>$::bartabs::NewTabNo</font>+1)%1000000}]
      <b><font color=#3a6797>set</font></b> wb <font color=#1b1baa>$w</font>.<font color=#1b1baa>$TID</font>[<b><font color=#3a6797>format</font></b> %06d <font color=#1b1baa>$::bartabs::NewTabNo</font>]
      <b><font color=#3a6797>set</font></b> wb1 <font color=#1b1baa>$wb</font>.l
      <b><font color=#3a6797>set</font></b> wb2 <font color=#1b1baa>$wb</font>.b
    }
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> configure <font color=#653760>-wb</font> <font color=#1b1baa>$wb</font> <font color=#653760>-wb1</font> <font color=#1b1baa>$wb1</font> <font color=#653760>-wb2</font> <font color=#1b1baa>$wb2</font>
    <b><font color=#134070>ttk::frame</font></b> <font color=#1b1baa>$wb</font> <font color=#653760>-borderwidth</font> [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$bd</font>? <font color=#1b1baa>$bd</font> : 2}]
    <b><font color=#134070>ttk::label</font></b> <font color=#1b1baa>$wb1</font>
    <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> TtkTheme]} {
      <b><font color=#134070>ttk::button</font></b> <font color=#1b1baa>$wb2</font> <font color=#653760>-style</font> ClButton<font color=#1b1baa>$BID</font> <font color=#653760>-image</font> bts_ImgNone \
        <font color=#653760>-command</font> [<b><font color=#3a6797>list</font></b> [<b><font color=#ca14ca>self</font></b>] <font color=#1b1baa>$TID</font> close yes <font color=#653760>-withicon</font> yes] <font color=#653760>-takefocus</font> 0
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#134070>button</font></b> <font color=#1b1baa>$wb2</font> <font color=#653760>-relief</font> flat <font color=#653760>-borderwidth</font> 0 <font color=#653760>-highlightthickness</font> 0 <font color=#653760>-image</font> bts_ImgNone \
        <font color=#653760>-command</font> [<b><font color=#3a6797>list</font></b> [<b><font color=#ca14ca>self</font></b>] <font color=#1b1baa>$TID</font> close yes <font color=#653760>-withicon</font> yes] <font color=#653760>-takefocus</font> 0 <font color=#653760>-background</font> <font color=#1b1baa>$bgm</font>
    }
  }
  <font color=#1b1baa>$wb</font> configure <font color=#653760>-relief</font> <font color=#1b1baa>$relief</font>
  <font color=#1b1baa>$wb1</font> configure <font color=#653760>-relief</font> flat <font color=#653760>-padding</font> <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>padx <font color=#1b1baa>$</font>pady <font color=#1b1baa>$</font>padx <font color=#1b1baa>$</font>pady&quot;</font> \
    {<b><font color=#3a6797>*</font></b>}[<b><font color=#ca14ca>my</font></b> Tab_Font <font color=#1b1baa>$BID</font>]
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_TextEllipsed <font color=#1b1baa>$BID</font> <font color=#1b1baa>$text</font>] text ttip
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> tip [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-tip</font>]] ne {}} {
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> configure <font color=#653760>-tip</font> <font color=#1b1baa>$tip</font>  ;<i><font color=#4b5d50># run baltip after creating $wb1 & $wb2</font></i>
  }
  <font color=#1b1baa>$wb1</font> configure <font color=#653760>-text</font> <font color=#1b1baa>$text</font> <font color=#653760>-background</font> <font color=#1b1baa>$bgm</font>
  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Tab_Iconic <font color=#1b1baa>$BID</font>]} {
    <font color=#1b1baa>$wb2</font> configure <font color=#653760>-state</font> normal
  } <b><font color=#3a6797>else</font></b> {
    <font color=#1b1baa>$wb2</font> configure <font color=#653760>-state</font> disabled <font color=#653760>-image</font> {}
  }
  <b><font color=#3a6797>list</font></b> <font color=#1b1baa>$wb</font> <font color=#1b1baa>$wb1</font> <font color=#1b1baa>$wb2</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_create></a>
<b><font color=#ca14ca>method</font></b> Tab_create {tabCom label} {
  <i><font color=#4b5d50># Creates tab method and registers it. Defined by &quot;My&quot;.</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> TID [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> tabID <font color=#1b1baa>$label</font>]] eq {}} {
    <b><font color=#ca14ca>return</font></b> <font color=#653760>-code</font> error <font color=#8b2a0e>&quot;No label <font color=#1b1baa>{$</font>label<font color=#1b1baa>}</font> in <font color=#1b1baa>$</font>BID&quot;</font>
  }
; <b><font color=#ca14ca>proc</font></b> <font color=#1b1baa>$tabCom</font> {args} <font color=#8b2a0e>&quot;return \[<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>TID <font color=#1b1baa>{</font>*<font color=#1b1baa>}</font>\$args\]&quot;</font>
  <b><font color=#3a6797>set</font></b> lObj [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-TABCOM</font>]
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-TABCOM</font> [<b><font color=#3a6797>lappend</font></b> lObj [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$TID</font> <font color=#1b1baa>$tabCom</font>]]
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_ExpandOption></a>
<b><font color=#ca14ca>method</font></b> Tab_ExpandOption {BID expand} {
  <i><font color=#4b5d50># Gets a real -expand option, counting that it may be set as a number&gt;1</font></i>
  <i><font color=#4b5d50># meaning &quot;starting from this number do expanding, otherwise not&quot;</font></i>
  <i><font color=#4b5d50>#   expand - original value of -expand option</font></i>

  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> is digit <font color=#1b1baa>$expand</font>] && <font color=#1b1baa>$expand</font>&gt;1} {
    <b><font color=#3a6797>set</font></b> tabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-TABS</font>]
    <b><font color=#3a6797>set</font></b> expand [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$expand</font>&lt;[<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$tabs</font>]}]
  }
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$expand</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_cget></a>
<b><font color=#ca14ca>method</font></b> Tab_cget {args} {
<i><font color=#4b5d50># Gets options of tab.</font></i>
<i><font color=#4b5d50>#   args - list of options</font></i>
<i><font color=#4b5d50># Returns a list of values or one value if args is one option.</font></i>

  <b><font color=#3a6797>variable</font></b> btData
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_BID [<b><font color=#3a6797>set</font></b> TID [<b><font color=#ca14ca>my</font></b> ID]]] BID i tab
  <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$tab</font> tID tdata
  <b><font color=#3a6797>set</font></b> res [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>foreach</font></b> opt <font color=#1b1baa>$args</font> {
    <b><font color=#3a6797>switch</font></b> -- <font color=#1b1baa>$opt</font> {
      <font color=#653760>-BID</font> {<b><font color=#3a6797>lappend</font></b> res <font color=#1b1baa>$BID</font>}
      <font color=#653760>-text</font> - <font color=#653760>-wb</font> - <font color=#653760>-wb1</font> - <font color=#653760>-wb2</font> - <font color=#653760>-pf</font> {
        <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>lappend</font></b> res [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$tdata</font> <font color=#1b1baa>$opt</font>]}]} {
          <b><font color=#3a6797>lappend</font></b> res {}
        }
      }
      <font color=#653760>-index</font> {
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$i</font>&lt;([<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$btData</font> <font color=#1b1baa>$BID</font> <font color=#653760>-LLEN</font>]-1)} {
          <b><font color=#3a6797>lappend</font></b> res <font color=#1b1baa>$i</font>
        } <b><font color=#3a6797>else</font></b> {
          <b><font color=#3a6797>lappend</font></b> res end
        }
      }
      <font color=#653760>-width</font> {  ;<i><font color=#4b5d50># width of tab widget</font></i>
        <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_DictItem <font color=#1b1baa>$tab</font>] tID text wb wb1 wb2
        <b><font color=#3a6797>if</font></b> {![<b><font color=#ca14ca>my</font></b> Tab_Is <font color=#1b1baa>$wb</font>]} {
          <b><font color=#3a6797>lappend</font></b> res 0
        } <b><font color=#3a6797>else</font></b> {
          <b><font color=#3a6797>set</font></b> b1 [<b><font color=#134070>ttk::style</font></b> configure TLabel <font color=#653760>-borderwidth</font>]
          <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$b1</font> eq {}} {<b><font color=#3a6797>set</font></b> b1 0}
          <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-bd</font> <font color=#653760>-expand</font> <font color=#653760>-static</font>] bd expand static
          <b><font color=#3a6797>set</font></b> bd [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$bd</font>?2*<font color=#1b1baa>$b1:0</font>}]
          <b><font color=#3a6797>set</font></b> b2 [<b><font color=#3a6797>expr</font></b> {[<b><font color=#ca14ca>my</font></b> Aux_WidgetWidth <font color=#1b1baa>$wb2</font>]-3}]
          <b><font color=#3a6797>set</font></b> expand [<b><font color=#ca14ca>my</font></b> Tab_ExpandOption <font color=#1b1baa>$BID</font> <font color=#1b1baa>$expand</font>]
          <b><font color=#3a6797>set</font></b> expand [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$expand</font>||![<b><font color=#ca14ca>my</font></b> Tab_Iconic <font color=#1b1baa>$BID</font>]?2:0}]
          <b><font color=#3a6797>lappend</font></b> res [<b><font color=#3a6797>expr</font></b> {[<b><font color=#ca14ca>my</font></b> Aux_WidgetWidth <font color=#1b1baa>$wb1</font>]+<font color=#1b1baa>$b2</font>+<font color=#1b1baa>$bd</font>+<font color=#1b1baa>$expand</font>}]
        }
      }
      <b><font color=#3a6797>default</font></b> {  ;<i><font color=#4b5d50># user's options</font></i>
        <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>lappend</font></b> res [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$tdata</font> <font color=#1b1baa>$opt</font>]}]} {<b><font color=#3a6797>lappend</font></b> res {}}
      }
    }
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$args</font>]==1} {<b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$res</font> 0]}
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$res</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_configure></a>
<b><font color=#ca14ca>method</font></b> Tab_configure {args} {
<i><font color=#4b5d50># Sets values of options for a tab.</font></i>
<i><font color=#4b5d50>#   args - list of pairs &quot;option value&quot;</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_BID [<b><font color=#3a6797>set</font></b> TID [<b><font color=#ca14ca>my</font></b> ID]]] BID i tab
  <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$tab</font> tID data
  <b><font color=#3a6797>foreach</font></b> {opt val} <font color=#1b1baa>$args</font> {
    <b><font color=#3a6797>dict</font></b> set data <font color=#1b1baa>$opt</font> <font color=#1b1baa>$val</font>
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$opt</font> eq {<font color=#653760>-tip</font>}} {   ;<i><font color=#4b5d50># configure the tab's tip</font></i>
      <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-wb1</font> <font color=#653760>-wb2</font>] wb1 wb2
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$wb1</font> ne {}} {
        <b><font color=#3a6797>catch</font></b> {
          baltip::tip <font color=#1b1baa>$wb1</font> <font color=#1b1baa>$val</font> <font color=#653760>-under</font> 3
          baltip::tip <font color=#1b1baa>$wb2</font> <font color=#1b1baa>$val</font> <font color=#653760>-under</font> 3
        }
      }
    }
  }
  <b><font color=#3a6797>set</font></b> tab [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$TID</font> <font color=#1b1baa>$data</font>]
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-TABS</font> [<b><font color=#3a6797>lreplace</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-TABS</font>] <font color=#1b1baa>$i</font> <font color=#1b1baa>$i</font> <font color=#1b1baa>$tab</font>]
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_DictItem></a>
<b><font color=#ca14ca>method</font></b> Tab_DictItem {TID {data <font color=#8b2a0e>&quot;&quot;</font>}} {
<i><font color=#4b5d50># Gets item data from a tab item (ID + data).</font></i>
<i><font color=#4b5d50>#   TID - tab ID or the tab item (ID + data).</font></i>
<i><font color=#4b5d50>#   data - tab's data (list of option-value)</font></i>
<i><font color=#4b5d50># If 'data' omitted, TID is a tab item (ID + data).</font></i>
<i><font color=#4b5d50># If the tab's attribute is absent, it's meant to be &quot;&quot;.</font></i>
<i><font color=#4b5d50># Returns a list of values: ID, text, wb, wb1, wb2, pf.</font></i>

  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$data</font> eq {}} {<b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$TID</font> TID data}
  <b><font color=#3a6797>set</font></b> res [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$TID</font>]
  <b><font color=#3a6797>foreach</font></b> a {<font color=#653760>-text</font> <font color=#653760>-wb</font> <font color=#653760>-wb1</font> <font color=#653760>-wb2</font> <font color=#653760>-pf</font>} {
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>dict</font></b> exists <font color=#1b1baa>$data</font> <font color=#1b1baa>$a</font>]} {
      <b><font color=#3a6797>lappend</font></b> res [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$data</font> <font color=#1b1baa>$a</font>]
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>lappend</font></b> res {}
    }
  }
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$res</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_ItemDict></a>
<b><font color=#ca14ca>method</font></b> Tab_ItemDict {TID text {wb <font color=#8b2a0e>&quot;&quot;</font>} {wb1 <font color=#8b2a0e>&quot;&quot;</font>} {wb2 <font color=#8b2a0e>&quot;&quot;</font>} {pf <font color=#8b2a0e>&quot;&quot;</font>}} {
<i><font color=#4b5d50># Returns a tab item (ID + data) from item data.</font></i>
<i><font color=#4b5d50>#   text - tab's text;</font></i>
<i><font color=#4b5d50>#   wb - tab's frame widget</font></i>
<i><font color=#4b5d50>#   wb1 - tab's label widget</font></i>
<i><font color=#4b5d50>#   wb2 - tab's button widget</font></i>
<i><font color=#4b5d50>#   pf - &quot;p&quot; for tab packed, &quot;&quot; for tab forgotten</font></i>

  <b><font color=#3a6797>list</font></b> <font color=#1b1baa>$TID</font> [<b><font color=#3a6797>list</font></b> <font color=#653760>-text</font> <font color=#1b1baa>$text</font> <font color=#653760>-wb</font> <font color=#1b1baa>$wb</font> <font color=#653760>-wb1</font> <font color=#1b1baa>$wb1</font> <font color=#653760>-wb2</font> <font color=#1b1baa>$wb2</font> <font color=#653760>-pf</font> <font color=#1b1baa>$pf</font>]
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_Data></a>
<b><font color=#ca14ca>method</font></b> Tab_Data {BID text} {
<i><font color=#4b5d50># Creates data of new tab.</font></i>
<i><font color=#4b5d50>#   text - new tab's label</font></i>
<i><font color=#4b5d50># The bar is checked for a duplicate of 'text'.</font></i>
<i><font color=#4b5d50># Returns a tab item or &quot;&quot; (if duplicated).</font></i>

  <b><font color=#3a6797>variable</font></b> btData
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>dict</font></b> exists <font color=#1b1baa>$btData</font> <font color=#1b1baa>$BID</font>] && [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> tabID <font color=#1b1baa>$text</font>] ne {}} {<b><font color=#ca14ca>return</font></b> {}}
  <b><font color=#ca14ca>my</font></b> My tab[<b><font color=#3a6797>incr</font></b> ::bartabs::NewTabID]
  <b><font color=#ca14ca>my</font></b> Tab_ItemDict tab<font color=#1b1baa>$::bartabs::NewTabID</font> <font color=#1b1baa>$text</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_BID></a>
<b><font color=#ca14ca>method</font></b> Tab_BID {TID {act <font color=#8b2a0e>&quot;&quot;</font>}} {
<i><font color=#4b5d50># Gets BID from TID.</font></i>
<i><font color=#4b5d50>#   act - if &quot;check&quot;, only checks the existance of TID</font></i>
<i><font color=#4b5d50># If 'act' is &quot;check&quot; and a bar not found, -1 is returned, otherwise BID.</font></i>
<i><font color=#4b5d50># Returns a list of 1. BID (or -1 if no bar found) 2. index of the tab in tab list 3. the tab data.</font></i>

  <b><font color=#3a6797>variable</font></b> btData
  <b><font color=#3a6797>set</font></b> BID {}
  <b><font color=#3a6797>dict</font></b> for {bID bInfo} <font color=#1b1baa>$btData</font> {
    <b><font color=#3a6797>set</font></b> tabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$bID</font> cget <font color=#653760>-TABS</font>]
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> i [<b><font color=#ca14ca>my</font></b> Aux_IndexInList <font color=#1b1baa>$TID</font> <font color=#1b1baa>$tabs</font>]] &gt; -1} {
      <b><font color=#3a6797>set</font></b> BID <font color=#1b1baa>$bID</font>
      <b><font color=#ca14ca>break</font></b>
    }
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$act</font> eq {check}} {<b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$BID</font>}
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$BID</font> eq {}} {
    <b><font color=#ca14ca>return</font></b> <font color=#653760>-code</font> error <font color=#8b2a0e>&quot;bartabs: tab ID <font color=#1b1baa>$</font>TID not found in the bars&quot;</font>
  }
  <b><font color=#3a6797>list</font></b> <font color=#1b1baa>$BID</font> <font color=#1b1baa>$i</font> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font>]
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_Bindings></a>
<b><font color=#ca14ca>method</font></b> Tab_Bindings {BID} {
<i><font color=#4b5d50># Sets bindings on events of tabs.</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-static</font> <font color=#653760>-FGOVER</font> <font color=#653760>-BGOVER</font> <font color=#653760>-WWID</font>] static fgo bgo wwid
  <b><font color=#3a6797>foreach</font></b> tab [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> listTab] {
    <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$tab</font> TID text wb wb1 wb2
    <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Tab_Is <font color=#1b1baa>$wb</font>]} {
      <b><font color=#3a6797>set</font></b> bar <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>BID&quot;</font>
      <b><font color=#3a6797>set</font></b> tab <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>TID&quot;</font>
      <b><font color=#3a6797>set</font></b> ctrlBP <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>tab OnCtrlClick ; break&quot;</font>
      <b><font color=#3a6797>foreach</font></b> w [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$wb</font> <font color=#1b1baa>$wb1</font> <font color=#1b1baa>$wb2</font>] {
        <b><font color=#134070>bind</font></b> <font color=#1b1baa>$w</font> &lt;Enter&gt; <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>bar OnEnterTab <font color=#1b1baa>$</font>TID <font color=#1b1baa>$</font>wb1 <font color=#1b1baa>$</font>wb2 <font color=#1b1baa>$</font>fgo <font color=#1b1baa>$</font>bgo&quot;</font>
        <b><font color=#134070>bind</font></b> <font color=#1b1baa>$w</font> &lt;Leave&gt; <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>TID OnLeaveTab <font color=#1b1baa>$</font>wb1 <font color=#1b1baa>$</font>wb2&quot;</font>
        <b><font color=#134070>bind</font></b> <font color=#1b1baa>$w</font> &lt;Button-3&gt; <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>TID OnPopup %X %Y&quot;</font>
        <b><font color=#134070>bind</font></b> <font color=#1b1baa>$w</font> &lt;Control-ButtonPress&gt; <font color=#1b1baa>$ctrlBP</font>
      }
      <b><font color=#134070>bind</font></b> <font color=#1b1baa>$wb</font> &lt;Control-ButtonPress&gt; <font color=#1b1baa>$ctrlBP</font>
      <b><font color=#134070>bind</font></b> <font color=#1b1baa>$wb</font> &lt;ButtonPress&gt; <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>BID OnButtonPress <font color=#1b1baa>$</font>TID <font color=#1b1baa>$</font>wb1 <font color=#1b1baa>{}</font>&quot;</font>
      <b><font color=#134070>bind</font></b> <font color=#1b1baa>$wb1</font> &lt;ButtonPress&gt; <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>BID OnButtonPress <font color=#1b1baa>$</font>TID <font color=#1b1baa>$</font>wb1 %x&quot;</font>
      <b><font color=#134070>bind</font></b> <font color=#1b1baa>$wb1</font> &lt;ButtonRelease&gt; <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>BID OnButtonRelease <font color=#1b1baa>$</font>wb1 %x&quot;</font>
      <b><font color=#134070>bind</font></b> <font color=#1b1baa>$wb1</font> &lt;Motion&gt; <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>BID OnButtonMotion <font color=#1b1baa>$</font>wb <font color=#1b1baa>$</font>wb1 %x %y&quot;</font>
    }
  }
  <b><font color=#134070>bind</font></b> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$wwid</font> 0] &lt;Button-3&gt; <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>BID OnPopup %X %Y <font color=#1b1baa>$</font>BID&quot;</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_Font></a>
<b><font color=#ca14ca>method</font></b> Tab_Font {BID} {
<i><font color=#4b5d50># Gets a font attributes for tab label.</font></i>

  <b><font color=#3a6797>set</font></b> font [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-font</font>]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$font</font> eq {}} {
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> font [<b><font color=#134070>ttk::style</font></b> configure TLabel <font color=#653760>-font</font>]] eq {}} {
      <b><font color=#3a6797>set</font></b> font TkDefaultFont
    }
    <b><font color=#3a6797>set</font></b> font [<b><font color=#134070>font</font></b> actual <font color=#1b1baa>$font</font>]
  }
  <b><font color=#ca14ca>return</font></b> <font color=#8b2a0e>&quot;-font <font color=#1b1baa>{$</font>font<font color=#1b1baa>}</font>&quot;</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_MarkAttrs></a>
<b><font color=#ca14ca>method</font></b> Tab_MarkAttrs {BID TID {withbg yes} {wb2 <font color=#8b2a0e>&quot;&quot;</font>}} {
<i><font color=#4b5d50># Gets image & mark attributes of marks.</font></i>
<i><font color=#4b5d50>#   TID - ID of current tab</font></i>
<i><font color=#4b5d50>#   withbg - if true, gets also background</font></i>
<i><font color=#4b5d50>#   wb2 - tab's button</font></i>
<i><font color=#4b5d50># Returns string of attributes if any.</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget \
    <font color=#653760>-mark</font> <font color=#653760>-imagemark</font> <font color=#653760>-fgmark</font> <font color=#653760>-bgmark</font> <font color=#653760>-IMAGETABS</font> <font color=#653760>-FGMAIN</font> <font color=#653760>-BGMAIN</font> <font color=#653760>-FGDSBL</font> <font color=#653760>-BGDSBL</font>] \
    marktabs imagemark fgm bgm imagetabs fgmain bgmain fgdsbl bgdsbl
  <b><font color=#3a6797>set</font></b> res {}
  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Disabled <font color=#1b1baa>$TID</font>]} {
    <b><font color=#3a6797>set</font></b> imagemark {}
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$wb2</font> ne {}} {<font color=#1b1baa>$wb2</font> configure <font color=#653760>-state</font> disabled}
    <b><font color=#3a6797>set</font></b> res <font color=#8b2a0e>&quot; -foreground <font color=#1b1baa>$</font>fgdsbl&quot;</font>
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$withbg</font>} {<b><font color=#3a6797>append</font></b> res <font color=#8b2a0e>&quot; -background <font color=#1b1baa>$</font>bgdsbl&quot;</font>}
  } <b><font color=#3a6797>elseif</font></b> {[<b><font color=#3a6797>lsearch</font></b> <font color=#1b1baa>$marktabs</font> <font color=#1b1baa>$TID</font>]&gt;-1} {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$imagemark</font> eq {}} {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$fgm</font> eq {}} {<b><font color=#3a6797>set</font></b> fgm <font color=#1b1baa>$fgmain</font>}  ;<i><font color=#4b5d50># empty value - no markable tabs</font></i>
      <b><font color=#3a6797>set</font></b> res <font color=#8b2a0e>&quot; -foreground <font color=#1b1baa>$</font>fgm&quot;</font>
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$withbg</font>} {
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$bgm</font> eq {}} {<b><font color=#3a6797>set</font></b> bgm <font color=#1b1baa>$bgmain</font>}
        <b><font color=#3a6797>append</font></b> res <font color=#8b2a0e>&quot; -background <font color=#1b1baa>$</font>bgm&quot;</font>
      }
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$wb2</font> ne {}} {<font color=#1b1baa>$wb2</font> configure <font color=#653760>-image</font> bts_ImgNone}
    }
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> imagemark {}
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>lsearch</font></b> <font color=#653760>-index</font> 0 <font color=#1b1baa>$imagetabs</font> <font color=#1b1baa>$TID</font>]]&gt;-1} {
      <b><font color=#3a6797>set</font></b> imagemark [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$imagetabs</font> <font color=#1b1baa>$i</font> 1]
    } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$wb2</font> ne {}} {
      <font color=#1b1baa>$wb2</font> configure <font color=#653760>-image</font> bts_ImgNone
    }
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$imagemark</font> ne {}} {
    <b><font color=#3a6797>set</font></b> res <font color=#8b2a0e>&quot; -image <font color=#1b1baa>$</font>imagemark&quot;</font>
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$wb2</font> ne {}} {
      <font color=#1b1baa>$wb2</font> configure {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$res</font>
      <b><font color=#3a6797>catch</font></b> {<font color=#1b1baa>$wb2</font> configure <font color=#653760>-style</font> ClButton<font color=#1b1baa>$BID</font>}
    }
  }
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$res</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_SelAttrs></a>
<b><font color=#ca14ca>method</font></b> Tab_SelAttrs {fnt fgsel bgsel} {
<i><font color=#4b5d50># Gets font attributes of selected tab.</font></i>
<i><font color=#4b5d50>#   fnt - original font attributes</font></i>
<i><font color=#4b5d50>#   fgsel - foreground for selection</font></i>
<i><font color=#4b5d50>#   bgsel - background for selection</font></i>
<i><font color=#4b5d50># If both set, fgsel and bgsel mean colors</font></i>
<i><font color=#4b5d50># If bgsel==&quot;&quot;, fgsel!=&quot;&quot;, fgsel is a widget to get attributes</font></i>
<i><font color=#4b5d50># If fgsel==&quot;&quot;, 'selection' is 'underlining'</font></i>

  <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$fnt</font> opt val
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$fgsel</font> eq {}} {
    <b><font color=#3a6797>set</font></b> val [<b><font color=#3a6797>dict</font></b> set val <font color=#653760>-underline</font> 1]
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$bgsel</font> eq {}} {
      <b><font color=#3a6797>set</font></b> bgsel [<b><font color=#134070>ttk::style</font></b> configure <font color=#1b1baa>$fgsel</font> <font color=#653760>-selectbackground</font>]
      <b><font color=#3a6797>set</font></b> fgsel [<b><font color=#134070>ttk::style</font></b> configure <font color=#1b1baa>$fgsel</font> <font color=#653760>-selectforeground</font>]
    }
    <b><font color=#3a6797>set</font></b> opt <font color=#8b2a0e>&quot;-foreground <font color=#1b1baa>$</font>fgsel -background <font color=#1b1baa>$</font>bgsel <font color=#1b1baa>$</font>opt&quot;</font>
  }
  <b><font color=#ca14ca>return</font></b> <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>opt <font color=#1b1baa>{$</font>val<font color=#1b1baa>}</font>&quot;</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_MarkBar></a>
<b><font color=#ca14ca>method</font></b> Tab_MarkBar {BID {TID <font color=#8b2a0e>&quot;-1&quot;</font>}} {
<i><font color=#4b5d50># Marks the tabs of a bar .</font></i>
<i><font color=#4b5d50>#   TID - ID of the current tab</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-tabcurrent</font> <font color=#653760>-fgsel</font> <font color=#653760>-bgsel</font> <font color=#653760>-select</font> <font color=#653760>-FGMAIN</font> <font color=#653760>-BGMAIN</font>] \
    tID fgs bgs fewsel fgm bgm
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$TID</font> in {{} {-1}}} {<b><font color=#3a6797>set</font></b> TID <font color=#1b1baa>$tID</font>}
  <b><font color=#3a6797>foreach</font></b> tab [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> listTab] {
    <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$tab</font> tID text wb wb1 wb2
    <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Tab_Is <font color=#1b1baa>$wb</font>]} {
      <b><font color=#3a6797>set</font></b> font [<b><font color=#ca14ca>my</font></b> Tab_Font <font color=#1b1baa>$BID</font>]
      <b><font color=#3a6797>set</font></b> selected [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$tID</font> == <font color=#1b1baa>$TID</font> || [<b><font color=#3a6797>lsearch</font></b> <font color=#1b1baa>$fewsel</font> <font color=#1b1baa>$tID</font>]&gt;-1}]
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$selected</font>} {<b><font color=#3a6797>set</font></b> font [<b><font color=#ca14ca>my</font></b> Tab_SelAttrs <font color=#1b1baa>$font</font> <font color=#1b1baa>$fgs</font> <font color=#1b1baa>$bgs</font>]}
      <font color=#1b1baa>$wb1</font> configure {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$font</font>
      <b><font color=#3a6797>set</font></b> attrs [<b><font color=#ca14ca>my</font></b> Tab_MarkAttrs <font color=#1b1baa>$BID</font> <font color=#1b1baa>$tID</font> [<b><font color=#3a6797>expr</font></b> {!<font color=#1b1baa>$selected</font>}] <font color=#1b1baa>$wb2</font>]
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$attrs</font> ne {} && {<font color=#653760>-image</font>} ni <font color=#1b1baa>$attrs</font> } {
        <font color=#1b1baa>$wb1</font> configure {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$attrs</font>
      } <b><font color=#3a6797>elseif</font></b> {!<font color=#1b1baa>$selected</font>} {
        <font color=#1b1baa>$wb1</font> configure <font color=#653760>-foreground</font> <font color=#1b1baa>$fgm</font> <font color=#653760>-background</font> <font color=#1b1baa>$bgm</font>
      }
    }
  }
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-tabcurrent</font> <font color=#1b1baa>$TID</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_MarkBars></a>
<b><font color=#ca14ca>method</font></b> Tab_MarkBars {{BID -1} {TID -1}} {
<i><font color=#4b5d50># Marks the tabs.</font></i>
<i><font color=#4b5d50>#   BID - bar ID (if omitted, all bars are scanned)</font></i>
<i><font color=#4b5d50>#   TID - ID of the current tab</font></i>

  <b><font color=#3a6797>variable</font></b> btData
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$BID</font> == -1} {
    <b><font color=#3a6797>dict</font></b> for {BID barOpts} <font color=#1b1baa>$btData</font> {<b><font color=#ca14ca>my</font></b> Tab_MarkBar <font color=#1b1baa>$BID</font>}
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#ca14ca>my</font></b> Tab_MarkBar <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font>
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_TextEllipsed></a>
<b><font color=#ca14ca>method</font></b> Tab_TextEllipsed {BID text {lneed -1}} {
<i><font color=#4b5d50># Returns a tab's label and tip.</font></i>
<i><font color=#4b5d50>#   text - label</font></i>
<i><font color=#4b5d50>#   lneed - label length anyway</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-lablen</font> <font color=#653760>-ELLIPSE</font>] lablen ellipse
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$lneed</font> ne -1} {<b><font color=#3a6797>set</font></b> lablen <font color=#1b1baa>$lneed</font>}
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$lablen</font> && [<b><font color=#3a6797>string</font></b> length <font color=#1b1baa>$text</font>]&gt;<font color=#1b1baa>$lablen</font>} {
    <b><font color=#3a6797>set</font></b> ttip <font color=#1b1baa>$text</font>
    <b><font color=#3a6797>set</font></b> text [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$text</font> 0 <font color=#1b1baa>$lablen</font>-1]
    <b><font color=#3a6797>append</font></b> text <font color=#1b1baa>$ellipse</font>
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> ttip {}
  }
  <b><font color=#3a6797>list</font></b> <font color=#1b1baa>$text</font> <font color=#1b1baa>$ttip</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_Iconic></a>
<b><font color=#ca14ca>method</font></b> Tab_Iconic {BID} {
<i><font color=#4b5d50># Gets a flag &quot;tabs with icons&quot;.</font></i>
<i><font color=#4b5d50># Returns &quot;yes&quot;, if tabs are supplied with icons.</font></i>

  <b><font color=#3a6797>expr</font></b> {![<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-static</font>]}
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_Pack></a>
<b><font color=#ca14ca>method</font></b> Tab_Pack {BID TID wb wb1 wb2} {

<i><font color=#4b5d50># Packs a tab widget.</font></i>
<i><font color=#4b5d50>#   wb, wb1, wb2 - tab's widgets</font></i>
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-static</font> <font color=#653760>-expand</font>] static expand
  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Tab_Iconic <font color=#1b1baa>$BID</font>]} {
    <b><font color=#134070>pack</font></b> <font color=#1b1baa>$wb1</font> <font color=#653760>-side</font> left
    <b><font color=#134070>pack</font></b> <font color=#1b1baa>$wb2</font> <font color=#653760>-side</font> left
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#134070>pack</font></b> <font color=#1b1baa>$wb1</font> <font color=#653760>-side</font> left <font color=#653760>-fill</font> x
    <b><font color=#134070>pack</font></b> forget <font color=#1b1baa>$wb2</font>
  }
  <b><font color=#3a6797>set</font></b> expand [<b><font color=#ca14ca>my</font></b> Tab_ExpandOption <font color=#1b1baa>$BID</font> <font color=#1b1baa>$expand</font>]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$expand</font>} {
    <b><font color=#134070>pack</font></b> <font color=#1b1baa>$wb</font> <font color=#653760>-side</font> left <font color=#653760>-fill</font> x <font color=#653760>-expand</font> 1
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#134070>pack</font></b> <font color=#1b1baa>$wb</font> <font color=#653760>-side</font> left
  }
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> configure <font color=#653760>-pf</font> <font color=#8b2a0e>&quot;p&quot;</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_RemoveLinks></a>
<b><font color=#ca14ca>method</font></b> Tab_RemoveLinks {BID TID} {
<i><font color=#4b5d50># Removes a tab's links to lists.</font></i>

  <b><font color=#3a6797>foreach</font></b> o {<font color=#653760>-IMAGETABS</font> <font color=#653760>-TABCOM</font> <font color=#653760>-mark</font> <font color=#653760>-disable</font> <font color=#653760>-select</font>} {
    <b><font color=#3a6797>set</font></b> l [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#1b1baa>$o</font>]
    <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i 0} {<font color=#1b1baa>$i</font>&gt;-1} {} {
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>lsearch</font></b> <font color=#653760>-index</font> 0 <font color=#1b1baa>$l</font> <font color=#1b1baa>$TID</font>]]&gt;-1} {
        <b><font color=#3a6797>set</font></b> l [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$l</font> <font color=#1b1baa>$i</font> <font color=#1b1baa>$i</font>]
        <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#1b1baa>$o</font> <font color=#1b1baa>$l</font>
      }
    }
  }
  <b><font color=#ca14ca>my</font></b> Tab_MarkBars <font color=#1b1baa>$BID</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_Is></a>
<b><font color=#ca14ca>method</font></b> Tab_Is {wb} {
<i><font color=#4b5d50># Checks if 'wb' is an existing tab widget.</font></i>
<i><font color=#4b5d50>#   wb - path</font></i>

  <b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$wb</font> ne {} && [<b><font color=#134070>winfo</font></b> exists <font color=#1b1baa>$wb</font>]}
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_CloseFew></a>
<b><font color=#ca14ca>method</font></b> Tab_CloseFew {{TID -1} {left no} args} {
<i><font color=#4b5d50># Closes tabs of bar.</font></i>
<i><font color=#4b5d50>#   TID - ID of the current tab or -1 if to close all</font></i>
<i><font color=#4b5d50>#   left - &quot;yes&quot; if to close all at left of TID, &quot;no&quot; if at right</font></i>
<i><font color=#4b5d50>#   args - options (if contains -skipsel, selected tabs aren't closed)</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$TID</font> ne {-1}} {<b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_BID <font color=#1b1baa>$TID</font>] BID icur}
  <b><font color=#3a6797>set</font></b> tabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> listTab]
  <b><font color=#3a6797>set</font></b> skipsel [<b><font color=#3a6797>expr</font></b> {[<b><font color=#3a6797>lsearch</font></b> <font color=#1b1baa>$args</font> <font color=#653760>-skipsel</font>]&gt;-1}]
  <b><font color=#3a6797>set</font></b> seltabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-select</font>]
  <b><font color=#3a6797>set</font></b> doupdate no
  <b><font color=#3a6797>set</font></b> first 1
  <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$tabs</font>]} {<font color=#1b1baa>$i</font>} {} {
    <b><font color=#3a6797>incr</font></b> i -1
    <b><font color=#3a6797>set</font></b> tID [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font> 0]
    <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$skipsel</font> || <font color=#1b1baa>$tID</font> ni <font color=#1b1baa>$seltabs</font>} {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$TID</font> eq {-1} || (<font color=#1b1baa>$left</font> && <font color=#1b1baa>$i</font>&lt;<font color=#1b1baa>$icur</font>) || (!<font color=#1b1baa>$left</font> && <font color=#1b1baa>$i</font>&gt;<font color=#1b1baa>$icur</font>)} {
        <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>set</font></b> res [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$tID</font> close no <font color=#653760>-first</font> <font color=#1b1baa>$first</font>]]} <b><font color=#ca14ca>break</font></b>
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$res</font>==1} {<b><font color=#3a6797>set</font></b> doupdate yes}
        <b><font color=#3a6797>set</font></b> first 0  ;<i><font color=#4b5d50># -first option is &quot;1&quot; for the very first closed tab</font></i>
      }
    }
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$doupdate</font>} {
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> clear
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$TID</font> eq {-1}} {
      <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Refill 0 yes
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font> show yes
    }
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=PrepareCmd></a>
<b><font color=#ca14ca>method</font></b> PrepareCmd {TID BID opt args} {
<i><font color=#4b5d50># Prepares a command bound to an action on a tab.</font></i>
<i><font color=#4b5d50>#   opt - command option (-csel, -cmov, -cdel)</font></i>
<i><font color=#4b5d50>#   args - additional argumens of the command</font></i>
<i><font color=#4b5d50># The commands can include wildcards: %b for bar ID, %t for tab ID, %l for tab label.</font></i>
<i><font color=#4b5d50># Returns &quot;&quot; or the command if 'opt' exists in 'args'.</font></i>

  <b><font color=#3a6797>variable</font></b> btData
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>dict</font></b> exists <font color=#1b1baa>$btData</font> <font color=#1b1baa>$BID</font> <font color=#1b1baa>$opt</font>]} {
    <b><font color=#3a6797>set</font></b> com [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$btData</font> <font color=#1b1baa>$BID</font> <font color=#1b1baa>$opt</font>]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$TID</font>&gt;-1} {
      <b><font color=#3a6797>set</font></b> label [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-text</font>]
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> label {}
    }
    <b><font color=#3a6797>set</font></b> label [<b><font color=#3a6797>string</font></b> map {\{ ( \} )} <font color=#1b1baa>$label</font>]
    <b><font color=#3a6797>lappend</font></b> com {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
    <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %b <font color=#1b1baa>$BID</font> %t <font color=#1b1baa>$TID</font> %l <font color=#1b1baa>$label</font>] <font color=#1b1baa>$com</font>]
  }
  <b><font color=#ca14ca>return</font></b> {}
}

<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_Cmd></a>
<b><font color=#ca14ca>method</font></b> Tab_Cmd {opt args} {
<i><font color=#4b5d50># Executes a command bound to an action on a tab.</font></i>
<i><font color=#4b5d50>#   opt - command option (-csel, -cmov, -cdel)</font></i>
<i><font color=#4b5d50>#   args - additional argumens of the command</font></i>
<i><font color=#4b5d50># The commands can include wildcards: %b for bar ID, %t for tab ID, %l for tab label.</font></i>
<i><font color=#4b5d50># Returns 1, if no command set; otherwise: 1 for Yes, 0 for No, -1 for Cancel.</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> IDs [<b><font color=#ca14ca>my</font></b> ID]] TID BID
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> com [<b><font color=#ca14ca>my</font></b> PrepareCmd <font color=#1b1baa>$TID</font> <font color=#1b1baa>$BID</font> <font color=#1b1baa>$opt</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>]] ne {}} {
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> res [{<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$com</font>]}]} {<b><font color=#3a6797>set</font></b> res yes}
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$res</font> eq {} || !<font color=#1b1baa>$res</font>} {<b><font color=#ca14ca>return</font></b> 0}
    <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$res</font>
  }
  <b><font color=#ca14ca>return</font></b> 1
}

<i><font color=#4b5d50>#_______________________</font></i>
<a id=Tab_BeCurrent></a>
<b><font color=#ca14ca>method</font></b> Tab_BeCurrent {} {
<i><font color=#4b5d50># Makes the tab be currently visible.</font></i>

  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> TID [<b><font color=#ca14ca>my</font></b> ID]] in {{} {-1}} || [<b><font color=#ca14ca>my</font></b> Disabled <font color=#1b1baa>$TID</font>]} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-BID</font>]
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> Tab_Cmd <font color=#653760>-csel</font>  ;<i><font color=#4b5d50># command before the selection shown</font></i>
  <b><font color=#ca14ca>my</font></b> Tab_MarkBar <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font>
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> wb2 [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-wb2</font>]] ne {} && \
  ![<b><font color=#3a6797>string</font></b> match *bartabs::* [<font color=#1b1baa>$wb2</font> cget <font color=#653760>-image</font>]] &&
  <font color=#1b1baa>$TID</font> ni [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> listFlag <font color=#8b2a0e>&quot;m&quot;</font>]} {
    <font color=#1b1baa>$wb2</font> configure <font color=#653760>-image</font> bts_ImgNone
  }
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Bar_Cmd2 <font color=#653760>-csel2</font> <font color=#1b1baa>$TID</font> ;<i><font color=#4b5d50># command after the selection shown</font></i>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Disabled></a>
<b><font color=#ca14ca>method</font></b> Disabled {TID} {
  <i><font color=#4b5d50># Checks if the tab is disabled.</font></i>

  <b><font color=#3a6797>set</font></b> dsbltabs [<b><font color=#ca14ca>my</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-BID</font>] cget <font color=#653760>-disable</font>]
  <b><font color=#3a6797>expr</font></b> {[<b><font color=#3a6797>lsearch</font></b> <font color=#1b1baa>$dsbltabs</font> <font color=#1b1baa>$TID</font>]&gt;-1}
}
<a id=Event_handlers></a>
<i><font color=#4b5d50>## ____________ Event handlers ____________ ##</font></i>
<a id=DestroyMoveWindow></a>
<b><font color=#ca14ca>method</font></b> DestroyMoveWindow {} {
  <i><font color=#4b5d50># Destroys the moving window zombi.</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>set</font></b> movWin [<b><font color=#3a6797>lindex</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-MOVWIN</font>] 0]
  <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>destroy</font></b> <font color=#1b1baa>$movWin</font>}
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-MOVX</font> {} <font color=#653760>-wb1</font> {}
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=OnEnterTab></a>
<b><font color=#ca14ca>method</font></b> OnEnterTab {TID wb1 wb2 fgo bgo} {
<i><font color=#4b5d50># Handles the mouse pointer entering a tab.</font></i>
<i><font color=#4b5d50>#   wb1, wb2 - tab's widgets</font></i>
<i><font color=#4b5d50>#   fgo, bgo - colors of &quot;mouse over the tab&quot;</font></i>

  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Disabled <font color=#1b1baa>$TID</font>]} <b><font color=#ca14ca>return</font></b>
  <font color=#1b1baa>$wb1</font> configure <font color=#653760>-foreground</font> <font color=#1b1baa>$fgo</font> <font color=#653760>-background</font> <font color=#1b1baa>$bgo</font>
  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Tab_Iconic [<b><font color=#ca14ca>my</font></b> ID]]} {<font color=#1b1baa>$wb2</font> configure <font color=#653760>-image</font> bts_ImgClose}
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=OnLeaveTab></a>
<b><font color=#ca14ca>method</font></b> OnLeaveTab {wb1 wb2} {
<i><font color=#4b5d50># Handles the mouse pointer leaving a tab.</font></i>
<i><font color=#4b5d50>#   wb1, wb2 - tab's widgets</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> IDs [<b><font color=#ca14ca>my</font></b> ID]] TID BID
  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Disabled <font color=#1b1baa>$TID</font>]} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>if</font></b> {![<b><font color=#134070>winfo</font></b> exists <font color=#1b1baa>$wb1</font>]} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-FGMAIN</font> <font color=#653760>-BGMAIN</font>] fgm bgm
  <font color=#1b1baa>$wb1</font> configure <font color=#653760>-foreground</font> <font color=#1b1baa>$fgm</font> <font color=#653760>-background</font> <font color=#1b1baa>$bgm</font>
  <b><font color=#ca14ca>my</font></b> Tab_MarkBars <font color=#1b1baa>$BID</font>
  <b><font color=#3a6797>if</font></b> {<font color=#8b2a0e>&quot;-image&quot;</font> ni [<b><font color=#3a6797>set</font></b> attrs [<b><font color=#ca14ca>my</font></b> Tab_MarkAttrs <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font> 0 <font color=#1b1baa>$wb2</font>]] && \
  [<b><font color=#ca14ca>my</font></b> Tab_Iconic <font color=#1b1baa>$BID</font>]} {
    <font color=#1b1baa>$wb2</font> configure <font color=#653760>-image</font> bts_ImgNone
    <b><font color=#3a6797>catch</font></b> {<font color=#1b1baa>$wb2</font> configure <font color=#653760>-style</font> ClButton<font color=#1b1baa>$BID</font>}
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=OnButtonPress></a>
<b><font color=#ca14ca>method</font></b> OnButtonPress {TID wb1 x} {
<i><font color=#4b5d50># Handles the mouse clicking a tab.</font></i>
<i><font color=#4b5d50>#   wb1 - tab's label</font></i>
<i><font color=#4b5d50>#   x - x position of the mouse pointer</font></i>

  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Disabled <font color=#1b1baa>$TID</font>]} <b><font color=#ca14ca>return</font></b>
  <b><font color=#ca14ca>my</font></b> [<b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]] configure <font color=#653760>-MOVX</font> <font color=#1b1baa>$x</font>
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$TID</font> eq {}} {<b><font color=#3a6797>set</font></b> TID [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> tabID [<font color=#1b1baa>$wb1</font> cget <font color=#653760>-text</font>]]}
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> Tab_BeCurrent
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=OnButtonMotion></a>
<b><font color=#ca14ca>method</font></b> OnButtonMotion {wb wb1 x y} {
<i><font color=#4b5d50># Handles the mouse moving over a tab.</font></i>
<i><font color=#4b5d50>#   wb - tab's frame</font></i>
<i><font color=#4b5d50>#   wb1 - tab's label</font></i>
<i><font color=#4b5d50>#   x, y - positions of the mouse pointer</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> [<b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]] cget \
    <font color=#653760>-static</font> <font color=#653760>-FGMAIN</font> <font color=#653760>-FGOVER</font> <font color=#653760>-BGOVER</font> <font color=#653760>-MOVWIN</font> <font color=#653760>-MOVX</font> <font color=#653760>-MOVX0</font> <font color=#653760>-MOVX1</font> <font color=#653760>-MOVY0</font>] \
    static fgm fgo bgo movWin movX movx movx1 movY0
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$movX</font> eq {} || <font color=#1b1baa>$static</font>} <b><font color=#ca14ca>return</font></b>
  <i><font color=#4b5d50># dragging the tab</font></i>
  <b><font color=#3a6797>if</font></b> {![<b><font color=#134070>winfo</font></b> exists <font color=#1b1baa>$movWin</font>]} {
    <i><font color=#4b5d50># make the tab's replica to be dragged</font></i>
    <b><font color=#134070>toplevel</font></b> <font color=#1b1baa>$movWin</font>
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$::tcl_platform(platform)</font> == <font color=#8b2a0e>&quot;windows&quot;</font>} {
      <b><font color=#134070>wm</font></b> attributes <font color=#1b1baa>$movWin</font> <font color=#653760>-alpha</font> 0.0
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#134070>wm</font></b> withdraw <font color=#1b1baa>$movWin</font>
    }
    <b><font color=#3a6797>if</font></b> {[<b><font color=#134070>tk</font></b> windowingsystem] eq <font color=#8b2a0e>&quot;aqua&quot;</font>} {
      ::tk::unsupported::MacWindowStyle style <font color=#1b1baa>$movWin</font> help none
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#134070>wm</font></b> overrideredirect <font color=#1b1baa>$movWin</font> 1
    }
    <b><font color=#3a6797>set</font></b> movx [<b><font color=#3a6797>set</font></b> movx1 <font color=#1b1baa>$x</font>]
    <b><font color=#3a6797>set</font></b> movX [<b><font color=#3a6797>expr</font></b> {[<b><font color=#134070>winfo</font></b> pointerx .]-<font color=#1b1baa>$x</font>}]
    <b><font color=#3a6797>set</font></b> movY0 [<b><font color=#3a6797>expr</font></b> {[<b><font color=#134070>winfo</font></b> pointery .]-<font color=#1b1baa>$y</font>}]
    <b><font color=#134070>label</font></b> <font color=#1b1baa>$movWin</font>.label <font color=#653760>-text</font> [<font color=#1b1baa>$wb1</font> cget <font color=#653760>-text</font>] <font color=#653760>-relief</font> solid \
      <font color=#653760>-foreground</font> black <font color=#653760>-background</font> #7eeeee  {<b><font color=#3a6797>*</font></b>}[<b><font color=#ca14ca>my</font></b> Tab_Font <font color=#1b1baa>$BID</font>]
    <b><font color=#134070>pack</font></b> <font color=#1b1baa>$movWin</font>.label <font color=#653760>-expand</font> 1 <font color=#653760>-fill</font> both <font color=#653760>-ipadx</font> 1
    <b><font color=#134070>wm</font></b> minsize <font color=#1b1baa>$movWin</font> [<b><font color=#134070>winfo</font></b> reqwidth <font color=#1b1baa>$movWin</font>.label] [<b><font color=#134070>winfo</font></b> reqheight <font color=#1b1baa>$wb1</font>]
    <b><font color=#3a6797>set</font></b> againstLooseFocus <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>BID DestroyMoveWindow&quot;</font>
    <b><font color=#134070>bind</font></b> <font color=#1b1baa>$movWin</font> &lt;Leave&gt; <font color=#1b1baa>$againstLooseFocus</font>
    <b><font color=#134070>bind</font></b> <font color=#1b1baa>$movWin</font> &lt;ButtonPress&gt; <font color=#1b1baa>$againstLooseFocus</font>
    <font color=#1b1baa>$wb1</font> configure <font color=#653760>-foreground</font> <font color=#1b1baa>$fgm</font>
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-wb1</font> <font color=#1b1baa>$wb1</font> <font color=#653760>-MOVX1</font> <font color=#1b1baa>$movx1</font> <font color=#653760>-MOVY0</font> <font color=#1b1baa>$movY0</font>
  }
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-WWID</font>] wframe wlarr
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#3a6797>split</font></b> [<b><font color=#134070>winfo</font></b> geometry <font color=#1b1baa>$wframe</font>] x+] wflen
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#3a6797>split</font></b> [<b><font color=#134070>winfo</font></b> geometry <font color=#1b1baa>$wlarr</font>] x+] walen
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#3a6797>split</font></b> [<b><font color=#134070>winfo</font></b> geometry <font color=#1b1baa>$wb</font>] x+] wbl - wbx
  <b><font color=#3a6797>if</font></b> {abs(<font color=#1b1baa>$x</font>-<font color=#1b1baa>$movx</font>)&gt;1 && (<font color=#1b1baa>$wflen</font>-<font color=#1b1baa>$wbx</font>+<font color=#1b1baa>$movx1</font>+<font color=#1b1baa>$walen</font>)&gt;<font color=#1b1baa>$x</font> && (<font color=#1b1baa>$wbx</font>+<font color=#1b1baa>$wbl</font>-<font color=#1b1baa>$movx1</font>+<font color=#1b1baa>$x</font>)&gt;0} {
    <b><font color=#134070>wm</font></b> geometry <font color=#1b1baa>$movWin</font> +<font color=#1b1baa>$movX</font>+<font color=#1b1baa>$movY0</font>
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$::tcl_platform(platform)</font> == <font color=#8b2a0e>&quot;windows&quot;</font>} {
      <b><font color=#3a6797>if</font></b> {[<b><font color=#134070>wm</font></b> attributes <font color=#1b1baa>$movWin</font> <font color=#653760>-alpha</font>] &lt; 0.1} {<b><font color=#134070>wm</font></b> attributes <font color=#1b1baa>$movWin</font> <font color=#653760>-alpha</font> 1.0}
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>wm</font></b> deiconify <font color=#1b1baa>$movWin</font> ; <b><font color=#134070>raise</font></b> <font color=#1b1baa>$movWin</font>}
    }
  }
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-MOVX</font> [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$movX</font>+<font color=#1b1baa>$x</font>-<font color=#1b1baa>$movx</font>}] <font color=#653760>-MOVX0</font> <font color=#1b1baa>$x</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=OnButtonRelease></a>
<b><font color=#ca14ca>method</font></b> OnButtonRelease {wb1o x} {
<i><font color=#4b5d50># Handles the mouse releasing a tab.</font></i>
<i><font color=#4b5d50>#   wb1o - original tab's label</font></i>
<i><font color=#4b5d50>#   x - x position of the mouse pointer</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> [<b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]] cget \
    <font color=#653760>-MOVWIN</font> <font color=#653760>-MOVX</font> <font color=#653760>-MOVX1</font> <font color=#653760>-MOVY0</font> <font color=#653760>-FGMAIN</font> <font color=#653760>-wb1</font> <font color=#653760>-tleft</font> <font color=#653760>-tright</font> <font color=#653760>-wbar</font> <font color=#653760>-static</font>] \
    movWin movX movx1 movY0 fgm wb1 tleft tright wbar static
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> DestroyMoveWindow
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$movX</font> eq {} || <font color=#1b1baa>$wb1o</font> ne <font color=#1b1baa>$wb1</font> || <font color=#1b1baa>$static</font>} <b><font color=#ca14ca>return</font></b>
  <i><font color=#4b5d50># dropping the tab - find a tab being dropped at</font></i>
  <font color=#1b1baa>$wb1</font> configure <font color=#653760>-foreground</font> <font color=#1b1baa>$fgm</font>
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Aux_InitDraw <font color=#1b1baa>$BID</font> no] bwidth vislen bd arrlen llen
  <b><font color=#3a6797>set</font></b> vislen1 <font color=#1b1baa>$vislen</font>
  <b><font color=#3a6797>set</font></b> vlist [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>set</font></b> i 0
  <b><font color=#3a6797>set</font></b> iw1 -1
  <b><font color=#3a6797>set</font></b> tabssav [<b><font color=#3a6797>set</font></b> tabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-TABS</font>]]
  <b><font color=#3a6797>foreach</font></b> tab <font color=#1b1baa>$tabs</font> {
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_DictItem <font color=#1b1baa>$tab</font>] tID text _wb _wb1 _wb2 _pf
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$_pf</font> ne {}} {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$_wb1</font> eq <font color=#1b1baa>$wb1</font>} {
        <b><font color=#3a6797>set</font></b> vislen0 <font color=#1b1baa>$vislen</font>
        <b><font color=#3a6797>set</font></b> tab1 <font color=#1b1baa>$tab</font>
        <b><font color=#3a6797>set</font></b> iw1 <font color=#1b1baa>$i</font>
        <b><font color=#3a6797>set</font></b> TID <font color=#1b1baa>$tID</font>
      }
      <b><font color=#3a6797>set</font></b> wl [<b><font color=#3a6797>expr</font></b> {[<b><font color=#134070>winfo</font></b> reqwidth <font color=#1b1baa>$_wb1</font>]+[<b><font color=#134070>winfo</font></b> reqwidth <font color=#1b1baa>$_wb2</font>]}]
      <b><font color=#3a6797>lappend</font></b> vlist [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$i</font> <font color=#1b1baa>$vislen</font> <font color=#1b1baa>$wl</font>]
      <b><font color=#3a6797>incr</font></b> vislen <font color=#1b1baa>$wl</font>
    }
    <b><font color=#3a6797>incr</font></b> i
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$iw1</font>==-1} <b><font color=#ca14ca>return</font></b>  ;<i><font color=#4b5d50># for sure</font></i>
  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> Tab_Cmd <font color=#653760>-cmov</font>] ni {<font color=#8b2a0e>&quot;1&quot;</font> <font color=#8b2a0e>&quot;yes&quot;</font> <font color=#8b2a0e>&quot;true&quot;</font>}} <b><font color=#ca14ca>return</font></b> ;<i><font color=#4b5d50># chosen to not move</font></i>
  <b><font color=#3a6797>set</font></b> vislen2 [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$vislen0</font>+<font color=#1b1baa>$x</font>-<font color=#1b1baa>$movx1</font>}]
  <b><font color=#3a6797>foreach</font></b> vl <font color=#1b1baa>$vlist</font> {
    <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$vl</font> i vislen wl
    <b><font color=#3a6797>set</font></b> rightest [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$i</font>==<font color=#1b1baa>$tright</font> && <font color=#1b1baa>$vislen2</font>&gt;(10+<font color=#1b1baa>$vislen</font>)}]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$iw1</font>==(<font color=#1b1baa>$i</font>+1) && <font color=#1b1baa>$x</font>&lt;0} {<b><font color=#3a6797>incr</font></b> vislen2 <font color=#1b1baa>$wl</font>}
    <b><font color=#3a6797>if</font></b> {(<font color=#1b1baa>$vislen</font>&gt;<font color=#1b1baa>$vislen2</font> || <font color=#1b1baa>$rightest</font>)} {
      <b><font color=#3a6797>set</font></b> tabs [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$iw1</font> <font color=#1b1baa>$iw1</font>]
      <b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$rightest</font>||<font color=#1b1baa>$iw1</font>&gt;<font color=#1b1baa>$i</font>?<font color=#1b1baa>$i:$i</font>-1}]
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$rightest</font> && <font color=#1b1baa>$i</font>&lt;(<font color=#1b1baa>$llen</font>-1) && <font color=#1b1baa>$i</font>==<font color=#1b1baa>$iw1</font>} {<b><font color=#3a6797>incr</font></b> i}
      <b><font color=#3a6797>set</font></b> tabs [<b><font color=#3a6797>linsert</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font> <font color=#1b1baa>$tab1</font>]
      <b><font color=#3a6797>set</font></b> left yes
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$rightest</font>} {
        <b><font color=#3a6797>set</font></b> left no
        <b><font color=#3a6797>set</font></b> tleft <font color=#1b1baa>$i</font>
      } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$i</font>&lt;<font color=#1b1baa>$tleft</font>} {
        <b><font color=#3a6797>set</font></b> tleft <font color=#1b1baa>$i</font>
      }
      <b><font color=#ca14ca>break</font></b>
    }
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tabssav</font> ne <font color=#1b1baa>$tabs</font>} {
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-TABS</font> <font color=#1b1baa>$tabs</font>
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Refill <font color=#1b1baa>$tleft</font> <font color=#1b1baa>$left</font>
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Bar_Cmd2 <font color=#653760>-cmov2</font> <font color=#1b1baa>$TID</font> ;<i><font color=#4b5d50># command after the action</font></i>
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=OnCtrlClick></a>
<b><font color=#ca14ca>method</font></b> OnCtrlClick {} {
<i><font color=#4b5d50># Handles a selection of tabs with Ctrl+click.</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> IDs [<b><font color=#ca14ca>my</font></b> ID]] TID BID
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-static</font> <font color=#653760>-select</font>] static fewsel
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$static</font>} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>lsearch</font></b> <font color=#1b1baa>$fewsel</font> <font color=#1b1baa>$TID</font>]]&gt;-1} {
    <b><font color=#3a6797>set</font></b> fewsel [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$fewsel</font> <font color=#1b1baa>$i</font> <font color=#1b1baa>$i</font>]
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>lappend</font></b> fewsel <font color=#1b1baa>$TID</font>
  }
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-select</font> <font color=#1b1baa>$fewsel</font>
  <b><font color=#ca14ca>my</font></b> Tab_MarkBar <font color=#1b1baa>$BID</font>
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Bar_Cmd2 <font color=#653760>-csel3</font> <font color=#1b1baa>$TID</font> ;<i><font color=#4b5d50># command after the action</font></i>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=OnPopup></a>
<b><font color=#ca14ca>method</font></b> OnPopup {X Y {BID <font color=#8b2a0e>&quot;-1&quot;</font>} {TID <font color=#8b2a0e>&quot;-1&quot;</font>} {textcur <font color=#8b2a0e>&quot;&quot;</font>}} {
<i><font color=#4b5d50># Handles the mouse right-clicking on a tab.</font></i>
<i><font color=#4b5d50>#   X, Y - positions of the mouse pointer</font></i>

  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$BID</font> eq <font color=#8b2a0e>&quot;-1&quot;</font>} {
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> IDs [<b><font color=#ca14ca>my</font></b> ID]] TID BID
    <b><font color=#3a6797>set</font></b> textcur [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-text</font>]
  }
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-wbar</font> <font color=#653760>-menu</font> <font color=#653760>-USERMNU</font> <font color=#653760>-UMNU</font> <font color=#653760>-TABS</font> <font color=#653760>-static</font> <font color=#653760>-hidearrows</font> <font color=#653760>-WWID</font>] \
    wbar popup usermnu popup0 tabs static hidearr wwid
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$static</font> && <font color=#1b1baa>$hidearr</font> && !<font color=#1b1baa>$usermnu</font>} {
    <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$wwid</font> wframe wlarr wrarr
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#134070>pack</font></b> info <font color=#1b1baa>$wlarr</font>}] && [<b><font color=#3a6797>catch</font></b> {<b><font color=#134070>pack</font></b> info <font color=#1b1baa>$wrarr</font>}]} {
      <b><font color=#ca14ca>return</font></b> ;<i><font color=#4b5d50># static absolutely</font></i>
    }
  }
  <b><font color=#3a6797>set</font></b> pop <font color=#1b1baa>$wbar</font>.popupMenu
  <b><font color=#3a6797>if</font></b> {[<b><font color=#134070>winfo</font></b> exist <font color=#1b1baa>$pop</font>]} {<b><font color=#134070>destroy</font></b> <font color=#1b1baa>$pop</font>}
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-LOCKDRAW</font> 1
  <b><font color=#134070>menu</font></b> <font color=#1b1baa>$pop</font> <font color=#653760>-tearoff</font> 0
  <b><font color=#3a6797>set</font></b> ipops [<b><font color=#3a6797>set</font></b> lpops [<b><font color=#3a6797>list</font></b>]]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$TID</font> eq <font color=#8b2a0e>&quot;-1&quot;</font>} {
    <b><font color=#3a6797>set</font></b> popup [<b><font color=#3a6797>list</font></b> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$popup</font> 0] s {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$popup0</font>]  ;<i><font color=#4b5d50># let &quot;List&quot; be in</font></i>
  }
  <b><font color=#3a6797>foreach</font></b> p <font color=#1b1baa>$popup</font> {
    <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$p</font> typ label comm menu dsbl tip var
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$menu</font> ne {}} {<b><font color=#3a6797>set</font></b> popc <font color=#1b1baa>$pop</font>.<font color=#1b1baa>$menu</font>} {<b><font color=#3a6797>set</font></b> popc <font color=#1b1baa>$pop</font>}
    <b><font color=#3a6797>foreach</font></b> opt {<b><font color=#134070>label</font></b> comm menu dsbl} {
      <b><font color=#3a6797>set</font></b> <font color=#1b1baa>$opt</font> [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %b <font color=#1b1baa>$BID</font> %t <font color=#1b1baa>$TID</font> %l <font color=#1b1baa>$textcur</font>] [<b><font color=#3a6797>set</font></b> <font color=#1b1baa>$opt</font>]]
    }
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>info</font></b> commands [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$dsbl</font> 0]] ne {}} {
      ;<i><font color=#4b5d50># 0/1/2 image label hotkey</font></i>
      <b><font color=#3a6797>lassign</font></b> [{<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$dsbl</font> <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font> <font color=#1b1baa>$label</font>] dsbl comimg comlabel hotk
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$dsbl</font> dsbl comimg comlabel hotk
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$dsbl</font> ne {}} {<b><font color=#3a6797>set</font></b> dsbl [<b><font color=#3a6797>expr</font></b> <font color=#1b1baa>$dsbl</font>]}
      <b><font color=#3a6797>set</font></b> dsbl [<b><font color=#3a6797>expr</font></b> {([<b><font color=#3a6797>string</font></b> is boolean <font color=#1b1baa>$dsbl</font>] && <font color=#1b1baa>$dsbl</font> ne {})?<font color=#1b1baa>$dsbl:0</font>}]
    }
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$dsbl</font> eq {2}} <b><font color=#ca14ca>continue</font></b>  ;<i><font color=#4b5d50># 2 - &quot;hide&quot;; 1 - &quot;disable&quot;; 0 - &quot;normal&quot;</font></i>
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$dsbl</font>} {<b><font color=#3a6797>set</font></b> dsbl {<font color=#653760>-state</font> disabled}} {<b><font color=#3a6797>set</font></b> dsbl {}}
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$comimg</font> ne {}} {<b><font color=#3a6797>set</font></b> comimg <font color=#8b2a0e>&quot;-image <font color=#1b1baa>$</font>comimg&quot;</font>}
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$comlabel</font> ne {}} {<b><font color=#3a6797>set</font></b> label <font color=#1b1baa>$comlabel</font>}
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$comimg</font> eq {}} {<b><font color=#3a6797>set</font></b> comimg {<font color=#653760>-image</font> bts_ImgNone}}
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$hotk</font> ne {}} {<b><font color=#3a6797>set</font></b> hotk <font color=#8b2a0e>&quot;-accelerator <font color=#1b1baa>$</font>hotk&quot;</font>}
    <b><font color=#3a6797>switch</font></b> [<b><font color=#3a6797>string</font></b> index <font color=#1b1baa>$typ</font> 0] {
      s {<font color=#1b1baa>$popc</font> add separator}
      c {
        <b><font color=#3a6797>switch</font></b> [<b><font color=#3a6797>string</font></b> index <font color=#1b1baa>$typ</font> 1] {
          o - {} { ;<i><font color=#4b5d50># command</font></i>
            <font color=#1b1baa>$popc</font> add command <font color=#653760>-label</font> <font color=#1b1baa>$label</font> <font color=#653760>-command</font> <font color=#1b1baa>$comm</font> \
              {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$dsbl</font> <font color=#653760>-compound</font> left {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$comimg</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$hotk</font>
          }
          h { ;<i><font color=#4b5d50># checkbutton</font></i>
            <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$comm</font> ne {}} {<b><font color=#3a6797>set</font></b> comm [<b><font color=#3a6797>list</font></b> <font color=#653760>-command</font> <font color=#1b1baa>$comm</font>]}
            <font color=#1b1baa>$popc</font> add checkbutton <font color=#653760>-label</font> <font color=#1b1baa>$label</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$comm</font> <font color=#653760>-variable</font> <font color=#1b1baa>$var</font>
          }
        }
      }
      m {
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$menu</font> eq {bartabs_cascade} && !<font color=#1b1baa>$usermnu</font> && <font color=#1b1baa>$static</font>} {
          <b><font color=#3a6797>set</font></b> popc <font color=#1b1baa>$pop</font>  ;<i><font color=#4b5d50># no user mnu & static: only list of tabs be shown</font></i>
        } <b><font color=#3a6797>else</font></b> {
          <b><font color=#3a6797>if</font></b> {[<b><font color=#134070>winfo</font></b> exist <font color=#1b1baa>$popc</font>]} {<b><font color=#134070>destroy</font></b> <font color=#1b1baa>$popc</font>}
          <b><font color=#134070>menu</font></b> <font color=#1b1baa>$popc</font> <font color=#653760>-tearoff</font> 0
          <b><font color=#3a6797>set</font></b> popm [<b><font color=#3a6797>string</font></b> range <font color=#1b1baa>$popc</font> 0 [<b><font color=#3a6797>string</font></b> last . <font color=#1b1baa>$popc</font>]-1]
          <font color=#1b1baa>$popm</font> add cascade <font color=#653760>-label</font> <font color=#1b1baa>$label</font> <font color=#653760>-menu</font> <font color=#1b1baa>$popc</font> \
            {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$dsbl</font> <font color=#653760>-compound</font> left {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$comimg</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$hotk</font>
        }
        <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> match {bartabs_cascade*} <font color=#1b1baa>$menu</font>]} {
          <b><font color=#3a6797>set</font></b> popi <font color=#1b1baa>$popc</font>
          <b><font color=#3a6797>lappend</font></b> lpops <font color=#1b1baa>$popi</font>
          <b><font color=#3a6797>set</font></b> ipops [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> FillMenuList <font color=#1b1baa>$BID</font> <font color=#1b1baa>$popi</font> <font color=#1b1baa>$TID</font> <font color=#1b1baa>$menu</font>]
        }
      }
    }
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tip</font> ne {}} {
      <b><font color=#3a6797>catch</font></b> {baltip::tip <font color=#1b1baa>$popc</font> <font color=#1b1baa>$tip</font> <font color=#653760>-index</font> [<font color=#1b1baa>$popc</font> index end]}
    }
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$lpops</font>]} {
    <b><font color=#3a6797>catch</font></b> {::apave::obj themePopup <font color=#1b1baa>$pop</font>}
    <b><font color=#ca14ca>my</font></b> Bar_MenuList <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font> <font color=#1b1baa>$pop</font> ;<i><font color=#4b5d50># main menu</font></i>
    <b><font color=#3a6797>foreach</font></b> popi <font color=#1b1baa>$lpops</font> {<b><font color=#ca14ca>my</font></b> Bar_MenuList <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font> <font color=#1b1baa>$popi</font> <font color=#1b1baa>$ipops</font>}
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$TID</font> ne {-1}} {
      <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-wb1</font> <font color=#653760>-wb2</font>] wb1 wb2
      <b><font color=#134070>bind</font></b> <font color=#1b1baa>$pop</font> &lt;Unmap&gt; [<b><font color=#3a6797>list</font></b> [<b><font color=#ca14ca>self</font></b>] <font color=#1b1baa>$TID</font> OnLeaveTab <font color=#1b1baa>$wb1</font> <font color=#1b1baa>$wb2</font>]
    }
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> DestroyMoveWindow
    <b><font color=#134070>tk_popup</font></b> <font color=#1b1baa>$pop</font> <font color=#1b1baa>$X</font> <font color=#1b1baa>$Y</font>
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> popList <font color=#1b1baa>$X</font> <font color=#1b1baa>$Y</font>
  }
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-LOCKDRAW</font> {}
}
<a id=Public_methods_of_Tab></a>
<i><font color=#4b5d50>## ____________ Public methods of Tab ____________ ##</font></i>
<a id=show></a>
<b><font color=#ca14ca>method</font></b> show {{refill no} {lifo yes}} {
<i><font color=#4b5d50># Shows a tab in a bar and sets it current.</font></i>
<i><font color=#4b5d50>#   refill - if &quot;yes&quot;, update the bar</font></i>
<i><font color=#4b5d50>#   lifo - if &quot;yes&quot;, allows moving a tab to 0th position</font></i>
<i><font color=#4b5d50># When refill=no and lifo=no, just shows a tab in its current position.</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> IDs [<b><font color=#ca14ca>my</font></b> ID]] TID BID
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$refill</font>} {<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> clear}
  <b><font color=#3a6797>set</font></b> itab 0
  <b><font color=#3a6797>foreach</font></b> tab [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> listTab]  {
    <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$tab</font> tID text wb wb1 wb2 pf
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$TID</font> eq <font color=#1b1baa>$tID</font>} {
      <b><font color=#3a6797>set</font></b> refill [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$pf</font> eq {}}]  ;<i><font color=#4b5d50># check if visible</font></i>
      <b><font color=#ca14ca>break</font></b>
    }
    <b><font color=#3a6797>incr</font></b> itab
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$refill</font> && <font color=#1b1baa>$lifo</font> && [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-lifo</font>] && (![<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> visible] || \
  [<b><font color=#3a6797>string</font></b> is true <font color=#653760>-strict</font> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-lifoest</font>]])} {
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> moveTab <font color=#1b1baa>$TID</font> 0
    <b><font color=#3a6797>set</font></b> itab 0
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$refill</font>} {<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Refill <font color=#1b1baa>$itab</font> no yes}
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> Tab_BeCurrent
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=close></a>
<b><font color=#ca14ca>method</font></b> close {{redraw yes} args} {
<i><font color=#4b5d50># Closes a tab and updates the bar.</font></i>
<i><font color=#4b5d50>#   redraw - if &quot;yes&quot;, update the bar and select the new tab</font></i>
<i><font color=#4b5d50>#   args - additional argumens of the -cdel command</font></i>
<i><font color=#4b5d50># Returns &quot;1&quot; if the deletion was successful, otherwise 0 (no) or -1 (cancel).</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_BID [<b><font color=#3a6797>set</font></b> TID [<b><font color=#ca14ca>my</font></b> ID]]] BID icurr tabcurr
  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Disabled <font color=#1b1baa>$TID</font>]} {
    <b><font color=#3a6797>set</font></b> ttl [msgcat::mc Closing]
    <b><font color=#3a6797>set</font></b> t [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-text</font>]
    <b><font color=#3a6797>set</font></b> msg [msgcat::mc <font color=#8b2a0e>&quot;Can't close the disabled\n\&quot;%t\&quot;\n\nClose others?&quot;</font>]
    <b><font color=#3a6797>set</font></b> msg [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %t <font color=#1b1baa>$t</font>] <font color=#1b1baa>$msg</font>]
    <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>expr</font></b> {[::bartabs::messageBox yesno <font color=#1b1baa>$ttl</font> <font color=#1b1baa>$msg</font> <font color=#653760>-icon</font> question]==1}]
  }
  <b><font color=#3a6797>set</font></b> cdel [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-cdel</font>]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$cdel</font> eq {}} {
    <b><font color=#3a6797>set</font></b> res 1
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> cdel [<b><font color=#ca14ca>my</font></b> PrepareCmd <font color=#1b1baa>$TID</font> <font color=#1b1baa>$BID</font> <font color=#653760>-cdel</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>]
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> res [{<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$cdel</font>]}]} {
      <b><font color=#3a6797>set</font></b> res [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> Tab_Cmd <font color=#653760>-cdel</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>]
    }
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$res</font> ni {1 yes true}} {<b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$res</font>}
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$redraw</font>} {<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> clear}
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-TABS</font> <font color=#653760>-tleft</font> <font color=#653760>-tright</font> <font color=#653760>-tabcurrent</font>] tabs tleft tright tcurr
  <b><font color=#ca14ca>my</font></b> Tab_RemoveLinks <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font>
  <b><font color=#134070>destroy</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-wb</font>]
  <b><font color=#3a6797>set</font></b> tabs [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$icurr</font> <font color=#1b1baa>$icurr</font>]
  <b><font color=#ca14ca>oo::objdefine</font></b> [<b><font color=#ca14ca>self</font></b>] [<b><font color=#3a6797>list</font></b> deletemethod [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabcurr</font> 0]]
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-TABS</font> <font color=#1b1baa>$tabs</font>
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$redraw</font>} {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$icurr</font>&gt;=<font color=#1b1baa>$tleft</font> && <font color=#1b1baa>$icurr</font>&lt;[<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$tabs</font>]} {
      <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> draw
      <b><font color=#ca14ca>my</font></b> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$icurr</font> 0] Tab_BeCurrent
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> TID [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> end 0]] ne {}} {
        <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> show yes ;<i><font color=#4b5d50># last tab deleted: show the new last if any</font></i>
      }
    }
  }
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Bar_Cmd2 <font color=#653760>-cdel2</font>  ;<i><font color=#4b5d50># command after the action</font></i>
  <b><font color=#ca14ca>return</font></b> 1
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=visible></a>
<b><font color=#ca14ca>method</font></b> visible {} {
<i><font color=#4b5d50># Checks if a tab is visible.</font></i>
<i><font color=#4b5d50># Returns yes if the tab is visible,.</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> IDs [<b><font color=#ca14ca>my</font></b> ID]] TID BID
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-tleft</font> <font color=#653760>-tright</font>] tleft tright
  <b><font color=#3a6797>set</font></b> tabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> listTab]
  <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i <font color=#1b1baa>$tleft</font>} {<font color=#1b1baa>$i</font>&lt;=<font color=#1b1baa>$tright</font>} {<b><font color=#3a6797>incr</font></b> i} {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$TID</font> eq [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font> 0]} {
      <b><font color=#ca14ca>return</font></b> yes
    }
  }
  <b><font color=#ca14ca>return</font></b> no
}
<a id=EOC_Tab></a>
<i><font color=#4b5d50>## ________________________ EOC Tab _________________________ ##</font></i>

}
<a id=Bar></a>
<i><font color=#4b5d50># ________________________ Bar _________________________ #</font></i>
<a id=Private_methods_of_Bar></a>
<i><font color=#4b5d50>## ____________ Private methods of Bar ____________ ##</font></i>

<b><font color=#ca14ca>oo::define</font></b> ::bartabs::Bar {
<a id=Bar_Data></a>
<b><font color=#ca14ca>method</font></b> Bar_Data {barOptions} {
<i><font color=#4b5d50># Puts data of new bar in btData.</font></i>
<i><font color=#4b5d50>#   barOptions - new bar's options</font></i>
<i><font color=#4b5d50># Returns BID of new bar.</font></i>

  <b><font color=#3a6797>variable</font></b> btData
  <b><font color=#3a6797>set</font></b> BID bar[<b><font color=#3a6797>incr</font></b> ::bartabs::NewBarID]
  <i><font color=#4b5d50># defaults:</font></i>
  <b><font color=#3a6797>set</font></b> barOpts [<b><font color=#3a6797>dict</font></b> create <font color=#653760>-wbar</font> {}  <font color=#653760>-wbase</font> {} <font color=#653760>-wproc</font> {} <font color=#653760>-static</font> no <font color=#653760>-lowlist</font> no \
    <font color=#653760>-hidearrows</font> no <font color=#653760>-scrollsel</font> yes <font color=#653760>-lablen</font> 0 <font color=#653760>-tiplen</font> 0 <font color=#653760>-tleft</font> 0 <font color=#653760>-tright</font> end \
    <font color=#653760>-disable</font> [<b><font color=#3a6797>list</font></b>] <font color=#653760>-select</font> [<b><font color=#3a6797>list</font></b>] <font color=#653760>-mark</font> [<b><font color=#3a6797>list</font></b>] <font color=#653760>-fgmark</font> #800080  <font color=#653760>-fgsel</font> <font color=#8b2a0e>&quot;.&quot;</font> \
    <font color=#653760>-relief</font> groove <font color=#653760>-padx</font> 1 <font color=#653760>-pady</font> 1 <font color=#653760>-expand</font> 0 <font color=#653760>-tabcurrent</font> -1 <font color=#653760>-dotip</font> no \
    <font color=#653760>-bd</font> 0 <font color=#653760>-separator</font> 1 <font color=#653760>-lifo</font> 0 <font color=#653760>-fg</font> {} <font color=#653760>-bg</font> {} <font color=#653760>-popuptip</font> {} <font color=#653760>-sortlist</font> 0 <font color=#653760>-comlist</font> {} \
    <font color=#653760>-ELLIPSE</font> <font color=#8b2a0e>&quot;\u2026&quot;</font> <font color=#653760>-MOVWIN</font> {.bt_move} <font color=#653760>-ARRLEN</font> 0 <font color=#653760>-USERMNU</font> 0 <font color=#653760>-LLEN</font> 0 <font color=#653760>-title</font> Tabs]
  <b><font color=#3a6797>set</font></b> tabinfo [<b><font color=#3a6797>set</font></b> imagetabs [<b><font color=#3a6797>set</font></b> popup [<b><font color=#3a6797>list</font></b>]]]
  <b><font color=#ca14ca>my</font></b> Bar_DefaultMenu <font color=#1b1baa>$BID</font> popup
  <b><font color=#3a6797>foreach</font></b> {optnam optval} <font color=#1b1baa>$barOptions</font> {
    <b><font color=#3a6797>switch</font></b> <font color=#653760>-exact</font> -- <font color=#1b1baa>$optnam</font> {
      <font color=#653760>-tab</font> - <font color=#653760>-imagetab</font> {
        <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$optnam</font> eq <font color=#8b2a0e>&quot;-imagetab&quot;</font>} {<b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$optval</font> optval img}
        <i><font color=#4b5d50># no duplicates allowed:</font></i>
        <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>lsearch</font></b> <font color=#653760>-index</font> {1 1} <font color=#653760>-exact</font> <font color=#1b1baa>$tabinfo</font> <font color=#1b1baa>$optval</font>]==-1} {
          <b><font color=#3a6797>lappend</font></b> tabinfo [<b><font color=#3a6797>set</font></b> tab [<b><font color=#ca14ca>my</font></b> Tab_Data <font color=#1b1baa>$BID</font> <font color=#1b1baa>$optval</font>]]
          <b><font color=#3a6797>dict</font></b> set barOpts <font color=#653760>-TABS</font> <font color=#1b1baa>$tabinfo</font>
          <b><font color=#3a6797>dict</font></b> set barOpts <font color=#653760>-LLEN</font> [<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$tabinfo</font>]
          <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$optnam</font> eq <font color=#8b2a0e>&quot;-imagetab&quot;</font>} {
            <b><font color=#3a6797>lappend</font></b> imagetabs [<b><font color=#3a6797>list</font></b> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tab</font> 0] <font color=#1b1baa>$img</font>]
            <b><font color=#3a6797>dict</font></b> set barOpts <font color=#653760>-IMAGETABS</font> <font color=#1b1baa>$imagetabs</font>
          }
        }
      }
      <font color=#653760>-menu</font> {
        <b><font color=#3a6797>lappend</font></b> popup {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$optval</font>
        <b><font color=#3a6797>dict</font></b> set barOpts <font color=#653760>-menu</font> <font color=#1b1baa>$popup</font>
        <b><font color=#3a6797>dict</font></b> set barOpts <font color=#653760>-USERMNU</font> 1
        <b><font color=#3a6797>lappend</font></b> mnu {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$optval</font>
        <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> index [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$mnu</font> 0] 0] eq <font color=#8b2a0e>&quot;s&quot;</font>} {<b><font color=#3a6797>set</font></b> mnu [<b><font color=#3a6797>lrange</font></b> <font color=#1b1baa>$mnu</font> 1 end]}
        <b><font color=#3a6797>dict</font></b> set barOpts <font color=#653760>-UMNU</font> <font color=#1b1baa>$mnu</font>
      }
      <b><font color=#3a6797>default</font></b> {
        <b><font color=#3a6797>dict</font></b> set barOpts <font color=#1b1baa>$optnam</font> <font color=#1b1baa>$optval</font>
      }
    }
  }
  <b><font color=#3a6797>set</font></b> wbar [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$barOpts</font> <font color=#653760>-wbar</font>]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$wbar</font> eq {}} {<b><font color=#ca14ca>return</font></b> <font color=#653760>-code</font> error {bartabs: <font color=#653760>-wbar</font> option is obligatory}}
  <b><font color=#3a6797>set</font></b> wbase [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$barOpts</font> <font color=#653760>-wbase</font>]
  <b><font color=#3a6797>set</font></b> wproc [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$barOpts</font> <font color=#653760>-wproc</font>]
  <b><font color=#3a6797>foreach</font></b> o {<font color=#653760>-tleft</font> <font color=#653760>-tright</font>} {
    <b><font color=#3a6797>set</font></b> v [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$barOpts</font> <font color=#1b1baa>$o</font>]
    <b><font color=#3a6797>set</font></b> v [<b><font color=#3a6797>expr</font></b> [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> end [<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$tabinfo</font>]-1] <font color=#1b1baa>$v</font>]]
    <b><font color=#3a6797>dict</font></b> set barOpts <font color=#1b1baa>$o</font> <font color=#1b1baa>$v</font>
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$wbase</font> ne {} && <font color=#1b1baa>$wproc</font> eq {}} {
    <b><font color=#3a6797>dict</font></b> set barOpts <font color=#653760>-wproc</font> <font color=#8b2a0e>&quot;expr <font color=#1b1baa>{</font>\[winfo width <font color=#1b1baa>$</font>wbase\]-80<font color=#1b1baa>}</font>&quot;</font> ;<i><font color=#4b5d50># 80 for ornithology</font></i>
  }
  <b><font color=#3a6797>dict</font></b> set btData <font color=#1b1baa>$BID</font> <font color=#1b1baa>$barOpts</font>
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$BID</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Bar_DefaultMenu></a>
<b><font color=#ca14ca>method</font></b> Bar_DefaultMenu {BID popName} {
<i><font color=#4b5d50># Creates default menu items.</font></i>
<i><font color=#4b5d50>#   popName - variable name for popup's data</font></i>

  <b><font color=#3a6797>upvar</font></b> 1 <font color=#1b1baa>$popName</font> pop
  <b><font color=#3a6797>set</font></b> bar <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>BID&quot;</font>
  <b><font color=#3a6797>set</font></b> dsbl <font color=#8b2a0e>&quot;<font color=#1b1baa>{$</font>bar CheckDsblPopup<font color=#1b1baa>}</font>&quot;</font>
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Mc_MenuItems] list behind close closeall closeleft closeright
  <b><font color=#3a6797>foreach</font></b> item [<b><font color=#3a6797>list</font></b> \
  <font color=#8b2a0e>&quot;m <font color=#1b1baa>{$</font>list<font color=#1b1baa>}</font> <font color=#1b1baa>{}</font> bartabs_cascade&quot;</font> \
  <font color=#8b2a0e>&quot;s <font color=#1b1baa>{}</font> <font color=#1b1baa>{}</font> <font color=#1b1baa>{}</font> <font color=#1b1baa>$</font>dsbl&quot;</font> \
  <font color=#8b2a0e>&quot;m <font color=#1b1baa>{</font>BHND<font color=#1b1baa>}</font> <font color=#1b1baa>{}</font> bartabs_cascade2 <font color=#1b1baa>$</font>dsbl&quot;</font> \
  <font color=#8b2a0e>&quot;s <font color=#1b1baa>{}</font> <font color=#1b1baa>{}</font> <font color=#1b1baa>{}</font> <font color=#1b1baa>$</font>dsbl&quot;</font> \
  <font color=#8b2a0e>&quot;c <font color=#1b1baa>{$</font>close<font color=#1b1baa>}</font> <font color=#1b1baa>{[</font>self<font color=#1b1baa>]</font> %t close yes -first -1<font color=#1b1baa>}</font> <font color=#1b1baa>{}</font> <font color=#1b1baa>$</font>dsbl&quot;</font> \
  <font color=#8b2a0e>&quot;c <font color=#1b1baa>{$</font>closeall<font color=#1b1baa>}</font> <font color=#1b1baa>{$</font>bar closeAll <font color=#1b1baa>$</font>BID -1 1<font color=#1b1baa>}</font> <font color=#1b1baa>{}</font> <font color=#1b1baa>$</font>dsbl&quot;</font> \
  <font color=#8b2a0e>&quot;c <font color=#1b1baa>{$</font>closeleft<font color=#1b1baa>}</font> <font color=#1b1baa>{$</font>bar closeAll <font color=#1b1baa>$</font>BID %t 2<font color=#1b1baa>}</font> <font color=#1b1baa>{}</font> <font color=#1b1baa>$</font>dsbl&quot;</font> \
  <font color=#8b2a0e>&quot;c <font color=#1b1baa>{$</font>closeright<font color=#1b1baa>}</font> <font color=#1b1baa>{$</font>bar closeAll <font color=#1b1baa>$</font>BID %t 3<font color=#1b1baa>}</font> <font color=#1b1baa>{}</font> <font color=#1b1baa>$</font>dsbl&quot;</font>] {
    <b><font color=#3a6797>lappend</font></b> pop <font color=#1b1baa>$item</font>
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Bar_MenuList></a>
<b><font color=#ca14ca>method</font></b> Bar_MenuList {BID TID popi {ilist <font color=#8b2a0e>&quot;&quot;</font>} {pop <font color=#8b2a0e>&quot;&quot;</font>}} {
<i><font color=#4b5d50># Tunes &quot;List&quot; menu item for colors & underlining.</font></i>
<i><font color=#4b5d50>#   popi - menu of tab items</font></i>
<i><font color=#4b5d50>#   ilist - list of &quot;s&quot; (separators) and TIDs</font></i>
<i><font color=#4b5d50>#   pop - menu to be themed in apave package</font></i>

  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$pop</font> eq {}} {<b><font color=#3a6797>set</font></b> pop <font color=#1b1baa>$popi</font>}
  <b><font color=#3a6797>catch</font></b> {::apave::obj themePopup <font color=#1b1baa>$pop</font>}
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-tabcurrent</font> <font color=#653760>-select</font> <font color=#653760>-FGOVER</font> <font color=#653760>-BGOVER</font> <font color=#653760>-lowlist</font>] \
    tabcurr fewsel fgo bgo ll
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$ll</font> || [<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> fs <font color=#8b2a0e>&quot;-size <font color=#1b1baa>[</font>dict get <font color=#1b1baa>[$</font>pop cget -font<font color=#1b1baa>]</font> -size<font color=#1b1baa>]</font>&quot;</font>}]} {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$ll</font> && [<b><font color=#3a6797>string</font></b> is digit <font color=#1b1baa>$ll</font>] && <font color=#1b1baa>$ll</font>&gt;1} {
      <b><font color=#3a6797>set</font></b> fs <font color=#8b2a0e>&quot;-size <font color=#1b1baa>$</font>ll&quot;</font>
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> fs {}
    }
  }
  <i><font color=#4b5d50># ALERT: &quot;font actual TkDefaultFont&quot; may be wasteful with tclkits</font></i>
  <b><font color=#3a6797>set</font></b> font [<b><font color=#3a6797>list</font></b> <font color=#653760>-font</font> <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>font actual TkDefaultFont<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>fs&quot;</font>]
  <b><font color=#3a6797>set</font></b> llen [<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$ilist</font>]
  <b><font color=#3a6797>if</font></b> {[<font color=#1b1baa>$popi</font> cget <font color=#653760>-tearoff</font>]} {
    <b><font color=#3a6797>set</font></b> ito 1
    <b><font color=#3a6797>set</font></b> TID <font color=#1b1baa>$tabcurr</font>
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> ito 0
  }
  <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i 0} {<font color=#1b1baa>$i</font>&lt;<font color=#1b1baa>$llen</font>} {<b><font color=#3a6797>incr</font></b> i} {
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> tID [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$ilist</font> <font color=#1b1baa>$i</font>]] eq {s}} <b><font color=#ca14ca>continue</font></b>
    <b><font color=#3a6797>set</font></b> opts [<b><font color=#ca14ca>my</font></b> Tab_MarkAttrs <font color=#1b1baa>$BID</font> <font color=#1b1baa>$tID</font> no]
    <b><font color=#3a6797>if</font></b> {<font color=#8b2a0e>&quot;-image&quot;</font> ni <font color=#1b1baa>$opts</font>} {<b><font color=#3a6797>append</font></b> opts <font color=#8b2a0e>&quot; -image bts_ImgNone&quot;</font>}
    <b><font color=#3a6797>append</font></b> opts <font color=#8b2a0e>&quot; -compound left&quot;</font>
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tID</font>==<font color=#1b1baa>$tabcurr</font> || [<b><font color=#3a6797>lsearch</font></b> <font color=#1b1baa>$fewsel</font> <font color=#1b1baa>$tID</font>]&gt;-1} {
      <b><font color=#3a6797>set</font></b> font2 [<b><font color=#ca14ca>my</font></b> Tab_SelAttrs <font color=#1b1baa>$font</font> {} {}]
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> font2 <font color=#1b1baa>$font</font>
    }
    <b><font color=#3a6797>append</font></b> opts <font color=#8b2a0e>&quot; <font color=#1b1baa>$</font>font2&quot;</font>
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tID</font>==<font color=#1b1baa>$TID</font>} {<b><font color=#3a6797>append</font></b> opts <font color=#8b2a0e>&quot; -foreground <font color=#1b1baa>$</font>fgo -background <font color=#1b1baa>$</font>bgo&quot;</font>}
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> match *bartabs_cascade2 <font color=#1b1baa>$popi</font>] && [<b><font color=#ca14ca>my</font></b> Disabled <font color=#1b1baa>$tID</font>]} {
      <b><font color=#3a6797>append</font></b> opts <font color=#8b2a0e>&quot; -foreground <font color=#1b1baa>[</font>my <font color=#1b1baa>$</font>BID cget -FGMAIN<font color=#1b1baa>]</font>&quot;</font>  ;<i><font color=#4b5d50># move behind any</font></i>
    }
    <b><font color=#3a6797>catch</font></b> {<font color=#1b1baa>$popi</font> entryconfigure [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$i</font>+<font color=#1b1baa>$ito</font>}] {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$opts</font>}
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Bar_Cmd2></a>
<b><font color=#ca14ca>method</font></b> Bar_Cmd2 {comopt2 {TID <font color=#8b2a0e>&quot;&quot;</font>}} {
<i><font color=#4b5d50># Executes a command after an action.</font></i>
<i><font color=#4b5d50>#   comopt2 - the command's option (-csel2, -cdel2, -cmov2)</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> com2 [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#1b1baa>$comopt2</font>]] ne {}} {
    {<b><font color=#3a6797>*</font></b>}[<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %t <font color=#1b1baa>$TID</font>] <font color=#1b1baa>$com2</font>]
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Mc_MenuItems></a>
<b><font color=#ca14ca>method</font></b> Mc_MenuItems {} {
  <i><font color=#4b5d50># Returns localized menu items' label.</font></i>

  <b><font color=#ca14ca>namespace</font></b> eval ::bartabs {
    <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>list</font></b> [msgcat::mc List] \
                 [msgcat::mc behind] \
                 [msgcat::mc Close] \
                 [msgcat::mc {... All}] \
                 [msgcat::mc {... All at Left}] \
                 [msgcat::mc {... All at Right}]]
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=InitColors></a>
<b><font color=#ca14ca>method</font></b> InitColors {} {
<i><font color=#4b5d50># Initializes colors of a bar.</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> fgmain [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-fg</font>]] eq {}} {
    <b><font color=#3a6797>set</font></b> fgmain [<b><font color=#134070>ttk::style</font></b> configure . <font color=#653760>-foreground</font>]
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> bgmain [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-bg</font>]] eq {}} {
    <b><font color=#3a6797>set</font></b> bgmain [<b><font color=#134070>ttk::style</font></b> configure . <font color=#653760>-background</font>]
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> fgdsbl [<b><font color=#3a6797>dict</font></b> get [<b><font color=#134070>ttk::style</font></b> map . <font color=#653760>-foreground</font>] disabled]}]} {
    <b><font color=#3a6797>set</font></b> fgdsbl <font color=#1b1baa>$fgmain</font>
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> bgdsbl [<b><font color=#3a6797>dict</font></b> get [<b><font color=#134070>ttk::style</font></b> map . <font color=#653760>-background</font>] disabled]}]} {
    <b><font color=#3a6797>set</font></b> bgdsbl <font color=#1b1baa>$bgmain</font>
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {
    <b><font color=#3a6797>set</font></b> fgo [<b><font color=#134070>ttk::style</font></b> map TButton <font color=#653760>-foreground</font>]
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>dict</font></b> exists <font color=#1b1baa>$fgo</font> active]} {
      <b><font color=#3a6797>set</font></b> fgo [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$fgo</font> active]
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> fgo <font color=#1b1baa>$fgmain</font>
    }
    <b><font color=#3a6797>set</font></b> bgo [<b><font color=#134070>ttk::style</font></b> map TButton <font color=#653760>-background</font>]
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>dict</font></b> exists <font color=#1b1baa>$bgo</font> active]} {
      <b><font color=#3a6797>set</font></b> bgo [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$bgo</font> active]
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> bgo <font color=#1b1baa>$bgmain</font>
    }
  }]} {
    <b><font color=#3a6797>set</font></b> bgo <font color=#1b1baa>$fgmain</font>  ;<i><font color=#4b5d50># reversed</font></i>
    <b><font color=#3a6797>set</font></b> fgo <font color=#1b1baa>$bgmain</font>
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$bgo</font> in {black #000000}} {<b><font color=#3a6797>set</font></b> bgo #444444; <b><font color=#3a6797>set</font></b> fgo #FFFFFF}
  }
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-FGMAIN</font> <font color=#1b1baa>$fgmain</font> <font color=#653760>-BGMAIN</font> <font color=#1b1baa>$bgmain</font> \
    <font color=#653760>-FGDSBL</font> <font color=#1b1baa>$fgdsbl</font> <font color=#653760>-BGDSBL</font> <font color=#1b1baa>$bgdsbl</font> <font color=#653760>-FGOVER</font> <font color=#1b1baa>$fgo</font> <font color=#653760>-BGOVER</font> <font color=#1b1baa>$bgo</font>
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Style
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Style></a>
<b><font color=#ca14ca>method</font></b> Style {} {
<i><font color=#4b5d50># Sets styles a bar's widgets.</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>set</font></b> bg [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-BGMAIN</font>]
  <b><font color=#134070>ttk::style</font></b> configure ClButton<font color=#1b1baa>$BID</font> {<b><font color=#3a6797>*</font></b>}[<b><font color=#134070>ttk::style</font></b> configure TButton]
  <b><font color=#134070>ttk::style</font></b> configure ClButton<font color=#1b1baa>$BID</font> <font color=#653760>-relief</font> flat <font color=#653760>-padx</font> 0 <font color=#653760>-bd</font> 0 <font color=#653760>-highlightthickness</font> 0
  <b><font color=#134070>ttk::style</font></b> map ClButton<font color=#1b1baa>$BID</font> {<b><font color=#3a6797>*</font></b>}[<b><font color=#134070>ttk::style</font></b> map TButton]
  <b><font color=#134070>ttk::style</font></b> map ClButton<font color=#1b1baa>$BID</font> <font color=#653760>-background</font> [<b><font color=#3a6797>list</font></b> active <font color=#1b1baa>$bg</font> !active <font color=#1b1baa>$bg</font>]
  <b><font color=#134070>ttk::style</font></b> layout ClButton<font color=#1b1baa>$BID</font> [<b><font color=#134070>ttk::style</font></b> layout TButton]
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ScrollCurr></a>
<b><font color=#ca14ca>method</font></b> ScrollCurr {dir} {
<i><font color=#4b5d50># Scrolls the current tab to the left/right.</font></i>
<i><font color=#4b5d50>#   dir - 1/-1 for scrolling to the right/left</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> [<b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]] cget <font color=#653760>-scrollsel</font> <font color=#653760>-tabcurrent</font>] sccur tcurr
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$sccur</font> || <font color=#1b1baa>$tcurr</font> eq {}} {<b><font color=#ca14ca>return</font></b> no}
  <b><font color=#3a6797>set</font></b> tabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> listFlag]
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> i [<b><font color=#ca14ca>my</font></b> Aux_IndexInList <font color=#1b1baa>$tcurr</font> <font color=#1b1baa>$tabs</font>]]==-1} {<b><font color=#ca14ca>return</font></b> no}
  <b><font color=#3a6797>incr</font></b> i <font color=#1b1baa>$dir</font>
  <b><font color=#3a6797>set</font></b> TID [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font> 0]
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font> 2] eq <font color=#8b2a0e>&quot;1&quot;</font> && ![<b><font color=#ca14ca>my</font></b> Disabled <font color=#1b1baa>$TID</font>]} {
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> Tab_BeCurrent  ;<i><font color=#4b5d50># TID visible & enabled</font></i>
    <b><font color=#ca14ca>return</font></b> yes
  }
  <b><font color=#ca14ca>return</font></b> no
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=ArrowsState></a>
<b><font color=#ca14ca>method</font></b> ArrowsState {tleft tright sright} {
<i><font color=#4b5d50># Sets a state of scrolling arrows.</font></i>
<i><font color=#4b5d50>#   tleft, tright - index of left/right tab</font></i>
<i><font color=#4b5d50>#   sright - state of a right arrow (&quot;no&quot; for disabled)</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> [<b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]] cget <font color=#653760>-WWID</font> <font color=#653760>-hidearrows</font> <font color=#653760>-tiplen</font>] wwid hidearr tiplen
  <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$wwid</font> wframe wlarr wrarr
  <b><font color=#3a6797>set</font></b> tabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> listTab]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tleft</font>} {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$hidearr</font> && [<b><font color=#3a6797>catch</font></b> {<b><font color=#134070>pack</font></b> <font color=#1b1baa>$wlarr</font> <font color=#653760>-before</font> <font color=#1b1baa>$wframe</font> <font color=#653760>-side</font> left}]} {
      <b><font color=#134070>pack</font></b> <font color=#1b1baa>$wlarr</font> <font color=#653760>-side</font> left
    }
    <b><font color=#3a6797>set</font></b> state normal
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$hidearr</font>} {
      <b><font color=#3a6797>set</font></b> state normal
      <b><font color=#134070>pack</font></b> forget <font color=#1b1baa>$wlarr</font>
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>pack</font></b> <font color=#1b1baa>$wlarr</font> <font color=#653760>-before</font> <font color=#1b1baa>$wframe</font> <font color=#653760>-side</font> left}
      <b><font color=#3a6797>set</font></b> state disabled
    }
  }
  <font color=#1b1baa>$wlarr</font> configure <font color=#653760>-state</font> <font color=#1b1baa>$state</font>
  <b><font color=#3a6797>set</font></b> tip {}
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$state</font> eq {normal} && <font color=#1b1baa>$tiplen</font>&gt;=0} {
    <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$tleft</font>-1}]} {<font color=#1b1baa>$i</font>&gt;=0} {<b><font color=#3a6797>incr</font></b> i -1} {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tiplen</font> && [<b><font color=#3a6797>incr</font></b> cntl]&gt;<font color=#1b1baa>$tiplen</font>} {
        <b><font color=#3a6797>append</font></b> tip <font color=#8b2a0e>&quot;...&quot;</font>
        <b><font color=#ca14ca>break</font></b>
      }
      <b><font color=#3a6797>set</font></b> text [<b><font color=#3a6797>lindex</font></b> [<b><font color=#ca14ca>my</font></b> Tab_TextEllipsed <font color=#1b1baa>$BID</font> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font> 1]] 0]
      <b><font color=#3a6797>append</font></b> tip <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>text\n&quot;</font>
    }
  }
  <b><font color=#3a6797>catch</font></b> {::baltip::tip <font color=#1b1baa>$wlarr</font> [<b><font color=#3a6797>string</font></b> trim <font color=#1b1baa>$tip</font>]}
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$sright</font>} {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$hidearr</font> && [<b><font color=#3a6797>catch</font></b> {<b><font color=#134070>pack</font></b> <font color=#1b1baa>$wrarr</font> <font color=#653760>-after</font> <font color=#1b1baa>$wframe</font> <font color=#653760>-side</font> right <font color=#653760>-anchor</font> e}]} {
      <b><font color=#134070>pack</font></b> <font color=#1b1baa>$wrarr</font> <font color=#653760>-side</font> right <font color=#653760>-anchor</font> e
    }
    <b><font color=#3a6797>set</font></b> state normal
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$hidearr</font>} {
      <b><font color=#3a6797>set</font></b> state normal
      <b><font color=#134070>pack</font></b> forget <font color=#1b1baa>$wrarr</font>
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>pack</font></b> <font color=#1b1baa>$wrarr</font> <font color=#653760>-after</font> <font color=#1b1baa>$wframe</font> <font color=#653760>-side</font> right <font color=#653760>-anchor</font> e}
      <b><font color=#3a6797>set</font></b> state disabled
    }
  }
  <font color=#1b1baa>$wrarr</font> configure <font color=#653760>-state</font> <font color=#1b1baa>$state</font>
  <b><font color=#3a6797>set</font></b> tip {}
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$state</font> eq {normal} && <font color=#1b1baa>$tiplen</font>&gt;=0} {
    <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$tright</font>+1}]} {<font color=#1b1baa>$i</font>&lt;[<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$tabs</font>]} {<b><font color=#3a6797>incr</font></b> i} {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tiplen</font> && [<b><font color=#3a6797>incr</font></b> cntr]&gt;<font color=#1b1baa>$tiplen</font>} {
        <b><font color=#3a6797>append</font></b> tip ...
        <b><font color=#ca14ca>break</font></b>
      }
      <b><font color=#3a6797>set</font></b> text [<b><font color=#3a6797>lindex</font></b> [<b><font color=#ca14ca>my</font></b> Tab_TextEllipsed <font color=#1b1baa>$BID</font> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font> 1]] 0]
      <b><font color=#3a6797>append</font></b> tip <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>text\n&quot;</font>
    }
  }
  <b><font color=#3a6797>catch</font></b> {::baltip::tip <font color=#1b1baa>$wrarr</font> [<b><font color=#3a6797>string</font></b> trim <font color=#1b1baa>$tip</font>]}
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=FillMenuList></a>
<b><font color=#ca14ca>method</font></b> FillMenuList {BID popi {TID -1} {mnu <font color=#8b2a0e>&quot;&quot;</font>} {mustBeSorted {}}} {
<i><font color=#4b5d50># Fills &quot;List of tabs&quot; item of popup menu.</font></i>
<i><font color=#4b5d50>#   popi - menu of tab items</font></i>
<i><font color=#4b5d50>#   TID - clicked tab ID</font></i>
<i><font color=#4b5d50>#   mnu - root menu</font></i>
<i><font color=#4b5d50>#   mustBeSorted - flag &quot;sorted list&quot;</font></i>
<i><font color=#4b5d50># Return a list of items types: s (separator) and TID.</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-tiplen</font> <font color=#653760>-popuptip</font> <font color=#653760>-sortlist</font> <font color=#653760>-comlist</font>] tiplen popuptip sortlist comlist
  <b><font color=#3a6797>set</font></b> vis [<b><font color=#3a6797>set</font></b> seps 0] ;<i><font color=#4b5d50># flags for separators: before/after visible items</font></i>
  <b><font color=#3a6797>set</font></b> idx [<b><font color=#3a6797>set</font></b> icom -1]
  <b><font color=#3a6797>set</font></b> res [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>set</font></b> tabs [<b><font color=#ca14ca>my</font></b> [<b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]] listFlag]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$mustBeSorted</font> ne {}} {<b><font color=#3a6797>set</font></b> sortlist <font color=#1b1baa>$mustBeSorted</font>}
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$sortlist</font>} {
    <b><font color=#3a6797>set</font></b> tabs [<b><font color=#3a6797>lsort</font></b> <font color=#653760>-index</font> 1 <font color=#653760>-dictionary</font> <font color=#1b1baa>$tabs</font>]
  }
  <b><font color=#3a6797>foreach</font></b> tab <font color=#1b1baa>$tabs</font> {
    <b><font color=#3a6797>incr</font></b> icom
    <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$tab</font> tID text vsbl
    <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$sortlist</font>} {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$vsbl</font> && !<font color=#1b1baa>$seps</font> || !<font color=#1b1baa>$vsbl</font> && <font color=#1b1baa>$vis</font>} {
        <b><font color=#3a6797>incr</font></b> idx
        <font color=#1b1baa>$popi</font> add separator
        <b><font color=#3a6797>lappend</font></b> res s
        <b><font color=#3a6797>incr</font></b> seps
        <b><font color=#3a6797>set</font></b> vis 0
      } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$vsbl</font>} {
        <b><font color=#3a6797>set</font></b> vis 1
      }
      <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$seps</font> && <font color=#1b1baa>$vis</font>} { ;<i><font color=#4b5d50># no invisible at left</font></i>
        <b><font color=#3a6797>incr</font></b> idx
        <font color=#1b1baa>$popi</font> add separator
        <b><font color=#3a6797>lappend</font></b> res s
        <b><font color=#3a6797>incr</font></b> seps
      }
    }
    <b><font color=#3a6797>set</font></b> dsbl {}
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$TID</font> == -1 || <font color=#1b1baa>$mnu</font> eq {bartabs_cascade}} {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$comlist</font> eq {}} {
        <b><font color=#3a6797>set</font></b> comm <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>tID show yes&quot;</font>
      } <b><font color=#3a6797>else</font></b> {
        <b><font color=#3a6797>set</font></b> tip [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$tID</font> cget <font color=#653760>-tip</font>]
        <b><font color=#3a6797>set</font></b> comm [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %ID <font color=#1b1baa>$tID</font> %i <font color=#1b1baa>$icom</font> %t <font color=#1b1baa>$tip</font>] <font color=#1b1baa>$comlist</font>]
      }
      <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Disabled <font color=#1b1baa>$tID</font>]} {<b><font color=#3a6797>set</font></b> dsbl {<font color=#653760>-state</font> disabled}}
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> comm <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> moveSelTab <font color=#1b1baa>$</font>TID <font color=#1b1baa>$</font>tID&quot;</font>
    }
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> cbr [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$tiplen</font>&gt;0 && [<b><font color=#3a6797>incr</font></b> ccnt]&gt;<font color=#1b1baa>$tiplen</font>}]]} {<b><font color=#3a6797>set</font></b> ccnt 0}
    <b><font color=#3a6797>incr</font></b> idx
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$popuptip</font> ne {}} {
      <i><font color=#4b5d50># make a tip for menu items</font></i>
      <font color=#1b1baa>$popuptip</font> <font color=#1b1baa>$popi</font> <font color=#1b1baa>$idx</font> <font color=#1b1baa>$tID</font>
    }
    <font color=#1b1baa>$popi</font> add command <font color=#653760>-label</font> <font color=#1b1baa>$text</font> <font color=#653760>-command</font> <font color=#1b1baa>$comm</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$dsbl</font> <font color=#653760>-columnbreak</font> <font color=#1b1baa>$cbr</font>
    <b><font color=#3a6797>lappend</font></b> res <font color=#1b1baa>$tID</font>
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$seps</font>&lt;2 && !<font color=#1b1baa>$sortlist</font>} { ;<i><font color=#4b5d50># no invisible at right</font></i>
    <font color=#1b1baa>$popi</font> add separator
    <b><font color=#3a6797>lappend</font></b> res s
  }
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$res</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Width></a>
<b><font color=#ca14ca>method</font></b> Width {} {
<i><font color=#4b5d50># Calculates and returns the bar width to place tabs.</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> [<b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]] cget \
    <font color=#653760>-tleft</font> <font color=#653760>-tright</font> <font color=#653760>-LLEN</font> <font color=#653760>-wbase</font> <font color=#653760>-wbar</font> <font color=#653760>-ARRLEN</font> <font color=#653760>-hidearrows</font> <font color=#653760>-WWID</font> <font color=#653760>-BWIDTH</font> <font color=#653760>-wproc</font>] \
    tleft tright llen wbase wb arrlen hidearrows wwid bwidth1 wproc
  <b><font color=#3a6797>set</font></b> iarr 2
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$hidearrows</font>} {  ;<i><font color=#4b5d50># how many arrows are visible?</font></i>
    <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$tleft</font>} {<b><font color=#3a6797>incr</font></b> iarr -1}
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tright</font>==(<font color=#1b1baa>$llen</font>-1)} {<b><font color=#3a6797>incr</font></b> iarr -1}
  }
  <b><font color=#3a6797>set</font></b> minus2len [<b><font color=#3a6797>expr</font></b> {-<font color=#1b1baa>$iarr</font>*<font color=#1b1baa>$arrlen</font>}]
  <b><font color=#3a6797>set</font></b> bwidth2 0
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$wproc</font> ne {}} {
    <b><font color=#3a6797>set</font></b> bwidth2 [{<b><font color=#3a6797>*</font></b>}[<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %b <font color=#1b1baa>$BID</font>] <font color=#1b1baa>$wproc</font>]]
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$bwidth2</font>&lt;2 && [<b><font color=#3a6797>set</font></b> wbase_exist [<b><font color=#134070>winfo</font></b> exists <font color=#1b1baa>$wbase</font>]]} {
    <i><font color=#4b5d50># 'wbase' is a base widget to get the bartabs' width from</font></i>
    <b><font color=#3a6797>set</font></b> bwidth2 [<b><font color=#ca14ca>my</font></b> Aux_WidgetWidth <font color=#1b1baa>$wbase</font>]
  }
  <b><font color=#3a6797>incr</font></b> bwidth2 <font color=#1b1baa>$minus2len</font>
  <b><font color=#3a6797>set</font></b> wbase_exist [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$bwidth2</font>&gt;1}]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$wbase_exist</font>} {
    <b><font color=#3a6797>set</font></b> bwidth <font color=#1b1baa>$bwidth2</font>
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$bwidth1</font> eq {} || <font color=#1b1baa>$bwidth1</font>&lt;=1} {<b><font color=#3a6797>set</font></b> bwidth1 100}
    <b><font color=#3a6797>set</font></b> bwidth [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$wbase_exist</font> ? min(<font color=#1b1baa>$bwidth1</font>,<font color=#1b1baa>$bwidth2</font>) : <font color=#1b1baa>$bwidth1</font>}]
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> winw [<b><font color=#134070>winfo</font></b> width .]]&lt;2} {<b><font color=#3a6797>set</font></b> winw [<b><font color=#134070>winfo</font></b> reqwidth .]}
  <b><font color=#3a6797>incr</font></b> winw <font color=#1b1baa>$minus2len</font>
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$bwidth</font>&lt;=0} { ;<i><font color=#4b5d50># last refuge</font></i>
    <b><font color=#3a6797>set</font></b> bwidth [<b><font color=#3a6797>expr</font></b> {max(<font color=#1b1baa>$winw</font>,[<b><font color=#134070>winfo</font></b> reqwidth <font color=#1b1baa>$wb</font>],[<b><font color=#134070>winfo</font></b> width <font color=#1b1baa>$wb</font>])}]
  } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$wbase</font> eq {} && <font color=#1b1baa>$bwidth1</font> && <font color=#1b1baa>$winw</font>&gt;1 && <font color=#1b1baa>$bwidth1</font>&gt;<font color=#1b1baa>$winw</font>} {
    <b><font color=#3a6797>set</font></b> bwidth <font color=#1b1baa>$winw</font>
  }
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$bwidth</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=FillFromLeft></a>
<b><font color=#ca14ca>method</font></b> FillFromLeft {{ileft <font color=#8b2a0e>&quot;&quot;</font>} {tright <font color=#8b2a0e>&quot;end&quot;</font>}} {
<i><font color=#4b5d50># Fills a bar with tabs from the left to the right (as much tabs as possible).</font></i>
<i><font color=#4b5d50>#   ileft - index of a left tab</font></i>
<i><font color=#4b5d50>#   tright - index of a right tab</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Aux_InitDraw [<b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]]] bwidth vislen bd arrlen llen tleft hidearr tabs wframe
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$ileft</font> ne {}} {<b><font color=#3a6797>set</font></b> tleft <font color=#1b1baa>$ileft</font>}
  <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i <font color=#1b1baa>$tleft</font>} {<font color=#1b1baa>$i</font>&lt;<font color=#1b1baa>$llen</font>} {<b><font color=#3a6797>incr</font></b> i} {
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_DictItem [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font>]] TID text wb wb1 wb2 pf
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_Create <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font> <font color=#1b1baa>$wframe</font> <font color=#1b1baa>$text</font>] wb wb1 wb2
    <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Aux_CheckTabVisible <font color=#1b1baa>$wb</font> <font color=#1b1baa>$wb1</font> <font color=#1b1baa>$wb2</font> <font color=#1b1baa>$i</font> <font color=#1b1baa>$tleft</font> tright vislen \
    <font color=#1b1baa>$llen</font> <font color=#1b1baa>$hidearr</font> <font color=#1b1baa>$arrlen</font> <font color=#1b1baa>$bd</font> <font color=#1b1baa>$bwidth</font> tabs <font color=#1b1baa>$TID</font> <font color=#1b1baa>$text</font>]} {
      <b><font color=#ca14ca>my</font></b> Tab_Pack <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font> <font color=#1b1baa>$wb</font> <font color=#1b1baa>$wb1</font> <font color=#1b1baa>$wb2</font>
    }
  }
  <b><font color=#ca14ca>my</font></b> Aux_EndDraw <font color=#1b1baa>$BID</font> <font color=#1b1baa>$tleft</font> <font color=#1b1baa>$tright</font> <font color=#1b1baa>$llen</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=FillFromRight></a>
<b><font color=#ca14ca>method</font></b> FillFromRight {tleft tright behind} {
<i><font color=#4b5d50># Fills a bar with tabs from the right to the left (as much tabs as possible).</font></i>
<i><font color=#4b5d50>#   tleft, tright - index of left/right tab</font></i>
<i><font color=#4b5d50>#   behind - flag &quot;go behind the right tab&quot;</font></i>

  <b><font color=#3a6797>set</font></b> llen [<b><font color=#ca14ca>my</font></b> [<b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]] cget <font color=#653760>-LLEN</font>]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tright</font> eq <font color=#8b2a0e>&quot;end&quot;</font> || <font color=#1b1baa>$tright</font>&gt;=<font color=#1b1baa>$llen</font>} {<b><font color=#3a6797>set</font></b> tright [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$llen</font>-1}]}
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-tleft</font> <font color=#1b1baa>$tright</font> <font color=#653760>-tright</font> <font color=#1b1baa>$tright</font>
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Aux_InitDraw <font color=#1b1baa>$BID</font>] bwidth vislen bd arrlen llen tleft hidearr tabs wframe
  <b><font color=#3a6797>set</font></b> totlen 0
  <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i <font color=#1b1baa>$tright</font>} {<font color=#1b1baa>$i</font>&gt;=0} {<b><font color=#3a6797>incr</font></b> i -1} {
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_DictItem [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font>]] TID text wb wb1 wb2 pf
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_Create <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font> <font color=#1b1baa>$wframe</font> <font color=#1b1baa>$text</font>] wb wb1 wb2
    <b><font color=#3a6797>incr</font></b> vislen [<b><font color=#3a6797>set</font></b> wlen [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-width</font>]]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$i</font>&lt;<font color=#1b1baa>$tright</font> && (<font color=#1b1baa>$vislen</font>+(<font color=#1b1baa>$tright</font>&lt;(<font color=#1b1baa>$llen</font>-1)||!<font color=#1b1baa>$hidearr</font>?<font color=#1b1baa>$arrlen:0</font>))&gt;<font color=#1b1baa>$bwidth</font>} {
      <b><font color=#3a6797>set</font></b> pf {}
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> tleft <font color=#1b1baa>$i</font>
      <b><font color=#3a6797>set</font></b> pf p
      <b><font color=#3a6797>incr</font></b> totlen <font color=#1b1baa>$wlen</font>
    }
    <b><font color=#3a6797>set</font></b> tabs [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font> <font color=#1b1baa>$i</font> [<b><font color=#ca14ca>my</font></b> Tab_ItemDict <font color=#1b1baa>$TID</font> <font color=#1b1baa>$text</font> <font color=#1b1baa>$wb</font> <font color=#1b1baa>$wb1</font> <font color=#1b1baa>$wb2</font> <font color=#1b1baa>$pf</font>]]
  }
  <b><font color=#3a6797>set</font></b> i <font color=#1b1baa>$tright</font>
  <b><font color=#3a6797>while</font></b> {<font color=#1b1baa>$behind</font> && [<b><font color=#3a6797>incr</font></b> i]&lt;<font color=#1b1baa>$llen</font> && <font color=#1b1baa>$totlen</font>&lt;<font color=#1b1baa>$bwidth</font>} {
    <i><font color=#4b5d50># go behind the right tab as far as possible</font></i>
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_DictItem [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font>]] TID text wb wb1 wb2 pf
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_Create <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font> <font color=#1b1baa>$wframe</font> <font color=#1b1baa>$text</font>] wb wb1 wb2
    <b><font color=#3a6797>incr</font></b> totlen [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-width</font>]
    <b><font color=#3a6797>if</font></b> {(<font color=#1b1baa>$totlen</font>+(<font color=#1b1baa>$i</font>&lt;(<font color=#1b1baa>$llen</font>-1)||!<font color=#1b1baa>$hidearr</font>?<font color=#1b1baa>$arrlen:0</font>))&gt;<font color=#1b1baa>$bwidth</font>} {
      <b><font color=#3a6797>set</font></b> pf {}
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>set</font></b> tright <font color=#1b1baa>$i</font>
      <b><font color=#3a6797>set</font></b> pf p
    }
    <b><font color=#3a6797>set</font></b> tabs [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font> <font color=#1b1baa>$i</font> [<b><font color=#ca14ca>my</font></b> Tab_ItemDict <font color=#1b1baa>$TID</font> <font color=#1b1baa>$text</font> <font color=#1b1baa>$wb</font> <font color=#1b1baa>$wb1</font> <font color=#1b1baa>$wb2</font> <font color=#1b1baa>$pf</font>]]
  }
  <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i <font color=#1b1baa>$tleft</font>} {<font color=#1b1baa>$i</font>&lt;<font color=#1b1baa>$llen</font>} {<b><font color=#3a6797>incr</font></b> i} {
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_DictItem [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font>]] TID text wb wb1 wb2 pf
    <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Tab_Is <font color=#1b1baa>$wb</font>] && <font color=#1b1baa>$pf</font> ne {}} {<b><font color=#ca14ca>my</font></b> Tab_Pack <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font> <font color=#1b1baa>$wb</font> <font color=#1b1baa>$wb1</font> <font color=#1b1baa>$wb2</font>}
  }
  <b><font color=#ca14ca>my</font></b> Aux_EndDraw <font color=#1b1baa>$BID</font> <font color=#1b1baa>$tleft</font> <font color=#1b1baa>$tright</font> <font color=#1b1baa>$llen</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Locked></a>
<b><font color=#ca14ca>method</font></b> Locked {BID} {
<i><font color=#4b5d50># Checks for &quot;draw locked&quot; mode: protects the menu.</font></i>

  <b><font color=#3a6797>expr</font></b> {[<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-LOCKDRAW</font>] ne {}}
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Refill></a>
<b><font color=#ca14ca>method</font></b> Refill {itab left {behind false}} {
<i><font color=#4b5d50># Fills a bar with tabs.</font></i>
<i><font color=#4b5d50>#   itab - index of tab</font></i>
<i><font color=#4b5d50>#   left - if &quot;yes&quot;, fill from left to right</font></i>
<i><font color=#4b5d50>#   behind - flag &quot;go behind the right tab&quot;</font></i>

  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Locked [<b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]]]} <b><font color=#ca14ca>return</font></b>
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> clear
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$itab</font> eq <font color=#8b2a0e>&quot;end&quot;</font> || <font color=#1b1baa>$itab</font>==([<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-LLEN</font>]-1)} {<b><font color=#3a6797>set</font></b> left 0}
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$left</font>} {
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> FillFromLeft <font color=#1b1baa>$itab</font>
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> FillFromRight 0 <font color=#1b1baa>$itab</font> <font color=#1b1baa>$behind</font>
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=CheckDsblPopup></a>
<b><font color=#ca14ca>method</font></b> CheckDsblPopup {BID TID mnuit} {
<i><font color=#4b5d50># Controls disabling of Close* menu items.</font></i>
<i><font color=#4b5d50>#   mnuit - menu label</font></i>
<i><font color=#4b5d50># Returns &quot;yes&quot; for disabled menu item</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_BID <font color=#1b1baa>$TID</font>] BID icur
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-static</font> <font color=#653760>-LLEN</font>] static llen
  <b><font color=#3a6797>set</font></b> dsbl [<b><font color=#ca14ca>my</font></b> Disabled <font color=#1b1baa>$TID</font>]
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Mc_MenuItems] list behind close closeall closeleft closeright
  <b><font color=#3a6797>switch</font></b> <font color=#653760>-exact</font> -- <font color=#1b1baa>$mnuit</font> [<b><font color=#3a6797>list</font></b> \
    BHND {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$static</font>} {<b><font color=#ca14ca>return</font></b> 2}
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> slen [<b><font color=#3a6797>llength</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> listFlag <font color=#8b2a0e>&quot;s&quot;</font>]]]&gt;1} {
        <b><font color=#3a6797>set</font></b> mnuit [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %n <font color=#1b1baa>$slen</font>] [msgcat::mc <font color=#8b2a0e>&quot;%n tabs&quot;</font>]]
      } <b><font color=#3a6797>else</font></b> {
        <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_TextEllipsed <font color=#1b1baa>$BID</font> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-text</font>] 16] mnuit
        <b><font color=#3a6797>set</font></b> mnuit <font color=#8b2a0e>&quot;\&quot;<font color=#1b1baa>$</font>mnuit\&quot;&quot;</font>
      }
      <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>list</font></b> [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$dsbl</font>||<font color=#1b1baa>$llen</font>&lt;2||<font color=#1b1baa>$llen</font>==2&&<font color=#1b1baa>$icur</font>==1}] {} <font color=#8b2a0e>&quot;<font color=#1b1baa>$</font>mnuit <font color=#1b1baa>$</font>behind&quot;</font>]
    } \
    <font color=#1b1baa>$close</font> - <font color=#1b1baa>$closeall</font> - {} {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$static</font>} {<b><font color=#ca14ca>return</font></b> 2}
    } \
    <font color=#1b1baa>$closeleft</font> {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$static</font>} {<b><font color=#ca14ca>return</font></b> 2}
      <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$dsbl</font> || !<font color=#1b1baa>$icur</font>}]
    } \
    <font color=#1b1baa>$closeright</font> {
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$static</font>} {<b><font color=#ca14ca>return</font></b> 2}
      <b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$dsbl</font> || <font color=#1b1baa>$icur</font>==(<font color=#1b1baa>$llen</font>-1)}]
    } \
  ]
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$dsbl</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=NeedDraw></a>
<b><font color=#ca14ca>method</font></b> NeedDraw {} {
<i><font color=#4b5d50># Redraws a bar at need.</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-wproc</font> <font color=#653760>-BWIDTH</font> <font color=#653760>-ARRLEN</font>] wproc bwo arrlen
  <b><font color=#3a6797>set</font></b> bw [{<b><font color=#3a6797>*</font></b>}[<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> %b <font color=#1b1baa>$BID</font>] <font color=#1b1baa>$wproc</font>]]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$bwo</font> eq {} || [<b><font color=#3a6797>set</font></b> need [<b><font color=#3a6797>expr</font></b> {abs(<font color=#1b1baa>$bwo</font>-<font color=#1b1baa>$bw</font>)&gt;<font color=#1b1baa>$arrlen</font>} && <font color=#1b1baa>$bw</font>&gt;10]]} {
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-BWIDTH</font> <font color=#1b1baa>$bw</font>
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$bwo</font> ne {} && <font color=#1b1baa>$need</font>} {
    <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>after</font></b> cancel <font color=#1b1baa>$::bartabs::NewAfterID($BID)</font>}
    <b><font color=#3a6797>set</font></b> ::bartabs::NewAfterID(<font color=#1b1baa>$BID</font>) [<b><font color=#3a6797>after</font></b> 10 [<b><font color=#3a6797>list</font></b> [<b><font color=#ca14ca>self</font></b>] <font color=#1b1baa>$BID</font> draw]]
  }
}
<a id=Exported_methods_of_Bar></a>
<i><font color=#4b5d50>## ____________ Exported methods of Bar ____________ ##</font></i>
<a id=_runBound_></a>
<b><font color=#ca14ca>method</font></b> _runBound_ {w ev args} {
<i><font color=#4b5d50># Runs a method bound to an event occuring at a widget.</font></i>
<i><font color=#4b5d50>#   w - widget</font></i>
<i><font color=#4b5d50>#   ev - event</font></i>
<i><font color=#4b5d50>#   args - the bound method & its arguments</font></i>

  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#ca14ca>my</font></b> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>}]} { ;<i><font color=#4b5d50># failed binding =&gt; remove it</font></i>
    <b><font color=#3a6797>foreach</font></b> b [<b><font color=#3a6797>split</font></b> [<b><font color=#134070>bind</font></b> <font color=#1b1baa>$w</font> <font color=#1b1baa>$ev</font>] \n] {
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> first <font color=#1b1baa>$args</font> <font color=#1b1baa>$b</font>]==-1} {
        <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>incr</font></b> is1]==1} {<b><font color=#134070>bind</font></b> <font color=#1b1baa>$w</font> <font color=#1b1baa>$ev</font> <font color=#1b1baa>$b</font>} {<b><font color=#ca14ca>my</font></b> bindToEvent <font color=#1b1baa>$w</font> <font color=#1b1baa>$ev</font> <font color=#1b1baa>$b</font>}
      }
    }
  }
}

export _runBound_
<a id=Auxiliary_methods_of_Bar></a>
<i><font color=#4b5d50>## ____________ Auxiliary methods of Bar ____________ ##</font></i>
<a id=Aux_WidgetWidth></a>
<b><font color=#ca14ca>method</font></b> Aux_WidgetWidth {w} {
<i><font color=#4b5d50># Calculates a widget's width.</font></i>

  <b><font color=#3a6797>if</font></b> {![<b><font color=#134070>winfo</font></b> exists <font color=#1b1baa>$w</font>]} {<b><font color=#ca14ca>return</font></b> 0}
  <b><font color=#3a6797>set</font></b> wwidth [<b><font color=#134070>winfo</font></b> width <font color=#1b1baa>$w</font>]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$wwidth</font>&lt;2} {<b><font color=#3a6797>set</font></b> wwidth [<b><font color=#134070>winfo</font></b> reqwidth <font color=#1b1baa>$w</font>]}
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$wwidth</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Aux_InitDraw></a>
<b><font color=#ca14ca>method</font></b> Aux_InitDraw {BID {clearpf yes}} {
<i><font color=#4b5d50># Auxiliary method used before cycles drawing tabs.</font></i>
<i><font color=#4b5d50># Returns a list of main options of drawing tabs.</font></i>

  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> InitColors
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget \
    <font color=#653760>-tleft</font> <font color=#653760>-hidearrows</font> <font color=#653760>-LLEN</font> <font color=#653760>-WWID</font> <font color=#653760>-bd</font> <font color=#653760>-wbase</font> <font color=#653760>-wbar</font> <font color=#653760>-ARRLEN</font> <font color=#653760>-wproc</font>] \
    tleft hidearr llen wwid bd wbase wbar arrlen wproc
  <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$wwid</font> wframe wlarr
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$arrlen</font> eq {}} {
    <b><font color=#3a6797>set</font></b> arrlen [<b><font color=#134070>winfo</font></b> reqwidth <font color=#1b1baa>$wlarr</font>]
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-wbase</font> <font color=#1b1baa>$wbase</font> <font color=#653760>-ARRLEN</font> <font color=#1b1baa>$arrlen</font>
  }
  <b><font color=#3a6797>set</font></b> bwidth [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Width]
  <b><font color=#3a6797>set</font></b> vislen [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$tleft</font> || !<font color=#1b1baa>$hidearr</font> ? <font color=#1b1baa>$arrlen</font> : 0}]
  <b><font color=#3a6797>set</font></b> tabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-TABS</font>]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$clearpf</font>} {<b><font color=#3a6797>foreach</font></b> tab <font color=#1b1baa>$tabs</font> {<b><font color=#ca14ca>my</font></b> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tab</font> 0] configure <font color=#653760>-pf</font> {}}}
  <b><font color=#3a6797>list</font></b> <font color=#1b1baa>$bwidth</font> <font color=#1b1baa>$vislen</font> <font color=#1b1baa>$bd</font> <font color=#1b1baa>$arrlen</font> <font color=#1b1baa>$llen</font> <font color=#1b1baa>$tleft</font> <font color=#1b1baa>$hidearr</font> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$wframe</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Aux_CheckTabVisible></a>
<b><font color=#ca14ca>method</font></b> Aux_CheckTabVisible {wb wb1 wb2 i tleft trightN vislenN llen hidearr arrlen bd bwidth tabsN TID text} {
<i><font color=#4b5d50># Auxiliary method used to check if a tab is visible.</font></i>

  <b><font color=#3a6797>upvar</font></b> 1 <font color=#1b1baa>$trightN</font> tright <font color=#1b1baa>$tabsN</font> tabs <font color=#1b1baa>$vislenN</font> vislen
  <b><font color=#3a6797>incr</font></b> vislen [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> cget <font color=#653760>-width</font>]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$i</font>&gt;<font color=#1b1baa>$tleft</font> && (<font color=#1b1baa>$vislen</font>+((<font color=#1b1baa>$i</font>+1)&lt;<font color=#1b1baa>$llen</font>||!<font color=#1b1baa>$hidearr</font>?<font color=#1b1baa>$arrlen:0</font>))&gt;<font color=#1b1baa>$bwidth</font>} {
    <b><font color=#134070>pack</font></b> forget <font color=#1b1baa>$wb</font>
    <b><font color=#3a6797>set</font></b> pf {}
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> tright <font color=#1b1baa>$i</font>
    <b><font color=#3a6797>set</font></b> pf p
  }
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> configure <font color=#653760>-wb</font> <font color=#1b1baa>$wb</font> <font color=#653760>-wb1</font> <font color=#1b1baa>$wb1</font> <font color=#653760>-wb2</font> <font color=#1b1baa>$wb2</font> <font color=#653760>-pf</font> <font color=#1b1baa>$pf</font>
  <b><font color=#3a6797>string</font></b> length <font color=#1b1baa>$pf</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Aux_EndDraw></a>
<b><font color=#ca14ca>method</font></b> Aux_EndDraw {BID tleft tright llen} {
<i><font color=#4b5d50># Auxiliary method used after cycles drawing tabs.</font></i>

  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> ArrowsState <font color=#1b1baa>$tleft</font> <font color=#1b1baa>$tright</font> [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$tright</font> &lt; (<font color=#1b1baa>$llen</font>-1)}]
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-tleft</font> <font color=#1b1baa>$tleft</font> <font color=#653760>-tright</font> <font color=#1b1baa>$tright</font>
  <b><font color=#ca14ca>my</font></b> Tab_Bindings <font color=#1b1baa>$BID</font>
  <b><font color=#ca14ca>my</font></b> Tab_MarkBar <font color=#1b1baa>$BID</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=Aux_IndexInList></a>
<b><font color=#ca14ca>method</font></b> Aux_IndexInList {ID lst} {
<i><font color=#4b5d50># Searches ID in list.</font></i>

  <b><font color=#3a6797>set</font></b> i 0
  <b><font color=#3a6797>foreach</font></b> it <font color=#1b1baa>$lst</font> {
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$it</font> 0]==<font color=#1b1baa>$ID</font>} {<b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$i</font>}
    <b><font color=#3a6797>incr</font></b> i
  }
  <b><font color=#ca14ca>return</font></b> -1
}
<a id=Public_methods_of_Bar></a>
<i><font color=#4b5d50>## ____________ Public methods of Bar ____________ ##</font></i>
<a id=cget></a>
<b><font color=#ca14ca>method</font></b> cget {args} {
<i><font color=#4b5d50># Gets values of options of bars & tabs.</font></i>
<i><font color=#4b5d50>#   args - list of options, e.g. {-tabcurrent -MyOpt}</font></i>
<i><font color=#4b5d50># Return a list of values or one value if args is one option.</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>variable</font></b> btData
  <b><font color=#3a6797>set</font></b> res [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>set</font></b> llen [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$btData</font> <font color=#1b1baa>$BID</font> <font color=#653760>-LLEN</font>]
  <b><font color=#3a6797>foreach</font></b> opt <font color=#1b1baa>$args</font> {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$opt</font> eq <font color=#8b2a0e>&quot;-listlen&quot;</font>} {
      <b><font color=#3a6797>lappend</font></b> res <font color=#1b1baa>$llen</font>
    } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$opt</font> eq <font color=#8b2a0e>&quot;-width&quot;</font>} {
      <b><font color=#3a6797>lassign</font></b> [<b><font color=#3a6797>dict</font></b> get [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$btData</font> <font color=#1b1baa>$BID</font>] <font color=#653760>-wbar</font>] wbar
      <b><font color=#3a6797>lappend</font></b> res [<b><font color=#ca14ca>my</font></b> Aux_WidgetWidth <font color=#1b1baa>$wbar</font>]
    } <b><font color=#3a6797>elseif</font></b> {[<b><font color=#3a6797>dict</font></b> exists <font color=#1b1baa>$btData</font> <font color=#1b1baa>$BID</font> <font color=#1b1baa>$opt</font>] && (<font color=#1b1baa>$llen</font> || <font color=#1b1baa>$opt</font> ne <font color=#8b2a0e>&quot;-tabcurrent&quot;</font>)} {
      <b><font color=#3a6797>lappend</font></b> res [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$btData</font> <font color=#1b1baa>$BID</font> <font color=#1b1baa>$opt</font>]
    } <b><font color=#3a6797>else</font></b> {
      <b><font color=#3a6797>lappend</font></b> res {}
    }
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$args</font>]==1} {<b><font color=#ca14ca>return</font></b> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$res</font> 0]}
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$res</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=configure></a>
<b><font color=#ca14ca>method</font></b> configure {args} {
<i><font color=#4b5d50># Sets values of options for bars & tabs.</font></i>
<i><font color=#4b5d50>#   args - list of pairs &quot;option value&quot;</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>variable</font></b> btData
  <b><font color=#3a6797>foreach</font></b> {opt val} <font color=#1b1baa>$args</font> {
    <b><font color=#3a6797>dict</font></b> set btData <font color=#1b1baa>$BID</font> <font color=#1b1baa>$opt</font> <font color=#1b1baa>$val</font>
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$opt</font> eq <font color=#8b2a0e>&quot;-TABS&quot;</font>} {<b><font color=#3a6797>dict</font></b> set btData <font color=#1b1baa>$BID</font> <font color=#653760>-LLEN</font> [<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$val</font>]}
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>dict</font></b> exists <font color=#1b1baa>$args</font> <font color=#653760>-static</font>]} {<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Style}
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=draw></a>
<b><font color=#ca14ca>method</font></b> draw {{upd yes}} {
<i><font color=#4b5d50># Draws the bar tabs at slight changes.</font></i>
<i><font color=#4b5d50>#   upd - if &quot;yes&quot;, run &quot;update&quot; before redrawing</font></i>

  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Locked [<b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]]]} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$upd</font>} <b><font color=#3a6797>update</font></b>
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Aux_InitDraw <font color=#1b1baa>$BID</font>] bwidth vislen bd arrlen llen tleft hidearr tabs wframe
  <b><font color=#3a6797>set</font></b> tright [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$llen</font>-1}]
  <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>set</font></b> i <font color=#1b1baa>$tleft</font>} {<font color=#1b1baa>$i</font>&lt;<font color=#1b1baa>$llen</font>} {<b><font color=#3a6797>incr</font></b> i} {
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_DictItem [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font>]] TID text wb wb1 wb2 pf
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_Create <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font> <font color=#1b1baa>$wframe</font> <font color=#1b1baa>$text</font>] wb wb1 wb2
    <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Aux_CheckTabVisible <font color=#1b1baa>$wb</font> <font color=#1b1baa>$wb1</font> <font color=#1b1baa>$wb2</font> <font color=#1b1baa>$i</font> <font color=#1b1baa>$tleft</font> tright vislen <font color=#1b1baa>$llen</font> <font color=#1b1baa>$hidearr</font> <font color=#1b1baa>$arrlen</font> <font color=#1b1baa>$bd</font> <font color=#1b1baa>$bwidth</font> tabs <font color=#1b1baa>$TID</font> <font color=#1b1baa>$text</font>]} {
      <b><font color=#ca14ca>my</font></b> Tab_Pack <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font> <font color=#1b1baa>$wb</font> <font color=#1b1baa>$wb1</font> <font color=#1b1baa>$wb2</font>
    }
  }
  <b><font color=#ca14ca>my</font></b> Aux_EndDraw <font color=#1b1baa>$BID</font> <font color=#1b1baa>$tleft</font> <font color=#1b1baa>$tright</font> <font color=#1b1baa>$llen</font>
  <b><font color=#ca14ca>my</font></b> Tab_MarkBar <font color=#1b1baa>$BID</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=update></a>
<b><font color=#ca14ca>method</font></b> update {} {
<i><font color=#4b5d50># Updates the bar in hard way.</font></i>

  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Locked [<b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]]]} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>update</font></b>
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Refill 0 yes
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=clear></a>
<b><font color=#ca14ca>method</font></b> clear {} {
<i><font color=#4b5d50># Forgets (hides) the shown tabs.</font></i>

  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Locked [<b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]]]} <b><font color=#ca14ca>return</font></b>
  <b><font color=#3a6797>set</font></b> wlist []
  <b><font color=#3a6797>foreach</font></b> tab [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> listTab] {
    <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$tab</font> TID text wb wb1 wb2 pf
    <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> Tab_Is <font color=#1b1baa>$wb</font>] && <font color=#1b1baa>$pf</font> ne {}} {
      <b><font color=#3a6797>lappend</font></b> wlist <font color=#1b1baa>$wb</font>
      <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> configure <font color=#653760>-pf</font> {}
    }
  }
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$wlist</font>]} {<b><font color=#134070>pack</font></b> forget {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$wlist</font>}
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=scrollLeft></a>
<b><font color=#ca14ca>method</font></b> scrollLeft {} {
  <i><font color=#4b5d50># Scrolls tabs to the left.</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-wbar</font> <font color=#653760>-dotip</font>] w dotip
  <b><font color=#3a6797>set</font></b> wlarr <font color=#1b1baa>$w</font>.larr   ;<i><font color=#4b5d50># left arrow</font></i>
  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> ScrollCurr -1]} {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$dotip</font>} {<b><font color=#3a6797>catch</font></b> {::baltip::repaint <font color=#1b1baa>$wlarr</font>}}
    <b><font color=#ca14ca>return</font></b>
  }
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-tleft</font> <font color=#653760>-LLEN</font> <font color=#653760>-scrollsel</font>] tleft llen sccur
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>string</font></b> is integer <font color=#653760>-strict</font> <font color=#1b1baa>$tleft</font>]} {<b><font color=#3a6797>set</font></b> tleft 0}
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tleft</font> && <font color=#1b1baa>$tleft</font>&lt;<font color=#1b1baa>$llen</font>} {
    <b><font color=#3a6797>incr</font></b> tleft -1
    <b><font color=#3a6797>set</font></b> tID [<b><font color=#3a6797>lindex</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> listTab] <font color=#1b1baa>$tleft</font> 0]
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-tleft</font> <font color=#1b1baa>$tleft</font>
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Refill <font color=#1b1baa>$tleft</font> yes
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$sccur</font>} {<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$tID</font> Tab_BeCurrent}
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$dotip</font>} {<b><font color=#3a6797>catch</font></b> {::baltip::repaint <font color=#1b1baa>$wlarr</font>}}
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=scrollRight></a>
<b><font color=#ca14ca>method</font></b> scrollRight {} {
  <i><font color=#4b5d50># Scrolls tabs to the right.</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-wbar</font> <font color=#653760>-dotip</font>] w dotip
  <b><font color=#3a6797>set</font></b> wrarr <font color=#1b1baa>$w</font>.rarr   ;<i><font color=#4b5d50># left arrow</font></i>
  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> ScrollCurr 1]} {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$dotip</font>} {<b><font color=#3a6797>catch</font></b> {::baltip::repaint <font color=#1b1baa>$wrarr</font>}}
    <b><font color=#ca14ca>return</font></b>
  }
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-tright</font> <font color=#653760>-LLEN</font> <font color=#653760>-scrollsel</font>] tright llen sccur
  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>string</font></b> is integer <font color=#653760>-strict</font> <font color=#1b1baa>$tright</font>]} {<b><font color=#3a6797>set</font></b> tright [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$llen</font>-2}]}
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tright</font>&lt;(<font color=#1b1baa>$llen</font>-1)} {
    <b><font color=#3a6797>incr</font></b> tright
    <b><font color=#3a6797>set</font></b> tID [<b><font color=#3a6797>lindex</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> listTab] <font color=#1b1baa>$tright</font> 0]
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-tright</font> <font color=#1b1baa>$tright</font>
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Refill <font color=#1b1baa>$tright</font> no
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$sccur</font>} {<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$tID</font> Tab_BeCurrent}
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$dotip</font>} {<b><font color=#3a6797>catch</font></b> {::baltip::repaint <font color=#1b1baa>$wrarr</font>}}
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=listTab></a>
<b><font color=#ca14ca>method</font></b> listTab {} {
<i><font color=#4b5d50># Gets a list of tabs.</font></i>
<i><font color=#4b5d50># Returns a list of TID, text, wb, wb1, wb2, pf.</font></i>

  <b><font color=#3a6797>set</font></b> res [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>foreach</font></b> tab [<b><font color=#ca14ca>my</font></b> [<b><font color=#ca14ca>my</font></b> ID] cget <font color=#653760>-TABS</font>] {<b><font color=#3a6797>lappend</font></b> res [<b><font color=#ca14ca>my</font></b> Tab_DictItem <font color=#1b1baa>$tab</font>]}
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$res</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=comparetext></a>
<b><font color=#ca14ca>method</font></b> comparetext {it1 it2} {
<i><font color=#4b5d50># Compares items (by -text attribute) for sort method.</font></i>
<i><font color=#4b5d50>#   it1 - 1st item to compare</font></i>
<i><font color=#4b5d50>#   it2 - 2nd item to compare</font></i>
<i><font color=#4b5d50># See also: sort</font></i>

  <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> it1 [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$it1</font> <font color=#653760>-text</font>]}
  <b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> it2 [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$it2</font> <font color=#653760>-text</font>]}
  <b><font color=#3a6797>string</font></b> compare <font color=#653760>-nocase</font> <font color=#1b1baa>$it1</font> <font color=#1b1baa>$it2</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=sort></a>
<b><font color=#ca14ca>method</font></b> sort {{mode <font color=#653760>-increasing</font>} {cmd <font color=#8b2a0e>&quot;&quot;</font>}} {
<i><font color=#4b5d50># Sorts a list of tabs by the tab names.</font></i>
<i><font color=#4b5d50>#   mode - option of sort</font></i>
<i><font color=#4b5d50>#   cmd - command to compare two items</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-tabcurrent</font> <font color=#653760>-lifo</font>] TID lifo
  <b><font color=#3a6797>set</font></b> tabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-TABS</font>]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$cmd</font> eq {}} {
    <b><font color=#3a6797>set</font></b> tabs [<b><font color=#3a6797>lsort</font></b> <font color=#1b1baa>$mode</font> <font color=#653760>-index</font> 1 <font color=#653760>-dictionary</font> <font color=#653760>-command</font> <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> comparetext&quot;</font> <font color=#1b1baa>$tabs</font>]
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> tabs [<b><font color=#3a6797>lsort</font></b> <font color=#1b1baa>$mode</font> <font color=#653760>-dictionary</font> <font color=#653760>-command</font> <font color=#1b1baa>$cmd</font> <font color=#1b1baa>$tabs</font>]
  }
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-TABS</font> <font color=#1b1baa>$tabs</font> <font color=#653760>-lifo</font> no
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> show yes
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-lifo</font> <font color=#1b1baa>$lifo</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=listFlag></a>
<b><font color=#ca14ca>method</font></b> listFlag {{filter <font color=#8b2a0e>&quot;&quot;</font>}} {
<i><font color=#4b5d50># Gets a list of TID + flags &quot;visible&quot;, &quot;marked&quot;, &quot;selected&quot;, &quot;disabled&quot;.</font></i>
<i><font color=#4b5d50>#   filter - &quot;&quot; for all or &quot;v&quot;,&quot;m&quot;,&quot;s&quot;,&quot;d&quot; for visible, marked, selected, disabled</font></i>
<i><font color=#4b5d50># Returns a list &quot;TID, text, visible, marked, selected, disabled&quot; for all or a list of TID for filtered.</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-mark</font> <font color=#653760>-disable</font> <font color=#653760>-select</font> <font color=#653760>-tabcurrent</font>] mark dsbl fewsel tcurr
  <b><font color=#3a6797>set</font></b> res [<b><font color=#3a6797>list</font></b>]
  <b><font color=#3a6797>foreach</font></b> tab [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> listTab] {
    <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$tab</font> TID text wb wb1 wb2 pf
    <b><font color=#3a6797>set</font></b> visibl [<b><font color=#3a6797>expr</font></b> {[<b><font color=#ca14ca>my</font></b> Tab_Is <font color=#1b1baa>$wb</font>] && <font color=#1b1baa>$pf</font> ne {}}]
    <b><font color=#3a6797>set</font></b> marked [<b><font color=#3a6797>expr</font></b> {[<b><font color=#3a6797>lsearch</font></b> <font color=#1b1baa>$mark</font> <font color=#1b1baa>$TID</font>]&gt;=0}]
    <b><font color=#3a6797>set</font></b> dsbled [<b><font color=#3a6797>expr</font></b> {[<b><font color=#3a6797>lsearch</font></b> <font color=#1b1baa>$dsbl</font> <font color=#1b1baa>$TID</font>]&gt;=0}]
    <b><font color=#3a6797>set</font></b> select [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$TID</font> == <font color=#1b1baa>$tcurr</font> || [<b><font color=#3a6797>lsearch</font></b> <font color=#1b1baa>$fewsel</font> <font color=#1b1baa>$TID</font>]&gt;-1}]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$filter</font> eq {}} {
      <b><font color=#3a6797>lappend</font></b> res [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$TID</font> <font color=#1b1baa>$text</font> <font color=#1b1baa>$visibl</font> <font color=#1b1baa>$marked</font> <font color=#1b1baa>$select</font> <font color=#1b1baa>$dsbled</font>]
    } <b><font color=#3a6797>elseif</font></b> {<font color=#1b1baa>$filter</font> eq <font color=#8b2a0e>&quot;v&quot;</font> && <font color=#1b1baa>$visibl</font> || <font color=#1b1baa>$filter</font> eq <font color=#8b2a0e>&quot;m&quot;</font> && <font color=#1b1baa>$marked</font> || \
              <font color=#1b1baa>$filter</font> eq <font color=#8b2a0e>&quot;d&quot;</font> && <font color=#1b1baa>$dsbled</font> || <font color=#1b1baa>$filter</font> eq <font color=#8b2a0e>&quot;s&quot;</font> && <font color=#1b1baa>$select</font>} {
      <b><font color=#3a6797>lappend</font></b> res <font color=#1b1baa>$TID</font>
    }
  }
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$res</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=insertTab></a>
<b><font color=#ca14ca>method</font></b> insertTab {txt {pos <font color=#8b2a0e>&quot;end&quot;</font>} {img <font color=#8b2a0e>&quot;&quot;</font>}} {
<i><font color=#4b5d50># Inserts a new tab into a bar.</font></i>
<i><font color=#4b5d50>#   txt - tab's label</font></i>
<i><font color=#4b5d50>#   pos - tab's position in tab list</font></i>
<i><font color=#4b5d50>#   img - tab's image</font></i>
<i><font color=#4b5d50># Returns TID of new tab or &quot;&quot;.</font></i>

  <b><font color=#3a6797>set</font></b> tabs [<b><font color=#ca14ca>my</font></b> [<b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]] cget <font color=#653760>-TABS</font>]
  <b><font color=#3a6797>set</font></b> tab [<b><font color=#ca14ca>my</font></b> Tab_Data <font color=#1b1baa>$BID</font> <font color=#1b1baa>$txt</font>]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tab</font> eq {}} {<b><font color=#ca14ca>return</font></b> {}}
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$pos</font> eq {end}} {
    <b><font color=#3a6797>lappend</font></b> tabs <font color=#1b1baa>$tab</font>
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> tabs [<b><font color=#3a6797>linsert</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$pos</font> <font color=#1b1baa>$tab</font>]
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$img</font> ne {}} {
    <b><font color=#3a6797>set</font></b> imagetabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-IMAGETABS</font>]
    <b><font color=#3a6797>lappend</font></b> imagetabs [<b><font color=#3a6797>list</font></b> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tab</font> 0] <font color=#1b1baa>$img</font>]
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-IMAGETABS</font> <font color=#1b1baa>$imagetabs</font>
  }
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-TABS</font> <font color=#1b1baa>$tabs</font>
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Refill <font color=#1b1baa>$pos</font> [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$pos</font> ne <font color=#8b2a0e>&quot;end&quot;</font>}]
  <b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tab</font> 0
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=tabID></a>
<b><font color=#ca14ca>method</font></b> tabID {txt} {
<i><font color=#4b5d50># Gets TID by tab's label.</font></i>
<i><font color=#4b5d50>#   txt - label</font></i>
<i><font color=#4b5d50># Returns TID or -1.</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>set</font></b> ellipse [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-ELLIPSE</font>]}]} {<b><font color=#ca14ca>return</font></b> {}}
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> first <font color=#1b1baa>$ellipse</font> <font color=#1b1baa>$txt</font>]&gt;0} {
    <b><font color=#3a6797>set</font></b> pattern [<b><font color=#3a6797>string</font></b> map [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$ellipse</font> <font color=#8b2a0e>&quot;*&quot;</font>] <font color=#1b1baa>$txt</font>]
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> pattern {}
  }
  <b><font color=#3a6797>foreach</font></b> tab [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> listTab] {
    <b><font color=#3a6797>lassign</font></b> <font color=#1b1baa>$tab</font> tID ttxt
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$txt</font> eq <font color=#1b1baa>$ttxt</font>} {<b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$tID</font>}
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$pattern</font> ne {} && [<b><font color=#3a6797>string</font></b> match <font color=#1b1baa>$pattern</font> <font color=#1b1baa>$ttxt</font>]} {<b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$tID</font>}
  }
  <b><font color=#ca14ca>return</font></b> {}
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=popList></a>
<b><font color=#ca14ca>method</font></b> popList {{X <font color=#8b2a0e>&quot;&quot;</font>} {Y <font color=#8b2a0e>&quot;&quot;</font>} {sortedList 0}} {
<i><font color=#4b5d50># Shows a menu of tabs.</font></i>
<i><font color=#4b5d50>#   X - x coordinate of mouse pointer</font></i>
<i><font color=#4b5d50>#   Y - y coordinate of mouse pointer</font></i>
<i><font color=#4b5d50>#   sortedList - flag &quot;sorted list&quot;</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> DestroyMoveWindow
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-wbar</font> <font color=#653760>-title</font>] wbar title
  <b><font color=#3a6797>set</font></b> popi <font color=#1b1baa>$wbar</font>.popupList
  <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>destroy</font></b> <font color=#1b1baa>$popi</font>}
  <b><font color=#134070>menu</font></b> <font color=#1b1baa>$popi</font> <font color=#653760>-tearoff</font> 1 <font color=#653760>-title</font> <font color=#1b1baa>$title</font>
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> plist [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> FillMenuList <font color=#1b1baa>$BID</font> <font color=#1b1baa>$popi</font> -1 {} <font color=#1b1baa>$sortedList</font>]] eq <font color=#8b2a0e>&quot;s&quot;</font>} {
    <b><font color=#134070>destroy</font></b> <font color=#1b1baa>$popi</font>
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#ca14ca>my</font></b> Bar_MenuList <font color=#1b1baa>$BID</font> -1 <font color=#1b1baa>$popi</font> <font color=#1b1baa>$plist</font>
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$X</font> eq {}} {<b><font color=#3a6797>lassign</font></b> [<b><font color=#134070>winfo</font></b> pointerxy .] X Y}
    <b><font color=#134070>tk_popup</font></b> <font color=#1b1baa>$popi</font> <font color=#1b1baa>$X</font> <font color=#1b1baa>$Y</font>
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=remove></a>
<b><font color=#ca14ca>method</font></b> remove {} {
<i><font color=#4b5d50># Removes a bar.</font></i>
<i><font color=#4b5d50># Returns &quot;yes&quot; at success.</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>variable</font></b> btData
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>dict</font></b> exists <font color=#1b1baa>$btData</font> <font color=#1b1baa>$BID</font>]} {
    <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>bind</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-wbase</font>] &lt;Configure&gt; {}}
    <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-BINDWBASE</font>] wb bnd
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$wb</font> ne {}} {<b><font color=#134070>bind</font></b> <font color=#1b1baa>$wb</font> &lt;Configure&gt; <font color=#1b1baa>$bnd</font>}
    <b><font color=#3a6797>set</font></b> bar [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$btData</font> <font color=#1b1baa>$BID</font>]
    <b><font color=#3a6797>foreach</font></b> tab [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$bar</font> <font color=#653760>-TABS</font>] {<b><font color=#ca14ca>my</font></b> Tab_RemoveLinks <font color=#1b1baa>$BID</font> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tab</font> 0]}
    <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>destroy</font></b> {<b><font color=#3a6797>*</font></b>}[<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$bar</font> <font color=#653760>-WWID</font>]}
    <b><font color=#3a6797>catch</font></b> {<b><font color=#134070>destroy</font></b> [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-UNDERWID</font>]}
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> bc [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-BARCOM</font>]] ne {}} {<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>rename</font></b> <font color=#1b1baa>$bc</font> {}}}
    <b><font color=#3a6797>foreach</font></b> tc [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-TABCOM</font>] {<b><font color=#3a6797>catch</font></b> {<b><font color=#3a6797>rename</font></b> [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tc</font> 1] {}}}
    <b><font color=#3a6797>dict</font></b> unset btData <font color=#1b1baa>$BID</font>
    <b><font color=#ca14ca>return</font></b> yes
  }
  <b><font color=#ca14ca>return</font></b> no
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=moveTab></a>
<b><font color=#ca14ca>method</font></b> moveTab {TID pos} {
  <i><font color=#4b5d50># Moves a tab to a new position in the bar.</font></i>
  <i><font color=#4b5d50>#   pos - the new position</font></i>

  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> ID]
  <b><font color=#3a6797>set</font></b> tabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-TABS</font>]
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>lsearch</font></b> <font color=#653760>-index</font> 0 <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$TID</font>]]&gt;-1} {
    <b><font color=#3a6797>set</font></b> tab [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font>]
    <b><font color=#3a6797>set</font></b> tabs [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font> <font color=#1b1baa>$i</font>]
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-TABS</font> [<b><font color=#3a6797>linsert</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$pos</font> <font color=#1b1baa>$tab</font>]
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=checkDisabledMenu></a>
<b><font color=#ca14ca>method</font></b> checkDisabledMenu {BID TID func} {
<i><font color=#4b5d50># Checks whether the popup menu's items are disabled.</font></i>
<i><font color=#4b5d50>#   func - close function</font></i>
<i><font color=#4b5d50># *func* equals to:</font></i>
<i><font color=#4b5d50>#   1 - for &quot;Close All&quot;</font></i>
<i><font color=#4b5d50>#   2 - for &quot;Close All at Left&quot;</font></i>
<i><font color=#4b5d50>#   3 - for &quot;Close All at Right&quot;</font></i>
<i><font color=#4b5d50># Returns &quot;yes&quot; if the menu's item is disabled.</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Mc_MenuItems] list behind close closeall closeleft closeright
  <b><font color=#3a6797>switch</font></b> <font color=#1b1baa>$func</font> {
    1 {<b><font color=#3a6797>set</font></b> item <font color=#1b1baa>$closeall</font>}
    2 {<b><font color=#3a6797>set</font></b> item <font color=#1b1baa>$closeleft</font>}
    3 {<b><font color=#3a6797>set</font></b> item <font color=#1b1baa>$closeright</font>}
    <b><font color=#3a6797>default</font></b> {<b><font color=#3a6797>set</font></b> item <font color=#1b1baa>$close</font>}
  }
  <b><font color=#ca14ca>my</font></b> CheckDsblPopup <font color=#1b1baa>$BID</font> <font color=#1b1baa>$TID</font> <font color=#1b1baa>$item</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=closeAll></a>
<b><font color=#ca14ca>method</font></b> closeAll {BID TID func args} {
<i><font color=#4b5d50># Closes tabs of bar.</font></i>
<i><font color=#4b5d50>#   func - close function</font></i>
<i><font color=#4b5d50># *func* equals to:</font></i>
<i><font color=#4b5d50>#   1 - for &quot;Close All&quot;</font></i>
<i><font color=#4b5d50>#   2 - for &quot;Close All at Left&quot;</font></i>
<i><font color=#4b5d50>#   3 - for &quot;Close All at Right&quot;</font></i>

  <b><font color=#3a6797>switch</font></b> <font color=#1b1baa>$func</font> {
    1 {<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Tab_CloseFew -1   no {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>}
    2 {<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Tab_CloseFew <font color=#1b1baa>$TID</font> yes}
    3 {<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Tab_CloseFew <font color=#1b1baa>$TID</font> no}
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=bindToEvent></a>
<b><font color=#ca14ca>method</font></b> bindToEvent {w event args} {
  <i><font color=#4b5d50># Binds an event on a widget to a command.</font></i>
  <i><font color=#4b5d50>#   w - the widget's path</font></i>
  <i><font color=#4b5d50>#   event - the event</font></i>
  <i><font color=#4b5d50>#   args - the command</font></i>

  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>string</font></b> first <font color=#1b1baa>$args</font> [<b><font color=#134070>bind</font></b> <font color=#1b1baa>$w</font> <font color=#1b1baa>$event</font>]]&lt;0} {
    <b><font color=#134070>bind</font></b> <font color=#1b1baa>$w</font> <font color=#1b1baa>$event</font> [<b><font color=#3a6797>list</font></b> + {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>]
  }
}
<a id=EOC_Bar></a>
<i><font color=#4b5d50>## ____________ EOC Bar ____________ ##</font></i>

}
<a id=Bars></a>
<i><font color=#4b5d50># ________________________ Bars _________________________ #</font></i>
<a id=Methods_of_Bars></a>
<i><font color=#4b5d50>## ____________ Methods of Bars ____________ ##</font></i>

<b><font color=#ca14ca>oo::define</font></b> ::bartabs::Bars {

<b><font color=#3a6797>variable</font></b> btData
<a id=constructor></a>
<b><font color=#ca14ca>constructor</font></b> {args} {
  <b><font color=#3a6797>set</font></b> btData [<b><font color=#3a6797>dict</font></b> create]
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>llength</font></b> [<b><font color=#ca14ca>self</font></b> next]]} { <b><font color=#3a6797>next</font></b> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font> }
  <b><font color=#ca14ca>oo::objdefine</font></b> [<b><font color=#ca14ca>self</font></b>] <font color=#8b2a0e>&quot;method tab-1 <font color=#1b1baa>{</font>args<font color=#1b1baa>}</font> <font color=#1b1baa>{</font>return <font color=#1b1baa>{</font>-1<font color=#1b1baa>}}</font>&quot;</font>
  <b><font color=#3a6797>lappend</font></b> ::bartabs::BarsList [<b><font color=#ca14ca>self</font></b>]
}
<a id=destructor></a>
<b><font color=#ca14ca>destructor</font></b> {
  <b><font color=#ca14ca>my</font></b> removeAll
  <b><font color=#3a6797>unset</font></b> btData
  <b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>lsearch</font></b> <font color=#653760>-exact</font> <font color=#1b1baa>$::bartabs::BarsList</font> [<b><font color=#ca14ca>self</font></b>]]
  <b><font color=#3a6797>set</font></b> ::bartabs::BarsList [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$::bartabs::BarsList</font> <font color=#1b1baa>$i</font> <font color=#1b1baa>$i</font>]
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>llength</font></b> [<b><font color=#ca14ca>self</font></b> next]]} <b><font color=#3a6797>next</font></b>
}
<a id=Private_methods_of_Bars></a>
<i><font color=#4b5d50>## ____________ Private methods of Bars ____________ ##</font></i>
<a id=Bars_Method></a>
<b><font color=#ca14ca>method</font></b> Bars_Method {mtd args} {
<i><font color=#4b5d50># Executes a method for all bars.</font></i>
<i><font color=#4b5d50>#   mtd - method's name</font></i>
<i><font color=#4b5d50>#   args - method's arguments</font></i>

  <b><font color=#3a6797>foreach</font></b> BID [<b><font color=#3a6797>lsort</font></b> <font color=#653760>-decreasing</font> [<b><font color=#3a6797>dict</font></b> keys <font color=#1b1baa>$btData</font>]] {<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> <font color=#1b1baa>$mtd</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>}
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=MarkTab></a>
<b><font color=#ca14ca>method</font></b> MarkTab {opt args} {
<i><font color=#4b5d50># Sets option of tab(s).</font></i>
<i><font color=#4b5d50>#   opt - option</font></i>
<i><font color=#4b5d50>#   args - list of TID</font></i>

  <b><font color=#3a6797>foreach</font></b> TID <font color=#1b1baa>$args</font> {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$TID</font> ni {{} -1}} {
      <b><font color=#3a6797>set</font></b> BID [<b><font color=#3a6797>lindex</font></b> [<b><font color=#ca14ca>my</font></b> Tab_BID <font color=#1b1baa>$TID</font>] 0]
      <b><font color=#3a6797>set</font></b> marktabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#1b1baa>$opt</font>]
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>lsearch</font></b> <font color=#1b1baa>$marktabs</font> <font color=#1b1baa>$TID</font>]&lt;0} {
        <b><font color=#3a6797>lappend</font></b> marktabs <font color=#1b1baa>$TID</font>
        <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#1b1baa>$opt</font> <font color=#1b1baa>$marktabs</font>
      }
    }
  }
  <b><font color=#ca14ca>my</font></b> Tab_MarkBars
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=UnmarkTab></a>
<b><font color=#ca14ca>method</font></b> UnmarkTab {opt args} {
<i><font color=#4b5d50># Unsets option of tab(s).</font></i>
<i><font color=#4b5d50>#   opt - option</font></i>
<i><font color=#4b5d50>#   args - list of TID</font></i>

  <b><font color=#3a6797>if</font></b> {![<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$args</font>]} {<b><font color=#ca14ca>my</font></b> Bars_Method configure <font color=#1b1baa>$opt</font> [<b><font color=#3a6797>list</font></b>]}
  <b><font color=#3a6797>foreach</font></b> TID <font color=#1b1baa>$args</font> {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$TID</font> ni {{} -1}} {
      <b><font color=#3a6797>set</font></b> BID [<b><font color=#3a6797>lindex</font></b> [<b><font color=#ca14ca>my</font></b> Tab_BID <font color=#1b1baa>$TID</font>] 0]
      <b><font color=#3a6797>set</font></b> marktabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#1b1baa>$opt</font>]
      <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>lsearch</font></b> <font color=#1b1baa>$marktabs</font> <font color=#1b1baa>$TID</font>]]&gt;=0} {
        <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#1b1baa>$opt</font> [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$marktabs</font> <font color=#1b1baa>$i</font> <font color=#1b1baa>$i</font>]
      }
    }
  }
  <b><font color=#ca14ca>my</font></b> Tab_MarkBars
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=TtkTheme></a>
<b><font color=#ca14ca>method</font></b> TtkTheme {} {
  <i><font color=#4b5d50># Checks if a standard ttk theme is used.</font></i>

  <b><font color=#3a6797>expr</font></b> {[<b><font color=#134070>ttk::style</font></b> theme use] in {clam alt classic default awdark awlight}}
}
<a id=Public_methods_of_Bars></a>
<i><font color=#4b5d50>## ____________ Public methods of Bars ____________ ##</font></i>
<a id=create></a>
<b><font color=#ca14ca>method</font></b> create {barCom {barOpts <font color=#8b2a0e>&quot;&quot;</font>} {tab1 <font color=#8b2a0e>&quot;&quot;</font>}} {
<i><font color=#4b5d50># Creates a bar.</font></i>
<i><font color=#4b5d50>#   barCom - bar command's name or barOpts</font></i>
<i><font color=#4b5d50>#   barOpts - list of bar's options</font></i>
<i><font color=#4b5d50>#   tab1 - tab to show after creating the bar</font></i>
<i><font color=#4b5d50># Returns BID.</font></i>

  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> noComm [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$barOpts</font> eq {}}]]} {<b><font color=#3a6797>set</font></b> barOpts <font color=#1b1baa>$barCom</font>}
  <b><font color=#3a6797>set</font></b> w [<b><font color=#3a6797>dict</font></b> get <font color=#1b1baa>$barOpts</font> <font color=#653760>-wbar</font>] ;<i><font color=#4b5d50># parent window</font></i>
  <b><font color=#3a6797>set</font></b> wframe <font color=#1b1baa>$w</font>.frame ;<i><font color=#4b5d50># frame</font></i>
  <b><font color=#3a6797>set</font></b> wlarr <font color=#1b1baa>$w</font>.larr   ;<i><font color=#4b5d50># left arrow</font></i>
  <b><font color=#3a6797>set</font></b> wrarr <font color=#1b1baa>$w</font>.rarr   ;<i><font color=#4b5d50># right arrow</font></i>
  <b><font color=#3a6797>lappend</font></b> barOpts <font color=#653760>-WWID</font> [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$wframe</font> <font color=#1b1baa>$wlarr</font> <font color=#1b1baa>$wrarr</font>]
  <b><font color=#ca14ca>my</font></b> My [<b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> Bar_Data <font color=#1b1baa>$barOpts</font>]]
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> InitColors
  <b><font color=#3a6797>set</font></b> bgm [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-BGMAIN</font>]
  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> TtkTheme]} {
    <b><font color=#134070>ttk::button</font></b> <font color=#1b1baa>$wlarr</font> <font color=#653760>-style</font> ClButton<font color=#1b1baa>$BID</font> <font color=#653760>-image</font> bts_ImgLeft \
      <font color=#653760>-command</font> [<b><font color=#3a6797>list</font></b> [<b><font color=#ca14ca>self</font></b>] <font color=#1b1baa>$BID</font> scrollLeft] <font color=#653760>-takefocus</font> 0
    <b><font color=#134070>ttk::button</font></b> <font color=#1b1baa>$wrarr</font> <font color=#653760>-style</font> ClButton<font color=#1b1baa>$BID</font> <font color=#653760>-image</font> bts_ImgRight \
      <font color=#653760>-command</font> [<b><font color=#3a6797>list</font></b> [<b><font color=#ca14ca>self</font></b>] <font color=#1b1baa>$BID</font> scrollRight] <font color=#653760>-takefocus</font> 0
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#134070>button</font></b> <font color=#1b1baa>$wlarr</font> <font color=#653760>-image</font> bts_ImgLeft <font color=#653760>-borderwidth</font> 0 <font color=#653760>-highlightthickness</font> 0 \
      <font color=#653760>-command</font> [<b><font color=#3a6797>list</font></b> [<b><font color=#ca14ca>self</font></b>] <font color=#1b1baa>$BID</font> scrollLeft] <font color=#653760>-takefocus</font> 0 <font color=#653760>-background</font> <font color=#1b1baa>$bgm</font>
    <b><font color=#134070>button</font></b> <font color=#1b1baa>$wrarr</font> <font color=#653760>-image</font> bts_ImgRight <font color=#653760>-borderwidth</font> 0 <font color=#653760>-highlightthickness</font> 0 \
      <font color=#653760>-command</font> [<b><font color=#3a6797>list</font></b> [<b><font color=#ca14ca>self</font></b>] <font color=#1b1baa>$BID</font> scrollRight] <font color=#653760>-takefocus</font> 0 <font color=#653760>-background</font> <font color=#1b1baa>$bgm</font>
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$bgm</font> eq {}} {<b><font color=#3a6797>set</font></b> style {}} {<b><font color=#3a6797>set</font></b> style <font color=#8b2a0e>&quot;-background <font color=#1b1baa>$</font>bgm&quot;</font>}
  <b><font color=#134070>frame</font></b> <font color=#1b1baa>$wframe</font> <font color=#653760>-relief</font> flat {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$style</font>
  <b><font color=#134070>pack</font></b> <font color=#1b1baa>$wlarr</font> <font color=#653760>-side</font> left <font color=#653760>-padx</font> 0 <font color=#653760>-pady</font> 0 <font color=#653760>-anchor</font> e
  <b><font color=#134070>pack</font></b> <font color=#1b1baa>$wframe</font> <font color=#653760>-after</font> <font color=#1b1baa>$wlarr</font> <font color=#653760>-side</font> left <font color=#653760>-padx</font> 0 <font color=#653760>-pady</font> 0 <font color=#653760>-fill</font> x <font color=#653760>-expand</font> 1
  <b><font color=#134070>pack</font></b> <font color=#1b1baa>$wrarr</font> <font color=#653760>-after</font> <font color=#1b1baa>$wframe</font> <font color=#653760>-side</font> right <font color=#653760>-padx</font> 0 <font color=#653760>-pady</font> 0 <font color=#653760>-anchor</font> w
  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-separator</font>]} {
    <b><font color=#3a6797>if</font></b> {![<b><font color=#134070>winfo</font></b> exists <font color=#1b1baa>$w</font>.under]} {
      <b><font color=#134070>ttk::separator</font></b> <font color=#1b1baa>$w</font>.under <font color=#653760>-orient</font> horizontal
      <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-UNDERWID</font> <font color=#1b1baa>$w</font>.under
    }
    <b><font color=#134070>pack</font></b> <font color=#1b1baa>$w</font>.under <font color=#653760>-before</font> <font color=#1b1baa>$wlarr</font> <font color=#653760>-side</font> bottom <font color=#653760>-fill</font> x <font color=#653760>-expand</font> 1 <font color=#653760>-padx</font> 0 <font color=#653760>-pady</font> 2
  }
  <b><font color=#3a6797>foreach</font></b> w {wlarr wrarr} {
    <b><font color=#134070>bind</font></b> [<b><font color=#3a6797>set</font></b> <font color=#1b1baa>$w</font>] &lt;Button-3&gt; <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>BID popList %X %Y&quot;</font>
  }
  <b><font color=#3a6797>set</font></b> wbase [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-wbase</font>]
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$wbase</font> ne {}} {
    <b><font color=#3a6797>after</font></b> 1 [<b><font color=#3a6797>list</font></b> \
      <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-BINDWBASE</font> [<b><font color=#3a6797>list</font></b> <font color=#1b1baa>$wbase</font> [<b><font color=#134070>bind</font></b> <font color=#1b1baa>$wbase</font> &lt;Configure&gt;]] ; \
      <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> bindToEvent <font color=#1b1baa>$wbase</font> &lt;Configure&gt; [<b><font color=#ca14ca>self</font></b>] _runBound_ <font color=#1b1baa>$wbase</font> &lt;Configure&gt; <font color=#1b1baa>$BID</font> NeedDraw]
  }
  <b><font color=#3a6797>if</font></b> {!<font color=#1b1baa>$noComm</font>} {
  ; <b><font color=#ca14ca>proc</font></b> <font color=#1b1baa>$barCom</font> {args} <font color=#8b2a0e>&quot;return \[<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>BID <font color=#1b1baa>{</font>*<font color=#1b1baa>}</font>\$args\]&quot;</font>
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-BARCOM</font> <font color=#1b1baa>$barCom</font>
  }
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tab1</font> eq {}} {
    <b><font color=#3a6797>after</font></b> 50 [<b><font color=#3a6797>list</font></b> [<b><font color=#ca14ca>self</font></b>] <font color=#1b1baa>$BID</font> NeedDraw ; [<b><font color=#ca14ca>self</font></b>] <font color=#1b1baa>$BID</font> draw]
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#3a6797>set</font></b> tab1 [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> tabID <font color=#1b1baa>$tab1</font>]
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tab1</font> ne {}} {<b><font color=#3a6797>after</font></b> 100 <font color=#8b2a0e>&quot;<font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>BID clear; <font color=#1b1baa>[</font>self<font color=#1b1baa>]</font> <font color=#1b1baa>$</font>BID <font color=#1b1baa>$</font>tab1 show yes&quot;</font>}
  }
  <b><font color=#ca14ca>return</font></b> <font color=#1b1baa>$BID</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=updateAll></a>
<b><font color=#ca14ca>method</font></b> updateAll {} {
<i><font color=#4b5d50># Updates all bars in hard way.</font></i>

  <b><font color=#ca14ca>my</font></b> Bars_Method Refill 0 yes
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=drawAll></a>
<b><font color=#ca14ca>method</font></b> drawAll {{upd yes}} {
<i><font color=#4b5d50># Redraws all bars.</font></i>
<i><font color=#4b5d50>#   upd - if &quot;yes&quot;, run &quot;update&quot; before redrawing</font></i>

  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$upd</font>} <b><font color=#3a6797>update</font></b>
  <b><font color=#ca14ca>my</font></b> Bars_Method draw no
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=removeAll></a>
<b><font color=#ca14ca>method</font></b> removeAll {} {
<i><font color=#4b5d50># Removes all bars.</font></i>

  <b><font color=#ca14ca>my</font></b> Bars_Method remove
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=markTab></a>
<b><font color=#ca14ca>method</font></b> markTab {args} {
<i><font color=#4b5d50># Marks tab(s).</font></i>
<i><font color=#4b5d50>#   args - list of TID</font></i>

  <b><font color=#ca14ca>my</font></b> MarkTab <font color=#653760>-mark</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=unmarkTab></a>
<b><font color=#ca14ca>method</font></b> unmarkTab {args} {
<i><font color=#4b5d50># Unmarks tab(s).</font></i>
<i><font color=#4b5d50>#   args - list of TID or {}</font></i>

  <b><font color=#ca14ca>my</font></b> UnmarkTab <font color=#653760>-mark</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=onSelectCmd></a>
<b><font color=#ca14ca>method</font></b> onSelectCmd {args} {
  <i><font color=#4b5d50># Runs a command (set by &quot;-csel3&quot;) on a list of tabs.</font></i>
  <i><font color=#4b5d50>#   args - list of TID</font></i>

  <b><font color=#3a6797>foreach</font></b> TID <font color=#1b1baa>$args</font> {
    <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$TID</font> ni {{} -1}} {
      <b><font color=#3a6797>set</font></b> BID [<b><font color=#3a6797>lindex</font></b> [<b><font color=#ca14ca>my</font></b> Tab_BID <font color=#1b1baa>$TID</font>] 0]
      <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Bar_Cmd2 <font color=#653760>-csel3</font> <font color=#1b1baa>$TID</font> ;<i><font color=#4b5d50># command after the action</font></i>
    }
  }
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=selectTab></a>
<b><font color=#ca14ca>method</font></b> selectTab {args} {
<i><font color=#4b5d50># Selects tab(s).</font></i>
<i><font color=#4b5d50>#   args - list of TID</font></i>

  <b><font color=#ca14ca>my</font></b> MarkTab <font color=#653760>-select</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
  <b><font color=#ca14ca>my</font></b> onSelectCmd {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=unselectTab></a>
<b><font color=#ca14ca>method</font></b> unselectTab {args} {
<i><font color=#4b5d50># Unselects tab(s).</font></i>
<i><font color=#4b5d50>#   args - list of TID or {}</font></i>

  <b><font color=#ca14ca>my</font></b> UnmarkTab <font color=#653760>-select</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
  <b><font color=#ca14ca>my</font></b> onSelectCmd {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=enableTab></a>
<b><font color=#ca14ca>method</font></b> enableTab {args} {
<i><font color=#4b5d50># Enables tab(s).</font></i>
<i><font color=#4b5d50>#   args - list of TID or {}</font></i>

  <b><font color=#ca14ca>my</font></b> UnmarkTab <font color=#653760>-disable</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=disableTab></a>
<b><font color=#ca14ca>method</font></b> disableTab {args} {
<i><font color=#4b5d50># Disables tab(s).</font></i>
<i><font color=#4b5d50>#   args - list of TID</font></i>

  <b><font color=#ca14ca>my</font></b> MarkTab <font color=#653760>-disable</font> {<b><font color=#3a6797>*</font></b>}<font color=#1b1baa>$args</font>
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=isTab></a>
<b><font color=#ca14ca>method</font></b> isTab {TID} {
<i><font color=#4b5d50># Checks if a tab exists.</font></i>
<i><font color=#4b5d50>#   TID - tab ID</font></i>
<i><font color=#4b5d50># Returns true if the tab exists.</font></i>

  <b><font color=#3a6797>expr</font></b> {[<b><font color=#ca14ca>my</font></b> Tab_BID <font color=#1b1baa>$TID</font> check] ne {}}
}
<i><font color=#4b5d50>#_______________________</font></i>
<a id=MoveTab></a>
<b><font color=#ca14ca>method</font></b> MoveTab {TID1 TID2} {
<i><font color=#4b5d50># Changes a tab's position in bar.</font></i>
<i><font color=#4b5d50>#   TID1 - TID of the moved tab</font></i>
<i><font color=#4b5d50>#   TID2 - TID of a tab to move TID1 behind</font></i>
<i><font color=#4b5d50># TID1 and TID2 must be of the same bar.</font></i>

  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_BID <font color=#1b1baa>$TID1</font>] BID1 i1
  <b><font color=#3a6797>lassign</font></b> [<b><font color=#ca14ca>my</font></b> Tab_BID <font color=#1b1baa>$TID2</font>] BID2 i2
  <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$i1</font>!=<font color=#1b1baa>$i2</font> && <font color=#1b1baa>$BID1</font> eq <font color=#1b1baa>$BID2</font>} {
    <b><font color=#3a6797>set</font></b> tabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID1</font> cget <font color=#653760>-TABS</font>]
    <b><font color=#3a6797>set</font></b> tab [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i1</font>]
    <b><font color=#3a6797>set</font></b> tabs [<b><font color=#3a6797>lreplace</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i1</font> <font color=#1b1baa>$i1</font>]
    <b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>expr</font></b> {<font color=#1b1baa>$i1</font>&gt;<font color=#1b1baa>$i2</font>?(<font color=#1b1baa>$i2</font>+1):<font color=#1b1baa>$i2</font>}]
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID1</font> configure <font color=#653760>-TABS</font> [<b><font color=#3a6797>linsert</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i</font> <font color=#1b1baa>$tab</font>]
    <i><font color=#4b5d50># let a neighbor be shown if possible</font></i>
    <b><font color=#3a6797>set</font></b> TID [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$tabs</font> <font color=#1b1baa>$i1</font> 0]
    <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>catch</font></b> {<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID</font> show yes}]} {
      <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID1</font> show yes ;<i><font color=#4b5d50># old way: show 1st moved tab</font></i>
    }
  }
}

<i><font color=#4b5d50>#_______________________</font></i>
<a id=moveSelTab></a>
<b><font color=#ca14ca>method</font></b> moveSelTab {TID1 TID2} {
<i><font color=#4b5d50># Changes a tab's or selected tabs' position in bar.</font></i>
<i><font color=#4b5d50>#   TID1 - TID of the moved tab</font></i>
<i><font color=#4b5d50>#   TID2 - TID of a tab to move TID1 behind</font></i>
<i><font color=#4b5d50># TID1 and TID2 must be of the same bar.</font></i>

  <b><font color=#3a6797>if</font></b> {[<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$TID1</font> Tab_Cmd <font color=#653760>-cmov</font>] ni {<font color=#8b2a0e>&quot;1&quot;</font> <font color=#8b2a0e>&quot;yes&quot;</font> <font color=#8b2a0e>&quot;true&quot;</font>}} <b><font color=#ca14ca>return</font></b> ;<i><font color=#4b5d50># chosen to not move</font></i>
  <b><font color=#3a6797>set</font></b> BID [<b><font color=#ca14ca>my</font></b> Tab_BID <font color=#1b1baa>$TID1</font> check]
  <i><font color=#4b5d50># -lifo option prevents moving, so it has to be temporarily disabled</font></i>
  <b><font color=#3a6797>set</font></b> lifo [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> cget <font color=#653760>-lifo</font>]
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-lifo</font> no
  <b><font color=#3a6797>set</font></b> seltabs [<b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> listFlag <font color=#8b2a0e>&quot;s&quot;</font>]
  <b><font color=#3a6797>if</font></b> {[<b><font color=#3a6797>set</font></b> i [<b><font color=#3a6797>llength</font></b> <font color=#1b1baa>$seltabs</font>]]&gt;1} {
    <b><font color=#3a6797>for</font></b> {<b><font color=#3a6797>incr</font></b> i -1} {<font color=#1b1baa>$i</font>&gt;=0} {<b><font color=#3a6797>incr</font></b> i -1} {
      <b><font color=#3a6797>set</font></b> tid [<b><font color=#3a6797>lindex</font></b> <font color=#1b1baa>$seltabs</font> <font color=#1b1baa>$i</font>]
      <b><font color=#3a6797>if</font></b> {<font color=#1b1baa>$tid</font> ne <font color=#1b1baa>$TID2</font>} {<b><font color=#ca14ca>my</font></b> MoveTab <font color=#1b1baa>$tid</font> <font color=#1b1baa>$TID2</font>}
    }
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Bar_Cmd2 <font color=#653760>-cmov3</font>
  } <b><font color=#3a6797>else</font></b> {
    <b><font color=#ca14ca>my</font></b> MoveTab <font color=#1b1baa>$TID1</font> <font color=#1b1baa>$TID2</font>
    <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> Bar_Cmd2 <font color=#653760>-cmov3</font> <font color=#1b1baa>$TID1</font> ;<i><font color=#4b5d50># command after the action</font></i>
  }
  <b><font color=#ca14ca>my</font></b> <font color=#1b1baa>$BID</font> configure <font color=#653760>-lifo</font> <font color=#1b1baa>$lifo</font>  ;<i><font color=#4b5d50># restore -lifo option</font></i>
}
<a id=EOC_Bars></a>
<i><font color=#4b5d50>## ____________ EOC Bars ____________ ##</font></i>

}
<a id=EOF></a>
<i><font color=#4b5d50># ________________________________ EOF __________________________________ #</font></i>

</pre>

<table border=0 cellPadding=4 cellSpacing=0 width=100%>  <td border=0 bgColor=#bdd7e7><div style=text-align:center>  <a href="../../index.html"><font color=#1a1a1a size=6>  <b>bartabs.tcl</b></font></div></td></table>

</section>
<script>
  writeFooter('Generated by <a href="'+homeLINK()+'/en/tcl/alited/index.html">alited</a> &amp; <a href="'+homeLINK()+'/en/tcl/mulster/index.html">mulster</a></a>');
</script>
</div>
</body>
</html>